(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();function ip(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var gg={exports:{}},Cc={},_g={exports:{}},Ot={};var hw;function uI(){if(hw)return Ot;hw=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function m(N){return N===null||typeof N!="object"?null:(N=p&&N[p]||N["@@iterator"],typeof N=="function"?N:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,E={};function g(N,H,U){this.props=N,this.context=H,this.refs=E,this.updater=U||y}g.prototype.isReactComponent={},g.prototype.setState=function(N,H){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,H,"setState")},g.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function v(){}v.prototype=g.prototype;function x(N,H,U){this.props=N,this.context=H,this.refs=E,this.updater=U||y}var w=x.prototype=new v;w.constructor=x,S(w,g.prototype),w.isPureReactComponent=!0;var C=Array.isArray,T=Object.prototype.hasOwnProperty,M={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function F(N,H,U){var P,L={},G=null,Q=null;if(H!=null)for(P in H.ref!==void 0&&(Q=H.ref),H.key!==void 0&&(G=""+H.key),H)T.call(H,P)&&!A.hasOwnProperty(P)&&(L[P]=H[P]);var le=arguments.length-2;if(le===1)L.children=U;else if(1<le){for(var xe=Array(le),Te=0;Te<le;Te++)xe[Te]=arguments[Te+2];L.children=xe}if(N&&N.defaultProps)for(P in le=N.defaultProps,le)L[P]===void 0&&(L[P]=le[P]);return{$$typeof:t,type:N,key:G,ref:Q,props:L,_owner:M.current}}function I(N,H){return{$$typeof:t,type:N.type,key:H,ref:N.ref,props:N.props,_owner:N._owner}}function O(N){return typeof N=="object"&&N!==null&&N.$$typeof===t}function W(N){var H={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(U){return H[U]})}var J=/\/+/g;function ae(N,H){return typeof N=="object"&&N!==null&&N.key!=null?W(""+N.key):H.toString(36)}function Z(N,H,U,P,L){var G=typeof N;(G==="undefined"||G==="boolean")&&(N=null);var Q=!1;if(N===null)Q=!0;else switch(G){case"string":case"number":Q=!0;break;case"object":switch(N.$$typeof){case t:case e:Q=!0}}if(Q)return Q=N,L=L(Q),N=P===""?"."+ae(Q,0):P,C(L)?(U="",N!=null&&(U=N.replace(J,"$&/")+"/"),Z(L,H,U,"",function(Te){return Te})):L!=null&&(O(L)&&(L=I(L,U+(!L.key||Q&&Q.key===L.key?"":(""+L.key).replace(J,"$&/")+"/")+N)),H.push(L)),1;if(Q=0,P=P===""?".":P+":",C(N))for(var le=0;le<N.length;le++){G=N[le];var xe=P+ae(G,le);Q+=Z(G,H,U,xe,L)}else if(xe=m(N),typeof xe=="function")for(N=xe.call(N),le=0;!(G=N.next()).done;)G=G.value,xe=P+ae(G,le++),Q+=Z(G,H,U,xe,L);else if(G==="object")throw H=String(N),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.");return Q}function ie(N,H,U){if(N==null)return N;var P=[],L=0;return Z(N,P,"","",function(G){return H.call(U,G,L++)}),P}function de(N){if(N._status===-1){var H=N._result;H=H(),H.then(function(U){(N._status===0||N._status===-1)&&(N._status=1,N._result=U)},function(U){(N._status===0||N._status===-1)&&(N._status=2,N._result=U)}),N._status===-1&&(N._status=0,N._result=H)}if(N._status===1)return N._result.default;throw N._result}var pe={current:null},K={transition:null},ne={ReactCurrentDispatcher:pe,ReactCurrentBatchConfig:K,ReactCurrentOwner:M};function j(){throw Error("act(...) is not supported in production builds of React.")}return Ot.Children={map:ie,forEach:function(N,H,U){ie(N,function(){H.apply(this,arguments)},U)},count:function(N){var H=0;return ie(N,function(){H++}),H},toArray:function(N){return ie(N,function(H){return H})||[]},only:function(N){if(!O(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},Ot.Component=g,Ot.Fragment=n,Ot.Profiler=i,Ot.PureComponent=x,Ot.StrictMode=r,Ot.Suspense=u,Ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ne,Ot.act=j,Ot.cloneElement=function(N,H,U){if(N==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+N+".");var P=S({},N.props),L=N.key,G=N.ref,Q=N._owner;if(H!=null){if(H.ref!==void 0&&(G=H.ref,Q=M.current),H.key!==void 0&&(L=""+H.key),N.type&&N.type.defaultProps)var le=N.type.defaultProps;for(xe in H)T.call(H,xe)&&!A.hasOwnProperty(xe)&&(P[xe]=H[xe]===void 0&&le!==void 0?le[xe]:H[xe])}var xe=arguments.length-2;if(xe===1)P.children=U;else if(1<xe){le=Array(xe);for(var Te=0;Te<xe;Te++)le[Te]=arguments[Te+2];P.children=le}return{$$typeof:t,type:N.type,key:L,ref:G,props:P,_owner:Q}},Ot.createContext=function(N){return N={$$typeof:l,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},N.Provider={$$typeof:a,_context:N},N.Consumer=N},Ot.createElement=F,Ot.createFactory=function(N){var H=F.bind(null,N);return H.type=N,H},Ot.createRef=function(){return{current:null}},Ot.forwardRef=function(N){return{$$typeof:c,render:N}},Ot.isValidElement=O,Ot.lazy=function(N){return{$$typeof:h,_payload:{_status:-1,_result:N},_init:de}},Ot.memo=function(N,H){return{$$typeof:f,type:N,compare:H===void 0?null:H}},Ot.startTransition=function(N){var H=K.transition;K.transition={};try{N()}finally{K.transition=H}},Ot.unstable_act=j,Ot.useCallback=function(N,H){return pe.current.useCallback(N,H)},Ot.useContext=function(N){return pe.current.useContext(N)},Ot.useDebugValue=function(){},Ot.useDeferredValue=function(N){return pe.current.useDeferredValue(N)},Ot.useEffect=function(N,H){return pe.current.useEffect(N,H)},Ot.useId=function(){return pe.current.useId()},Ot.useImperativeHandle=function(N,H,U){return pe.current.useImperativeHandle(N,H,U)},Ot.useInsertionEffect=function(N,H){return pe.current.useInsertionEffect(N,H)},Ot.useLayoutEffect=function(N,H){return pe.current.useLayoutEffect(N,H)},Ot.useMemo=function(N,H){return pe.current.useMemo(N,H)},Ot.useReducer=function(N,H,U){return pe.current.useReducer(N,H,U)},Ot.useRef=function(N){return pe.current.useRef(N)},Ot.useState=function(N){return pe.current.useState(N)},Ot.useSyncExternalStore=function(N,H,U){return pe.current.useSyncExternalStore(N,H,U)},Ot.useTransition=function(){return pe.current.useTransition()},Ot.version="18.3.1",Ot}var pw;function Hv(){return pw||(pw=1,_g.exports=uI()),_g.exports}var mw;function dI(){if(mw)return Cc;mw=1;var t=Hv(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(c,u,f){var h,p={},m=null,y=null;f!==void 0&&(m=""+f),u.key!==void 0&&(m=""+u.key),u.ref!==void 0&&(y=u.ref);for(h in u)r.call(u,h)&&!a.hasOwnProperty(h)&&(p[h]=u[h]);if(c&&c.defaultProps)for(h in u=c.defaultProps,u)p[h]===void 0&&(p[h]=u[h]);return{$$typeof:e,type:c,key:m,ref:y,props:p,_owner:i.current}}return Cc.Fragment=n,Cc.jsx=l,Cc.jsxs=l,Cc}var gw;function fI(){return gw||(gw=1,gg.exports=dI()),gg.exports}var q=fI(),V=Hv();const qt=ip(V);var Vd={},vg={exports:{}},zr={},yg={exports:{}},Sg={};var _w;function hI(){return _w||(_w=1,(function(t){function e(K,ne){var j=K.length;K.push(ne);e:for(;0<j;){var N=j-1>>>1,H=K[N];if(0<i(H,ne))K[N]=ne,K[j]=H,j=N;else break e}}function n(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var ne=K[0],j=K.pop();if(j!==ne){K[0]=j;e:for(var N=0,H=K.length,U=H>>>1;N<U;){var P=2*(N+1)-1,L=K[P],G=P+1,Q=K[G];if(0>i(L,j))G<H&&0>i(Q,L)?(K[N]=Q,K[G]=j,N=G):(K[N]=L,K[P]=j,N=P);else if(G<H&&0>i(Q,j))K[N]=Q,K[G]=j,N=G;else break e}}return ne}function i(K,ne){var j=K.sortIndex-ne.sortIndex;return j!==0?j:K.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var u=[],f=[],h=1,p=null,m=3,y=!1,S=!1,E=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(K){for(var ne=n(f);ne!==null;){if(ne.callback===null)r(f);else if(ne.startTime<=K)r(f),ne.sortIndex=ne.expirationTime,e(u,ne);else break;ne=n(f)}}function C(K){if(E=!1,w(K),!S)if(n(u)!==null)S=!0,de(T);else{var ne=n(f);ne!==null&&pe(C,ne.startTime-K)}}function T(K,ne){S=!1,E&&(E=!1,v(F),F=-1),y=!0;var j=m;try{for(w(ne),p=n(u);p!==null&&(!(p.expirationTime>ne)||K&&!W());){var N=p.callback;if(typeof N=="function"){p.callback=null,m=p.priorityLevel;var H=N(p.expirationTime<=ne);ne=t.unstable_now(),typeof H=="function"?p.callback=H:p===n(u)&&r(u),w(ne)}else r(u);p=n(u)}if(p!==null)var U=!0;else{var P=n(f);P!==null&&pe(C,P.startTime-ne),U=!1}return U}finally{p=null,m=j,y=!1}}var M=!1,A=null,F=-1,I=5,O=-1;function W(){return!(t.unstable_now()-O<I)}function J(){if(A!==null){var K=t.unstable_now();O=K;var ne=!0;try{ne=A(!0,K)}finally{ne?ae():(M=!1,A=null)}}else M=!1}var ae;if(typeof x=="function")ae=function(){x(J)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,ie=Z.port2;Z.port1.onmessage=J,ae=function(){ie.postMessage(null)}}else ae=function(){g(J,0)};function de(K){A=K,M||(M=!0,ae())}function pe(K,ne){F=g(function(){K(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_continueExecution=function(){S||y||(S=!0,de(T))},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(K){switch(m){case 1:case 2:case 3:var ne=3;break;default:ne=m}var j=m;m=ne;try{return K()}finally{m=j}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(K,ne){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var j=m;m=K;try{return ne()}finally{m=j}},t.unstable_scheduleCallback=function(K,ne,j){var N=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?N+j:N):j=N,K){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=j+H,K={id:h++,callback:ne,priorityLevel:K,startTime:j,expirationTime:H,sortIndex:-1},j>N?(K.sortIndex=j,e(f,K),n(u)===null&&K===n(f)&&(E?(v(F),F=-1):E=!0,pe(C,j-N))):(K.sortIndex=H,e(u,K),S||y||(S=!0,de(T))),K},t.unstable_shouldYield=W,t.unstable_wrapCallback=function(K){var ne=m;return function(){var j=m;m=ne;try{return K.apply(this,arguments)}finally{m=j}}}})(Sg)),Sg}var vw;function pI(){return vw||(vw=1,yg.exports=hI()),yg.exports}var yw;function mI(){if(yw)return zr;yw=1;var t=Hv(),e=pI();function n(s){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+s,d=1;d<arguments.length;d++)o+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function a(s,o){l(s,o),l(s+"Capture",o)}function l(s,o){for(i[s]=o,s=0;s<o.length;s++)r.add(o[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function m(s){return u.call(p,s)?!0:u.call(h,s)?!1:f.test(s)?p[s]=!0:(h[s]=!0,!1)}function y(s,o,d,_){if(d!==null&&d.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return _?!1:d!==null?!d.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function S(s,o,d,_){if(o===null||typeof o>"u"||y(s,o,d,_))return!0;if(_)return!1;if(d!==null)switch(d.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function E(s,o,d,_,b,R,k){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=_,this.attributeNamespace=b,this.mustUseProperty=d,this.propertyName=s,this.type=o,this.sanitizeURL=R,this.removeEmptyString=k}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){g[s]=new E(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var o=s[0];g[o]=new E(o,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){g[s]=new E(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){g[s]=new E(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){g[s]=new E(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){g[s]=new E(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){g[s]=new E(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){g[s]=new E(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){g[s]=new E(s,5,!1,s.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function x(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var o=s.replace(v,x);g[o]=new E(o,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var o=s.replace(v,x);g[o]=new E(o,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var o=s.replace(v,x);g[o]=new E(o,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){g[s]=new E(s,1,!1,s.toLowerCase(),null,!1,!1)}),g.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){g[s]=new E(s,1,!1,s.toLowerCase(),null,!0,!0)});function w(s,o,d,_){var b=g.hasOwnProperty(o)?g[o]:null;(b!==null?b.type!==0:_||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(S(o,d,b,_)&&(d=null),_||b===null?m(o)&&(d===null?s.removeAttribute(o):s.setAttribute(o,""+d)):b.mustUseProperty?s[b.propertyName]=d===null?b.type===3?!1:"":d:(o=b.attributeName,_=b.attributeNamespace,d===null?s.removeAttribute(o):(b=b.type,d=b===3||b===4&&d===!0?"":""+d,_?s.setAttributeNS(_,o,d):s.setAttribute(o,d))))}var C=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,T=Symbol.for("react.element"),M=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),W=Symbol.for("react.context"),J=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),Z=Symbol.for("react.suspense_list"),ie=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),pe=Symbol.for("react.offscreen"),K=Symbol.iterator;function ne(s){return s===null||typeof s!="object"?null:(s=K&&s[K]||s["@@iterator"],typeof s=="function"?s:null)}var j=Object.assign,N;function H(s){if(N===void 0)try{throw Error()}catch(d){var o=d.stack.trim().match(/\n( *(at )?)/);N=o&&o[1]||""}return`
`+N+s}var U=!1;function P(s,o){if(!s||U)return"";U=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(me){var _=me}Reflect.construct(s,[],o)}else{try{o.call()}catch(me){_=me}s.call(o.prototype)}else{try{throw Error()}catch(me){_=me}s()}}catch(me){if(me&&_&&typeof me.stack=="string"){for(var b=me.stack.split(`
`),R=_.stack.split(`
`),k=b.length-1,Y=R.length-1;1<=k&&0<=Y&&b[k]!==R[Y];)Y--;for(;1<=k&&0<=Y;k--,Y--)if(b[k]!==R[Y]){if(k!==1||Y!==1)do if(k--,Y--,0>Y||b[k]!==R[Y]){var te=`
`+b[k].replace(" at new "," at ");return s.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",s.displayName)),te}while(1<=k&&0<=Y);break}}}finally{U=!1,Error.prepareStackTrace=d}return(s=s?s.displayName||s.name:"")?H(s):""}function L(s){switch(s.tag){case 5:return H(s.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return s=P(s.type,!1),s;case 11:return s=P(s.type.render,!1),s;case 1:return s=P(s.type,!0),s;default:return""}}function G(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case A:return"Fragment";case M:return"Portal";case I:return"Profiler";case F:return"StrictMode";case ae:return"Suspense";case Z:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case W:return(s.displayName||"Context")+".Consumer";case O:return(s._context.displayName||"Context")+".Provider";case J:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case ie:return o=s.displayName||null,o!==null?o:G(s.type)||"Memo";case de:o=s._payload,s=s._init;try{return G(s(o))}catch{}}return null}function Q(s){var o=s.type;switch(s.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=o.render,s=s.displayName||s.name||"",o.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return G(o);case 8:return o===F?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function le(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function xe(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Te(s){var o=xe(s)?"checked":"value",d=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),_=""+s[o];if(!s.hasOwnProperty(o)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var b=d.get,R=d.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return b.call(this)},set:function(k){_=""+k,R.call(this,k)}}),Object.defineProperty(s,o,{enumerable:d.enumerable}),{getValue:function(){return _},setValue:function(k){_=""+k},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function X(s){s._valueTracker||(s._valueTracker=Te(s))}function z(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var d=o.getValue(),_="";return s&&(_=xe(s)?s.checked?"true":"false":s.value),s=_,s!==d?(o.setValue(s),!0):!1}function ve(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function he(s,o){var d=o.checked;return j({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??s._wrapperState.initialChecked})}function be(s,o){var d=o.defaultValue==null?"":o.defaultValue,_=o.checked!=null?o.checked:o.defaultChecked;d=le(o.value!=null?o.value:d),s._wrapperState={initialChecked:_,initialValue:d,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function Re(s,o){o=o.checked,o!=null&&w(s,"checked",o,!1)}function gt(s,o){Re(s,o);var d=le(o.value),_=o.type;if(d!=null)_==="number"?(d===0&&s.value===""||s.value!=d)&&(s.value=""+d):s.value!==""+d&&(s.value=""+d);else if(_==="submit"||_==="reset"){s.removeAttribute("value");return}o.hasOwnProperty("value")?$(s,o.type,d):o.hasOwnProperty("defaultValue")&&$(s,o.type,le(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(s.defaultChecked=!!o.defaultChecked)}function at(s,o,d){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var _=o.type;if(!(_!=="submit"&&_!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+s._wrapperState.initialValue,d||o===s.value||(s.value=o),s.defaultValue=o}d=s.name,d!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,d!==""&&(s.name=d)}function $(s,o,d){(o!=="number"||ve(s.ownerDocument)!==s)&&(d==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+d&&(s.defaultValue=""+d))}var D=Array.isArray;function oe(s,o,d,_){if(s=s.options,o){o={};for(var b=0;b<d.length;b++)o["$"+d[b]]=!0;for(d=0;d<s.length;d++)b=o.hasOwnProperty("$"+s[d].value),s[d].selected!==b&&(s[d].selected=b),b&&_&&(s[d].defaultSelected=!0)}else{for(d=""+le(d),o=null,b=0;b<s.length;b++){if(s[b].value===d){s[b].selected=!0,_&&(s[b].defaultSelected=!0);return}o!==null||s[b].disabled||(o=s[b])}o!==null&&(o.selected=!0)}}function Me(s,o){if(o.dangerouslySetInnerHTML!=null)throw Error(n(91));return j({},o,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function Ee(s,o){var d=o.value;if(d==null){if(d=o.children,o=o.defaultValue,d!=null){if(o!=null)throw Error(n(92));if(D(d)){if(1<d.length)throw Error(n(93));d=d[0]}o=d}o==null&&(o=""),d=o}s._wrapperState={initialValue:le(d)}}function Ie(s,o){var d=le(o.value),_=le(o.defaultValue);d!=null&&(d=""+d,d!==s.value&&(s.value=d),o.defaultValue==null&&s.defaultValue!==d&&(s.defaultValue=d)),_!=null&&(s.defaultValue=""+_)}function et(s){var o=s.textContent;o===s._wrapperState.initialValue&&o!==""&&o!==null&&(s.value=o)}function ze(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ze(s,o){return s==null||s==="http://www.w3.org/1999/xhtml"?ze(o):s==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var ot,St=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,d,_,b){MSApp.execUnsafeLocalFunction(function(){return s(o,d,_,b)})}:s})(function(s,o){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=o;else{for(ot=ot||document.createElement("div"),ot.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=ot.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;o.firstChild;)s.appendChild(o.firstChild)}});function Ae(s,o){if(o){var d=s.firstChild;if(d&&d===s.lastChild&&d.nodeType===3){d.nodeValue=o;return}}s.textContent=o}var zt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nt=["Webkit","ms","Moz","O"];Object.keys(zt).forEach(function(s){Nt.forEach(function(o){o=o+s.charAt(0).toUpperCase()+s.substring(1),zt[o]=zt[s]})});function vt(s,o,d){return o==null||typeof o=="boolean"||o===""?"":d||typeof o!="number"||o===0||zt.hasOwnProperty(s)&&zt[s]?(""+o).trim():o+"px"}function lt(s,o){s=s.style;for(var d in o)if(o.hasOwnProperty(d)){var _=d.indexOf("--")===0,b=vt(d,o[d],_);d==="float"&&(d="cssFloat"),_?s.setProperty(d,b):s[d]=b}}var Qe=j({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wt(s,o){if(o){if(Qe[s]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(n(137,s));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(n(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(n(61))}if(o.style!=null&&typeof o.style!="object")throw Error(n(62))}}function Bt(s,o){if(s.indexOf("-")===-1)return typeof o.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ln=null;function bt(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ue=null,re=null,$e=null;function Ve(s){if(s=hc(s)){if(typeof Ue!="function")throw Error(n(280));var o=s.stateNode;o&&(o=rd(o),Ue(s.stateNode,s.type,o))}}function pt(s){re?$e?$e.push(s):$e=[s]:re=s}function ct(){if(re){var s=re,o=$e;if($e=re=null,Ve(s),o)for(s=0;s<o.length;s++)Ve(o[s])}}function Yt(s,o){return s(o)}function Jt(){}var Mn=!1;function Gn(s,o,d){if(Mn)return s(o,d);Mn=!0;try{return Yt(s,o,d)}finally{Mn=!1,(re!==null||$e!==null)&&(Jt(),ct())}}function Ht(s,o){var d=s.stateNode;if(d===null)return null;var _=rd(d);if(_===null)return null;d=_[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(s=s.type,_=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!_;break e;default:s=!1}if(s)return null;if(d&&typeof d!="function")throw Error(n(231,o,typeof d));return d}var Un=!1;if(c)try{var cr={};Object.defineProperty(cr,"passive",{get:function(){Un=!0}}),window.addEventListener("test",cr,cr),window.removeEventListener("test",cr,cr)}catch{Un=!1}function Du(s,o,d,_,b,R,k,Y,te){var me=Array.prototype.slice.call(arguments,3);try{o.apply(d,me)}catch(Pe){this.onError(Pe)}}var Ta=!1,ss=null,Ma=!1,Us=null,Uu={onError:function(s){Ta=!0,ss=s}};function Fu(s,o,d,_,b,R,k,Y,te){Ta=!1,ss=null,Du.apply(Uu,arguments)}function Fp(s,o,d,_,b,R,k,Y,te){if(Fu.apply(this,arguments),Ta){if(Ta){var me=ss;Ta=!1,ss=null}else throw Error(n(198));Ma||(Ma=!0,Us=me)}}function as(s){var o=s,d=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(d=o.return),s=o.return;while(s)}return o.tag===3?d:null}function zu(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function B(s){if(as(s)!==s)throw Error(n(188))}function ue(s){var o=s.alternate;if(!o){if(o=as(s),o===null)throw Error(n(188));return o!==s?null:s}for(var d=s,_=o;;){var b=d.return;if(b===null)break;var R=b.alternate;if(R===null){if(_=b.return,_!==null){d=_;continue}break}if(b.child===R.child){for(R=b.child;R;){if(R===d)return B(b),s;if(R===_)return B(b),o;R=R.sibling}throw Error(n(188))}if(d.return!==_.return)d=b,_=R;else{for(var k=!1,Y=b.child;Y;){if(Y===d){k=!0,d=b,_=R;break}if(Y===_){k=!0,_=b,d=R;break}Y=Y.sibling}if(!k){for(Y=R.child;Y;){if(Y===d){k=!0,d=R,_=b;break}if(Y===_){k=!0,_=R,d=b;break}Y=Y.sibling}if(!k)throw Error(n(189))}}if(d.alternate!==_)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?s:o}function ye(s){return s=ue(s),s!==null?we(s):null}function we(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var o=we(s);if(o!==null)return o;s=s.sibling}return null}var ge=e.unstable_scheduleCallback,We=e.unstable_cancelCallback,st=e.unstable_shouldYield,ft=e.unstable_requestPaint,Ke=e.unstable_now,Rt=e.unstable_getCurrentPriorityLevel,yt=e.unstable_ImmediatePriority,xt=e.unstable_UserBlockingPriority,cn=e.unstable_NormalPriority,yr=e.unstable_LowPriority,Pn=e.unstable_IdlePriority,Nr=null,$t=null;function Ct(s){if($t&&typeof $t.onCommitFiberRoot=="function")try{$t.onCommitFiberRoot(Nr,s,void 0,(s.current.flags&128)===128)}catch{}}var Sr=Math.clz32?Math.clz32:$u,_n=Math.log,os=Math.LN2;function $u(s){return s>>>=0,s===0?32:31-(_n(s)/os|0)|0}var Wi=64,Fs=4194304;function Rn(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function si(s,o){var d=s.pendingLanes;if(d===0)return 0;var _=0,b=s.suspendedLanes,R=s.pingedLanes,k=d&268435455;if(k!==0){var Y=k&~b;Y!==0?_=Rn(Y):(R&=k,R!==0&&(_=Rn(R)))}else k=d&~b,k!==0?_=Rn(k):R!==0&&(_=Rn(R));if(_===0)return 0;if(o!==0&&o!==_&&(o&b)===0&&(b=_&-_,R=o&-o,b>=R||b===16&&(R&4194240)!==0))return o;if((_&4)!==0&&(_|=d&16),o=s.entangledLanes,o!==0)for(s=s.entanglements,o&=_;0<o;)d=31-Sr(o),b=1<<d,_|=s[d],o&=~b;return _}function Xl(s,o){switch(s){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kr(s,o){for(var d=s.suspendedLanes,_=s.pingedLanes,b=s.expirationTimes,R=s.pendingLanes;0<R;){var k=31-Sr(R),Y=1<<k,te=b[k];te===-1?((Y&d)===0||(Y&_)!==0)&&(b[k]=Xl(Y,o)):te<=o&&(s.expiredLanes|=Y),R&=~Y}}function Ra(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Bu(){var s=Wi;return Wi<<=1,(Wi&4194240)===0&&(Wi=64),s}function wo(s){for(var o=[],d=0;31>d;d++)o.push(s);return o}function Kl(s,o,d){s.pendingLanes|=o,o!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,o=31-Sr(o),s[o]=d}function I1(s,o){var d=s.pendingLanes&~o;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=o,s.mutableReadLanes&=o,s.entangledLanes&=o,o=s.entanglements;var _=s.eventTimes;for(s=s.expirationTimes;0<d;){var b=31-Sr(d),R=1<<b;o[b]=0,_[b]=-1,s[b]=-1,d&=~R}}function zp(s,o){var d=s.entangledLanes|=o;for(s=s.entanglements;d;){var _=31-Sr(d),b=1<<_;b&o|s[_]&o&&(s[_]|=o),d&=~b}}var Qt=0;function Gy(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Wy,$p,qy,Zy,Xy,Bp=!1,Vu=[],zs=null,$s=null,Bs=null,Yl=new Map,Jl=new Map,Vs=[],N1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ky(s,o){switch(s){case"focusin":case"focusout":zs=null;break;case"dragenter":case"dragleave":$s=null;break;case"mouseover":case"mouseout":Bs=null;break;case"pointerover":case"pointerout":Yl.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jl.delete(o.pointerId)}}function Ql(s,o,d,_,b,R){return s===null||s.nativeEvent!==R?(s={blockedOn:o,domEventName:d,eventSystemFlags:_,nativeEvent:R,targetContainers:[b]},o!==null&&(o=hc(o),o!==null&&$p(o)),s):(s.eventSystemFlags|=_,o=s.targetContainers,b!==null&&o.indexOf(b)===-1&&o.push(b),s)}function k1(s,o,d,_,b){switch(o){case"focusin":return zs=Ql(zs,s,o,d,_,b),!0;case"dragenter":return $s=Ql($s,s,o,d,_,b),!0;case"mouseover":return Bs=Ql(Bs,s,o,d,_,b),!0;case"pointerover":var R=b.pointerId;return Yl.set(R,Ql(Yl.get(R)||null,s,o,d,_,b)),!0;case"gotpointercapture":return R=b.pointerId,Jl.set(R,Ql(Jl.get(R)||null,s,o,d,_,b)),!0}return!1}function Yy(s){var o=Ca(s.target);if(o!==null){var d=as(o);if(d!==null){if(o=d.tag,o===13){if(o=zu(d),o!==null){s.blockedOn=o,Xy(s.priority,function(){qy(d)});return}}else if(o===3&&d.stateNode.current.memoizedState.isDehydrated){s.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ju(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var d=jp(s.domEventName,s.eventSystemFlags,o[0],s.nativeEvent);if(d===null){d=s.nativeEvent;var _=new d.constructor(d.type,d);ln=_,d.target.dispatchEvent(_),ln=null}else return o=hc(d),o!==null&&$p(o),s.blockedOn=d,!1;o.shift()}return!0}function Jy(s,o,d){ju(s)&&d.delete(o)}function L1(){Bp=!1,zs!==null&&ju(zs)&&(zs=null),$s!==null&&ju($s)&&($s=null),Bs!==null&&ju(Bs)&&(Bs=null),Yl.forEach(Jy),Jl.forEach(Jy)}function ec(s,o){s.blockedOn===o&&(s.blockedOn=null,Bp||(Bp=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,L1)))}function tc(s){function o(b){return ec(b,s)}if(0<Vu.length){ec(Vu[0],s);for(var d=1;d<Vu.length;d++){var _=Vu[d];_.blockedOn===s&&(_.blockedOn=null)}}for(zs!==null&&ec(zs,s),$s!==null&&ec($s,s),Bs!==null&&ec(Bs,s),Yl.forEach(o),Jl.forEach(o),d=0;d<Vs.length;d++)_=Vs[d],_.blockedOn===s&&(_.blockedOn=null);for(;0<Vs.length&&(d=Vs[0],d.blockedOn===null);)Yy(d),d.blockedOn===null&&Vs.shift()}var xo=C.ReactCurrentBatchConfig,Hu=!0;function O1(s,o,d,_){var b=Qt,R=xo.transition;xo.transition=null;try{Qt=1,Vp(s,o,d,_)}finally{Qt=b,xo.transition=R}}function D1(s,o,d,_){var b=Qt,R=xo.transition;xo.transition=null;try{Qt=4,Vp(s,o,d,_)}finally{Qt=b,xo.transition=R}}function Vp(s,o,d,_){if(Hu){var b=jp(s,o,d,_);if(b===null)am(s,o,_,Gu,d),Ky(s,_);else if(k1(b,s,o,d,_))_.stopPropagation();else if(Ky(s,_),o&4&&-1<N1.indexOf(s)){for(;b!==null;){var R=hc(b);if(R!==null&&Wy(R),R=jp(s,o,d,_),R===null&&am(s,o,_,Gu,d),R===b)break;b=R}b!==null&&_.stopPropagation()}else am(s,o,_,null,d)}}var Gu=null;function jp(s,o,d,_){if(Gu=null,s=bt(_),s=Ca(s),s!==null)if(o=as(s),o===null)s=null;else if(d=o.tag,d===13){if(s=zu(o),s!==null)return s;s=null}else if(d===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null);return Gu=s,null}function Qy(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Rt()){case yt:return 1;case xt:return 4;case cn:case yr:return 16;case Pn:return 536870912;default:return 16}default:return 16}}var js=null,Hp=null,Wu=null;function e0(){if(Wu)return Wu;var s,o=Hp,d=o.length,_,b="value"in js?js.value:js.textContent,R=b.length;for(s=0;s<d&&o[s]===b[s];s++);var k=d-s;for(_=1;_<=k&&o[d-_]===b[R-_];_++);return Wu=b.slice(s,1<_?1-_:void 0)}function qu(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function Zu(){return!0}function t0(){return!1}function Gr(s){function o(d,_,b,R,k){this._reactName=d,this._targetInst=b,this.type=_,this.nativeEvent=R,this.target=k,this.currentTarget=null;for(var Y in s)s.hasOwnProperty(Y)&&(d=s[Y],this[Y]=d?d(R):R[Y]);return this.isDefaultPrevented=(R.defaultPrevented!=null?R.defaultPrevented:R.returnValue===!1)?Zu:t0,this.isPropagationStopped=t0,this}return j(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Zu)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Zu)},persist:function(){},isPersistent:Zu}),o}var Eo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gp=Gr(Eo),nc=j({},Eo,{view:0,detail:0}),U1=Gr(nc),Wp,qp,rc,Xu=j({},nc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xp,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==rc&&(rc&&s.type==="mousemove"?(Wp=s.screenX-rc.screenX,qp=s.screenY-rc.screenY):qp=Wp=0,rc=s),Wp)},movementY:function(s){return"movementY"in s?s.movementY:qp}}),n0=Gr(Xu),F1=j({},Xu,{dataTransfer:0}),z1=Gr(F1),$1=j({},nc,{relatedTarget:0}),Zp=Gr($1),B1=j({},Eo,{animationName:0,elapsedTime:0,pseudoElement:0}),V1=Gr(B1),j1=j({},Eo,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),H1=Gr(j1),G1=j({},Eo,{data:0}),r0=Gr(G1),W1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},q1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Z1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function X1(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=Z1[s])?!!o[s]:!1}function Xp(){return X1}var K1=j({},nc,{key:function(s){if(s.key){var o=W1[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=qu(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?q1[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xp,charCode:function(s){return s.type==="keypress"?qu(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?qu(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Y1=Gr(K1),J1=j({},Xu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),i0=Gr(J1),Q1=j({},nc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xp}),eP=Gr(Q1),tP=j({},Eo,{propertyName:0,elapsedTime:0,pseudoElement:0}),nP=Gr(tP),rP=j({},Xu,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),iP=Gr(rP),sP=[9,13,27,32],Kp=c&&"CompositionEvent"in window,ic=null;c&&"documentMode"in document&&(ic=document.documentMode);var aP=c&&"TextEvent"in window&&!ic,s0=c&&(!Kp||ic&&8<ic&&11>=ic),a0=" ",o0=!1;function l0(s,o){switch(s){case"keyup":return sP.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function c0(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var bo=!1;function oP(s,o){switch(s){case"compositionend":return c0(o);case"keypress":return o.which!==32?null:(o0=!0,a0);case"textInput":return s=o.data,s===a0&&o0?null:s;default:return null}}function lP(s,o){if(bo)return s==="compositionend"||!Kp&&l0(s,o)?(s=e0(),Wu=Hp=js=null,bo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return s0&&o.locale!=="ko"?null:o.data;default:return null}}var cP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function u0(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!cP[s.type]:o==="textarea"}function d0(s,o,d,_){pt(_),o=ed(o,"onChange"),0<o.length&&(d=new Gp("onChange","change",null,d,_),s.push({event:d,listeners:o}))}var sc=null,ac=null;function uP(s){A0(s,0)}function Ku(s){var o=Ao(s);if(z(o))return s}function dP(s,o){if(s==="change")return o}var f0=!1;if(c){var Yp;if(c){var Jp="oninput"in document;if(!Jp){var h0=document.createElement("div");h0.setAttribute("oninput","return;"),Jp=typeof h0.oninput=="function"}Yp=Jp}else Yp=!1;f0=Yp&&(!document.documentMode||9<document.documentMode)}function p0(){sc&&(sc.detachEvent("onpropertychange",m0),ac=sc=null)}function m0(s){if(s.propertyName==="value"&&Ku(ac)){var o=[];d0(o,ac,s,bt(s)),Gn(uP,o)}}function fP(s,o,d){s==="focusin"?(p0(),sc=o,ac=d,sc.attachEvent("onpropertychange",m0)):s==="focusout"&&p0()}function hP(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ku(ac)}function pP(s,o){if(s==="click")return Ku(o)}function mP(s,o){if(s==="input"||s==="change")return Ku(o)}function gP(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var bi=typeof Object.is=="function"?Object.is:gP;function oc(s,o){if(bi(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var d=Object.keys(s),_=Object.keys(o);if(d.length!==_.length)return!1;for(_=0;_<d.length;_++){var b=d[_];if(!u.call(o,b)||!bi(s[b],o[b]))return!1}return!0}function g0(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function _0(s,o){var d=g0(s);s=0;for(var _;d;){if(d.nodeType===3){if(_=s+d.textContent.length,s<=o&&_>=o)return{node:d,offset:o-s};s=_}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=g0(d)}}function v0(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?v0(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function y0(){for(var s=window,o=ve();o instanceof s.HTMLIFrameElement;){try{var d=typeof o.contentWindow.location.href=="string"}catch{d=!1}if(d)s=o.contentWindow;else break;o=ve(s.document)}return o}function Qp(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}function _P(s){var o=y0(),d=s.focusedElem,_=s.selectionRange;if(o!==d&&d&&d.ownerDocument&&v0(d.ownerDocument.documentElement,d)){if(_!==null&&Qp(d)){if(o=_.start,s=_.end,s===void 0&&(s=o),"selectionStart"in d)d.selectionStart=o,d.selectionEnd=Math.min(s,d.value.length);else if(s=(o=d.ownerDocument||document)&&o.defaultView||window,s.getSelection){s=s.getSelection();var b=d.textContent.length,R=Math.min(_.start,b);_=_.end===void 0?R:Math.min(_.end,b),!s.extend&&R>_&&(b=_,_=R,R=b),b=_0(d,R);var k=_0(d,_);b&&k&&(s.rangeCount!==1||s.anchorNode!==b.node||s.anchorOffset!==b.offset||s.focusNode!==k.node||s.focusOffset!==k.offset)&&(o=o.createRange(),o.setStart(b.node,b.offset),s.removeAllRanges(),R>_?(s.addRange(o),s.extend(k.node,k.offset)):(o.setEnd(k.node,k.offset),s.addRange(o)))}}for(o=[],s=d;s=s.parentNode;)s.nodeType===1&&o.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<o.length;d++)s=o[d],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var vP=c&&"documentMode"in document&&11>=document.documentMode,To=null,em=null,lc=null,tm=!1;function S0(s,o,d){var _=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;tm||To==null||To!==ve(_)||(_=To,"selectionStart"in _&&Qp(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),lc&&oc(lc,_)||(lc=_,_=ed(em,"onSelect"),0<_.length&&(o=new Gp("onSelect","select",null,o,d),s.push({event:o,listeners:_}),o.target=To)))}function Yu(s,o){var d={};return d[s.toLowerCase()]=o.toLowerCase(),d["Webkit"+s]="webkit"+o,d["Moz"+s]="moz"+o,d}var Mo={animationend:Yu("Animation","AnimationEnd"),animationiteration:Yu("Animation","AnimationIteration"),animationstart:Yu("Animation","AnimationStart"),transitionend:Yu("Transition","TransitionEnd")},nm={},w0={};c&&(w0=document.createElement("div").style,"AnimationEvent"in window||(delete Mo.animationend.animation,delete Mo.animationiteration.animation,delete Mo.animationstart.animation),"TransitionEvent"in window||delete Mo.transitionend.transition);function Ju(s){if(nm[s])return nm[s];if(!Mo[s])return s;var o=Mo[s],d;for(d in o)if(o.hasOwnProperty(d)&&d in w0)return nm[s]=o[d];return s}var x0=Ju("animationend"),E0=Ju("animationiteration"),b0=Ju("animationstart"),T0=Ju("transitionend"),M0=new Map,R0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hs(s,o){M0.set(s,o),a(o,[s])}for(var rm=0;rm<R0.length;rm++){var im=R0[rm],yP=im.toLowerCase(),SP=im[0].toUpperCase()+im.slice(1);Hs(yP,"on"+SP)}Hs(x0,"onAnimationEnd"),Hs(E0,"onAnimationIteration"),Hs(b0,"onAnimationStart"),Hs("dblclick","onDoubleClick"),Hs("focusin","onFocus"),Hs("focusout","onBlur"),Hs(T0,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wP=new Set("cancel close invalid load scroll toggle".split(" ").concat(cc));function C0(s,o,d){var _=s.type||"unknown-event";s.currentTarget=d,Fp(_,o,void 0,s),s.currentTarget=null}function A0(s,o){o=(o&4)!==0;for(var d=0;d<s.length;d++){var _=s[d],b=_.event;_=_.listeners;e:{var R=void 0;if(o)for(var k=_.length-1;0<=k;k--){var Y=_[k],te=Y.instance,me=Y.currentTarget;if(Y=Y.listener,te!==R&&b.isPropagationStopped())break e;C0(b,Y,me),R=te}else for(k=0;k<_.length;k++){if(Y=_[k],te=Y.instance,me=Y.currentTarget,Y=Y.listener,te!==R&&b.isPropagationStopped())break e;C0(b,Y,me),R=te}}}if(Ma)throw s=Us,Ma=!1,Us=null,s}function hn(s,o){var d=o[fm];d===void 0&&(d=o[fm]=new Set);var _=s+"__bubble";d.has(_)||(P0(o,s,2,!1),d.add(_))}function sm(s,o,d){var _=0;o&&(_|=4),P0(d,s,_,o)}var Qu="_reactListening"+Math.random().toString(36).slice(2);function uc(s){if(!s[Qu]){s[Qu]=!0,r.forEach(function(d){d!=="selectionchange"&&(wP.has(d)||sm(d,!1,s),sm(d,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[Qu]||(o[Qu]=!0,sm("selectionchange",!1,o))}}function P0(s,o,d,_){switch(Qy(o)){case 1:var b=O1;break;case 4:b=D1;break;default:b=Vp}d=b.bind(null,o,d,s),b=void 0,!Un||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(b=!0),_?b!==void 0?s.addEventListener(o,d,{capture:!0,passive:b}):s.addEventListener(o,d,!0):b!==void 0?s.addEventListener(o,d,{passive:b}):s.addEventListener(o,d,!1)}function am(s,o,d,_,b){var R=_;if((o&1)===0&&(o&2)===0&&_!==null)e:for(;;){if(_===null)return;var k=_.tag;if(k===3||k===4){var Y=_.stateNode.containerInfo;if(Y===b||Y.nodeType===8&&Y.parentNode===b)break;if(k===4)for(k=_.return;k!==null;){var te=k.tag;if((te===3||te===4)&&(te=k.stateNode.containerInfo,te===b||te.nodeType===8&&te.parentNode===b))return;k=k.return}for(;Y!==null;){if(k=Ca(Y),k===null)return;if(te=k.tag,te===5||te===6){_=R=k;continue e}Y=Y.parentNode}}_=_.return}Gn(function(){var me=R,Pe=bt(d),ke=[];e:{var Ce=M0.get(s);if(Ce!==void 0){var qe=Gp,Je=s;switch(s){case"keypress":if(qu(d)===0)break e;case"keydown":case"keyup":qe=Y1;break;case"focusin":Je="focus",qe=Zp;break;case"focusout":Je="blur",qe=Zp;break;case"beforeblur":case"afterblur":qe=Zp;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":qe=n0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":qe=z1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":qe=eP;break;case x0:case E0:case b0:qe=V1;break;case T0:qe=nP;break;case"scroll":qe=U1;break;case"wheel":qe=iP;break;case"copy":case"cut":case"paste":qe=H1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":qe=i0}var tt=(o&4)!==0,In=!tt&&s==="scroll",ce=tt?Ce!==null?Ce+"Capture":null:Ce;tt=[];for(var se=me,fe;se!==null;){fe=se;var De=fe.stateNode;if(fe.tag===5&&De!==null&&(fe=De,ce!==null&&(De=Ht(se,ce),De!=null&&tt.push(dc(se,De,fe)))),In)break;se=se.return}0<tt.length&&(Ce=new qe(Ce,Je,null,d,Pe),ke.push({event:Ce,listeners:tt}))}}if((o&7)===0){e:{if(Ce=s==="mouseover"||s==="pointerover",qe=s==="mouseout"||s==="pointerout",Ce&&d!==ln&&(Je=d.relatedTarget||d.fromElement)&&(Ca(Je)||Je[ls]))break e;if((qe||Ce)&&(Ce=Pe.window===Pe?Pe:(Ce=Pe.ownerDocument)?Ce.defaultView||Ce.parentWindow:window,qe?(Je=d.relatedTarget||d.toElement,qe=me,Je=Je?Ca(Je):null,Je!==null&&(In=as(Je),Je!==In||Je.tag!==5&&Je.tag!==6)&&(Je=null)):(qe=null,Je=me),qe!==Je)){if(tt=n0,De="onMouseLeave",ce="onMouseEnter",se="mouse",(s==="pointerout"||s==="pointerover")&&(tt=i0,De="onPointerLeave",ce="onPointerEnter",se="pointer"),In=qe==null?Ce:Ao(qe),fe=Je==null?Ce:Ao(Je),Ce=new tt(De,se+"leave",qe,d,Pe),Ce.target=In,Ce.relatedTarget=fe,De=null,Ca(Pe)===me&&(tt=new tt(ce,se+"enter",Je,d,Pe),tt.target=fe,tt.relatedTarget=In,De=tt),In=De,qe&&Je)t:{for(tt=qe,ce=Je,se=0,fe=tt;fe;fe=Ro(fe))se++;for(fe=0,De=ce;De;De=Ro(De))fe++;for(;0<se-fe;)tt=Ro(tt),se--;for(;0<fe-se;)ce=Ro(ce),fe--;for(;se--;){if(tt===ce||ce!==null&&tt===ce.alternate)break t;tt=Ro(tt),ce=Ro(ce)}tt=null}else tt=null;qe!==null&&I0(ke,Ce,qe,tt,!1),Je!==null&&In!==null&&I0(ke,In,Je,tt,!0)}}e:{if(Ce=me?Ao(me):window,qe=Ce.nodeName&&Ce.nodeName.toLowerCase(),qe==="select"||qe==="input"&&Ce.type==="file")var nt=dP;else if(u0(Ce))if(f0)nt=mP;else{nt=hP;var ut=fP}else(qe=Ce.nodeName)&&qe.toLowerCase()==="input"&&(Ce.type==="checkbox"||Ce.type==="radio")&&(nt=pP);if(nt&&(nt=nt(s,me))){d0(ke,nt,d,Pe);break e}ut&&ut(s,Ce,me),s==="focusout"&&(ut=Ce._wrapperState)&&ut.controlled&&Ce.type==="number"&&$(Ce,"number",Ce.value)}switch(ut=me?Ao(me):window,s){case"focusin":(u0(ut)||ut.contentEditable==="true")&&(To=ut,em=me,lc=null);break;case"focusout":lc=em=To=null;break;case"mousedown":tm=!0;break;case"contextmenu":case"mouseup":case"dragend":tm=!1,S0(ke,d,Pe);break;case"selectionchange":if(vP)break;case"keydown":case"keyup":S0(ke,d,Pe)}var dt;if(Kp)e:{switch(s){case"compositionstart":var _t="onCompositionStart";break e;case"compositionend":_t="onCompositionEnd";break e;case"compositionupdate":_t="onCompositionUpdate";break e}_t=void 0}else bo?l0(s,d)&&(_t="onCompositionEnd"):s==="keydown"&&d.keyCode===229&&(_t="onCompositionStart");_t&&(s0&&d.locale!=="ko"&&(bo||_t!=="onCompositionStart"?_t==="onCompositionEnd"&&bo&&(dt=e0()):(js=Pe,Hp="value"in js?js.value:js.textContent,bo=!0)),ut=ed(me,_t),0<ut.length&&(_t=new r0(_t,s,null,d,Pe),ke.push({event:_t,listeners:ut}),dt?_t.data=dt:(dt=c0(d),dt!==null&&(_t.data=dt)))),(dt=aP?oP(s,d):lP(s,d))&&(me=ed(me,"onBeforeInput"),0<me.length&&(Pe=new r0("onBeforeInput","beforeinput",null,d,Pe),ke.push({event:Pe,listeners:me}),Pe.data=dt))}A0(ke,o)})}function dc(s,o,d){return{instance:s,listener:o,currentTarget:d}}function ed(s,o){for(var d=o+"Capture",_=[];s!==null;){var b=s,R=b.stateNode;b.tag===5&&R!==null&&(b=R,R=Ht(s,d),R!=null&&_.unshift(dc(s,R,b)),R=Ht(s,o),R!=null&&_.push(dc(s,R,b))),s=s.return}return _}function Ro(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function I0(s,o,d,_,b){for(var R=o._reactName,k=[];d!==null&&d!==_;){var Y=d,te=Y.alternate,me=Y.stateNode;if(te!==null&&te===_)break;Y.tag===5&&me!==null&&(Y=me,b?(te=Ht(d,R),te!=null&&k.unshift(dc(d,te,Y))):b||(te=Ht(d,R),te!=null&&k.push(dc(d,te,Y)))),d=d.return}k.length!==0&&s.push({event:o,listeners:k})}var xP=/\r\n?/g,EP=/\u0000|\uFFFD/g;function N0(s){return(typeof s=="string"?s:""+s).replace(xP,`
`).replace(EP,"")}function td(s,o,d){if(o=N0(o),N0(s)!==o&&d)throw Error(n(425))}function nd(){}var om=null,lm=null;function cm(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var um=typeof setTimeout=="function"?setTimeout:void 0,bP=typeof clearTimeout=="function"?clearTimeout:void 0,k0=typeof Promise=="function"?Promise:void 0,TP=typeof queueMicrotask=="function"?queueMicrotask:typeof k0<"u"?function(s){return k0.resolve(null).then(s).catch(MP)}:um;function MP(s){setTimeout(function(){throw s})}function dm(s,o){var d=o,_=0;do{var b=d.nextSibling;if(s.removeChild(d),b&&b.nodeType===8)if(d=b.data,d==="/$"){if(_===0){s.removeChild(b),tc(o);return}_--}else d!=="$"&&d!=="$?"&&d!=="$!"||_++;d=b}while(d);tc(o)}function Gs(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return s}function L0(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var d=s.data;if(d==="$"||d==="$!"||d==="$?"){if(o===0)return s;o--}else d==="/$"&&o++}s=s.previousSibling}return null}var Co=Math.random().toString(36).slice(2),qi="__reactFiber$"+Co,fc="__reactProps$"+Co,ls="__reactContainer$"+Co,fm="__reactEvents$"+Co,RP="__reactListeners$"+Co,CP="__reactHandles$"+Co;function Ca(s){var o=s[qi];if(o)return o;for(var d=s.parentNode;d;){if(o=d[ls]||d[qi]){if(d=o.alternate,o.child!==null||d!==null&&d.child!==null)for(s=L0(s);s!==null;){if(d=s[qi])return d;s=L0(s)}return o}s=d,d=s.parentNode}return null}function hc(s){return s=s[qi]||s[ls],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Ao(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(n(33))}function rd(s){return s[fc]||null}var hm=[],Po=-1;function Ws(s){return{current:s}}function pn(s){0>Po||(s.current=hm[Po],hm[Po]=null,Po--)}function un(s,o){Po++,hm[Po]=s.current,s.current=o}var qs={},ur=Ws(qs),Lr=Ws(!1),Aa=qs;function Io(s,o){var d=s.type.contextTypes;if(!d)return qs;var _=s.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===o)return _.__reactInternalMemoizedMaskedChildContext;var b={},R;for(R in d)b[R]=o[R];return _&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=o,s.__reactInternalMemoizedMaskedChildContext=b),b}function Or(s){return s=s.childContextTypes,s!=null}function id(){pn(Lr),pn(ur)}function O0(s,o,d){if(ur.current!==qs)throw Error(n(168));un(ur,o),un(Lr,d)}function D0(s,o,d){var _=s.stateNode;if(o=o.childContextTypes,typeof _.getChildContext!="function")return d;_=_.getChildContext();for(var b in _)if(!(b in o))throw Error(n(108,Q(s)||"Unknown",b));return j({},d,_)}function sd(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||qs,Aa=ur.current,un(ur,s),un(Lr,Lr.current),!0}function U0(s,o,d){var _=s.stateNode;if(!_)throw Error(n(169));d?(s=D0(s,o,Aa),_.__reactInternalMemoizedMergedChildContext=s,pn(Lr),pn(ur),un(ur,s)):pn(Lr),un(Lr,d)}var cs=null,ad=!1,pm=!1;function F0(s){cs===null?cs=[s]:cs.push(s)}function AP(s){ad=!0,F0(s)}function Zs(){if(!pm&&cs!==null){pm=!0;var s=0,o=Qt;try{var d=cs;for(Qt=1;s<d.length;s++){var _=d[s];do _=_(!0);while(_!==null)}cs=null,ad=!1}catch(b){throw cs!==null&&(cs=cs.slice(s+1)),ge(yt,Zs),b}finally{Qt=o,pm=!1}}return null}var No=[],ko=0,od=null,ld=0,ai=[],oi=0,Pa=null,us=1,ds="";function Ia(s,o){No[ko++]=ld,No[ko++]=od,od=s,ld=o}function z0(s,o,d){ai[oi++]=us,ai[oi++]=ds,ai[oi++]=Pa,Pa=s;var _=us;s=ds;var b=32-Sr(_)-1;_&=~(1<<b),d+=1;var R=32-Sr(o)+b;if(30<R){var k=b-b%5;R=(_&(1<<k)-1).toString(32),_>>=k,b-=k,us=1<<32-Sr(o)+b|d<<b|_,ds=R+s}else us=1<<R|d<<b|_,ds=s}function mm(s){s.return!==null&&(Ia(s,1),z0(s,1,0))}function gm(s){for(;s===od;)od=No[--ko],No[ko]=null,ld=No[--ko],No[ko]=null;for(;s===Pa;)Pa=ai[--oi],ai[oi]=null,ds=ai[--oi],ai[oi]=null,us=ai[--oi],ai[oi]=null}var Wr=null,qr=null,vn=!1,Ti=null;function $0(s,o){var d=di(5,null,null,0);d.elementType="DELETED",d.stateNode=o,d.return=s,o=s.deletions,o===null?(s.deletions=[d],s.flags|=16):o.push(d)}function B0(s,o){switch(s.tag){case 5:var d=s.type;return o=o.nodeType!==1||d.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(s.stateNode=o,Wr=s,qr=Gs(o.firstChild),!0):!1;case 6:return o=s.pendingProps===""||o.nodeType!==3?null:o,o!==null?(s.stateNode=o,Wr=s,qr=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(d=Pa!==null?{id:us,overflow:ds}:null,s.memoizedState={dehydrated:o,treeContext:d,retryLane:1073741824},d=di(18,null,null,0),d.stateNode=o,d.return=s,s.child=d,Wr=s,qr=null,!0):!1;default:return!1}}function _m(s){return(s.mode&1)!==0&&(s.flags&128)===0}function vm(s){if(vn){var o=qr;if(o){var d=o;if(!B0(s,o)){if(_m(s))throw Error(n(418));o=Gs(d.nextSibling);var _=Wr;o&&B0(s,o)?$0(_,d):(s.flags=s.flags&-4097|2,vn=!1,Wr=s)}}else{if(_m(s))throw Error(n(418));s.flags=s.flags&-4097|2,vn=!1,Wr=s}}}function V0(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Wr=s}function cd(s){if(s!==Wr)return!1;if(!vn)return V0(s),vn=!0,!1;var o;if((o=s.tag!==3)&&!(o=s.tag!==5)&&(o=s.type,o=o!=="head"&&o!=="body"&&!cm(s.type,s.memoizedProps)),o&&(o=qr)){if(_m(s))throw j0(),Error(n(418));for(;o;)$0(s,o),o=Gs(o.nextSibling)}if(V0(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8){var d=s.data;if(d==="/$"){if(o===0){qr=Gs(s.nextSibling);break e}o--}else d!=="$"&&d!=="$!"&&d!=="$?"||o++}s=s.nextSibling}qr=null}}else qr=Wr?Gs(s.stateNode.nextSibling):null;return!0}function j0(){for(var s=qr;s;)s=Gs(s.nextSibling)}function Lo(){qr=Wr=null,vn=!1}function ym(s){Ti===null?Ti=[s]:Ti.push(s)}var PP=C.ReactCurrentBatchConfig;function pc(s,o,d){if(s=d.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(n(309));var _=d.stateNode}if(!_)throw Error(n(147,s));var b=_,R=""+s;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===R?o.ref:(o=function(k){var Y=b.refs;k===null?delete Y[R]:Y[R]=k},o._stringRef=R,o)}if(typeof s!="string")throw Error(n(284));if(!d._owner)throw Error(n(290,s))}return s}function ud(s,o){throw s=Object.prototype.toString.call(o),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s))}function H0(s){var o=s._init;return o(s._payload)}function G0(s){function o(ce,se){if(s){var fe=ce.deletions;fe===null?(ce.deletions=[se],ce.flags|=16):fe.push(se)}}function d(ce,se){if(!s)return null;for(;se!==null;)o(ce,se),se=se.sibling;return null}function _(ce,se){for(ce=new Map;se!==null;)se.key!==null?ce.set(se.key,se):ce.set(se.index,se),se=se.sibling;return ce}function b(ce,se){return ce=na(ce,se),ce.index=0,ce.sibling=null,ce}function R(ce,se,fe){return ce.index=fe,s?(fe=ce.alternate,fe!==null?(fe=fe.index,fe<se?(ce.flags|=2,se):fe):(ce.flags|=2,se)):(ce.flags|=1048576,se)}function k(ce){return s&&ce.alternate===null&&(ce.flags|=2),ce}function Y(ce,se,fe,De){return se===null||se.tag!==6?(se=ug(fe,ce.mode,De),se.return=ce,se):(se=b(se,fe),se.return=ce,se)}function te(ce,se,fe,De){var nt=fe.type;return nt===A?Pe(ce,se,fe.props.children,De,fe.key):se!==null&&(se.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===de&&H0(nt)===se.type)?(De=b(se,fe.props),De.ref=pc(ce,se,fe),De.return=ce,De):(De=Ld(fe.type,fe.key,fe.props,null,ce.mode,De),De.ref=pc(ce,se,fe),De.return=ce,De)}function me(ce,se,fe,De){return se===null||se.tag!==4||se.stateNode.containerInfo!==fe.containerInfo||se.stateNode.implementation!==fe.implementation?(se=dg(fe,ce.mode,De),se.return=ce,se):(se=b(se,fe.children||[]),se.return=ce,se)}function Pe(ce,se,fe,De,nt){return se===null||se.tag!==7?(se=za(fe,ce.mode,De,nt),se.return=ce,se):(se=b(se,fe),se.return=ce,se)}function ke(ce,se,fe){if(typeof se=="string"&&se!==""||typeof se=="number")return se=ug(""+se,ce.mode,fe),se.return=ce,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case T:return fe=Ld(se.type,se.key,se.props,null,ce.mode,fe),fe.ref=pc(ce,null,se),fe.return=ce,fe;case M:return se=dg(se,ce.mode,fe),se.return=ce,se;case de:var De=se._init;return ke(ce,De(se._payload),fe)}if(D(se)||ne(se))return se=za(se,ce.mode,fe,null),se.return=ce,se;ud(ce,se)}return null}function Ce(ce,se,fe,De){var nt=se!==null?se.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number")return nt!==null?null:Y(ce,se,""+fe,De);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case T:return fe.key===nt?te(ce,se,fe,De):null;case M:return fe.key===nt?me(ce,se,fe,De):null;case de:return nt=fe._init,Ce(ce,se,nt(fe._payload),De)}if(D(fe)||ne(fe))return nt!==null?null:Pe(ce,se,fe,De,null);ud(ce,fe)}return null}function qe(ce,se,fe,De,nt){if(typeof De=="string"&&De!==""||typeof De=="number")return ce=ce.get(fe)||null,Y(se,ce,""+De,nt);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case T:return ce=ce.get(De.key===null?fe:De.key)||null,te(se,ce,De,nt);case M:return ce=ce.get(De.key===null?fe:De.key)||null,me(se,ce,De,nt);case de:var ut=De._init;return qe(ce,se,fe,ut(De._payload),nt)}if(D(De)||ne(De))return ce=ce.get(fe)||null,Pe(se,ce,De,nt,null);ud(se,De)}return null}function Je(ce,se,fe,De){for(var nt=null,ut=null,dt=se,_t=se=0,Zn=null;dt!==null&&_t<fe.length;_t++){dt.index>_t?(Zn=dt,dt=null):Zn=dt.sibling;var Gt=Ce(ce,dt,fe[_t],De);if(Gt===null){dt===null&&(dt=Zn);break}s&&dt&&Gt.alternate===null&&o(ce,dt),se=R(Gt,se,_t),ut===null?nt=Gt:ut.sibling=Gt,ut=Gt,dt=Zn}if(_t===fe.length)return d(ce,dt),vn&&Ia(ce,_t),nt;if(dt===null){for(;_t<fe.length;_t++)dt=ke(ce,fe[_t],De),dt!==null&&(se=R(dt,se,_t),ut===null?nt=dt:ut.sibling=dt,ut=dt);return vn&&Ia(ce,_t),nt}for(dt=_(ce,dt);_t<fe.length;_t++)Zn=qe(dt,ce,_t,fe[_t],De),Zn!==null&&(s&&Zn.alternate!==null&&dt.delete(Zn.key===null?_t:Zn.key),se=R(Zn,se,_t),ut===null?nt=Zn:ut.sibling=Zn,ut=Zn);return s&&dt.forEach(function(ra){return o(ce,ra)}),vn&&Ia(ce,_t),nt}function tt(ce,se,fe,De){var nt=ne(fe);if(typeof nt!="function")throw Error(n(150));if(fe=nt.call(fe),fe==null)throw Error(n(151));for(var ut=nt=null,dt=se,_t=se=0,Zn=null,Gt=fe.next();dt!==null&&!Gt.done;_t++,Gt=fe.next()){dt.index>_t?(Zn=dt,dt=null):Zn=dt.sibling;var ra=Ce(ce,dt,Gt.value,De);if(ra===null){dt===null&&(dt=Zn);break}s&&dt&&ra.alternate===null&&o(ce,dt),se=R(ra,se,_t),ut===null?nt=ra:ut.sibling=ra,ut=ra,dt=Zn}if(Gt.done)return d(ce,dt),vn&&Ia(ce,_t),nt;if(dt===null){for(;!Gt.done;_t++,Gt=fe.next())Gt=ke(ce,Gt.value,De),Gt!==null&&(se=R(Gt,se,_t),ut===null?nt=Gt:ut.sibling=Gt,ut=Gt);return vn&&Ia(ce,_t),nt}for(dt=_(ce,dt);!Gt.done;_t++,Gt=fe.next())Gt=qe(dt,ce,_t,Gt.value,De),Gt!==null&&(s&&Gt.alternate!==null&&dt.delete(Gt.key===null?_t:Gt.key),se=R(Gt,se,_t),ut===null?nt=Gt:ut.sibling=Gt,ut=Gt);return s&&dt.forEach(function(cI){return o(ce,cI)}),vn&&Ia(ce,_t),nt}function In(ce,se,fe,De){if(typeof fe=="object"&&fe!==null&&fe.type===A&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case T:e:{for(var nt=fe.key,ut=se;ut!==null;){if(ut.key===nt){if(nt=fe.type,nt===A){if(ut.tag===7){d(ce,ut.sibling),se=b(ut,fe.props.children),se.return=ce,ce=se;break e}}else if(ut.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===de&&H0(nt)===ut.type){d(ce,ut.sibling),se=b(ut,fe.props),se.ref=pc(ce,ut,fe),se.return=ce,ce=se;break e}d(ce,ut);break}else o(ce,ut);ut=ut.sibling}fe.type===A?(se=za(fe.props.children,ce.mode,De,fe.key),se.return=ce,ce=se):(De=Ld(fe.type,fe.key,fe.props,null,ce.mode,De),De.ref=pc(ce,se,fe),De.return=ce,ce=De)}return k(ce);case M:e:{for(ut=fe.key;se!==null;){if(se.key===ut)if(se.tag===4&&se.stateNode.containerInfo===fe.containerInfo&&se.stateNode.implementation===fe.implementation){d(ce,se.sibling),se=b(se,fe.children||[]),se.return=ce,ce=se;break e}else{d(ce,se);break}else o(ce,se);se=se.sibling}se=dg(fe,ce.mode,De),se.return=ce,ce=se}return k(ce);case de:return ut=fe._init,In(ce,se,ut(fe._payload),De)}if(D(fe))return Je(ce,se,fe,De);if(ne(fe))return tt(ce,se,fe,De);ud(ce,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"?(fe=""+fe,se!==null&&se.tag===6?(d(ce,se.sibling),se=b(se,fe),se.return=ce,ce=se):(d(ce,se),se=ug(fe,ce.mode,De),se.return=ce,ce=se),k(ce)):d(ce,se)}return In}var Oo=G0(!0),W0=G0(!1),dd=Ws(null),fd=null,Do=null,Sm=null;function wm(){Sm=Do=fd=null}function xm(s){var o=dd.current;pn(dd),s._currentValue=o}function Em(s,o,d){for(;s!==null;){var _=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,_!==null&&(_.childLanes|=o)):_!==null&&(_.childLanes&o)!==o&&(_.childLanes|=o),s===d)break;s=s.return}}function Uo(s,o){fd=s,Sm=Do=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&o)!==0&&(Dr=!0),s.firstContext=null)}function li(s){var o=s._currentValue;if(Sm!==s)if(s={context:s,memoizedValue:o,next:null},Do===null){if(fd===null)throw Error(n(308));Do=s,fd.dependencies={lanes:0,firstContext:s}}else Do=Do.next=s;return o}var Na=null;function bm(s){Na===null?Na=[s]:Na.push(s)}function q0(s,o,d,_){var b=o.interleaved;return b===null?(d.next=d,bm(o)):(d.next=b.next,b.next=d),o.interleaved=d,fs(s,_)}function fs(s,o){s.lanes|=o;var d=s.alternate;for(d!==null&&(d.lanes|=o),d=s,s=s.return;s!==null;)s.childLanes|=o,d=s.alternate,d!==null&&(d.childLanes|=o),d=s,s=s.return;return d.tag===3?d.stateNode:null}var Xs=!1;function Tm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Z0(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function hs(s,o){return{eventTime:s,lane:o,tag:0,payload:null,callback:null,next:null}}function Ks(s,o,d){var _=s.updateQueue;if(_===null)return null;if(_=_.shared,(Vt&2)!==0){var b=_.pending;return b===null?o.next=o:(o.next=b.next,b.next=o),_.pending=o,fs(s,d)}return b=_.interleaved,b===null?(o.next=o,bm(_)):(o.next=b.next,b.next=o),_.interleaved=o,fs(s,d)}function hd(s,o,d){if(o=o.updateQueue,o!==null&&(o=o.shared,(d&4194240)!==0)){var _=o.lanes;_&=s.pendingLanes,d|=_,o.lanes=d,zp(s,d)}}function X0(s,o){var d=s.updateQueue,_=s.alternate;if(_!==null&&(_=_.updateQueue,d===_)){var b=null,R=null;if(d=d.firstBaseUpdate,d!==null){do{var k={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};R===null?b=R=k:R=R.next=k,d=d.next}while(d!==null);R===null?b=R=o:R=R.next=o}else b=R=o;d={baseState:_.baseState,firstBaseUpdate:b,lastBaseUpdate:R,shared:_.shared,effects:_.effects},s.updateQueue=d;return}s=d.lastBaseUpdate,s===null?d.firstBaseUpdate=o:s.next=o,d.lastBaseUpdate=o}function pd(s,o,d,_){var b=s.updateQueue;Xs=!1;var R=b.firstBaseUpdate,k=b.lastBaseUpdate,Y=b.shared.pending;if(Y!==null){b.shared.pending=null;var te=Y,me=te.next;te.next=null,k===null?R=me:k.next=me,k=te;var Pe=s.alternate;Pe!==null&&(Pe=Pe.updateQueue,Y=Pe.lastBaseUpdate,Y!==k&&(Y===null?Pe.firstBaseUpdate=me:Y.next=me,Pe.lastBaseUpdate=te))}if(R!==null){var ke=b.baseState;k=0,Pe=me=te=null,Y=R;do{var Ce=Y.lane,qe=Y.eventTime;if((_&Ce)===Ce){Pe!==null&&(Pe=Pe.next={eventTime:qe,lane:0,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null});e:{var Je=s,tt=Y;switch(Ce=o,qe=d,tt.tag){case 1:if(Je=tt.payload,typeof Je=="function"){ke=Je.call(qe,ke,Ce);break e}ke=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=tt.payload,Ce=typeof Je=="function"?Je.call(qe,ke,Ce):Je,Ce==null)break e;ke=j({},ke,Ce);break e;case 2:Xs=!0}}Y.callback!==null&&Y.lane!==0&&(s.flags|=64,Ce=b.effects,Ce===null?b.effects=[Y]:Ce.push(Y))}else qe={eventTime:qe,lane:Ce,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null},Pe===null?(me=Pe=qe,te=ke):Pe=Pe.next=qe,k|=Ce;if(Y=Y.next,Y===null){if(Y=b.shared.pending,Y===null)break;Ce=Y,Y=Ce.next,Ce.next=null,b.lastBaseUpdate=Ce,b.shared.pending=null}}while(!0);if(Pe===null&&(te=ke),b.baseState=te,b.firstBaseUpdate=me,b.lastBaseUpdate=Pe,o=b.shared.interleaved,o!==null){b=o;do k|=b.lane,b=b.next;while(b!==o)}else R===null&&(b.shared.lanes=0);Oa|=k,s.lanes=k,s.memoizedState=ke}}function K0(s,o,d){if(s=o.effects,o.effects=null,s!==null)for(o=0;o<s.length;o++){var _=s[o],b=_.callback;if(b!==null){if(_.callback=null,_=d,typeof b!="function")throw Error(n(191,b));b.call(_)}}}var mc={},Zi=Ws(mc),gc=Ws(mc),_c=Ws(mc);function ka(s){if(s===mc)throw Error(n(174));return s}function Mm(s,o){switch(un(_c,o),un(gc,s),un(Zi,mc),s=o.nodeType,s){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:Ze(null,"");break;default:s=s===8?o.parentNode:o,o=s.namespaceURI||null,s=s.tagName,o=Ze(o,s)}pn(Zi),un(Zi,o)}function Fo(){pn(Zi),pn(gc),pn(_c)}function Y0(s){ka(_c.current);var o=ka(Zi.current),d=Ze(o,s.type);o!==d&&(un(gc,s),un(Zi,d))}function Rm(s){gc.current===s&&(pn(Zi),pn(gc))}var xn=Ws(0);function md(s){for(var o=s;o!==null;){if(o.tag===13){var d=o.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Cm=[];function Am(){for(var s=0;s<Cm.length;s++)Cm[s]._workInProgressVersionPrimary=null;Cm.length=0}var gd=C.ReactCurrentDispatcher,Pm=C.ReactCurrentBatchConfig,La=0,En=null,Fn=null,Wn=null,_d=!1,vc=!1,yc=0,IP=0;function dr(){throw Error(n(321))}function Im(s,o){if(o===null)return!1;for(var d=0;d<o.length&&d<s.length;d++)if(!bi(s[d],o[d]))return!1;return!0}function Nm(s,o,d,_,b,R){if(La=R,En=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,gd.current=s===null||s.memoizedState===null?OP:DP,s=d(_,b),vc){R=0;do{if(vc=!1,yc=0,25<=R)throw Error(n(301));R+=1,Wn=Fn=null,o.updateQueue=null,gd.current=UP,s=d(_,b)}while(vc)}if(gd.current=Sd,o=Fn!==null&&Fn.next!==null,La=0,Wn=Fn=En=null,_d=!1,o)throw Error(n(300));return s}function km(){var s=yc!==0;return yc=0,s}function Xi(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wn===null?En.memoizedState=Wn=s:Wn=Wn.next=s,Wn}function ci(){if(Fn===null){var s=En.alternate;s=s!==null?s.memoizedState:null}else s=Fn.next;var o=Wn===null?En.memoizedState:Wn.next;if(o!==null)Wn=o,Fn=s;else{if(s===null)throw Error(n(310));Fn=s,s={memoizedState:Fn.memoizedState,baseState:Fn.baseState,baseQueue:Fn.baseQueue,queue:Fn.queue,next:null},Wn===null?En.memoizedState=Wn=s:Wn=Wn.next=s}return Wn}function Sc(s,o){return typeof o=="function"?o(s):o}function Lm(s){var o=ci(),d=o.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=s;var _=Fn,b=_.baseQueue,R=d.pending;if(R!==null){if(b!==null){var k=b.next;b.next=R.next,R.next=k}_.baseQueue=b=R,d.pending=null}if(b!==null){R=b.next,_=_.baseState;var Y=k=null,te=null,me=R;do{var Pe=me.lane;if((La&Pe)===Pe)te!==null&&(te=te.next={lane:0,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),_=me.hasEagerState?me.eagerState:s(_,me.action);else{var ke={lane:Pe,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null};te===null?(Y=te=ke,k=_):te=te.next=ke,En.lanes|=Pe,Oa|=Pe}me=me.next}while(me!==null&&me!==R);te===null?k=_:te.next=Y,bi(_,o.memoizedState)||(Dr=!0),o.memoizedState=_,o.baseState=k,o.baseQueue=te,d.lastRenderedState=_}if(s=d.interleaved,s!==null){b=s;do R=b.lane,En.lanes|=R,Oa|=R,b=b.next;while(b!==s)}else b===null&&(d.lanes=0);return[o.memoizedState,d.dispatch]}function Om(s){var o=ci(),d=o.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=s;var _=d.dispatch,b=d.pending,R=o.memoizedState;if(b!==null){d.pending=null;var k=b=b.next;do R=s(R,k.action),k=k.next;while(k!==b);bi(R,o.memoizedState)||(Dr=!0),o.memoizedState=R,o.baseQueue===null&&(o.baseState=R),d.lastRenderedState=R}return[R,_]}function J0(){}function Q0(s,o){var d=En,_=ci(),b=o(),R=!bi(_.memoizedState,b);if(R&&(_.memoizedState=b,Dr=!0),_=_.queue,Dm(nS.bind(null,d,_,s),[s]),_.getSnapshot!==o||R||Wn!==null&&Wn.memoizedState.tag&1){if(d.flags|=2048,wc(9,tS.bind(null,d,_,b,o),void 0,null),qn===null)throw Error(n(349));(La&30)!==0||eS(d,o,b)}return b}function eS(s,o,d){s.flags|=16384,s={getSnapshot:o,value:d},o=En.updateQueue,o===null?(o={lastEffect:null,stores:null},En.updateQueue=o,o.stores=[s]):(d=o.stores,d===null?o.stores=[s]:d.push(s))}function tS(s,o,d,_){o.value=d,o.getSnapshot=_,rS(o)&&iS(s)}function nS(s,o,d){return d(function(){rS(o)&&iS(s)})}function rS(s){var o=s.getSnapshot;s=s.value;try{var d=o();return!bi(s,d)}catch{return!0}}function iS(s){var o=fs(s,1);o!==null&&Ai(o,s,1,-1)}function sS(s){var o=Xi();return typeof s=="function"&&(s=s()),o.memoizedState=o.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sc,lastRenderedState:s},o.queue=s,s=s.dispatch=LP.bind(null,En,s),[o.memoizedState,s]}function wc(s,o,d,_){return s={tag:s,create:o,destroy:d,deps:_,next:null},o=En.updateQueue,o===null?(o={lastEffect:null,stores:null},En.updateQueue=o,o.lastEffect=s.next=s):(d=o.lastEffect,d===null?o.lastEffect=s.next=s:(_=d.next,d.next=s,s.next=_,o.lastEffect=s)),s}function aS(){return ci().memoizedState}function vd(s,o,d,_){var b=Xi();En.flags|=s,b.memoizedState=wc(1|o,d,void 0,_===void 0?null:_)}function yd(s,o,d,_){var b=ci();_=_===void 0?null:_;var R=void 0;if(Fn!==null){var k=Fn.memoizedState;if(R=k.destroy,_!==null&&Im(_,k.deps)){b.memoizedState=wc(o,d,R,_);return}}En.flags|=s,b.memoizedState=wc(1|o,d,R,_)}function oS(s,o){return vd(8390656,8,s,o)}function Dm(s,o){return yd(2048,8,s,o)}function lS(s,o){return yd(4,2,s,o)}function cS(s,o){return yd(4,4,s,o)}function uS(s,o){if(typeof o=="function")return s=s(),o(s),function(){o(null)};if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function dS(s,o,d){return d=d!=null?d.concat([s]):null,yd(4,4,uS.bind(null,o,s),d)}function Um(){}function fS(s,o){var d=ci();o=o===void 0?null:o;var _=d.memoizedState;return _!==null&&o!==null&&Im(o,_[1])?_[0]:(d.memoizedState=[s,o],s)}function hS(s,o){var d=ci();o=o===void 0?null:o;var _=d.memoizedState;return _!==null&&o!==null&&Im(o,_[1])?_[0]:(s=s(),d.memoizedState=[s,o],s)}function pS(s,o,d){return(La&21)===0?(s.baseState&&(s.baseState=!1,Dr=!0),s.memoizedState=d):(bi(d,o)||(d=Bu(),En.lanes|=d,Oa|=d,s.baseState=!0),o)}function NP(s,o){var d=Qt;Qt=d!==0&&4>d?d:4,s(!0);var _=Pm.transition;Pm.transition={};try{s(!1),o()}finally{Qt=d,Pm.transition=_}}function mS(){return ci().memoizedState}function kP(s,o,d){var _=ea(s);if(d={lane:_,action:d,hasEagerState:!1,eagerState:null,next:null},gS(s))_S(o,d);else if(d=q0(s,o,d,_),d!==null){var b=xr();Ai(d,s,_,b),vS(d,o,_)}}function LP(s,o,d){var _=ea(s),b={lane:_,action:d,hasEagerState:!1,eagerState:null,next:null};if(gS(s))_S(o,b);else{var R=s.alternate;if(s.lanes===0&&(R===null||R.lanes===0)&&(R=o.lastRenderedReducer,R!==null))try{var k=o.lastRenderedState,Y=R(k,d);if(b.hasEagerState=!0,b.eagerState=Y,bi(Y,k)){var te=o.interleaved;te===null?(b.next=b,bm(o)):(b.next=te.next,te.next=b),o.interleaved=b;return}}catch{}d=q0(s,o,b,_),d!==null&&(b=xr(),Ai(d,s,_,b),vS(d,o,_))}}function gS(s){var o=s.alternate;return s===En||o!==null&&o===En}function _S(s,o){vc=_d=!0;var d=s.pending;d===null?o.next=o:(o.next=d.next,d.next=o),s.pending=o}function vS(s,o,d){if((d&4194240)!==0){var _=o.lanes;_&=s.pendingLanes,d|=_,o.lanes=d,zp(s,d)}}var Sd={readContext:li,useCallback:dr,useContext:dr,useEffect:dr,useImperativeHandle:dr,useInsertionEffect:dr,useLayoutEffect:dr,useMemo:dr,useReducer:dr,useRef:dr,useState:dr,useDebugValue:dr,useDeferredValue:dr,useTransition:dr,useMutableSource:dr,useSyncExternalStore:dr,useId:dr,unstable_isNewReconciler:!1},OP={readContext:li,useCallback:function(s,o){return Xi().memoizedState=[s,o===void 0?null:o],s},useContext:li,useEffect:oS,useImperativeHandle:function(s,o,d){return d=d!=null?d.concat([s]):null,vd(4194308,4,uS.bind(null,o,s),d)},useLayoutEffect:function(s,o){return vd(4194308,4,s,o)},useInsertionEffect:function(s,o){return vd(4,2,s,o)},useMemo:function(s,o){var d=Xi();return o=o===void 0?null:o,s=s(),d.memoizedState=[s,o],s},useReducer:function(s,o,d){var _=Xi();return o=d!==void 0?d(o):o,_.memoizedState=_.baseState=o,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},_.queue=s,s=s.dispatch=kP.bind(null,En,s),[_.memoizedState,s]},useRef:function(s){var o=Xi();return s={current:s},o.memoizedState=s},useState:sS,useDebugValue:Um,useDeferredValue:function(s){return Xi().memoizedState=s},useTransition:function(){var s=sS(!1),o=s[0];return s=NP.bind(null,s[1]),Xi().memoizedState=s,[o,s]},useMutableSource:function(){},useSyncExternalStore:function(s,o,d){var _=En,b=Xi();if(vn){if(d===void 0)throw Error(n(407));d=d()}else{if(d=o(),qn===null)throw Error(n(349));(La&30)!==0||eS(_,o,d)}b.memoizedState=d;var R={value:d,getSnapshot:o};return b.queue=R,oS(nS.bind(null,_,R,s),[s]),_.flags|=2048,wc(9,tS.bind(null,_,R,d,o),void 0,null),d},useId:function(){var s=Xi(),o=qn.identifierPrefix;if(vn){var d=ds,_=us;d=(_&~(1<<32-Sr(_)-1)).toString(32)+d,o=":"+o+"R"+d,d=yc++,0<d&&(o+="H"+d.toString(32)),o+=":"}else d=IP++,o=":"+o+"r"+d.toString(32)+":";return s.memoizedState=o},unstable_isNewReconciler:!1},DP={readContext:li,useCallback:fS,useContext:li,useEffect:Dm,useImperativeHandle:dS,useInsertionEffect:lS,useLayoutEffect:cS,useMemo:hS,useReducer:Lm,useRef:aS,useState:function(){return Lm(Sc)},useDebugValue:Um,useDeferredValue:function(s){var o=ci();return pS(o,Fn.memoizedState,s)},useTransition:function(){var s=Lm(Sc)[0],o=ci().memoizedState;return[s,o]},useMutableSource:J0,useSyncExternalStore:Q0,useId:mS,unstable_isNewReconciler:!1},UP={readContext:li,useCallback:fS,useContext:li,useEffect:Dm,useImperativeHandle:dS,useInsertionEffect:lS,useLayoutEffect:cS,useMemo:hS,useReducer:Om,useRef:aS,useState:function(){return Om(Sc)},useDebugValue:Um,useDeferredValue:function(s){var o=ci();return Fn===null?o.memoizedState=s:pS(o,Fn.memoizedState,s)},useTransition:function(){var s=Om(Sc)[0],o=ci().memoizedState;return[s,o]},useMutableSource:J0,useSyncExternalStore:Q0,useId:mS,unstable_isNewReconciler:!1};function Mi(s,o){if(s&&s.defaultProps){o=j({},o),s=s.defaultProps;for(var d in s)o[d]===void 0&&(o[d]=s[d]);return o}return o}function Fm(s,o,d,_){o=s.memoizedState,d=d(_,o),d=d==null?o:j({},o,d),s.memoizedState=d,s.lanes===0&&(s.updateQueue.baseState=d)}var wd={isMounted:function(s){return(s=s._reactInternals)?as(s)===s:!1},enqueueSetState:function(s,o,d){s=s._reactInternals;var _=xr(),b=ea(s),R=hs(_,b);R.payload=o,d!=null&&(R.callback=d),o=Ks(s,R,b),o!==null&&(Ai(o,s,b,_),hd(o,s,b))},enqueueReplaceState:function(s,o,d){s=s._reactInternals;var _=xr(),b=ea(s),R=hs(_,b);R.tag=1,R.payload=o,d!=null&&(R.callback=d),o=Ks(s,R,b),o!==null&&(Ai(o,s,b,_),hd(o,s,b))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var d=xr(),_=ea(s),b=hs(d,_);b.tag=2,o!=null&&(b.callback=o),o=Ks(s,b,_),o!==null&&(Ai(o,s,_,d),hd(o,s,_))}};function yS(s,o,d,_,b,R,k){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(_,R,k):o.prototype&&o.prototype.isPureReactComponent?!oc(d,_)||!oc(b,R):!0}function SS(s,o,d){var _=!1,b=qs,R=o.contextType;return typeof R=="object"&&R!==null?R=li(R):(b=Or(o)?Aa:ur.current,_=o.contextTypes,R=(_=_!=null)?Io(s,b):qs),o=new o(d,R),s.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=wd,s.stateNode=o,o._reactInternals=s,_&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=b,s.__reactInternalMemoizedMaskedChildContext=R),o}function wS(s,o,d,_){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(d,_),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(d,_),o.state!==s&&wd.enqueueReplaceState(o,o.state,null)}function zm(s,o,d,_){var b=s.stateNode;b.props=d,b.state=s.memoizedState,b.refs={},Tm(s);var R=o.contextType;typeof R=="object"&&R!==null?b.context=li(R):(R=Or(o)?Aa:ur.current,b.context=Io(s,R)),b.state=s.memoizedState,R=o.getDerivedStateFromProps,typeof R=="function"&&(Fm(s,o,R,d),b.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(o=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),o!==b.state&&wd.enqueueReplaceState(b,b.state,null),pd(s,d,b,_),b.state=s.memoizedState),typeof b.componentDidMount=="function"&&(s.flags|=4194308)}function zo(s,o){try{var d="",_=o;do d+=L(_),_=_.return;while(_);var b=d}catch(R){b=`
Error generating stack: `+R.message+`
`+R.stack}return{value:s,source:o,stack:b,digest:null}}function $m(s,o,d){return{value:s,source:null,stack:d??null,digest:o??null}}function Bm(s,o){try{console.error(o.value)}catch(d){setTimeout(function(){throw d})}}var FP=typeof WeakMap=="function"?WeakMap:Map;function xS(s,o,d){d=hs(-1,d),d.tag=3,d.payload={element:null};var _=o.value;return d.callback=function(){Cd||(Cd=!0,ng=_),Bm(s,o)},d}function ES(s,o,d){d=hs(-1,d),d.tag=3;var _=s.type.getDerivedStateFromError;if(typeof _=="function"){var b=o.value;d.payload=function(){return _(b)},d.callback=function(){Bm(s,o)}}var R=s.stateNode;return R!==null&&typeof R.componentDidCatch=="function"&&(d.callback=function(){Bm(s,o),typeof _!="function"&&(Js===null?Js=new Set([this]):Js.add(this));var k=o.stack;this.componentDidCatch(o.value,{componentStack:k!==null?k:""})}),d}function bS(s,o,d){var _=s.pingCache;if(_===null){_=s.pingCache=new FP;var b=new Set;_.set(o,b)}else b=_.get(o),b===void 0&&(b=new Set,_.set(o,b));b.has(d)||(b.add(d),s=JP.bind(null,s,o,d),o.then(s,s))}function TS(s){do{var o;if((o=s.tag===13)&&(o=s.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return s;s=s.return}while(s!==null);return null}function MS(s,o,d,_,b){return(s.mode&1)===0?(s===o?s.flags|=65536:(s.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(o=hs(-1,1),o.tag=2,Ks(d,o,1))),d.lanes|=1),s):(s.flags|=65536,s.lanes=b,s)}var zP=C.ReactCurrentOwner,Dr=!1;function wr(s,o,d,_){o.child=s===null?W0(o,null,d,_):Oo(o,s.child,d,_)}function RS(s,o,d,_,b){d=d.render;var R=o.ref;return Uo(o,b),_=Nm(s,o,d,_,R,b),d=km(),s!==null&&!Dr?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~b,ps(s,o,b)):(vn&&d&&mm(o),o.flags|=1,wr(s,o,_,b),o.child)}function CS(s,o,d,_,b){if(s===null){var R=d.type;return typeof R=="function"&&!cg(R)&&R.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(o.tag=15,o.type=R,AS(s,o,R,_,b)):(s=Ld(d.type,null,_,o,o.mode,b),s.ref=o.ref,s.return=o,o.child=s)}if(R=s.child,(s.lanes&b)===0){var k=R.memoizedProps;if(d=d.compare,d=d!==null?d:oc,d(k,_)&&s.ref===o.ref)return ps(s,o,b)}return o.flags|=1,s=na(R,_),s.ref=o.ref,s.return=o,o.child=s}function AS(s,o,d,_,b){if(s!==null){var R=s.memoizedProps;if(oc(R,_)&&s.ref===o.ref)if(Dr=!1,o.pendingProps=_=R,(s.lanes&b)!==0)(s.flags&131072)!==0&&(Dr=!0);else return o.lanes=s.lanes,ps(s,o,b)}return Vm(s,o,d,_,b)}function PS(s,o,d){var _=o.pendingProps,b=_.children,R=s!==null?s.memoizedState:null;if(_.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},un(Bo,Zr),Zr|=d;else{if((d&1073741824)===0)return s=R!==null?R.baseLanes|d:d,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:s,cachePool:null,transitions:null},o.updateQueue=null,un(Bo,Zr),Zr|=s,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=R!==null?R.baseLanes:d,un(Bo,Zr),Zr|=_}else R!==null?(_=R.baseLanes|d,o.memoizedState=null):_=d,un(Bo,Zr),Zr|=_;return wr(s,o,b,d),o.child}function IS(s,o){var d=o.ref;(s===null&&d!==null||s!==null&&s.ref!==d)&&(o.flags|=512,o.flags|=2097152)}function Vm(s,o,d,_,b){var R=Or(d)?Aa:ur.current;return R=Io(o,R),Uo(o,b),d=Nm(s,o,d,_,R,b),_=km(),s!==null&&!Dr?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~b,ps(s,o,b)):(vn&&_&&mm(o),o.flags|=1,wr(s,o,d,b),o.child)}function NS(s,o,d,_,b){if(Or(d)){var R=!0;sd(o)}else R=!1;if(Uo(o,b),o.stateNode===null)Ed(s,o),SS(o,d,_),zm(o,d,_,b),_=!0;else if(s===null){var k=o.stateNode,Y=o.memoizedProps;k.props=Y;var te=k.context,me=d.contextType;typeof me=="object"&&me!==null?me=li(me):(me=Or(d)?Aa:ur.current,me=Io(o,me));var Pe=d.getDerivedStateFromProps,ke=typeof Pe=="function"||typeof k.getSnapshotBeforeUpdate=="function";ke||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(Y!==_||te!==me)&&wS(o,k,_,me),Xs=!1;var Ce=o.memoizedState;k.state=Ce,pd(o,_,k,b),te=o.memoizedState,Y!==_||Ce!==te||Lr.current||Xs?(typeof Pe=="function"&&(Fm(o,d,Pe,_),te=o.memoizedState),(Y=Xs||yS(o,d,Y,_,Ce,te,me))?(ke||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(o.flags|=4194308)):(typeof k.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=_,o.memoizedState=te),k.props=_,k.state=te,k.context=me,_=Y):(typeof k.componentDidMount=="function"&&(o.flags|=4194308),_=!1)}else{k=o.stateNode,Z0(s,o),Y=o.memoizedProps,me=o.type===o.elementType?Y:Mi(o.type,Y),k.props=me,ke=o.pendingProps,Ce=k.context,te=d.contextType,typeof te=="object"&&te!==null?te=li(te):(te=Or(d)?Aa:ur.current,te=Io(o,te));var qe=d.getDerivedStateFromProps;(Pe=typeof qe=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(Y!==ke||Ce!==te)&&wS(o,k,_,te),Xs=!1,Ce=o.memoizedState,k.state=Ce,pd(o,_,k,b);var Je=o.memoizedState;Y!==ke||Ce!==Je||Lr.current||Xs?(typeof qe=="function"&&(Fm(o,d,qe,_),Je=o.memoizedState),(me=Xs||yS(o,d,me,_,Ce,Je,te)||!1)?(Pe||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(_,Je,te),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(_,Je,te)),typeof k.componentDidUpdate=="function"&&(o.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof k.componentDidUpdate!="function"||Y===s.memoizedProps&&Ce===s.memoizedState||(o.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||Y===s.memoizedProps&&Ce===s.memoizedState||(o.flags|=1024),o.memoizedProps=_,o.memoizedState=Je),k.props=_,k.state=Je,k.context=te,_=me):(typeof k.componentDidUpdate!="function"||Y===s.memoizedProps&&Ce===s.memoizedState||(o.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||Y===s.memoizedProps&&Ce===s.memoizedState||(o.flags|=1024),_=!1)}return jm(s,o,d,_,R,b)}function jm(s,o,d,_,b,R){IS(s,o);var k=(o.flags&128)!==0;if(!_&&!k)return b&&U0(o,d,!1),ps(s,o,R);_=o.stateNode,zP.current=o;var Y=k&&typeof d.getDerivedStateFromError!="function"?null:_.render();return o.flags|=1,s!==null&&k?(o.child=Oo(o,s.child,null,R),o.child=Oo(o,null,Y,R)):wr(s,o,Y,R),o.memoizedState=_.state,b&&U0(o,d,!0),o.child}function kS(s){var o=s.stateNode;o.pendingContext?O0(s,o.pendingContext,o.pendingContext!==o.context):o.context&&O0(s,o.context,!1),Mm(s,o.containerInfo)}function LS(s,o,d,_,b){return Lo(),ym(b),o.flags|=256,wr(s,o,d,_),o.child}var Hm={dehydrated:null,treeContext:null,retryLane:0};function Gm(s){return{baseLanes:s,cachePool:null,transitions:null}}function OS(s,o,d){var _=o.pendingProps,b=xn.current,R=!1,k=(o.flags&128)!==0,Y;if((Y=k)||(Y=s!==null&&s.memoizedState===null?!1:(b&2)!==0),Y?(R=!0,o.flags&=-129):(s===null||s.memoizedState!==null)&&(b|=1),un(xn,b&1),s===null)return vm(o),s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((o.mode&1)===0?o.lanes=1:s.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(k=_.children,s=_.fallback,R?(_=o.mode,R=o.child,k={mode:"hidden",children:k},(_&1)===0&&R!==null?(R.childLanes=0,R.pendingProps=k):R=Od(k,_,0,null),s=za(s,_,d,null),R.return=o,s.return=o,R.sibling=s,o.child=R,o.child.memoizedState=Gm(d),o.memoizedState=Hm,s):Wm(o,k));if(b=s.memoizedState,b!==null&&(Y=b.dehydrated,Y!==null))return $P(s,o,k,_,Y,b,d);if(R){R=_.fallback,k=o.mode,b=s.child,Y=b.sibling;var te={mode:"hidden",children:_.children};return(k&1)===0&&o.child!==b?(_=o.child,_.childLanes=0,_.pendingProps=te,o.deletions=null):(_=na(b,te),_.subtreeFlags=b.subtreeFlags&14680064),Y!==null?R=na(Y,R):(R=za(R,k,d,null),R.flags|=2),R.return=o,_.return=o,_.sibling=R,o.child=_,_=R,R=o.child,k=s.child.memoizedState,k=k===null?Gm(d):{baseLanes:k.baseLanes|d,cachePool:null,transitions:k.transitions},R.memoizedState=k,R.childLanes=s.childLanes&~d,o.memoizedState=Hm,_}return R=s.child,s=R.sibling,_=na(R,{mode:"visible",children:_.children}),(o.mode&1)===0&&(_.lanes=d),_.return=o,_.sibling=null,s!==null&&(d=o.deletions,d===null?(o.deletions=[s],o.flags|=16):d.push(s)),o.child=_,o.memoizedState=null,_}function Wm(s,o){return o=Od({mode:"visible",children:o},s.mode,0,null),o.return=s,s.child=o}function xd(s,o,d,_){return _!==null&&ym(_),Oo(o,s.child,null,d),s=Wm(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function $P(s,o,d,_,b,R,k){if(d)return o.flags&256?(o.flags&=-257,_=$m(Error(n(422))),xd(s,o,k,_)):o.memoizedState!==null?(o.child=s.child,o.flags|=128,null):(R=_.fallback,b=o.mode,_=Od({mode:"visible",children:_.children},b,0,null),R=za(R,b,k,null),R.flags|=2,_.return=o,R.return=o,_.sibling=R,o.child=_,(o.mode&1)!==0&&Oo(o,s.child,null,k),o.child.memoizedState=Gm(k),o.memoizedState=Hm,R);if((o.mode&1)===0)return xd(s,o,k,null);if(b.data==="$!"){if(_=b.nextSibling&&b.nextSibling.dataset,_)var Y=_.dgst;return _=Y,R=Error(n(419)),_=$m(R,_,void 0),xd(s,o,k,_)}if(Y=(k&s.childLanes)!==0,Dr||Y){if(_=qn,_!==null){switch(k&-k){case 4:b=2;break;case 16:b=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:b=32;break;case 536870912:b=268435456;break;default:b=0}b=(b&(_.suspendedLanes|k))!==0?0:b,b!==0&&b!==R.retryLane&&(R.retryLane=b,fs(s,b),Ai(_,s,b,-1))}return lg(),_=$m(Error(n(421))),xd(s,o,k,_)}return b.data==="$?"?(o.flags|=128,o.child=s.child,o=QP.bind(null,s),b._reactRetry=o,null):(s=R.treeContext,qr=Gs(b.nextSibling),Wr=o,vn=!0,Ti=null,s!==null&&(ai[oi++]=us,ai[oi++]=ds,ai[oi++]=Pa,us=s.id,ds=s.overflow,Pa=o),o=Wm(o,_.children),o.flags|=4096,o)}function DS(s,o,d){s.lanes|=o;var _=s.alternate;_!==null&&(_.lanes|=o),Em(s.return,o,d)}function qm(s,o,d,_,b){var R=s.memoizedState;R===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:_,tail:d,tailMode:b}:(R.isBackwards=o,R.rendering=null,R.renderingStartTime=0,R.last=_,R.tail=d,R.tailMode=b)}function US(s,o,d){var _=o.pendingProps,b=_.revealOrder,R=_.tail;if(wr(s,o,_.children,d),_=xn.current,(_&2)!==0)_=_&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&DS(s,d,o);else if(s.tag===19)DS(s,d,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}_&=1}if(un(xn,_),(o.mode&1)===0)o.memoizedState=null;else switch(b){case"forwards":for(d=o.child,b=null;d!==null;)s=d.alternate,s!==null&&md(s)===null&&(b=d),d=d.sibling;d=b,d===null?(b=o.child,o.child=null):(b=d.sibling,d.sibling=null),qm(o,!1,b,d,R);break;case"backwards":for(d=null,b=o.child,o.child=null;b!==null;){if(s=b.alternate,s!==null&&md(s)===null){o.child=b;break}s=b.sibling,b.sibling=d,d=b,b=s}qm(o,!0,d,null,R);break;case"together":qm(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Ed(s,o){(o.mode&1)===0&&s!==null&&(s.alternate=null,o.alternate=null,o.flags|=2)}function ps(s,o,d){if(s!==null&&(o.dependencies=s.dependencies),Oa|=o.lanes,(d&o.childLanes)===0)return null;if(s!==null&&o.child!==s.child)throw Error(n(153));if(o.child!==null){for(s=o.child,d=na(s,s.pendingProps),o.child=d,d.return=o;s.sibling!==null;)s=s.sibling,d=d.sibling=na(s,s.pendingProps),d.return=o;d.sibling=null}return o.child}function BP(s,o,d){switch(o.tag){case 3:kS(o),Lo();break;case 5:Y0(o);break;case 1:Or(o.type)&&sd(o);break;case 4:Mm(o,o.stateNode.containerInfo);break;case 10:var _=o.type._context,b=o.memoizedProps.value;un(dd,_._currentValue),_._currentValue=b;break;case 13:if(_=o.memoizedState,_!==null)return _.dehydrated!==null?(un(xn,xn.current&1),o.flags|=128,null):(d&o.child.childLanes)!==0?OS(s,o,d):(un(xn,xn.current&1),s=ps(s,o,d),s!==null?s.sibling:null);un(xn,xn.current&1);break;case 19:if(_=(d&o.childLanes)!==0,(s.flags&128)!==0){if(_)return US(s,o,d);o.flags|=128}if(b=o.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),un(xn,xn.current),_)break;return null;case 22:case 23:return o.lanes=0,PS(s,o,d)}return ps(s,o,d)}var FS,Zm,zS,$S;FS=function(s,o){for(var d=o.child;d!==null;){if(d.tag===5||d.tag===6)s.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===o)break;for(;d.sibling===null;){if(d.return===null||d.return===o)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},Zm=function(){},zS=function(s,o,d,_){var b=s.memoizedProps;if(b!==_){s=o.stateNode,ka(Zi.current);var R=null;switch(d){case"input":b=he(s,b),_=he(s,_),R=[];break;case"select":b=j({},b,{value:void 0}),_=j({},_,{value:void 0}),R=[];break;case"textarea":b=Me(s,b),_=Me(s,_),R=[];break;default:typeof b.onClick!="function"&&typeof _.onClick=="function"&&(s.onclick=nd)}wt(d,_);var k;d=null;for(me in b)if(!_.hasOwnProperty(me)&&b.hasOwnProperty(me)&&b[me]!=null)if(me==="style"){var Y=b[me];for(k in Y)Y.hasOwnProperty(k)&&(d||(d={}),d[k]="")}else me!=="dangerouslySetInnerHTML"&&me!=="children"&&me!=="suppressContentEditableWarning"&&me!=="suppressHydrationWarning"&&me!=="autoFocus"&&(i.hasOwnProperty(me)?R||(R=[]):(R=R||[]).push(me,null));for(me in _){var te=_[me];if(Y=b?.[me],_.hasOwnProperty(me)&&te!==Y&&(te!=null||Y!=null))if(me==="style")if(Y){for(k in Y)!Y.hasOwnProperty(k)||te&&te.hasOwnProperty(k)||(d||(d={}),d[k]="");for(k in te)te.hasOwnProperty(k)&&Y[k]!==te[k]&&(d||(d={}),d[k]=te[k])}else d||(R||(R=[]),R.push(me,d)),d=te;else me==="dangerouslySetInnerHTML"?(te=te?te.__html:void 0,Y=Y?Y.__html:void 0,te!=null&&Y!==te&&(R=R||[]).push(me,te)):me==="children"?typeof te!="string"&&typeof te!="number"||(R=R||[]).push(me,""+te):me!=="suppressContentEditableWarning"&&me!=="suppressHydrationWarning"&&(i.hasOwnProperty(me)?(te!=null&&me==="onScroll"&&hn("scroll",s),R||Y===te||(R=[])):(R=R||[]).push(me,te))}d&&(R=R||[]).push("style",d);var me=R;(o.updateQueue=me)&&(o.flags|=4)}},$S=function(s,o,d,_){d!==_&&(o.flags|=4)};function xc(s,o){if(!vn)switch(s.tailMode){case"hidden":o=s.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?s.tail=null:d.sibling=null;break;case"collapsed":d=s.tail;for(var _=null;d!==null;)d.alternate!==null&&(_=d),d=d.sibling;_===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:_.sibling=null}}function fr(s){var o=s.alternate!==null&&s.alternate.child===s.child,d=0,_=0;if(o)for(var b=s.child;b!==null;)d|=b.lanes|b.childLanes,_|=b.subtreeFlags&14680064,_|=b.flags&14680064,b.return=s,b=b.sibling;else for(b=s.child;b!==null;)d|=b.lanes|b.childLanes,_|=b.subtreeFlags,_|=b.flags,b.return=s,b=b.sibling;return s.subtreeFlags|=_,s.childLanes=d,o}function VP(s,o,d){var _=o.pendingProps;switch(gm(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fr(o),null;case 1:return Or(o.type)&&id(),fr(o),null;case 3:return _=o.stateNode,Fo(),pn(Lr),pn(ur),Am(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(s===null||s.child===null)&&(cd(o)?o.flags|=4:s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Ti!==null&&(sg(Ti),Ti=null))),Zm(s,o),fr(o),null;case 5:Rm(o);var b=ka(_c.current);if(d=o.type,s!==null&&o.stateNode!=null)zS(s,o,d,_,b),s.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!_){if(o.stateNode===null)throw Error(n(166));return fr(o),null}if(s=ka(Zi.current),cd(o)){_=o.stateNode,d=o.type;var R=o.memoizedProps;switch(_[qi]=o,_[fc]=R,s=(o.mode&1)!==0,d){case"dialog":hn("cancel",_),hn("close",_);break;case"iframe":case"object":case"embed":hn("load",_);break;case"video":case"audio":for(b=0;b<cc.length;b++)hn(cc[b],_);break;case"source":hn("error",_);break;case"img":case"image":case"link":hn("error",_),hn("load",_);break;case"details":hn("toggle",_);break;case"input":be(_,R),hn("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!R.multiple},hn("invalid",_);break;case"textarea":Ee(_,R),hn("invalid",_)}wt(d,R),b=null;for(var k in R)if(R.hasOwnProperty(k)){var Y=R[k];k==="children"?typeof Y=="string"?_.textContent!==Y&&(R.suppressHydrationWarning!==!0&&td(_.textContent,Y,s),b=["children",Y]):typeof Y=="number"&&_.textContent!==""+Y&&(R.suppressHydrationWarning!==!0&&td(_.textContent,Y,s),b=["children",""+Y]):i.hasOwnProperty(k)&&Y!=null&&k==="onScroll"&&hn("scroll",_)}switch(d){case"input":X(_),at(_,R,!0);break;case"textarea":X(_),et(_);break;case"select":case"option":break;default:typeof R.onClick=="function"&&(_.onclick=nd)}_=b,o.updateQueue=_,_!==null&&(o.flags|=4)}else{k=b.nodeType===9?b:b.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=ze(d)),s==="http://www.w3.org/1999/xhtml"?d==="script"?(s=k.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof _.is=="string"?s=k.createElement(d,{is:_.is}):(s=k.createElement(d),d==="select"&&(k=s,_.multiple?k.multiple=!0:_.size&&(k.size=_.size))):s=k.createElementNS(s,d),s[qi]=o,s[fc]=_,FS(s,o,!1,!1),o.stateNode=s;e:{switch(k=Bt(d,_),d){case"dialog":hn("cancel",s),hn("close",s),b=_;break;case"iframe":case"object":case"embed":hn("load",s),b=_;break;case"video":case"audio":for(b=0;b<cc.length;b++)hn(cc[b],s);b=_;break;case"source":hn("error",s),b=_;break;case"img":case"image":case"link":hn("error",s),hn("load",s),b=_;break;case"details":hn("toggle",s),b=_;break;case"input":be(s,_),b=he(s,_),hn("invalid",s);break;case"option":b=_;break;case"select":s._wrapperState={wasMultiple:!!_.multiple},b=j({},_,{value:void 0}),hn("invalid",s);break;case"textarea":Ee(s,_),b=Me(s,_),hn("invalid",s);break;default:b=_}wt(d,b),Y=b;for(R in Y)if(Y.hasOwnProperty(R)){var te=Y[R];R==="style"?lt(s,te):R==="dangerouslySetInnerHTML"?(te=te?te.__html:void 0,te!=null&&St(s,te)):R==="children"?typeof te=="string"?(d!=="textarea"||te!=="")&&Ae(s,te):typeof te=="number"&&Ae(s,""+te):R!=="suppressContentEditableWarning"&&R!=="suppressHydrationWarning"&&R!=="autoFocus"&&(i.hasOwnProperty(R)?te!=null&&R==="onScroll"&&hn("scroll",s):te!=null&&w(s,R,te,k))}switch(d){case"input":X(s),at(s,_,!1);break;case"textarea":X(s),et(s);break;case"option":_.value!=null&&s.setAttribute("value",""+le(_.value));break;case"select":s.multiple=!!_.multiple,R=_.value,R!=null?oe(s,!!_.multiple,R,!1):_.defaultValue!=null&&oe(s,!!_.multiple,_.defaultValue,!0);break;default:typeof b.onClick=="function"&&(s.onclick=nd)}switch(d){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return fr(o),null;case 6:if(s&&o.stateNode!=null)$S(s,o,s.memoizedProps,_);else{if(typeof _!="string"&&o.stateNode===null)throw Error(n(166));if(d=ka(_c.current),ka(Zi.current),cd(o)){if(_=o.stateNode,d=o.memoizedProps,_[qi]=o,(R=_.nodeValue!==d)&&(s=Wr,s!==null))switch(s.tag){case 3:td(_.nodeValue,d,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&td(_.nodeValue,d,(s.mode&1)!==0)}R&&(o.flags|=4)}else _=(d.nodeType===9?d:d.ownerDocument).createTextNode(_),_[qi]=o,o.stateNode=_}return fr(o),null;case 13:if(pn(xn),_=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(vn&&qr!==null&&(o.mode&1)!==0&&(o.flags&128)===0)j0(),Lo(),o.flags|=98560,R=!1;else if(R=cd(o),_!==null&&_.dehydrated!==null){if(s===null){if(!R)throw Error(n(318));if(R=o.memoizedState,R=R!==null?R.dehydrated:null,!R)throw Error(n(317));R[qi]=o}else Lo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;fr(o),R=!1}else Ti!==null&&(sg(Ti),Ti=null),R=!0;if(!R)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=d,o):(_=_!==null,_!==(s!==null&&s.memoizedState!==null)&&_&&(o.child.flags|=8192,(o.mode&1)!==0&&(s===null||(xn.current&1)!==0?zn===0&&(zn=3):lg())),o.updateQueue!==null&&(o.flags|=4),fr(o),null);case 4:return Fo(),Zm(s,o),s===null&&uc(o.stateNode.containerInfo),fr(o),null;case 10:return xm(o.type._context),fr(o),null;case 17:return Or(o.type)&&id(),fr(o),null;case 19:if(pn(xn),R=o.memoizedState,R===null)return fr(o),null;if(_=(o.flags&128)!==0,k=R.rendering,k===null)if(_)xc(R,!1);else{if(zn!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(k=md(s),k!==null){for(o.flags|=128,xc(R,!1),_=k.updateQueue,_!==null&&(o.updateQueue=_,o.flags|=4),o.subtreeFlags=0,_=d,d=o.child;d!==null;)R=d,s=_,R.flags&=14680066,k=R.alternate,k===null?(R.childLanes=0,R.lanes=s,R.child=null,R.subtreeFlags=0,R.memoizedProps=null,R.memoizedState=null,R.updateQueue=null,R.dependencies=null,R.stateNode=null):(R.childLanes=k.childLanes,R.lanes=k.lanes,R.child=k.child,R.subtreeFlags=0,R.deletions=null,R.memoizedProps=k.memoizedProps,R.memoizedState=k.memoizedState,R.updateQueue=k.updateQueue,R.type=k.type,s=k.dependencies,R.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),d=d.sibling;return un(xn,xn.current&1|2),o.child}s=s.sibling}R.tail!==null&&Ke()>Vo&&(o.flags|=128,_=!0,xc(R,!1),o.lanes=4194304)}else{if(!_)if(s=md(k),s!==null){if(o.flags|=128,_=!0,d=s.updateQueue,d!==null&&(o.updateQueue=d,o.flags|=4),xc(R,!0),R.tail===null&&R.tailMode==="hidden"&&!k.alternate&&!vn)return fr(o),null}else 2*Ke()-R.renderingStartTime>Vo&&d!==1073741824&&(o.flags|=128,_=!0,xc(R,!1),o.lanes=4194304);R.isBackwards?(k.sibling=o.child,o.child=k):(d=R.last,d!==null?d.sibling=k:o.child=k,R.last=k)}return R.tail!==null?(o=R.tail,R.rendering=o,R.tail=o.sibling,R.renderingStartTime=Ke(),o.sibling=null,d=xn.current,un(xn,_?d&1|2:d&1),o):(fr(o),null);case 22:case 23:return og(),_=o.memoizedState!==null,s!==null&&s.memoizedState!==null!==_&&(o.flags|=8192),_&&(o.mode&1)!==0?(Zr&1073741824)!==0&&(fr(o),o.subtreeFlags&6&&(o.flags|=8192)):fr(o),null;case 24:return null;case 25:return null}throw Error(n(156,o.tag))}function jP(s,o){switch(gm(o),o.tag){case 1:return Or(o.type)&&id(),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return Fo(),pn(Lr),pn(ur),Am(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 5:return Rm(o),null;case 13:if(pn(xn),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Lo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return pn(xn),null;case 4:return Fo(),null;case 10:return xm(o.type._context),null;case 22:case 23:return og(),null;case 24:return null;default:return null}}var bd=!1,hr=!1,HP=typeof WeakSet=="function"?WeakSet:Set,Ye=null;function $o(s,o){var d=s.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(_){Cn(s,o,_)}else d.current=null}function Xm(s,o,d){try{d()}catch(_){Cn(s,o,_)}}var BS=!1;function GP(s,o){if(om=Hu,s=y0(),Qp(s)){if("selectionStart"in s)var d={start:s.selectionStart,end:s.selectionEnd};else e:{d=(d=s.ownerDocument)&&d.defaultView||window;var _=d.getSelection&&d.getSelection();if(_&&_.rangeCount!==0){d=_.anchorNode;var b=_.anchorOffset,R=_.focusNode;_=_.focusOffset;try{d.nodeType,R.nodeType}catch{d=null;break e}var k=0,Y=-1,te=-1,me=0,Pe=0,ke=s,Ce=null;t:for(;;){for(var qe;ke!==d||b!==0&&ke.nodeType!==3||(Y=k+b),ke!==R||_!==0&&ke.nodeType!==3||(te=k+_),ke.nodeType===3&&(k+=ke.nodeValue.length),(qe=ke.firstChild)!==null;)Ce=ke,ke=qe;for(;;){if(ke===s)break t;if(Ce===d&&++me===b&&(Y=k),Ce===R&&++Pe===_&&(te=k),(qe=ke.nextSibling)!==null)break;ke=Ce,Ce=ke.parentNode}ke=qe}d=Y===-1||te===-1?null:{start:Y,end:te}}else d=null}d=d||{start:0,end:0}}else d=null;for(lm={focusedElem:s,selectionRange:d},Hu=!1,Ye=o;Ye!==null;)if(o=Ye,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,Ye=s;else for(;Ye!==null;){o=Ye;try{var Je=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(Je!==null){var tt=Je.memoizedProps,In=Je.memoizedState,ce=o.stateNode,se=ce.getSnapshotBeforeUpdate(o.elementType===o.type?tt:Mi(o.type,tt),In);ce.__reactInternalSnapshotBeforeUpdate=se}break;case 3:var fe=o.stateNode.containerInfo;fe.nodeType===1?fe.textContent="":fe.nodeType===9&&fe.documentElement&&fe.removeChild(fe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(De){Cn(o,o.return,De)}if(s=o.sibling,s!==null){s.return=o.return,Ye=s;break}Ye=o.return}return Je=BS,BS=!1,Je}function Ec(s,o,d){var _=o.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var b=_=_.next;do{if((b.tag&s)===s){var R=b.destroy;b.destroy=void 0,R!==void 0&&Xm(o,d,R)}b=b.next}while(b!==_)}}function Td(s,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var d=o=o.next;do{if((d.tag&s)===s){var _=d.create;d.destroy=_()}d=d.next}while(d!==o)}}function Km(s){var o=s.ref;if(o!==null){var d=s.stateNode;s.tag,s=d,typeof o=="function"?o(s):o.current=s}}function VS(s){var o=s.alternate;o!==null&&(s.alternate=null,VS(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&(delete o[qi],delete o[fc],delete o[fm],delete o[RP],delete o[CP])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function jS(s){return s.tag===5||s.tag===3||s.tag===4}function HS(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||jS(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Ym(s,o,d){var _=s.tag;if(_===5||_===6)s=s.stateNode,o?d.nodeType===8?d.parentNode.insertBefore(s,o):d.insertBefore(s,o):(d.nodeType===8?(o=d.parentNode,o.insertBefore(s,d)):(o=d,o.appendChild(s)),d=d._reactRootContainer,d!=null||o.onclick!==null||(o.onclick=nd));else if(_!==4&&(s=s.child,s!==null))for(Ym(s,o,d),s=s.sibling;s!==null;)Ym(s,o,d),s=s.sibling}function Jm(s,o,d){var _=s.tag;if(_===5||_===6)s=s.stateNode,o?d.insertBefore(s,o):d.appendChild(s);else if(_!==4&&(s=s.child,s!==null))for(Jm(s,o,d),s=s.sibling;s!==null;)Jm(s,o,d),s=s.sibling}var Qn=null,Ri=!1;function Ys(s,o,d){for(d=d.child;d!==null;)GS(s,o,d),d=d.sibling}function GS(s,o,d){if($t&&typeof $t.onCommitFiberUnmount=="function")try{$t.onCommitFiberUnmount(Nr,d)}catch{}switch(d.tag){case 5:hr||$o(d,o);case 6:var _=Qn,b=Ri;Qn=null,Ys(s,o,d),Qn=_,Ri=b,Qn!==null&&(Ri?(s=Qn,d=d.stateNode,s.nodeType===8?s.parentNode.removeChild(d):s.removeChild(d)):Qn.removeChild(d.stateNode));break;case 18:Qn!==null&&(Ri?(s=Qn,d=d.stateNode,s.nodeType===8?dm(s.parentNode,d):s.nodeType===1&&dm(s,d),tc(s)):dm(Qn,d.stateNode));break;case 4:_=Qn,b=Ri,Qn=d.stateNode.containerInfo,Ri=!0,Ys(s,o,d),Qn=_,Ri=b;break;case 0:case 11:case 14:case 15:if(!hr&&(_=d.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){b=_=_.next;do{var R=b,k=R.destroy;R=R.tag,k!==void 0&&((R&2)!==0||(R&4)!==0)&&Xm(d,o,k),b=b.next}while(b!==_)}Ys(s,o,d);break;case 1:if(!hr&&($o(d,o),_=d.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=d.memoizedProps,_.state=d.memoizedState,_.componentWillUnmount()}catch(Y){Cn(d,o,Y)}Ys(s,o,d);break;case 21:Ys(s,o,d);break;case 22:d.mode&1?(hr=(_=hr)||d.memoizedState!==null,Ys(s,o,d),hr=_):Ys(s,o,d);break;default:Ys(s,o,d)}}function WS(s){var o=s.updateQueue;if(o!==null){s.updateQueue=null;var d=s.stateNode;d===null&&(d=s.stateNode=new HP),o.forEach(function(_){var b=eI.bind(null,s,_);d.has(_)||(d.add(_),_.then(b,b))})}}function Ci(s,o){var d=o.deletions;if(d!==null)for(var _=0;_<d.length;_++){var b=d[_];try{var R=s,k=o,Y=k;e:for(;Y!==null;){switch(Y.tag){case 5:Qn=Y.stateNode,Ri=!1;break e;case 3:Qn=Y.stateNode.containerInfo,Ri=!0;break e;case 4:Qn=Y.stateNode.containerInfo,Ri=!0;break e}Y=Y.return}if(Qn===null)throw Error(n(160));GS(R,k,b),Qn=null,Ri=!1;var te=b.alternate;te!==null&&(te.return=null),b.return=null}catch(me){Cn(b,o,me)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)qS(o,s),o=o.sibling}function qS(s,o){var d=s.alternate,_=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Ci(o,s),Ki(s),_&4){try{Ec(3,s,s.return),Td(3,s)}catch(tt){Cn(s,s.return,tt)}try{Ec(5,s,s.return)}catch(tt){Cn(s,s.return,tt)}}break;case 1:Ci(o,s),Ki(s),_&512&&d!==null&&$o(d,d.return);break;case 5:if(Ci(o,s),Ki(s),_&512&&d!==null&&$o(d,d.return),s.flags&32){var b=s.stateNode;try{Ae(b,"")}catch(tt){Cn(s,s.return,tt)}}if(_&4&&(b=s.stateNode,b!=null)){var R=s.memoizedProps,k=d!==null?d.memoizedProps:R,Y=s.type,te=s.updateQueue;if(s.updateQueue=null,te!==null)try{Y==="input"&&R.type==="radio"&&R.name!=null&&Re(b,R),Bt(Y,k);var me=Bt(Y,R);for(k=0;k<te.length;k+=2){var Pe=te[k],ke=te[k+1];Pe==="style"?lt(b,ke):Pe==="dangerouslySetInnerHTML"?St(b,ke):Pe==="children"?Ae(b,ke):w(b,Pe,ke,me)}switch(Y){case"input":gt(b,R);break;case"textarea":Ie(b,R);break;case"select":var Ce=b._wrapperState.wasMultiple;b._wrapperState.wasMultiple=!!R.multiple;var qe=R.value;qe!=null?oe(b,!!R.multiple,qe,!1):Ce!==!!R.multiple&&(R.defaultValue!=null?oe(b,!!R.multiple,R.defaultValue,!0):oe(b,!!R.multiple,R.multiple?[]:"",!1))}b[fc]=R}catch(tt){Cn(s,s.return,tt)}}break;case 6:if(Ci(o,s),Ki(s),_&4){if(s.stateNode===null)throw Error(n(162));b=s.stateNode,R=s.memoizedProps;try{b.nodeValue=R}catch(tt){Cn(s,s.return,tt)}}break;case 3:if(Ci(o,s),Ki(s),_&4&&d!==null&&d.memoizedState.isDehydrated)try{tc(o.containerInfo)}catch(tt){Cn(s,s.return,tt)}break;case 4:Ci(o,s),Ki(s);break;case 13:Ci(o,s),Ki(s),b=s.child,b.flags&8192&&(R=b.memoizedState!==null,b.stateNode.isHidden=R,!R||b.alternate!==null&&b.alternate.memoizedState!==null||(tg=Ke())),_&4&&WS(s);break;case 22:if(Pe=d!==null&&d.memoizedState!==null,s.mode&1?(hr=(me=hr)||Pe,Ci(o,s),hr=me):Ci(o,s),Ki(s),_&8192){if(me=s.memoizedState!==null,(s.stateNode.isHidden=me)&&!Pe&&(s.mode&1)!==0)for(Ye=s,Pe=s.child;Pe!==null;){for(ke=Ye=Pe;Ye!==null;){switch(Ce=Ye,qe=Ce.child,Ce.tag){case 0:case 11:case 14:case 15:Ec(4,Ce,Ce.return);break;case 1:$o(Ce,Ce.return);var Je=Ce.stateNode;if(typeof Je.componentWillUnmount=="function"){_=Ce,d=Ce.return;try{o=_,Je.props=o.memoizedProps,Je.state=o.memoizedState,Je.componentWillUnmount()}catch(tt){Cn(_,d,tt)}}break;case 5:$o(Ce,Ce.return);break;case 22:if(Ce.memoizedState!==null){KS(ke);continue}}qe!==null?(qe.return=Ce,Ye=qe):KS(ke)}Pe=Pe.sibling}e:for(Pe=null,ke=s;;){if(ke.tag===5){if(Pe===null){Pe=ke;try{b=ke.stateNode,me?(R=b.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none"):(Y=ke.stateNode,te=ke.memoizedProps.style,k=te!=null&&te.hasOwnProperty("display")?te.display:null,Y.style.display=vt("display",k))}catch(tt){Cn(s,s.return,tt)}}}else if(ke.tag===6){if(Pe===null)try{ke.stateNode.nodeValue=me?"":ke.memoizedProps}catch(tt){Cn(s,s.return,tt)}}else if((ke.tag!==22&&ke.tag!==23||ke.memoizedState===null||ke===s)&&ke.child!==null){ke.child.return=ke,ke=ke.child;continue}if(ke===s)break e;for(;ke.sibling===null;){if(ke.return===null||ke.return===s)break e;Pe===ke&&(Pe=null),ke=ke.return}Pe===ke&&(Pe=null),ke.sibling.return=ke.return,ke=ke.sibling}}break;case 19:Ci(o,s),Ki(s),_&4&&WS(s);break;case 21:break;default:Ci(o,s),Ki(s)}}function Ki(s){var o=s.flags;if(o&2){try{e:{for(var d=s.return;d!==null;){if(jS(d)){var _=d;break e}d=d.return}throw Error(n(160))}switch(_.tag){case 5:var b=_.stateNode;_.flags&32&&(Ae(b,""),_.flags&=-33);var R=HS(s);Jm(s,R,b);break;case 3:case 4:var k=_.stateNode.containerInfo,Y=HS(s);Ym(s,Y,k);break;default:throw Error(n(161))}}catch(te){Cn(s,s.return,te)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function WP(s,o,d){Ye=s,ZS(s)}function ZS(s,o,d){for(var _=(s.mode&1)!==0;Ye!==null;){var b=Ye,R=b.child;if(b.tag===22&&_){var k=b.memoizedState!==null||bd;if(!k){var Y=b.alternate,te=Y!==null&&Y.memoizedState!==null||hr;Y=bd;var me=hr;if(bd=k,(hr=te)&&!me)for(Ye=b;Ye!==null;)k=Ye,te=k.child,k.tag===22&&k.memoizedState!==null?YS(b):te!==null?(te.return=k,Ye=te):YS(b);for(;R!==null;)Ye=R,ZS(R),R=R.sibling;Ye=b,bd=Y,hr=me}XS(s)}else(b.subtreeFlags&8772)!==0&&R!==null?(R.return=b,Ye=R):XS(s)}}function XS(s){for(;Ye!==null;){var o=Ye;if((o.flags&8772)!==0){var d=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:hr||Td(5,o);break;case 1:var _=o.stateNode;if(o.flags&4&&!hr)if(d===null)_.componentDidMount();else{var b=o.elementType===o.type?d.memoizedProps:Mi(o.type,d.memoizedProps);_.componentDidUpdate(b,d.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var R=o.updateQueue;R!==null&&K0(o,R,_);break;case 3:var k=o.updateQueue;if(k!==null){if(d=null,o.child!==null)switch(o.child.tag){case 5:d=o.child.stateNode;break;case 1:d=o.child.stateNode}K0(o,k,d)}break;case 5:var Y=o.stateNode;if(d===null&&o.flags&4){d=Y;var te=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":te.autoFocus&&d.focus();break;case"img":te.src&&(d.src=te.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var me=o.alternate;if(me!==null){var Pe=me.memoizedState;if(Pe!==null){var ke=Pe.dehydrated;ke!==null&&tc(ke)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}hr||o.flags&512&&Km(o)}catch(Ce){Cn(o,o.return,Ce)}}if(o===s){Ye=null;break}if(d=o.sibling,d!==null){d.return=o.return,Ye=d;break}Ye=o.return}}function KS(s){for(;Ye!==null;){var o=Ye;if(o===s){Ye=null;break}var d=o.sibling;if(d!==null){d.return=o.return,Ye=d;break}Ye=o.return}}function YS(s){for(;Ye!==null;){var o=Ye;try{switch(o.tag){case 0:case 11:case 15:var d=o.return;try{Td(4,o)}catch(te){Cn(o,d,te)}break;case 1:var _=o.stateNode;if(typeof _.componentDidMount=="function"){var b=o.return;try{_.componentDidMount()}catch(te){Cn(o,b,te)}}var R=o.return;try{Km(o)}catch(te){Cn(o,R,te)}break;case 5:var k=o.return;try{Km(o)}catch(te){Cn(o,k,te)}}}catch(te){Cn(o,o.return,te)}if(o===s){Ye=null;break}var Y=o.sibling;if(Y!==null){Y.return=o.return,Ye=Y;break}Ye=o.return}}var qP=Math.ceil,Md=C.ReactCurrentDispatcher,Qm=C.ReactCurrentOwner,ui=C.ReactCurrentBatchConfig,Vt=0,qn=null,Ln=null,er=0,Zr=0,Bo=Ws(0),zn=0,bc=null,Oa=0,Rd=0,eg=0,Tc=null,Ur=null,tg=0,Vo=1/0,ms=null,Cd=!1,ng=null,Js=null,Ad=!1,Qs=null,Pd=0,Mc=0,rg=null,Id=-1,Nd=0;function xr(){return(Vt&6)!==0?Ke():Id!==-1?Id:Id=Ke()}function ea(s){return(s.mode&1)===0?1:(Vt&2)!==0&&er!==0?er&-er:PP.transition!==null?(Nd===0&&(Nd=Bu()),Nd):(s=Qt,s!==0||(s=window.event,s=s===void 0?16:Qy(s.type)),s)}function Ai(s,o,d,_){if(50<Mc)throw Mc=0,rg=null,Error(n(185));Kl(s,d,_),((Vt&2)===0||s!==qn)&&(s===qn&&((Vt&2)===0&&(Rd|=d),zn===4&&ta(s,er)),Fr(s,_),d===1&&Vt===0&&(o.mode&1)===0&&(Vo=Ke()+500,ad&&Zs()))}function Fr(s,o){var d=s.callbackNode;kr(s,o);var _=si(s,s===qn?er:0);if(_===0)d!==null&&We(d),s.callbackNode=null,s.callbackPriority=0;else if(o=_&-_,s.callbackPriority!==o){if(d!=null&&We(d),o===1)s.tag===0?AP(QS.bind(null,s)):F0(QS.bind(null,s)),TP(function(){(Vt&6)===0&&Zs()}),d=null;else{switch(Gy(_)){case 1:d=yt;break;case 4:d=xt;break;case 16:d=cn;break;case 536870912:d=Pn;break;default:d=cn}d=ow(d,JS.bind(null,s))}s.callbackPriority=o,s.callbackNode=d}}function JS(s,o){if(Id=-1,Nd=0,(Vt&6)!==0)throw Error(n(327));var d=s.callbackNode;if(jo()&&s.callbackNode!==d)return null;var _=si(s,s===qn?er:0);if(_===0)return null;if((_&30)!==0||(_&s.expiredLanes)!==0||o)o=kd(s,_);else{o=_;var b=Vt;Vt|=2;var R=tw();(qn!==s||er!==o)&&(ms=null,Vo=Ke()+500,Ua(s,o));do try{KP();break}catch(Y){ew(s,Y)}while(!0);wm(),Md.current=R,Vt=b,Ln!==null?o=0:(qn=null,er=0,o=zn)}if(o!==0){if(o===2&&(b=Ra(s),b!==0&&(_=b,o=ig(s,b))),o===1)throw d=bc,Ua(s,0),ta(s,_),Fr(s,Ke()),d;if(o===6)ta(s,_);else{if(b=s.current.alternate,(_&30)===0&&!ZP(b)&&(o=kd(s,_),o===2&&(R=Ra(s),R!==0&&(_=R,o=ig(s,R))),o===1))throw d=bc,Ua(s,0),ta(s,_),Fr(s,Ke()),d;switch(s.finishedWork=b,s.finishedLanes=_,o){case 0:case 1:throw Error(n(345));case 2:Fa(s,Ur,ms);break;case 3:if(ta(s,_),(_&130023424)===_&&(o=tg+500-Ke(),10<o)){if(si(s,0)!==0)break;if(b=s.suspendedLanes,(b&_)!==_){xr(),s.pingedLanes|=s.suspendedLanes&b;break}s.timeoutHandle=um(Fa.bind(null,s,Ur,ms),o);break}Fa(s,Ur,ms);break;case 4:if(ta(s,_),(_&4194240)===_)break;for(o=s.eventTimes,b=-1;0<_;){var k=31-Sr(_);R=1<<k,k=o[k],k>b&&(b=k),_&=~R}if(_=b,_=Ke()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*qP(_/1960))-_,10<_){s.timeoutHandle=um(Fa.bind(null,s,Ur,ms),_);break}Fa(s,Ur,ms);break;case 5:Fa(s,Ur,ms);break;default:throw Error(n(329))}}}return Fr(s,Ke()),s.callbackNode===d?JS.bind(null,s):null}function ig(s,o){var d=Tc;return s.current.memoizedState.isDehydrated&&(Ua(s,o).flags|=256),s=kd(s,o),s!==2&&(o=Ur,Ur=d,o!==null&&sg(o)),s}function sg(s){Ur===null?Ur=s:Ur.push.apply(Ur,s)}function ZP(s){for(var o=s;;){if(o.flags&16384){var d=o.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var _=0;_<d.length;_++){var b=d[_],R=b.getSnapshot;b=b.value;try{if(!bi(R(),b))return!1}catch{return!1}}}if(d=o.child,o.subtreeFlags&16384&&d!==null)d.return=o,o=d;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ta(s,o){for(o&=~eg,o&=~Rd,s.suspendedLanes|=o,s.pingedLanes&=~o,s=s.expirationTimes;0<o;){var d=31-Sr(o),_=1<<d;s[d]=-1,o&=~_}}function QS(s){if((Vt&6)!==0)throw Error(n(327));jo();var o=si(s,0);if((o&1)===0)return Fr(s,Ke()),null;var d=kd(s,o);if(s.tag!==0&&d===2){var _=Ra(s);_!==0&&(o=_,d=ig(s,_))}if(d===1)throw d=bc,Ua(s,0),ta(s,o),Fr(s,Ke()),d;if(d===6)throw Error(n(345));return s.finishedWork=s.current.alternate,s.finishedLanes=o,Fa(s,Ur,ms),Fr(s,Ke()),null}function ag(s,o){var d=Vt;Vt|=1;try{return s(o)}finally{Vt=d,Vt===0&&(Vo=Ke()+500,ad&&Zs())}}function Da(s){Qs!==null&&Qs.tag===0&&(Vt&6)===0&&jo();var o=Vt;Vt|=1;var d=ui.transition,_=Qt;try{if(ui.transition=null,Qt=1,s)return s()}finally{Qt=_,ui.transition=d,Vt=o,(Vt&6)===0&&Zs()}}function og(){Zr=Bo.current,pn(Bo)}function Ua(s,o){s.finishedWork=null,s.finishedLanes=0;var d=s.timeoutHandle;if(d!==-1&&(s.timeoutHandle=-1,bP(d)),Ln!==null)for(d=Ln.return;d!==null;){var _=d;switch(gm(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&id();break;case 3:Fo(),pn(Lr),pn(ur),Am();break;case 5:Rm(_);break;case 4:Fo();break;case 13:pn(xn);break;case 19:pn(xn);break;case 10:xm(_.type._context);break;case 22:case 23:og()}d=d.return}if(qn=s,Ln=s=na(s.current,null),er=Zr=o,zn=0,bc=null,eg=Rd=Oa=0,Ur=Tc=null,Na!==null){for(o=0;o<Na.length;o++)if(d=Na[o],_=d.interleaved,_!==null){d.interleaved=null;var b=_.next,R=d.pending;if(R!==null){var k=R.next;R.next=b,_.next=k}d.pending=_}Na=null}return s}function ew(s,o){do{var d=Ln;try{if(wm(),gd.current=Sd,_d){for(var _=En.memoizedState;_!==null;){var b=_.queue;b!==null&&(b.pending=null),_=_.next}_d=!1}if(La=0,Wn=Fn=En=null,vc=!1,yc=0,Qm.current=null,d===null||d.return===null){zn=1,bc=o,Ln=null;break}e:{var R=s,k=d.return,Y=d,te=o;if(o=er,Y.flags|=32768,te!==null&&typeof te=="object"&&typeof te.then=="function"){var me=te,Pe=Y,ke=Pe.tag;if((Pe.mode&1)===0&&(ke===0||ke===11||ke===15)){var Ce=Pe.alternate;Ce?(Pe.updateQueue=Ce.updateQueue,Pe.memoizedState=Ce.memoizedState,Pe.lanes=Ce.lanes):(Pe.updateQueue=null,Pe.memoizedState=null)}var qe=TS(k);if(qe!==null){qe.flags&=-257,MS(qe,k,Y,R,o),qe.mode&1&&bS(R,me,o),o=qe,te=me;var Je=o.updateQueue;if(Je===null){var tt=new Set;tt.add(te),o.updateQueue=tt}else Je.add(te);break e}else{if((o&1)===0){bS(R,me,o),lg();break e}te=Error(n(426))}}else if(vn&&Y.mode&1){var In=TS(k);if(In!==null){(In.flags&65536)===0&&(In.flags|=256),MS(In,k,Y,R,o),ym(zo(te,Y));break e}}R=te=zo(te,Y),zn!==4&&(zn=2),Tc===null?Tc=[R]:Tc.push(R),R=k;do{switch(R.tag){case 3:R.flags|=65536,o&=-o,R.lanes|=o;var ce=xS(R,te,o);X0(R,ce);break e;case 1:Y=te;var se=R.type,fe=R.stateNode;if((R.flags&128)===0&&(typeof se.getDerivedStateFromError=="function"||fe!==null&&typeof fe.componentDidCatch=="function"&&(Js===null||!Js.has(fe)))){R.flags|=65536,o&=-o,R.lanes|=o;var De=ES(R,Y,o);X0(R,De);break e}}R=R.return}while(R!==null)}rw(d)}catch(nt){o=nt,Ln===d&&d!==null&&(Ln=d=d.return);continue}break}while(!0)}function tw(){var s=Md.current;return Md.current=Sd,s===null?Sd:s}function lg(){(zn===0||zn===3||zn===2)&&(zn=4),qn===null||(Oa&268435455)===0&&(Rd&268435455)===0||ta(qn,er)}function kd(s,o){var d=Vt;Vt|=2;var _=tw();(qn!==s||er!==o)&&(ms=null,Ua(s,o));do try{XP();break}catch(b){ew(s,b)}while(!0);if(wm(),Vt=d,Md.current=_,Ln!==null)throw Error(n(261));return qn=null,er=0,zn}function XP(){for(;Ln!==null;)nw(Ln)}function KP(){for(;Ln!==null&&!st();)nw(Ln)}function nw(s){var o=aw(s.alternate,s,Zr);s.memoizedProps=s.pendingProps,o===null?rw(s):Ln=o,Qm.current=null}function rw(s){var o=s;do{var d=o.alternate;if(s=o.return,(o.flags&32768)===0){if(d=VP(d,o,Zr),d!==null){Ln=d;return}}else{if(d=jP(d,o),d!==null){d.flags&=32767,Ln=d;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{zn=6,Ln=null;return}}if(o=o.sibling,o!==null){Ln=o;return}Ln=o=s}while(o!==null);zn===0&&(zn=5)}function Fa(s,o,d){var _=Qt,b=ui.transition;try{ui.transition=null,Qt=1,YP(s,o,d,_)}finally{ui.transition=b,Qt=_}return null}function YP(s,o,d,_){do jo();while(Qs!==null);if((Vt&6)!==0)throw Error(n(327));d=s.finishedWork;var b=s.finishedLanes;if(d===null)return null;if(s.finishedWork=null,s.finishedLanes=0,d===s.current)throw Error(n(177));s.callbackNode=null,s.callbackPriority=0;var R=d.lanes|d.childLanes;if(I1(s,R),s===qn&&(Ln=qn=null,er=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Ad||(Ad=!0,ow(cn,function(){return jo(),null})),R=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||R){R=ui.transition,ui.transition=null;var k=Qt;Qt=1;var Y=Vt;Vt|=4,Qm.current=null,GP(s,d),qS(d,s),_P(lm),Hu=!!om,lm=om=null,s.current=d,WP(d),ft(),Vt=Y,Qt=k,ui.transition=R}else s.current=d;if(Ad&&(Ad=!1,Qs=s,Pd=b),R=s.pendingLanes,R===0&&(Js=null),Ct(d.stateNode),Fr(s,Ke()),o!==null)for(_=s.onRecoverableError,d=0;d<o.length;d++)b=o[d],_(b.value,{componentStack:b.stack,digest:b.digest});if(Cd)throw Cd=!1,s=ng,ng=null,s;return(Pd&1)!==0&&s.tag!==0&&jo(),R=s.pendingLanes,(R&1)!==0?s===rg?Mc++:(Mc=0,rg=s):Mc=0,Zs(),null}function jo(){if(Qs!==null){var s=Gy(Pd),o=ui.transition,d=Qt;try{if(ui.transition=null,Qt=16>s?16:s,Qs===null)var _=!1;else{if(s=Qs,Qs=null,Pd=0,(Vt&6)!==0)throw Error(n(331));var b=Vt;for(Vt|=4,Ye=s.current;Ye!==null;){var R=Ye,k=R.child;if((Ye.flags&16)!==0){var Y=R.deletions;if(Y!==null){for(var te=0;te<Y.length;te++){var me=Y[te];for(Ye=me;Ye!==null;){var Pe=Ye;switch(Pe.tag){case 0:case 11:case 15:Ec(8,Pe,R)}var ke=Pe.child;if(ke!==null)ke.return=Pe,Ye=ke;else for(;Ye!==null;){Pe=Ye;var Ce=Pe.sibling,qe=Pe.return;if(VS(Pe),Pe===me){Ye=null;break}if(Ce!==null){Ce.return=qe,Ye=Ce;break}Ye=qe}}}var Je=R.alternate;if(Je!==null){var tt=Je.child;if(tt!==null){Je.child=null;do{var In=tt.sibling;tt.sibling=null,tt=In}while(tt!==null)}}Ye=R}}if((R.subtreeFlags&2064)!==0&&k!==null)k.return=R,Ye=k;else e:for(;Ye!==null;){if(R=Ye,(R.flags&2048)!==0)switch(R.tag){case 0:case 11:case 15:Ec(9,R,R.return)}var ce=R.sibling;if(ce!==null){ce.return=R.return,Ye=ce;break e}Ye=R.return}}var se=s.current;for(Ye=se;Ye!==null;){k=Ye;var fe=k.child;if((k.subtreeFlags&2064)!==0&&fe!==null)fe.return=k,Ye=fe;else e:for(k=se;Ye!==null;){if(Y=Ye,(Y.flags&2048)!==0)try{switch(Y.tag){case 0:case 11:case 15:Td(9,Y)}}catch(nt){Cn(Y,Y.return,nt)}if(Y===k){Ye=null;break e}var De=Y.sibling;if(De!==null){De.return=Y.return,Ye=De;break e}Ye=Y.return}}if(Vt=b,Zs(),$t&&typeof $t.onPostCommitFiberRoot=="function")try{$t.onPostCommitFiberRoot(Nr,s)}catch{}_=!0}return _}finally{Qt=d,ui.transition=o}}return!1}function iw(s,o,d){o=zo(d,o),o=xS(s,o,1),s=Ks(s,o,1),o=xr(),s!==null&&(Kl(s,1,o),Fr(s,o))}function Cn(s,o,d){if(s.tag===3)iw(s,s,d);else for(;o!==null;){if(o.tag===3){iw(o,s,d);break}else if(o.tag===1){var _=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Js===null||!Js.has(_))){s=zo(d,s),s=ES(o,s,1),o=Ks(o,s,1),s=xr(),o!==null&&(Kl(o,1,s),Fr(o,s));break}}o=o.return}}function JP(s,o,d){var _=s.pingCache;_!==null&&_.delete(o),o=xr(),s.pingedLanes|=s.suspendedLanes&d,qn===s&&(er&d)===d&&(zn===4||zn===3&&(er&130023424)===er&&500>Ke()-tg?Ua(s,0):eg|=d),Fr(s,o)}function sw(s,o){o===0&&((s.mode&1)===0?o=1:(o=Fs,Fs<<=1,(Fs&130023424)===0&&(Fs=4194304)));var d=xr();s=fs(s,o),s!==null&&(Kl(s,o,d),Fr(s,d))}function QP(s){var o=s.memoizedState,d=0;o!==null&&(d=o.retryLane),sw(s,d)}function eI(s,o){var d=0;switch(s.tag){case 13:var _=s.stateNode,b=s.memoizedState;b!==null&&(d=b.retryLane);break;case 19:_=s.stateNode;break;default:throw Error(n(314))}_!==null&&_.delete(o),sw(s,d)}var aw;aw=function(s,o,d){if(s!==null)if(s.memoizedProps!==o.pendingProps||Lr.current)Dr=!0;else{if((s.lanes&d)===0&&(o.flags&128)===0)return Dr=!1,BP(s,o,d);Dr=(s.flags&131072)!==0}else Dr=!1,vn&&(o.flags&1048576)!==0&&z0(o,ld,o.index);switch(o.lanes=0,o.tag){case 2:var _=o.type;Ed(s,o),s=o.pendingProps;var b=Io(o,ur.current);Uo(o,d),b=Nm(null,o,_,s,b,d);var R=km();return o.flags|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Or(_)?(R=!0,sd(o)):R=!1,o.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,Tm(o),b.updater=wd,o.stateNode=b,b._reactInternals=o,zm(o,_,s,d),o=jm(null,o,_,!0,R,d)):(o.tag=0,vn&&R&&mm(o),wr(null,o,b,d),o=o.child),o;case 16:_=o.elementType;e:{switch(Ed(s,o),s=o.pendingProps,b=_._init,_=b(_._payload),o.type=_,b=o.tag=nI(_),s=Mi(_,s),b){case 0:o=Vm(null,o,_,s,d);break e;case 1:o=NS(null,o,_,s,d);break e;case 11:o=RS(null,o,_,s,d);break e;case 14:o=CS(null,o,_,Mi(_.type,s),d);break e}throw Error(n(306,_,""))}return o;case 0:return _=o.type,b=o.pendingProps,b=o.elementType===_?b:Mi(_,b),Vm(s,o,_,b,d);case 1:return _=o.type,b=o.pendingProps,b=o.elementType===_?b:Mi(_,b),NS(s,o,_,b,d);case 3:e:{if(kS(o),s===null)throw Error(n(387));_=o.pendingProps,R=o.memoizedState,b=R.element,Z0(s,o),pd(o,_,null,d);var k=o.memoizedState;if(_=k.element,R.isDehydrated)if(R={element:_,isDehydrated:!1,cache:k.cache,pendingSuspenseBoundaries:k.pendingSuspenseBoundaries,transitions:k.transitions},o.updateQueue.baseState=R,o.memoizedState=R,o.flags&256){b=zo(Error(n(423)),o),o=LS(s,o,_,d,b);break e}else if(_!==b){b=zo(Error(n(424)),o),o=LS(s,o,_,d,b);break e}else for(qr=Gs(o.stateNode.containerInfo.firstChild),Wr=o,vn=!0,Ti=null,d=W0(o,null,_,d),o.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Lo(),_===b){o=ps(s,o,d);break e}wr(s,o,_,d)}o=o.child}return o;case 5:return Y0(o),s===null&&vm(o),_=o.type,b=o.pendingProps,R=s!==null?s.memoizedProps:null,k=b.children,cm(_,b)?k=null:R!==null&&cm(_,R)&&(o.flags|=32),IS(s,o),wr(s,o,k,d),o.child;case 6:return s===null&&vm(o),null;case 13:return OS(s,o,d);case 4:return Mm(o,o.stateNode.containerInfo),_=o.pendingProps,s===null?o.child=Oo(o,null,_,d):wr(s,o,_,d),o.child;case 11:return _=o.type,b=o.pendingProps,b=o.elementType===_?b:Mi(_,b),RS(s,o,_,b,d);case 7:return wr(s,o,o.pendingProps,d),o.child;case 8:return wr(s,o,o.pendingProps.children,d),o.child;case 12:return wr(s,o,o.pendingProps.children,d),o.child;case 10:e:{if(_=o.type._context,b=o.pendingProps,R=o.memoizedProps,k=b.value,un(dd,_._currentValue),_._currentValue=k,R!==null)if(bi(R.value,k)){if(R.children===b.children&&!Lr.current){o=ps(s,o,d);break e}}else for(R=o.child,R!==null&&(R.return=o);R!==null;){var Y=R.dependencies;if(Y!==null){k=R.child;for(var te=Y.firstContext;te!==null;){if(te.context===_){if(R.tag===1){te=hs(-1,d&-d),te.tag=2;var me=R.updateQueue;if(me!==null){me=me.shared;var Pe=me.pending;Pe===null?te.next=te:(te.next=Pe.next,Pe.next=te),me.pending=te}}R.lanes|=d,te=R.alternate,te!==null&&(te.lanes|=d),Em(R.return,d,o),Y.lanes|=d;break}te=te.next}}else if(R.tag===10)k=R.type===o.type?null:R.child;else if(R.tag===18){if(k=R.return,k===null)throw Error(n(341));k.lanes|=d,Y=k.alternate,Y!==null&&(Y.lanes|=d),Em(k,d,o),k=R.sibling}else k=R.child;if(k!==null)k.return=R;else for(k=R;k!==null;){if(k===o){k=null;break}if(R=k.sibling,R!==null){R.return=k.return,k=R;break}k=k.return}R=k}wr(s,o,b.children,d),o=o.child}return o;case 9:return b=o.type,_=o.pendingProps.children,Uo(o,d),b=li(b),_=_(b),o.flags|=1,wr(s,o,_,d),o.child;case 14:return _=o.type,b=Mi(_,o.pendingProps),b=Mi(_.type,b),CS(s,o,_,b,d);case 15:return AS(s,o,o.type,o.pendingProps,d);case 17:return _=o.type,b=o.pendingProps,b=o.elementType===_?b:Mi(_,b),Ed(s,o),o.tag=1,Or(_)?(s=!0,sd(o)):s=!1,Uo(o,d),SS(o,_,b),zm(o,_,b,d),jm(null,o,_,!0,s,d);case 19:return US(s,o,d);case 22:return PS(s,o,d)}throw Error(n(156,o.tag))};function ow(s,o){return ge(s,o)}function tI(s,o,d,_){this.tag=s,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(s,o,d,_){return new tI(s,o,d,_)}function cg(s){return s=s.prototype,!(!s||!s.isReactComponent)}function nI(s){if(typeof s=="function")return cg(s)?1:0;if(s!=null){if(s=s.$$typeof,s===J)return 11;if(s===ie)return 14}return 2}function na(s,o){var d=s.alternate;return d===null?(d=di(s.tag,o,s.key,s.mode),d.elementType=s.elementType,d.type=s.type,d.stateNode=s.stateNode,d.alternate=s,s.alternate=d):(d.pendingProps=o,d.type=s.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=s.flags&14680064,d.childLanes=s.childLanes,d.lanes=s.lanes,d.child=s.child,d.memoizedProps=s.memoizedProps,d.memoizedState=s.memoizedState,d.updateQueue=s.updateQueue,o=s.dependencies,d.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},d.sibling=s.sibling,d.index=s.index,d.ref=s.ref,d}function Ld(s,o,d,_,b,R){var k=2;if(_=s,typeof s=="function")cg(s)&&(k=1);else if(typeof s=="string")k=5;else e:switch(s){case A:return za(d.children,b,R,o);case F:k=8,b|=8;break;case I:return s=di(12,d,o,b|2),s.elementType=I,s.lanes=R,s;case ae:return s=di(13,d,o,b),s.elementType=ae,s.lanes=R,s;case Z:return s=di(19,d,o,b),s.elementType=Z,s.lanes=R,s;case pe:return Od(d,b,R,o);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case O:k=10;break e;case W:k=9;break e;case J:k=11;break e;case ie:k=14;break e;case de:k=16,_=null;break e}throw Error(n(130,s==null?s:typeof s,""))}return o=di(k,d,o,b),o.elementType=s,o.type=_,o.lanes=R,o}function za(s,o,d,_){return s=di(7,s,_,o),s.lanes=d,s}function Od(s,o,d,_){return s=di(22,s,_,o),s.elementType=pe,s.lanes=d,s.stateNode={isHidden:!1},s}function ug(s,o,d){return s=di(6,s,null,o),s.lanes=d,s}function dg(s,o,d){return o=di(4,s.children!==null?s.children:[],s.key,o),o.lanes=d,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}function rI(s,o,d,_,b){this.tag=o,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wo(0),this.expirationTimes=wo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wo(0),this.identifierPrefix=_,this.onRecoverableError=b,this.mutableSourceEagerHydrationData=null}function fg(s,o,d,_,b,R,k,Y,te){return s=new rI(s,o,d,Y,te),o===1?(o=1,R===!0&&(o|=8)):o=0,R=di(3,null,null,o),s.current=R,R.stateNode=s,R.memoizedState={element:_,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Tm(R),s}function iI(s,o,d){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M,key:_==null?null:""+_,children:s,containerInfo:o,implementation:d}}function lw(s){if(!s)return qs;s=s._reactInternals;e:{if(as(s)!==s||s.tag!==1)throw Error(n(170));var o=s;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Or(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(n(171))}if(s.tag===1){var d=s.type;if(Or(d))return D0(s,d,o)}return o}function cw(s,o,d,_,b,R,k,Y,te){return s=fg(d,_,!0,s,b,R,k,Y,te),s.context=lw(null),d=s.current,_=xr(),b=ea(d),R=hs(_,b),R.callback=o??null,Ks(d,R,b),s.current.lanes=b,Kl(s,b,_),Fr(s,_),s}function Dd(s,o,d,_){var b=o.current,R=xr(),k=ea(b);return d=lw(d),o.context===null?o.context=d:o.pendingContext=d,o=hs(R,k),o.payload={element:s},_=_===void 0?null:_,_!==null&&(o.callback=_),s=Ks(b,o,k),s!==null&&(Ai(s,b,k,R),hd(s,b,k)),k}function Ud(s){return s=s.current,s.child?(s.child.tag===5,s.child.stateNode):null}function uw(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var d=s.retryLane;s.retryLane=d!==0&&d<o?d:o}}function hg(s,o){uw(s,o),(s=s.alternate)&&uw(s,o)}function sI(){return null}var dw=typeof reportError=="function"?reportError:function(s){console.error(s)};function pg(s){this._internalRoot=s}Fd.prototype.render=pg.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(n(409));Dd(s,o,null,null)},Fd.prototype.unmount=pg.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;Da(function(){Dd(null,s,null,null)}),o[ls]=null}};function Fd(s){this._internalRoot=s}Fd.prototype.unstable_scheduleHydration=function(s){if(s){var o=Zy();s={blockedOn:null,target:s,priority:o};for(var d=0;d<Vs.length&&o!==0&&o<Vs[d].priority;d++);Vs.splice(d,0,s),d===0&&Yy(s)}};function mg(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function zd(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function fw(){}function aI(s,o,d,_,b){if(b){if(typeof _=="function"){var R=_;_=function(){var me=Ud(k);R.call(me)}}var k=cw(o,_,s,0,null,!1,!1,"",fw);return s._reactRootContainer=k,s[ls]=k.current,uc(s.nodeType===8?s.parentNode:s),Da(),k}for(;b=s.lastChild;)s.removeChild(b);if(typeof _=="function"){var Y=_;_=function(){var me=Ud(te);Y.call(me)}}var te=fg(s,0,!1,null,null,!1,!1,"",fw);return s._reactRootContainer=te,s[ls]=te.current,uc(s.nodeType===8?s.parentNode:s),Da(function(){Dd(o,te,d,_)}),te}function $d(s,o,d,_,b){var R=d._reactRootContainer;if(R){var k=R;if(typeof b=="function"){var Y=b;b=function(){var te=Ud(k);Y.call(te)}}Dd(o,k,s,b)}else k=aI(d,o,s,b,_);return Ud(k)}Wy=function(s){switch(s.tag){case 3:var o=s.stateNode;if(o.current.memoizedState.isDehydrated){var d=Rn(o.pendingLanes);d!==0&&(zp(o,d|1),Fr(o,Ke()),(Vt&6)===0&&(Vo=Ke()+500,Zs()))}break;case 13:Da(function(){var _=fs(s,1);if(_!==null){var b=xr();Ai(_,s,1,b)}}),hg(s,1)}},$p=function(s){if(s.tag===13){var o=fs(s,134217728);if(o!==null){var d=xr();Ai(o,s,134217728,d)}hg(s,134217728)}},qy=function(s){if(s.tag===13){var o=ea(s),d=fs(s,o);if(d!==null){var _=xr();Ai(d,s,o,_)}hg(s,o)}},Zy=function(){return Qt},Xy=function(s,o){var d=Qt;try{return Qt=s,o()}finally{Qt=d}},Ue=function(s,o,d){switch(o){case"input":if(gt(s,d),o=d.name,d.type==="radio"&&o!=null){for(d=s;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<d.length;o++){var _=d[o];if(_!==s&&_.form===s.form){var b=rd(_);if(!b)throw Error(n(90));z(_),gt(_,b)}}}break;case"textarea":Ie(s,d);break;case"select":o=d.value,o!=null&&oe(s,!!d.multiple,o,!1)}},Yt=ag,Jt=Da;var oI={usingClientEntryPoint:!1,Events:[hc,Ao,rd,pt,ct,ag]},Rc={findFiberByHostInstance:Ca,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},lI={bundleType:Rc.bundleType,version:Rc.version,rendererPackageName:Rc.rendererPackageName,rendererConfig:Rc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=ye(s),s===null?null:s.stateNode},findFiberByHostInstance:Rc.findFiberByHostInstance||sI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bd.isDisabled&&Bd.supportsFiber)try{Nr=Bd.inject(lI),$t=Bd}catch{}}return zr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oI,zr.createPortal=function(s,o){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!mg(o))throw Error(n(200));return iI(s,o,null,d)},zr.createRoot=function(s,o){if(!mg(s))throw Error(n(299));var d=!1,_="",b=dw;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(_=o.identifierPrefix),o.onRecoverableError!==void 0&&(b=o.onRecoverableError)),o=fg(s,1,!1,null,null,d,!1,_,b),s[ls]=o.current,uc(s.nodeType===8?s.parentNode:s),new pg(o)},zr.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=ye(o),s=s===null?null:s.stateNode,s},zr.flushSync=function(s){return Da(s)},zr.hydrate=function(s,o,d){if(!zd(o))throw Error(n(200));return $d(null,s,o,!0,d)},zr.hydrateRoot=function(s,o,d){if(!mg(s))throw Error(n(405));var _=d!=null&&d.hydratedSources||null,b=!1,R="",k=dw;if(d!=null&&(d.unstable_strictMode===!0&&(b=!0),d.identifierPrefix!==void 0&&(R=d.identifierPrefix),d.onRecoverableError!==void 0&&(k=d.onRecoverableError)),o=cw(o,null,s,1,d??null,b,!1,R,k),s[ls]=o.current,uc(s),_)for(s=0;s<_.length;s++)d=_[s],b=d._getVersion,b=b(d._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[d,b]:o.mutableSourceEagerHydrationData.push(d,b);return new Fd(o)},zr.render=function(s,o,d){if(!zd(o))throw Error(n(200));return $d(null,s,o,!1,d)},zr.unmountComponentAtNode=function(s){if(!zd(s))throw Error(n(40));return s._reactRootContainer?(Da(function(){$d(null,null,s,!1,function(){s._reactRootContainer=null,s[ls]=null})}),!0):!1},zr.unstable_batchedUpdates=ag,zr.unstable_renderSubtreeIntoContainer=function(s,o,d,_){if(!zd(d))throw Error(n(200));if(s==null||s._reactInternals===void 0)throw Error(n(38));return $d(s,o,d,!1,_)},zr.version="18.3.1-next-f1338f8080-20240426",zr}var Sw;function gI(){if(Sw)return vg.exports;Sw=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),vg.exports=mI(),vg.exports}var ww;function _I(){if(ww)return Vd;ww=1;var t=gI();return Vd.createRoot=t.createRoot,Vd.hydrateRoot=t.hydrateRoot,Vd}var vI=_I();const yI=ip(vI);var xw="popstate";function SI(t={}){function e(r,i){let{pathname:a,search:l,hash:c}=r.location;return C_("",{pathname:a,search:l,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:su(i)}return xI(e,n,null,t)}function bn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function es(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function wI(){return Math.random().toString(36).substring(2,10)}function Ew(t,e){return{usr:t.state,key:t.key,idx:e}}function C_(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?zl(e):e,state:n,key:e&&e.key||r||wI()}}function su({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function zl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function xI(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,l=i.history,c="POP",u=null,f=h();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function h(){return(l.state||{idx:null}).idx}function p(){c="POP";let g=h(),v=g==null?null:g-f;f=g,u&&u({action:c,location:E.location,delta:v})}function m(g,v){c="PUSH";let x=C_(E.location,g,v);f=h()+1;let w=Ew(x,f),C=E.createHref(x);try{l.pushState(w,"",C)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;i.location.assign(C)}a&&u&&u({action:c,location:E.location,delta:1})}function y(g,v){c="REPLACE";let x=C_(E.location,g,v);f=h();let w=Ew(x,f),C=E.createHref(x);l.replaceState(w,"",C),a&&u&&u({action:c,location:E.location,delta:0})}function S(g){return EI(g)}let E={get action(){return c},get location(){return t(i,l)},listen(g){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(xw,p),u=g,()=>{i.removeEventListener(xw,p),u=null}},createHref(g){return e(i,g)},createURL:S,encodeLocation(g){let v=S(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:m,replace:y,go(g){return l.go(g)}};return E}function EI(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),bn(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:su(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function zT(t,e,n="/"){return bI(t,e,n,!1)}function bI(t,e,n,r){let i=typeof e=="string"?zl(e):e,a=Ns(i.pathname||"/",n);if(a==null)return null;let l=$T(t);TI(l);let c=null;for(let u=0;c==null&&u<l.length;++u){let f=DI(a);c=LI(l[u],f,r)}return c}function $T(t,e=[],n=[],r="",i=!1){let a=(l,c,u=i,f)=>{let h={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;bn(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=Ps([r,h.relativePath]),m=n.concat(h);l.children&&l.children.length>0&&(bn(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),$T(l.children,e,m,p,u)),!(l.path==null&&!l.index)&&e.push({path:p,score:NI(p,l.index),routesMeta:m})};return t.forEach((l,c)=>{if(l.path===""||!l.path?.includes("?"))a(l,c);else for(let u of BT(l.path))a(l,c,!0,u)}),e}function BT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let l=BT(r.join("/")),c=[];return c.push(...l.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...l),c.map(u=>t.startsWith("/")&&u===""?"/":u)}function TI(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:kI(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var MI=/^:[\w-]+$/,RI=3,CI=2,AI=1,PI=10,II=-2,bw=t=>t==="*";function NI(t,e){let n=t.split("/"),r=n.length;return n.some(bw)&&(r+=II),e&&(r+=CI),n.filter(i=>!bw(i)).reduce((i,a)=>i+(MI.test(a)?RI:a===""?AI:PI),r)}function kI(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function LI(t,e,n=!1){let{routesMeta:r}=t,i={},a="/",l=[];for(let c=0;c<r.length;++c){let u=r[c],f=c===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=Eh({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},h),m=u.route;if(!p&&f&&n&&!r[r.length-1].route.index&&(p=Eh({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),l.push({params:i,pathname:Ps([a,p.pathname]),pathnameBase:$I(Ps([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=Ps([a,p.pathnameBase]))}return l}function Eh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=OI(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let a=i[0],l=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:r.reduce((f,{paramName:h,isOptional:p},m)=>{if(h==="*"){let S=c[m]||"";l=a.slice(0,a.length-S.length).replace(/(.)\/+$/,"$1")}const y=c[m];return p&&!y?f[h]=void 0:f[h]=(y||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:l,pattern:t}}function OI(t,e=!1,n=!0){es(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function DI(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return es(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Ns(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var UI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function FI(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?zl(t):t,a;return n?(n=n.replace(/\/\/+/g,"/"),n.startsWith("/")?a=Tw(n.substring(1),"/"):a=Tw(n,e)):a=e,{pathname:a,search:BI(r),hash:VI(i)}}function Tw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function wg(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function zI(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function VT(t){let e=zI(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function jT(t,e,n,r=!1){let i;typeof t=="string"?i=zl(t):(i={...t},bn(!i.pathname||!i.pathname.includes("?"),wg("?","pathname","search",i)),bn(!i.pathname||!i.pathname.includes("#"),wg("#","pathname","hash",i)),bn(!i.search||!i.search.includes("#"),wg("#","search","hash",i)));let a=t===""||i.pathname==="",l=a?"/":i.pathname,c;if(l==null)c=n;else{let p=e.length-1;if(!r&&l.startsWith("..")){let m=l.split("/");for(;m[0]==="..";)m.shift(),p-=1;i.pathname=m.join("/")}c=p>=0?e[p]:"/"}let u=FI(i,c),f=l&&l!=="/"&&l.endsWith("/"),h=(a||l===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(f||h)&&(u.pathname+="/"),u}var Ps=t=>t.join("/").replace(/\/\/+/g,"/"),$I=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),BI=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,VI=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,jI=class{constructor(t,e,n,r=!1){this.status=t,this.statusText=e||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function HI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function GI(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var HT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function GT(t,e){let n=t;if(typeof n!="string"||!UI.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let r=n,i=!1;if(HT)try{let a=new URL(window.location.href),l=n.startsWith("//")?new URL(a.protocol+n):new URL(n),c=Ns(l.pathname,e);l.origin===a.origin&&c!=null?n=c+l.search+l.hash:i=!0}catch{es(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var WT=["POST","PUT","PATCH","DELETE"];new Set(WT);var WI=["GET",...WT];new Set(WI);var $l=V.createContext(null);$l.displayName="DataRouter";var sp=V.createContext(null);sp.displayName="DataRouterState";var qI=V.createContext(!1),qT=V.createContext({isTransitioning:!1});qT.displayName="ViewTransition";var ZI=V.createContext(new Map);ZI.displayName="Fetchers";var XI=V.createContext(null);XI.displayName="Await";var wi=V.createContext(null);wi.displayName="Navigation";var Su=V.createContext(null);Su.displayName="Location";var Ds=V.createContext({outlet:null,matches:[],isDataRoute:!1});Ds.displayName="Route";var Gv=V.createContext(null);Gv.displayName="RouteError";var ZT="REACT_ROUTER_ERROR",KI="REDIRECT",YI="ROUTE_ERROR_RESPONSE";function JI(t){if(t.startsWith(`${ZT}:${KI}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function QI(t){if(t.startsWith(`${ZT}:${YI}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new jI(e.status,e.statusText,e.data)}catch{}}function eN(t,{relative:e}={}){bn(wu(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=V.useContext(wi),{hash:i,pathname:a,search:l}=xu(t,{relative:e}),c=a;return n!=="/"&&(c=a==="/"?n:Ps([n,a])),r.createHref({pathname:c,search:l,hash:i})}function wu(){return V.useContext(Su)!=null}function go(){return bn(wu(),"useLocation() may be used only in the context of a <Router> component."),V.useContext(Su).location}var XT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function KT(t){V.useContext(wi).static||V.useLayoutEffect(t)}function Wv(){let{isDataRoute:t}=V.useContext(Ds);return t?hN():tN()}function tN(){bn(wu(),"useNavigate() may be used only in the context of a <Router> component.");let t=V.useContext($l),{basename:e,navigator:n}=V.useContext(wi),{matches:r}=V.useContext(Ds),{pathname:i}=go(),a=JSON.stringify(VT(r)),l=V.useRef(!1);return KT(()=>{l.current=!0}),V.useCallback((u,f={})=>{if(es(l.current,XT),!l.current)return;if(typeof u=="number"){n.go(u);return}let h=jT(u,JSON.parse(a),i,f.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ps([e,h.pathname])),(f.replace?n.replace:n.push)(h,f.state,f)},[e,n,a,i,t])}V.createContext(null);function xu(t,{relative:e}={}){let{matches:n}=V.useContext(Ds),{pathname:r}=go(),i=JSON.stringify(VT(n));return V.useMemo(()=>jT(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function nN(t,e){return YT(t,e)}function YT(t,e,n,r,i){bn(wu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=V.useContext(wi),{matches:l}=V.useContext(Ds),c=l[l.length-1],u=c?c.params:{},f=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let x=p&&p.path||"";QT(f,!p||x.endsWith("*")||x.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${x}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${x}"> to <Route path="${x==="/"?"*":`${x}/*`}">.`)}let m=go(),y;if(e){let x=typeof e=="string"?zl(e):e;bn(h==="/"||x.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${x.pathname}" was given in the \`location\` prop.`),y=x}else y=m;let S=y.pathname||"/",E=S;if(h!=="/"){let x=h.replace(/^\//,"").split("/");E="/"+S.replace(/^\//,"").split("/").slice(x.length).join("/")}let g=zT(t,{pathname:E});es(p||g!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),es(g==null||g[g.length-1].route.element!==void 0||g[g.length-1].route.Component!==void 0||g[g.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let v=oN(g&&g.map(x=>Object.assign({},x,{params:Object.assign({},u,x.params),pathname:Ps([h,a.encodeLocation?a.encodeLocation(x.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?h:Ps([h,a.encodeLocation?a.encodeLocation(x.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:x.pathnameBase])})),l,n,r,i);return e&&v?V.createElement(Su.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},v):v}function rN(){let t=fN(),e=HI(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",t),l=V.createElement(V.Fragment,null,V.createElement("p",null," Hey developer "),V.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",V.createElement("code",{style:a},"ErrorBoundary")," or"," ",V.createElement("code",{style:a},"errorElement")," prop on your route.")),V.createElement(V.Fragment,null,V.createElement("h2",null,"Unexpected Application Error!"),V.createElement("h3",{style:{fontStyle:"italic"}},e),n?V.createElement("pre",{style:i},n):null,l)}var iN=V.createElement(rN,null),JT=class extends V.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=QI(t.digest);n&&(t=n)}let e=t!==void 0?V.createElement(Ds.Provider,{value:this.props.routeContext},V.createElement(Gv.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?V.createElement(sN,{error:t},e):e}};JT.contextType=qI;var xg=new WeakMap;function sN({children:t,error:e}){let{basename:n}=V.useContext(wi);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=JI(e.digest);if(r){let i=xg.get(e);if(i)throw i;let a=GT(r.location,n);if(HT&&!xg.get(e))if(a.isExternal||r.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const l=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:r.replace}));throw xg.set(e,l),l}return V.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return t}function aN({routeContext:t,match:e,children:n}){let r=V.useContext($l);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),V.createElement(Ds.Provider,{value:t},n)}function oN(t,e=[],n=null,r=null,i=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,l=n?.errors;if(l!=null){let h=a.findIndex(p=>p.route.id&&l?.[p.route.id]!==void 0);bn(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(n)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:m,errors:y}=n,S=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!y||y[p.route.id]===void 0);if(p.route.lazy||S){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}let f=n&&r?(h,p)=>{r(h,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:GI(n.matches),errorInfo:p})}:void 0;return a.reduceRight((h,p,m)=>{let y,S=!1,E=null,g=null;n&&(y=l&&p.route.id?l[p.route.id]:void 0,E=p.route.errorElement||iN,c&&(u<0&&m===0?(QT("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),S=!0,g=null):u===m&&(S=!0,g=p.route.hydrateFallbackElement||null)));let v=e.concat(a.slice(0,m+1)),x=()=>{let w;return y?w=E:S?w=g:p.route.Component?w=V.createElement(p.route.Component,null):p.route.element?w=p.route.element:w=h,V.createElement(aN,{match:p,routeContext:{outlet:h,matches:v,isDataRoute:n!=null},children:w})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?V.createElement(JT,{location:n.location,revalidation:n.revalidation,component:E,error:y,children:x(),routeContext:{outlet:null,matches:v,isDataRoute:!0},onError:f}):x()},null)}function qv(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lN(t){let e=V.useContext($l);return bn(e,qv(t)),e}function cN(t){let e=V.useContext(sp);return bn(e,qv(t)),e}function uN(t){let e=V.useContext(Ds);return bn(e,qv(t)),e}function Zv(t){let e=uN(t),n=e.matches[e.matches.length-1];return bn(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function dN(){return Zv("useRouteId")}function fN(){let t=V.useContext(Gv),e=cN("useRouteError"),n=Zv("useRouteError");return t!==void 0?t:e.errors?.[n]}function hN(){let{router:t}=lN("useNavigate"),e=Zv("useNavigate"),n=V.useRef(!1);return KT(()=>{n.current=!0}),V.useCallback(async(i,a={})=>{es(n.current,XT),n.current&&(typeof i=="number"?await t.navigate(i):await t.navigate(i,{fromRouteId:e,...a}))},[t,e])}var Mw={};function QT(t,e,n){!e&&!Mw[t]&&(Mw[t]=!0,es(!1,n))}V.memo(pN);function pN({routes:t,future:e,state:n,onError:r}){return YT(t,void 0,n,r,e)}function A_(t){bn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function mN({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:a=!1,unstable_useTransitions:l}){bn(!wu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),u=V.useMemo(()=>({basename:c,navigator:i,static:a,unstable_useTransitions:l,future:{}}),[c,i,a,l]);typeof n=="string"&&(n=zl(n));let{pathname:f="/",search:h="",hash:p="",state:m=null,key:y="default"}=n,S=V.useMemo(()=>{let E=Ns(f,c);return E==null?null:{location:{pathname:E,search:h,hash:p,state:m,key:y},navigationType:r}},[c,f,h,p,m,y,r]);return es(S!=null,`<Router basename="${c}"> is not able to match the URL "${f}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:V.createElement(wi.Provider,{value:u},V.createElement(Su.Provider,{children:e,value:S}))}function gN({children:t,location:e}){return nN(P_(t),e)}function P_(t,e=[]){let n=[];return V.Children.forEach(t,(r,i)=>{if(!V.isValidElement(r))return;let a=[...e,i];if(r.type===V.Fragment){n.push.apply(n,P_(r.props.children,a));return}bn(r.type===A_,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),bn(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=P_(r.props.children,a)),n.push(l)}),n}var dh="get",fh="application/x-www-form-urlencoded";function ap(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function _N(t){return ap(t)&&t.tagName.toLowerCase()==="button"}function vN(t){return ap(t)&&t.tagName.toLowerCase()==="form"}function yN(t){return ap(t)&&t.tagName.toLowerCase()==="input"}function SN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function wN(t,e){return t.button===0&&(!e||e==="_self")&&!SN(t)}var jd=null;function xN(){if(jd===null)try{new FormData(document.createElement("form"),0),jd=!1}catch{jd=!0}return jd}var EN=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Eg(t){return t!=null&&!EN.has(t)?(es(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${fh}"`),null):t}function bN(t,e){let n,r,i,a,l;if(vN(t)){let c=t.getAttribute("action");r=c?Ns(c,e):null,n=t.getAttribute("method")||dh,i=Eg(t.getAttribute("enctype"))||fh,a=new FormData(t)}else if(_N(t)||yN(t)&&(t.type==="submit"||t.type==="image")){let c=t.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||c.getAttribute("action");if(r=u?Ns(u,e):null,n=t.getAttribute("formmethod")||c.getAttribute("method")||dh,i=Eg(t.getAttribute("formenctype"))||Eg(c.getAttribute("enctype"))||fh,a=new FormData(c,t),!xN()){let{name:f,type:h,value:p}=t;if(h==="image"){let m=f?`${f}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else f&&a.append(f,p)}}else{if(ap(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=dh,r=null,i=fh,l=t}return a&&i==="text/plain"&&(l=a,a=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:a,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Xv(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function TN(t,e,n,r){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${r}`:i.pathname=`${i.pathname}.${r}`:i.pathname==="/"?i.pathname=`_root.${r}`:e&&Ns(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function MN(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function RN(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function CN(t,e,n){let r=await Promise.all(t.map(async i=>{let a=e.routes[i.route.id];if(a){let l=await MN(a,n);return l.links?l.links():[]}return[]}));return NN(r.flat(1).filter(RN).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function Rw(t,e,n,r,i,a){let l=(u,f)=>n[f]?u.route.id!==n[f].route.id:!0,c=(u,f)=>n[f].pathname!==u.pathname||n[f].route.path?.endsWith("*")&&n[f].params["*"]!==u.params["*"];return a==="assets"?e.filter((u,f)=>l(u,f)||c(u,f)):a==="data"?e.filter((u,f)=>{let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(l(u,f)||c(u,f))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function AN(t,e,{includeHydrateFallback:n}={}){return PN(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function PN(t){return[...new Set(t)]}function IN(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function NN(t,e){let n=new Set;return new Set(e),t.reduce((r,i)=>{let a=JSON.stringify(IN(i));return n.has(a)||(n.add(a),r.push({key:a,link:i})),r},[])}function eM(){let t=V.useContext($l);return Xv(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function kN(){let t=V.useContext(sp);return Xv(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Kv=V.createContext(void 0);Kv.displayName="FrameworkContext";function tM(){let t=V.useContext(Kv);return Xv(t,"You must render this element inside a <HydratedRouter> element"),t}function LN(t,e){let n=V.useContext(Kv),[r,i]=V.useState(!1),[a,l]=V.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:f,onMouseLeave:h,onTouchStart:p}=e,m=V.useRef(null);V.useEffect(()=>{if(t==="render"&&l(!0),t==="viewport"){let E=v=>{v.forEach(x=>{l(x.isIntersecting)})},g=new IntersectionObserver(E,{threshold:.5});return m.current&&g.observe(m.current),()=>{g.disconnect()}}},[t]),V.useEffect(()=>{if(r){let E=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(E)}}},[r]);let y=()=>{i(!0)},S=()=>{i(!1),l(!1)};return n?t!=="intent"?[a,m,{}]:[a,m,{onFocus:Ac(c,y),onBlur:Ac(u,S),onMouseEnter:Ac(f,y),onMouseLeave:Ac(h,S),onTouchStart:Ac(p,y)}]:[!1,m,{}]}function Ac(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function ON({page:t,...e}){let{router:n}=eM(),r=V.useMemo(()=>zT(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?V.createElement(UN,{page:t,matches:r,...e}):null}function DN(t){let{manifest:e,routeModules:n}=tM(),[r,i]=V.useState([]);return V.useEffect(()=>{let a=!1;return CN(t,e,n).then(l=>{a||i(l)}),()=>{a=!0}},[t,e,n]),r}function UN({page:t,matches:e,...n}){let r=go(),{future:i,manifest:a,routeModules:l}=tM(),{basename:c}=eM(),{loaderData:u,matches:f}=kN(),h=V.useMemo(()=>Rw(t,e,f,a,r,"data"),[t,e,f,a,r]),p=V.useMemo(()=>Rw(t,e,f,a,r,"assets"),[t,e,f,a,r]),m=V.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let E=new Set,g=!1;if(e.forEach(x=>{let w=a.routes[x.route.id];!w||!w.hasLoader||(!h.some(C=>C.route.id===x.route.id)&&x.route.id in u&&l[x.route.id]?.shouldRevalidate||w.hasClientLoader?g=!0:E.add(x.route.id))}),E.size===0)return[];let v=TN(t,c,i.unstable_trailingSlashAwareDataRequests,"data");return g&&E.size>0&&v.searchParams.set("_routes",e.filter(x=>E.has(x.route.id)).map(x=>x.route.id).join(",")),[v.pathname+v.search]},[c,i.unstable_trailingSlashAwareDataRequests,u,r,a,h,e,t,l]),y=V.useMemo(()=>AN(p,a),[p,a]),S=DN(p);return V.createElement(V.Fragment,null,m.map(E=>V.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...n})),y.map(E=>V.createElement("link",{key:E,rel:"modulepreload",href:E,...n})),S.map(({key:E,link:g})=>V.createElement("link",{key:E,nonce:n.nonce,...g,crossOrigin:g.crossOrigin??n.crossOrigin})))}function FN(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var zN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{zN&&(window.__reactRouterVersion="7.13.0")}catch{}function $N({basename:t,children:e,unstable_useTransitions:n,window:r}){let i=V.useRef();i.current==null&&(i.current=SI({window:r,v5Compat:!0}));let a=i.current,[l,c]=V.useState({action:a.action,location:a.location}),u=V.useCallback(f=>{n===!1?c(f):V.startTransition(()=>c(f))},[n]);return V.useLayoutEffect(()=>a.listen(u),[a,u]),V.createElement(mN,{basename:t,children:e,location:l.location,navigationType:l.action,navigator:a,unstable_useTransitions:n})}var nM=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,rM=V.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:a,replace:l,state:c,target:u,to:f,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...y},S){let{basename:E,unstable_useTransitions:g}=V.useContext(wi),v=typeof f=="string"&&nM.test(f),x=GT(f,E);f=x.to;let w=eN(f,{relative:i}),[C,T,M]=LN(r,y),A=HN(f,{replace:l,state:c,target:u,preventScrollReset:h,relative:i,viewTransition:p,unstable_defaultShouldRevalidate:m,unstable_useTransitions:g});function F(O){e&&e(O),O.defaultPrevented||A(O)}let I=V.createElement("a",{...y,...M,href:x.absoluteURL||w,onClick:x.isExternal||a?e:F,ref:FN(S,T),target:u,"data-discover":!v&&n==="render"?"true":void 0});return C&&!v?V.createElement(V.Fragment,null,I,V.createElement(ON,{page:w})):I});rM.displayName="Link";var BN=V.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:a,to:l,viewTransition:c,children:u,...f},h){let p=xu(l,{relative:f.relative}),m=go(),y=V.useContext(sp),{navigator:S,basename:E}=V.useContext(wi),g=y!=null&&XN(p)&&c===!0,v=S.encodeLocation?S.encodeLocation(p).pathname:p.pathname,x=m.pathname,w=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;n||(x=x.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&E&&(w=Ns(w,E)||w);const C=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let T=x===v||!i&&x.startsWith(v)&&x.charAt(C)==="/",M=w!=null&&(w===v||!i&&w.startsWith(v)&&w.charAt(v.length)==="/"),A={isActive:T,isPending:M,isTransitioning:g},F=T?e:void 0,I;typeof r=="function"?I=r(A):I=[r,T?"active":null,M?"pending":null,g?"transitioning":null].filter(Boolean).join(" ");let O=typeof a=="function"?a(A):a;return V.createElement(rM,{...f,"aria-current":F,className:I,ref:h,style:O,to:l,viewTransition:c},typeof u=="function"?u(A):u)});BN.displayName="NavLink";var VN=V.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:a,method:l=dh,action:c,onSubmit:u,relative:f,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m,...y},S)=>{let{unstable_useTransitions:E}=V.useContext(wi),g=qN(),v=ZN(c,{relative:f}),x=l.toLowerCase()==="get"?"get":"post",w=typeof c=="string"&&nM.test(c),C=T=>{if(u&&u(T),T.defaultPrevented)return;T.preventDefault();let M=T.nativeEvent.submitter,A=M?.getAttribute("formmethod")||l,F=()=>g(M||T.currentTarget,{fetcherKey:e,method:A,navigate:n,replace:i,state:a,relative:f,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:m});E&&n!==!1?V.startTransition(()=>F()):F()};return V.createElement("form",{ref:S,method:x,action:v,onSubmit:r?u:C,...y,"data-discover":!w&&t==="render"?"true":void 0})});VN.displayName="Form";function jN(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function iM(t){let e=V.useContext($l);return bn(e,jN(t)),e}function HN(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:a,viewTransition:l,unstable_defaultShouldRevalidate:c,unstable_useTransitions:u}={}){let f=Wv(),h=go(),p=xu(t,{relative:a});return V.useCallback(m=>{if(wN(m,e)){m.preventDefault();let y=n!==void 0?n:su(h)===su(p),S=()=>f(t,{replace:y,state:r,preventScrollReset:i,relative:a,viewTransition:l,unstable_defaultShouldRevalidate:c});u?V.startTransition(()=>S()):S()}},[h,f,p,n,r,e,t,i,a,l,c,u])}var GN=0,WN=()=>`__${String(++GN)}__`;function qN(){let{router:t}=iM("useSubmit"),{basename:e}=V.useContext(wi),n=dN(),r=t.fetch,i=t.navigate;return V.useCallback(async(a,l={})=>{let{action:c,method:u,encType:f,formData:h,body:p}=bN(a,e);if(l.navigate===!1){let m=l.fetcherKey||WN();await r(m,n,l.action||c,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:h,body:p,formMethod:l.method||u,formEncType:l.encType||f,flushSync:l.flushSync})}else await i(l.action||c,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:h,body:p,formMethod:l.method||u,formEncType:l.encType||f,replace:l.replace,state:l.state,fromRouteId:n,flushSync:l.flushSync,viewTransition:l.viewTransition})},[r,i,e,n])}function ZN(t,{relative:e}={}){let{basename:n}=V.useContext(wi),r=V.useContext(Ds);bn(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...xu(t||".",{relative:e})},l=go();if(t==null){a.search=l.search;let c=new URLSearchParams(a.search),u=c.getAll("index");if(u.some(h=>h==="")){c.delete("index"),u.filter(p=>p).forEach(p=>c.append("index",p));let h=c.toString();a.search=h?`?${h}`:""}}return(!t||t===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:Ps([n,a.pathname])),su(a)}function XN(t,{relative:e}={}){let n=V.useContext(qT);bn(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=iM("useViewTransitionState"),i=xu(t,{relative:e});if(!n.isTransitioning)return!1;let a=Ns(n.currentLocation.pathname,r)||n.currentLocation.pathname,l=Ns(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Eh(i.pathname,l)!=null||Eh(i.pathname,a)!=null}const{getOwnPropertyNames:KN,getOwnPropertySymbols:YN}=Object,{hasOwnProperty:JN}=Object.prototype;function bg(t,e){return function(r,i,a){return t(r,i,a)&&e(r,i,a)}}function Hd(t){return function(n,r,i){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,i);const{cache:a}=i,l=a.get(n),c=a.get(r);if(l&&c)return l===r&&c===n;a.set(n,r),a.set(r,n);const u=t(n,r,i);return a.delete(n),a.delete(r),u}}function QN(t){return t?.[Symbol.toStringTag]}function Cw(t){return KN(t).concat(YN(t))}const ek=Object.hasOwn||((t,e)=>JN.call(t,e));function _o(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const tk="__v",nk="__o",rk="_owner",{getOwnPropertyDescriptor:Aw,keys:Pw}=Object;function ik(t,e){return t.byteLength===e.byteLength&&bh(new Uint8Array(t),new Uint8Array(e))}function sk(t,e,n){let r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function ak(t,e){return t.byteLength===e.byteLength&&bh(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function ok(t,e){return _o(t.getTime(),e.getTime())}function lk(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function ck(t,e){return t===e}function Iw(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const i=new Array(r),a=t.entries();let l,c,u=0;for(;(l=a.next())&&!l.done;){const f=e.entries();let h=!1,p=0;for(;(c=f.next())&&!c.done;){if(i[p]){p++;continue}const m=l.value,y=c.value;if(n.equals(m[0],y[0],u,p,t,e,n)&&n.equals(m[1],y[1],m[0],y[0],t,e,n)){h=i[p]=!0;break}p++}if(!h)return!1;u++}return!0}const uk=_o;function dk(t,e,n){const r=Pw(t);let i=r.length;if(Pw(e).length!==i)return!1;for(;i-- >0;)if(!sM(t,e,n,r[i]))return!1;return!0}function Pc(t,e,n){const r=Cw(t);let i=r.length;if(Cw(e).length!==i)return!1;let a,l,c;for(;i-- >0;)if(a=r[i],!sM(t,e,n,a)||(l=Aw(t,a),c=Aw(e,a),(l||c)&&(!l||!c||l.configurable!==c.configurable||l.enumerable!==c.enumerable||l.writable!==c.writable)))return!1;return!0}function fk(t,e){return _o(t.valueOf(),e.valueOf())}function hk(t,e){return t.source===e.source&&t.flags===e.flags}function Nw(t,e,n){const r=t.size;if(r!==e.size)return!1;if(!r)return!0;const i=new Array(r),a=t.values();let l,c;for(;(l=a.next())&&!l.done;){const u=e.values();let f=!1,h=0;for(;(c=u.next())&&!c.done;){if(!i[h]&&n.equals(l.value,c.value,l.value,c.value,t,e,n)){f=i[h]=!0;break}h++}if(!f)return!1}return!0}function bh(t,e){let n=t.byteLength;if(e.byteLength!==n||t.byteOffset!==e.byteOffset)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function pk(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function sM(t,e,n,r){return(r===rk||r===nk||r===tk)&&(t.$$typeof||e.$$typeof)?!0:ek(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}const mk="[object ArrayBuffer]",gk="[object Arguments]",_k="[object Boolean]",vk="[object DataView]",yk="[object Date]",Sk="[object Error]",wk="[object Map]",xk="[object Number]",Ek="[object Object]",bk="[object RegExp]",Tk="[object Set]",Mk="[object String]",Rk={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},Ck="[object URL]",Ak=Object.prototype.toString;function Pk({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:n,areDatesEqual:r,areErrorsEqual:i,areFunctionsEqual:a,areMapsEqual:l,areNumbersEqual:c,areObjectsEqual:u,arePrimitiveWrappersEqual:f,areRegExpsEqual:h,areSetsEqual:p,areTypedArraysEqual:m,areUrlsEqual:y,unknownTagComparators:S}){return function(g,v,x){if(g===v)return!0;if(g==null||v==null)return!1;const w=typeof g;if(w!==typeof v)return!1;if(w!=="object")return w==="number"?c(g,v,x):w==="function"?a(g,v,x):!1;const C=g.constructor;if(C!==v.constructor)return!1;if(C===Object)return u(g,v,x);if(Array.isArray(g))return e(g,v,x);if(C===Date)return r(g,v,x);if(C===RegExp)return h(g,v,x);if(C===Map)return l(g,v,x);if(C===Set)return p(g,v,x);const T=Ak.call(g);if(T===yk)return r(g,v,x);if(T===bk)return h(g,v,x);if(T===wk)return l(g,v,x);if(T===Tk)return p(g,v,x);if(T===Ek)return typeof g.then!="function"&&typeof v.then!="function"&&u(g,v,x);if(T===Ck)return y(g,v,x);if(T===Sk)return i(g,v,x);if(T===gk)return u(g,v,x);if(Rk[T])return m(g,v,x);if(T===mk)return t(g,v,x);if(T===vk)return n(g,v,x);if(T===_k||T===xk||T===Mk)return f(g,v,x);if(S){let M=S[T];if(!M){const A=QN(g);A&&(M=S[A])}if(M)return M(g,v,x)}return!1}}function Ik({circular:t,createCustomConfig:e,strict:n}){let r={areArrayBuffersEqual:ik,areArraysEqual:n?Pc:sk,areDataViewsEqual:ak,areDatesEqual:ok,areErrorsEqual:lk,areFunctionsEqual:ck,areMapsEqual:n?bg(Iw,Pc):Iw,areNumbersEqual:uk,areObjectsEqual:n?Pc:dk,arePrimitiveWrappersEqual:fk,areRegExpsEqual:hk,areSetsEqual:n?bg(Nw,Pc):Nw,areTypedArraysEqual:n?bg(bh,Pc):bh,areUrlsEqual:pk,unknownTagComparators:void 0};if(e&&(r=Object.assign({},r,e(r))),t){const i=Hd(r.areArraysEqual),a=Hd(r.areMapsEqual),l=Hd(r.areObjectsEqual),c=Hd(r.areSetsEqual);r=Object.assign({},r,{areArraysEqual:i,areMapsEqual:a,areObjectsEqual:l,areSetsEqual:c})}return r}function Nk(t){return function(e,n,r,i,a,l,c){return t(e,n,c)}}function kk({circular:t,comparator:e,createState:n,equals:r,strict:i}){if(n)return function(c,u){const{cache:f=t?new WeakMap:void 0,meta:h}=n();return e(c,u,{cache:f,equals:r,meta:h,strict:i})};if(t)return function(c,u){return e(c,u,{cache:new WeakMap,equals:r,meta:void 0,strict:i})};const a={cache:void 0,equals:r,meta:void 0,strict:i};return function(c,u){return e(c,u,a)}}const Lk=xa();xa({strict:!0});xa({circular:!0});xa({circular:!0,strict:!0});xa({createInternalComparator:()=>_o});xa({strict:!0,createInternalComparator:()=>_o});xa({circular:!0,createInternalComparator:()=>_o});xa({circular:!0,createInternalComparator:()=>_o,strict:!0});function xa(t={}){const{circular:e=!1,createInternalComparator:n,createState:r,strict:i=!1}=t,a=Ik(t),l=Pk(a),c=n?n(l):Nk(l);return kk({circular:e,comparator:l,createState:r,equals:c,strict:i})}var jt;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function n(i){throw new Error}t.assertNever=n,t.arrayToEnum=i=>{const a={};for(const l of i)a[l]=l;return a},t.getValidEnumValues=i=>{const a=t.objectKeys(i).filter(c=>typeof i[i[c]]!="number"),l={};for(const c of a)l[c]=i[c];return t.objectValues(l)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const a=[];for(const l in i)Object.prototype.hasOwnProperty.call(i,l)&&a.push(l);return a},t.find=(i,a)=>{for(const l of i)if(a(l))return l},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function r(i,a=" | "){return i.map(l=>typeof l=="string"?`'${l}'`:l).join(a)}t.joinValues=r,t.jsonStringifyReplacer=(i,a)=>typeof a=="bigint"?a.toString():a})(jt||(jt={}));var kw;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(kw||(kw={}));const Xe=jt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ua=t=>{switch(typeof t){case"undefined":return Xe.undefined;case"string":return Xe.string;case"number":return Number.isNaN(t)?Xe.nan:Xe.number;case"boolean":return Xe.boolean;case"function":return Xe.function;case"bigint":return Xe.bigint;case"symbol":return Xe.symbol;case"object":return Array.isArray(t)?Xe.array:t===null?Xe.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Xe.promise:typeof Map<"u"&&t instanceof Map?Xe.map:typeof Set<"u"&&t instanceof Set?Xe.set:typeof Date<"u"&&t instanceof Date?Xe.date:Xe.object;default:return Xe.unknown}},Le=jt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class yi extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(a){return a.message},r={_errors:[]},i=a=>{for(const l of a.issues)if(l.code==="invalid_union")l.unionErrors.map(i);else if(l.code==="invalid_return_type")i(l.returnTypeError);else if(l.code==="invalid_arguments")i(l.argumentsError);else if(l.path.length===0)r._errors.push(n(l));else{let c=r,u=0;for(;u<l.path.length;){const f=l.path[u];u===l.path.length-1?(c[f]=c[f]||{_errors:[]},c[f]._errors.push(n(l))):c[f]=c[f]||{_errors:[]},c=c[f],u++}}};return i(this),r}static assert(e){if(!(e instanceof yi))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,jt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const i of this.issues)if(i.path.length>0){const a=i.path[0];n[a]=n[a]||[],n[a].push(e(i))}else r.push(e(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}yi.create=t=>new yi(t);const au=(t,e)=>{let n;switch(t.code){case Le.invalid_type:t.received===Xe.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case Le.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,jt.jsonStringifyReplacer)}`;break;case Le.unrecognized_keys:n=`Unrecognized key(s) in object: ${jt.joinValues(t.keys,", ")}`;break;case Le.invalid_union:n="Invalid input";break;case Le.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${jt.joinValues(t.options)}`;break;case Le.invalid_enum_value:n=`Invalid enum value. Expected ${jt.joinValues(t.options)}, received '${t.received}'`;break;case Le.invalid_arguments:n="Invalid function arguments";break;case Le.invalid_return_type:n="Invalid function return type";break;case Le.invalid_date:n="Invalid date";break;case Le.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:jt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case Le.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case Le.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case Le.custom:n="Invalid input";break;case Le.invalid_intersection_types:n="Intersection results could not be merged";break;case Le.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case Le.not_finite:n="Number must be finite";break;default:n=e.defaultError,jt.assertNever(t)}return{message:n}};let Ok=au;function I_(){return Ok}const N_=t=>{const{data:e,path:n,errorMaps:r,issueData:i}=t,a=[...n,...i.path||[]],l={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let c="";const u=r.filter(f=>!!f).slice().reverse();for(const f of u)c=f(l,{data:e,defaultError:c}).message;return{...i,path:a,message:c}};function He(t,e){const n=I_(),r=N_({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===au?void 0:au].filter(i=>!!i)});t.common.issues.push(r)}class Pr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const i of n){if(i.status==="aborted")return mt;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const i of n){const a=await i.key,l=await i.value;r.push({key:a,value:l})}return Pr.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const i of n){const{key:a,value:l}=i;if(a.status==="aborted"||l.status==="aborted")return mt;a.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof l.value<"u"||i.alwaysSet)&&(r[a.value]=l.value)}return{status:e.value,value:r}}}const mt=Object.freeze({status:"aborted"}),$c=t=>({status:"dirty",value:t}),jr=t=>({status:"valid",value:t}),Lw=t=>t.status==="aborted",Ow=t=>t.status==="dirty",Cl=t=>t.status==="valid",Th=t=>typeof Promise<"u"&&t instanceof Promise;var rt;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(rt||(rt={}));class ts{constructor(e,n,r,i){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Dw=(t,e)=>{if(Cl(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new yi(t.common.issues);return this._error=n,this._error}}};function Tt(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:i}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(l,c)=>{const{message:u}=t;return l.code==="invalid_enum_value"?{message:u??c.defaultError}:typeof c.data>"u"?{message:u??r??c.defaultError}:l.code!=="invalid_type"?{message:c.defaultError}:{message:u??n??c.defaultError}},description:i}}let Ft=class{get description(){return this._def.description}_getType(e){return ua(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:ua(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Pr,ctx:{common:e.parent.common,data:e.data,parsedType:ua(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Th(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:n?.async??!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ua(e)},i=this._parseSync({data:e,path:r.path,parent:r});return Dw(r,i)}"~validate"(e){const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ua(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:n});return Cl(r)?{value:r.value}:{issues:n.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(r=>Cl(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ua(e)},i=this._parse({data:e,path:r.path,parent:r}),a=await(Th(i)?i:Promise.resolve(i));return Dw(r,a)}refine(e,n){const r=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,a)=>{const l=e(i),c=()=>a.addIssue({code:Le.custom,...r(i)});return typeof Promise<"u"&&l instanceof Promise?l.then(u=>u?!0:(c(),!1)):l?!0:(c(),!1)})}refinement(e,n){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof n=="function"?n(r,i):n),!1))}_refinement(e){return new co({schema:this,typeName:Oe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Is.create(this,this._def)}nullable(){return uo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Al.create(this)}promise(){return cu.create(this,this._def)}or(e){return Ch.create([this,e],this._def)}and(e){return Ah.create(this,e,this._def)}transform(e){return new co({...Tt(this._def),schema:this,typeName:Oe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Ih({...Tt(this._def),innerType:this,defaultValue:n,typeName:Oe.ZodDefault})}brand(){return new uM({typeName:Oe.ZodBranded,type:this,...Tt(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Nh({...Tt(this._def),innerType:this,catchValue:n,typeName:Oe.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Yv.create(this,e)}readonly(){return kh.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}};const Dk=/^c[^\s-]{8,}$/i,Uk=/^[0-9a-z]+$/,Fk=/^[0-9A-HJKMNP-TV-Z]{26}$/i,zk=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,$k=/^[a-z0-9_-]{21}$/i,Bk=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Vk=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,jk=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Hk="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Tg;const Gk=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Wk=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,qk=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Zk=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Xk=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Kk=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,aM="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Yk=new RegExp(`^${aM}$`);function oM(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function Jk(t){return new RegExp(`^${oM(t)}$`)}function Qk(t){let e=`${aM}T${oM(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function eL(t,e){return!!((e==="v4"||!e)&&Gk.test(t)||(e==="v6"||!e)&&qk.test(t))}function tL(t,e){if(!Bk.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||"typ"in i&&i?.typ!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function nL(t,e){return!!((e==="v4"||!e)&&Wk.test(t)||(e==="v6"||!e)&&Zk.test(t))}let Mh=class Bc extends Ft{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Xe.string){const a=this._getOrReturnCtx(e);return He(a,{code:Le.invalid_type,expected:Xe.string,received:a.parsedType}),mt}const r=new Pr;let i;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),He(i,{code:Le.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),He(i,{code:Le.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const l=e.data.length>a.value,c=e.data.length<a.value;(l||c)&&(i=this._getOrReturnCtx(e,i),l?He(i,{code:Le.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):c&&He(i,{code:Le.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")jk.test(e.data)||(i=this._getOrReturnCtx(e,i),He(i,{validation:"email",code:Le.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")Tg||(Tg=new RegExp(Hk,"u")),Tg.test(e.data)||(i=this._getOrReturnCtx(e,i),He(i,{validation:"emoji",code:Le.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")zk.test(e.data)||(i=this._getOrReturnCtx(e,i),He(i,{validation:"uuid",code:Le.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")$k.test(e.data)||(i=this._getOrReturnCtx(e,i),He(i,{validation:"nanoid",code:Le.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")Dk.test(e.data)||(i=this._getOrReturnCtx(e,i),He(i,{validation:"cuid",code:Le.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")Uk.test(e.data)||(i=this._getOrReturnCtx(e,i),He(i,{validation:"cuid2",code:Le.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")Fk.test(e.data)||(i=this._getOrReturnCtx(e,i),He(i,{validation:"ulid",code:Le.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),He(i,{validation:"url",code:Le.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),He(i,{validation:"regex",code:Le.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),He(i,{code:Le.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),He(i,{code:Le.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),He(i,{code:Le.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?Qk(a).test(e.data)||(i=this._getOrReturnCtx(e,i),He(i,{code:Le.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?Yk.test(e.data)||(i=this._getOrReturnCtx(e,i),He(i,{code:Le.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?Jk(a).test(e.data)||(i=this._getOrReturnCtx(e,i),He(i,{code:Le.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?Vk.test(e.data)||(i=this._getOrReturnCtx(e,i),He(i,{validation:"duration",code:Le.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?eL(e.data,a.version)||(i=this._getOrReturnCtx(e,i),He(i,{validation:"ip",code:Le.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?tL(e.data,a.alg)||(i=this._getOrReturnCtx(e,i),He(i,{validation:"jwt",code:Le.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?nL(e.data,a.version)||(i=this._getOrReturnCtx(e,i),He(i,{validation:"cidr",code:Le.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?Xk.test(e.data)||(i=this._getOrReturnCtx(e,i),He(i,{validation:"base64",code:Le.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?Kk.test(e.data)||(i=this._getOrReturnCtx(e,i),He(i,{validation:"base64url",code:Le.invalid_string,message:a.message}),r.dirty()):jt.assertNever(a);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(i=>e.test(i),{validation:n,code:Le.invalid_string,...rt.errToObj(r)})}_addCheck(e){return new Bc({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...rt.errToObj(e)})}url(e){return this._addCheck({kind:"url",...rt.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...rt.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...rt.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...rt.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...rt.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...rt.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...rt.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...rt.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...rt.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...rt.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...rt.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...rt.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...rt.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...rt.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...rt.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...rt.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n?.position,...rt.errToObj(n?.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...rt.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...rt.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...rt.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...rt.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...rt.errToObj(n)})}nonempty(e){return this.min(1,rt.errToObj(e))}trim(){return new Bc({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Bc({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Bc({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}};Mh.create=t=>new Mh({checks:[],typeName:Oe.ZodString,coerce:t?.coerce??!1,...Tt(t)});function rL(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=n>r?n:r,a=Number.parseInt(t.toFixed(i).replace(".","")),l=Number.parseInt(e.toFixed(i).replace(".",""));return a%l/10**i}let k_=class L_ extends Ft{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Xe.number){const a=this._getOrReturnCtx(e);return He(a,{code:Le.invalid_type,expected:Xe.number,received:a.parsedType}),mt}let r;const i=new Pr;for(const a of this._def.checks)a.kind==="int"?jt.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),He(r,{code:Le.invalid_type,expected:"integer",received:"float",message:a.message}),i.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),He(r,{code:Le.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),He(r,{code:Le.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="multipleOf"?rL(e.data,a.value)!==0&&(r=this._getOrReturnCtx(e,r),He(r,{code:Le.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),He(r,{code:Le.not_finite,message:a.message}),i.dirty()):jt.assertNever(a);return{status:i.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,rt.toString(n))}gt(e,n){return this.setLimit("min",e,!1,rt.toString(n))}lte(e,n){return this.setLimit("max",e,!0,rt.toString(n))}lt(e,n){return this.setLimit("max",e,!1,rt.toString(n))}setLimit(e,n,r,i){return new L_({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:rt.toString(i)}]})}_addCheck(e){return new L_({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:rt.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:rt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:rt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:rt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:rt.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:rt.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:rt.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:rt.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:rt.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&jt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}};k_.create=t=>new k_({checks:[],typeName:Oe.ZodNumber,coerce:t?.coerce||!1,...Tt(t)});class ou extends Ft{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Xe.bigint)return this._getInvalidInput(e);let r;const i=new Pr;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),He(r,{code:Le.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),He(r,{code:Le.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),He(r,{code:Le.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):jt.assertNever(a);return{status:i.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return He(n,{code:Le.invalid_type,expected:Xe.bigint,received:n.parsedType}),mt}gte(e,n){return this.setLimit("min",e,!0,rt.toString(n))}gt(e,n){return this.setLimit("min",e,!1,rt.toString(n))}lte(e,n){return this.setLimit("max",e,!0,rt.toString(n))}lt(e,n){return this.setLimit("max",e,!1,rt.toString(n))}setLimit(e,n,r,i){return new ou({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:rt.toString(i)}]})}_addCheck(e){return new ou({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:rt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:rt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:rt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:rt.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:rt.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}ou.create=t=>new ou({checks:[],typeName:Oe.ZodBigInt,coerce:t?.coerce??!1,...Tt(t)});let O_=class extends Ft{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Xe.boolean){const r=this._getOrReturnCtx(e);return He(r,{code:Le.invalid_type,expected:Xe.boolean,received:r.parsedType}),mt}return jr(e.data)}};O_.create=t=>new O_({typeName:Oe.ZodBoolean,coerce:t?.coerce||!1,...Tt(t)});class Rh extends Ft{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Xe.date){const a=this._getOrReturnCtx(e);return He(a,{code:Le.invalid_type,expected:Xe.date,received:a.parsedType}),mt}if(Number.isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return He(a,{code:Le.invalid_date}),mt}const r=new Pr;let i;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(i=this._getOrReturnCtx(e,i),He(i,{code:Le.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(i=this._getOrReturnCtx(e,i),He(i,{code:Le.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):jt.assertNever(a);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Rh({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:rt.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:rt.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Rh.create=t=>new Rh({checks:[],coerce:t?.coerce||!1,typeName:Oe.ZodDate,...Tt(t)});class Uw extends Ft{_parse(e){if(this._getType(e)!==Xe.symbol){const r=this._getOrReturnCtx(e);return He(r,{code:Le.invalid_type,expected:Xe.symbol,received:r.parsedType}),mt}return jr(e.data)}}Uw.create=t=>new Uw({typeName:Oe.ZodSymbol,...Tt(t)});class D_ extends Ft{_parse(e){if(this._getType(e)!==Xe.undefined){const r=this._getOrReturnCtx(e);return He(r,{code:Le.invalid_type,expected:Xe.undefined,received:r.parsedType}),mt}return jr(e.data)}}D_.create=t=>new D_({typeName:Oe.ZodUndefined,...Tt(t)});let U_=class extends Ft{_parse(e){if(this._getType(e)!==Xe.null){const r=this._getOrReturnCtx(e);return He(r,{code:Le.invalid_type,expected:Xe.null,received:r.parsedType}),mt}return jr(e.data)}};U_.create=t=>new U_({typeName:Oe.ZodNull,...Tt(t)});let F_=class extends Ft{constructor(){super(...arguments),this._any=!0}_parse(e){return jr(e.data)}};F_.create=t=>new F_({typeName:Oe.ZodAny,...Tt(t)});let El=class extends Ft{constructor(){super(...arguments),this._unknown=!0}_parse(e){return jr(e.data)}};El.create=t=>new El({typeName:Oe.ZodUnknown,...Tt(t)});let ya=class extends Ft{_parse(e){const n=this._getOrReturnCtx(e);return He(n,{code:Le.invalid_type,expected:Xe.never,received:n.parsedType}),mt}};ya.create=t=>new ya({typeName:Oe.ZodNever,...Tt(t)});class z_ extends Ft{_parse(e){if(this._getType(e)!==Xe.undefined){const r=this._getOrReturnCtx(e);return He(r,{code:Le.invalid_type,expected:Xe.void,received:r.parsedType}),mt}return jr(e.data)}}z_.create=t=>new z_({typeName:Oe.ZodVoid,...Tt(t)});let Al=class hh extends Ft{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),i=this._def;if(n.parsedType!==Xe.array)return He(n,{code:Le.invalid_type,expected:Xe.array,received:n.parsedType}),mt;if(i.exactLength!==null){const l=n.data.length>i.exactLength.value,c=n.data.length<i.exactLength.value;(l||c)&&(He(n,{code:l?Le.too_big:Le.too_small,minimum:c?i.exactLength.value:void 0,maximum:l?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(He(n,{code:Le.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(He(n,{code:Le.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((l,c)=>i.type._parseAsync(new ts(n,l,n.path,c)))).then(l=>Pr.mergeArray(r,l));const a=[...n.data].map((l,c)=>i.type._parseSync(new ts(n,l,n.path,c)));return Pr.mergeArray(r,a)}get element(){return this._def.type}min(e,n){return new hh({...this._def,minLength:{value:e,message:rt.toString(n)}})}max(e,n){return new hh({...this._def,maxLength:{value:e,message:rt.toString(n)}})}length(e,n){return new hh({...this._def,exactLength:{value:e,message:rt.toString(n)}})}nonempty(e){return this.min(1,e)}};Al.create=(t,e)=>new Al({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Oe.ZodArray,...Tt(e)});function fl(t){if(t instanceof ks){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Is.create(fl(r))}return new ks({...t._def,shape:()=>e})}else return t instanceof Al?new Al({...t._def,type:fl(t.element)}):t instanceof Is?Is.create(fl(t.unwrap())):t instanceof uo?uo.create(fl(t.unwrap())):t instanceof Ls?Ls.create(t.items.map(e=>fl(e))):t}let ks=class Di extends Ft{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=jt.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==Xe.object){const f=this._getOrReturnCtx(e);return He(f,{code:Le.invalid_type,expected:Xe.object,received:f.parsedType}),mt}const{status:r,ctx:i}=this._processInputParams(e),{shape:a,keys:l}=this._getCached(),c=[];if(!(this._def.catchall instanceof ya&&this._def.unknownKeys==="strip"))for(const f in i.data)l.includes(f)||c.push(f);const u=[];for(const f of l){const h=a[f],p=i.data[f];u.push({key:{status:"valid",value:f},value:h._parse(new ts(i,p,i.path,f)),alwaysSet:f in i.data})}if(this._def.catchall instanceof ya){const f=this._def.unknownKeys;if(f==="passthrough")for(const h of c)u.push({key:{status:"valid",value:h},value:{status:"valid",value:i.data[h]}});else if(f==="strict")c.length>0&&(He(i,{code:Le.unrecognized_keys,keys:c}),r.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const h of c){const p=i.data[h];u.push({key:{status:"valid",value:h},value:f._parse(new ts(i,p,i.path,h)),alwaysSet:h in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const f=[];for(const h of u){const p=await h.key,m=await h.value;f.push({key:p,value:m,alwaysSet:h.alwaysSet})}return f}).then(f=>Pr.mergeObjectSync(r,f)):Pr.mergeObjectSync(r,u)}get shape(){return this._def.shape()}strict(e){return rt.errToObj,new Di({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{const i=this._def.errorMap?.(n,r).message??r.defaultError;return n.code==="unrecognized_keys"?{message:rt.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new Di({...this._def,unknownKeys:"strip"})}passthrough(){return new Di({...this._def,unknownKeys:"passthrough"})}extend(e){return new Di({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Di({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Oe.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Di({...this._def,catchall:e})}pick(e){const n={};for(const r of jt.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Di({...this._def,shape:()=>n})}omit(e){const n={};for(const r of jt.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new Di({...this._def,shape:()=>n})}deepPartial(){return fl(this)}partial(e){const n={};for(const r of jt.objectKeys(this.shape)){const i=this.shape[r];e&&!e[r]?n[r]=i:n[r]=i.optional()}return new Di({...this._def,shape:()=>n})}required(e){const n={};for(const r of jt.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof Is;)a=a._def.innerType;n[r]=a}return new Di({...this._def,shape:()=>n})}keyof(){return cM(jt.objectKeys(this.shape))}};ks.create=(t,e)=>new ks({shape:()=>t,unknownKeys:"strip",catchall:ya.create(),typeName:Oe.ZodObject,...Tt(e)});ks.strictCreate=(t,e)=>new ks({shape:()=>t,unknownKeys:"strict",catchall:ya.create(),typeName:Oe.ZodObject,...Tt(e)});ks.lazycreate=(t,e)=>new ks({shape:t,unknownKeys:"strip",catchall:ya.create(),typeName:Oe.ZodObject,...Tt(e)});let Ch=class extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function i(a){for(const c of a)if(c.result.status==="valid")return c.result;for(const c of a)if(c.result.status==="dirty")return n.common.issues.push(...c.ctx.common.issues),c.result;const l=a.map(c=>new yi(c.ctx.common.issues));return He(n,{code:Le.invalid_union,unionErrors:l}),mt}if(n.common.async)return Promise.all(r.map(async a=>{const l={...n,common:{...n.common,issues:[]},parent:null};return{result:await a._parseAsync({data:n.data,path:n.path,parent:l}),ctx:l}})).then(i);{let a;const l=[];for(const u of r){const f={...n,common:{...n.common,issues:[]},parent:null},h=u._parseSync({data:n.data,path:n.path,parent:f});if(h.status==="valid")return h;h.status==="dirty"&&!a&&(a={result:h,ctx:f}),f.common.issues.length&&l.push(f.common.issues)}if(a)return n.common.issues.push(...a.ctx.common.issues),a.result;const c=l.map(u=>new yi(u));return He(n,{code:Le.invalid_union,unionErrors:c}),mt}}get options(){return this._def.options}};Ch.create=(t,e)=>new Ch({options:t,typeName:Oe.ZodUnion,...Tt(e)});const bs=t=>t instanceof V_?bs(t.schema):t instanceof co?bs(t.innerType()):t instanceof Ph?[t.value]:t instanceof op?t.options:t instanceof H_?jt.objectValues(t.enum):t instanceof Ih?bs(t._def.innerType):t instanceof D_?[void 0]:t instanceof U_?[null]:t instanceof Is?[void 0,...bs(t.unwrap())]:t instanceof uo?[null,...bs(t.unwrap())]:t instanceof uM||t instanceof kh?bs(t.unwrap()):t instanceof Nh?bs(t._def.innerType):[];let iL=class lM extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Xe.object)return He(n,{code:Le.invalid_type,expected:Xe.object,received:n.parsedType}),mt;const r=this.discriminator,i=n.data[r],a=this.optionsMap.get(i);return a?n.common.async?a._parseAsync({data:n.data,path:n.path,parent:n}):a._parseSync({data:n.data,path:n.path,parent:n}):(He(n,{code:Le.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),mt)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const i=new Map;for(const a of n){const l=bs(a.shape[e]);if(!l.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const c of l){if(i.has(c))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(c)}`);i.set(c,a)}}return new lM({typeName:Oe.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:i,...Tt(r)})}};function $_(t,e){const n=ua(t),r=ua(e);if(t===e)return{valid:!0,data:t};if(n===Xe.object&&r===Xe.object){const i=jt.objectKeys(e),a=jt.objectKeys(t).filter(c=>i.indexOf(c)!==-1),l={...t,...e};for(const c of a){const u=$_(t[c],e[c]);if(!u.valid)return{valid:!1};l[c]=u.data}return{valid:!0,data:l}}else if(n===Xe.array&&r===Xe.array){if(t.length!==e.length)return{valid:!1};const i=[];for(let a=0;a<t.length;a++){const l=t[a],c=e[a],u=$_(l,c);if(!u.valid)return{valid:!1};i.push(u.data)}return{valid:!0,data:i}}else return n===Xe.date&&r===Xe.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}let Ah=class extends Ft{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=(a,l)=>{if(Lw(a)||Lw(l))return mt;const c=$_(a.value,l.value);return c.valid?((Ow(a)||Ow(l))&&n.dirty(),{status:n.value,value:c.data}):(He(r,{code:Le.invalid_intersection_types}),mt)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,l])=>i(a,l)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}};Ah.create=(t,e,n)=>new Ah({left:t,right:e,typeName:Oe.ZodIntersection,...Tt(n)});class Ls extends Ft{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Xe.array)return He(r,{code:Le.invalid_type,expected:Xe.array,received:r.parsedType}),mt;if(r.data.length<this._def.items.length)return He(r,{code:Le.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),mt;!this._def.rest&&r.data.length>this._def.items.length&&(He(r,{code:Le.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const a=[...r.data].map((l,c)=>{const u=this._def.items[c]||this._def.rest;return u?u._parse(new ts(r,l,r.path,c)):null}).filter(l=>!!l);return r.common.async?Promise.all(a).then(l=>Pr.mergeArray(n,l)):Pr.mergeArray(n,a)}get items(){return this._def.items}rest(e){return new Ls({...this._def,rest:e})}}Ls.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ls({items:t,typeName:Oe.ZodTuple,rest:null,...Tt(e)})};let sL=class B_ extends Ft{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Xe.object)return He(r,{code:Le.invalid_type,expected:Xe.object,received:r.parsedType}),mt;const i=[],a=this._def.keyType,l=this._def.valueType;for(const c in r.data)i.push({key:a._parse(new ts(r,c,r.path,c)),value:l._parse(new ts(r,r.data[c],r.path,c)),alwaysSet:c in r.data});return r.common.async?Pr.mergeObjectAsync(n,i):Pr.mergeObjectSync(n,i)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof Ft?new B_({keyType:e,valueType:n,typeName:Oe.ZodRecord,...Tt(r)}):new B_({keyType:Mh.create(),valueType:e,typeName:Oe.ZodRecord,...Tt(n)})}};class Fw extends Ft{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Xe.map)return He(r,{code:Le.invalid_type,expected:Xe.map,received:r.parsedType}),mt;const i=this._def.keyType,a=this._def.valueType,l=[...r.data.entries()].map(([c,u],f)=>({key:i._parse(new ts(r,c,r.path,[f,"key"])),value:a._parse(new ts(r,u,r.path,[f,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const u of l){const f=await u.key,h=await u.value;if(f.status==="aborted"||h.status==="aborted")return mt;(f.status==="dirty"||h.status==="dirty")&&n.dirty(),c.set(f.value,h.value)}return{status:n.value,value:c}})}else{const c=new Map;for(const u of l){const f=u.key,h=u.value;if(f.status==="aborted"||h.status==="aborted")return mt;(f.status==="dirty"||h.status==="dirty")&&n.dirty(),c.set(f.value,h.value)}return{status:n.value,value:c}}}}Fw.create=(t,e,n)=>new Fw({valueType:e,keyType:t,typeName:Oe.ZodMap,...Tt(n)});class lu extends Ft{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Xe.set)return He(r,{code:Le.invalid_type,expected:Xe.set,received:r.parsedType}),mt;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(He(r,{code:Le.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(He(r,{code:Le.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const a=this._def.valueType;function l(u){const f=new Set;for(const h of u){if(h.status==="aborted")return mt;h.status==="dirty"&&n.dirty(),f.add(h.value)}return{status:n.value,value:f}}const c=[...r.data.values()].map((u,f)=>a._parse(new ts(r,u,r.path,f)));return r.common.async?Promise.all(c).then(u=>l(u)):l(c)}min(e,n){return new lu({...this._def,minSize:{value:e,message:rt.toString(n)}})}max(e,n){return new lu({...this._def,maxSize:{value:e,message:rt.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}lu.create=(t,e)=>new lu({valueType:t,minSize:null,maxSize:null,typeName:Oe.ZodSet,...Tt(e)});class Yc extends Ft{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Xe.function)return He(n,{code:Le.invalid_type,expected:Xe.function,received:n.parsedType}),mt;function r(c,u){return N_({data:c,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,I_(),au].filter(f=>!!f),issueData:{code:Le.invalid_arguments,argumentsError:u}})}function i(c,u){return N_({data:c,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,I_(),au].filter(f=>!!f),issueData:{code:Le.invalid_return_type,returnTypeError:u}})}const a={errorMap:n.common.contextualErrorMap},l=n.data;if(this._def.returns instanceof cu){const c=this;return jr(async function(...u){const f=new yi([]),h=await c._def.args.parseAsync(u,a).catch(y=>{throw f.addIssue(r(u,y)),f}),p=await Reflect.apply(l,this,h);return await c._def.returns._def.type.parseAsync(p,a).catch(y=>{throw f.addIssue(i(p,y)),f})})}else{const c=this;return jr(function(...u){const f=c._def.args.safeParse(u,a);if(!f.success)throw new yi([r(u,f.error)]);const h=Reflect.apply(l,this,f.data),p=c._def.returns.safeParse(h,a);if(!p.success)throw new yi([i(h,p.error)]);return p.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Yc({...this._def,args:Ls.create(e).rest(El.create())})}returns(e){return new Yc({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new Yc({args:e||Ls.create([]).rest(El.create()),returns:n||El.create(),typeName:Oe.ZodFunction,...Tt(r)})}}class V_ extends Ft{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}V_.create=(t,e)=>new V_({getter:t,typeName:Oe.ZodLazy,...Tt(e)});let Ph=class extends Ft{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return He(n,{received:n.data,code:Le.invalid_literal,expected:this._def.value}),mt}return{status:"valid",value:e.data}}get value(){return this._def.value}};Ph.create=(t,e)=>new Ph({value:t,typeName:Oe.ZodLiteral,...Tt(e)});function cM(t,e){return new op({values:t,typeName:Oe.ZodEnum,...Tt(e)})}let op=class j_ extends Ft{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return He(n,{expected:jt.joinValues(r),received:n.parsedType,code:Le.invalid_type}),mt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return He(n,{received:n.data,code:Le.invalid_enum_value,options:r}),mt}return jr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return j_.create(e,{...this._def,...n})}exclude(e,n=this._def){return j_.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}};op.create=cM;class H_ extends Ft{_parse(e){const n=jt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==Xe.string&&r.parsedType!==Xe.number){const i=jt.objectValues(n);return He(r,{expected:jt.joinValues(i),received:r.parsedType,code:Le.invalid_type}),mt}if(this._cache||(this._cache=new Set(jt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const i=jt.objectValues(n);return He(r,{received:r.data,code:Le.invalid_enum_value,options:i}),mt}return jr(e.data)}get enum(){return this._def.values}}H_.create=(t,e)=>new H_({values:t,typeName:Oe.ZodNativeEnum,...Tt(e)});class cu extends Ft{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Xe.promise&&n.common.async===!1)return He(n,{code:Le.invalid_type,expected:Xe.promise,received:n.parsedType}),mt;const r=n.parsedType===Xe.promise?n.data:Promise.resolve(n.data);return jr(r.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}cu.create=(t,e)=>new cu({type:t,typeName:Oe.ZodPromise,...Tt(e)});class co extends Ft{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Oe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=this._def.effect||null,a={addIssue:l=>{He(r,l),l.fatal?n.abort():n.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),i.type==="preprocess"){const l=i.transform(r.data,a);if(r.common.async)return Promise.resolve(l).then(async c=>{if(n.value==="aborted")return mt;const u=await this._def.schema._parseAsync({data:c,path:r.path,parent:r});return u.status==="aborted"?mt:u.status==="dirty"||n.value==="dirty"?$c(u.value):u});{if(n.value==="aborted")return mt;const c=this._def.schema._parseSync({data:l,path:r.path,parent:r});return c.status==="aborted"?mt:c.status==="dirty"||n.value==="dirty"?$c(c.value):c}}if(i.type==="refinement"){const l=c=>{const u=i.refinement(c,a);if(r.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?mt:(c.status==="dirty"&&n.dirty(),l(c.value),{status:n.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?mt:(c.status==="dirty"&&n.dirty(),l(c.value).then(()=>({status:n.value,value:c.value}))))}if(i.type==="transform")if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Cl(l))return mt;const c=i.transform(l.value,a);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>Cl(l)?Promise.resolve(i.transform(l.value,a)).then(c=>({status:n.value,value:c})):mt);jt.assertNever(i)}}co.create=(t,e,n)=>new co({schema:t,typeName:Oe.ZodEffects,effect:e,...Tt(n)});co.createWithPreprocess=(t,e,n)=>new co({schema:e,effect:{type:"preprocess",transform:t},typeName:Oe.ZodEffects,...Tt(n)});let Is=class extends Ft{_parse(e){return this._getType(e)===Xe.undefined?jr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Is.create=(t,e)=>new Is({innerType:t,typeName:Oe.ZodOptional,...Tt(e)});let uo=class extends Ft{_parse(e){return this._getType(e)===Xe.null?jr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};uo.create=(t,e)=>new uo({innerType:t,typeName:Oe.ZodNullable,...Tt(e)});let Ih=class extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===Xe.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}};Ih.create=(t,e)=>new Ih({innerType:t,typeName:Oe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Tt(e)});let Nh=class extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Th(i)?i.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new yi(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new yi(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}};Nh.create=(t,e)=>new Nh({innerType:t,typeName:Oe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Tt(e)});class zw extends Ft{_parse(e){if(this._getType(e)!==Xe.nan){const r=this._getOrReturnCtx(e);return He(r,{code:Le.invalid_type,expected:Xe.nan,received:r.parsedType}),mt}return{status:"valid",value:e.data}}}zw.create=t=>new zw({typeName:Oe.ZodNaN,...Tt(t)});class uM extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Yv extends Ft{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?mt:a.status==="dirty"?(n.dirty(),$c(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?mt:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,n){return new Yv({in:e,out:n,typeName:Oe.ZodPipeline})}}let kh=class extends Ft{_parse(e){const n=this._def.innerType._parse(e),r=i=>(Cl(i)&&(i.value=Object.freeze(i.value)),i);return Th(n)?n.then(i=>r(i)):r(n)}unwrap(){return this._def.innerType}};kh.create=(t,e)=>new kh({innerType:t,typeName:Oe.ZodReadonly,...Tt(e)});var Oe;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Oe||(Oe={}));const it=Mh.create,fn=k_.create,so=O_.create,Gd=F_.create;El.create;ya.create;const uu=z_.create,ji=Al.create,Pt=ks.create;Ch.create;const $w=iL.create;Ah.create;Ls.create;const Wd=sL.create,du=Yc.create,qd=Ph.create,rs=op.create,aL=cu.create;Is.create;uo.create;const oL=t=>()=>!Array.isArray(t)||t.length===0?null:{components:t.map(e=>{if(typeof e!="object"||e===null)return{id:"unknown",componentName:"unknown",description:"invalid component",props:void 0,propsSchema:"Not specified",state:void 0,isSelectedForInteraction:!1,stateSchema:"Not specified"};const n=e;return{id:String(n.id??"unknown"),componentName:String(n.name??"unknown"),description:String(n.description??""),props:n.props,propsSchema:n.propsSchema?"Available - use component-specific update tools":"Not specified",state:n.state,isSelectedForInteraction:n.isSelectedForInteraction??!1,stateSchema:n.stateSchema?"Available - use component-specific update tools":"Not specified"}})},lL=Object.freeze({status:"aborted"});function _e(t,e,n){function r(c,u){var f;Object.defineProperty(c,"_zod",{value:c._zod??{},enumerable:!1}),(f=c._zod).traits??(f.traits=new Set),c._zod.traits.add(t),e(c,u);for(const h in l.prototype)h in c||Object.defineProperty(c,h,{value:l.prototype[h].bind(c)});c._zod.constr=l,c._zod.def=u}const i=n?.Parent??Object;class a extends i{}Object.defineProperty(a,"name",{value:t});function l(c){var u;const f=n?.Parent?new a:this;r(f,c),(u=f._zod).deferred??(u.deferred=[]);for(const h of f._zod.deferred)h();return f}return Object.defineProperty(l,"init",{value:r}),Object.defineProperty(l,Symbol.hasInstance,{value:c=>n?.Parent&&c instanceof n.Parent?!0:c?._zod?.traits?.has(t)}),Object.defineProperty(l,"name",{value:t}),l}const W6=Symbol("zod_brand");class fu extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const G_={};function ns(t){return t&&Object.assign(G_,t),G_}function cL(t){return t}function uL(t){return t}function dL(t){}function fL(t){throw new Error}function hL(t){}function Jv(t){const e=Object.values(t).filter(r=>typeof r=="number");return Object.entries(t).filter(([r,i])=>e.indexOf(+r)===-1).map(([r,i])=>i)}function pL(t,e="|"){return t.map(n=>mM(n)).join(e)}function dM(t,e){return typeof e=="bigint"?e.toString():e}function lp(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function vo(t){return t==null}function cp(t){const e=t.startsWith("^")?1:0,n=t.endsWith("$")?t.length-1:t.length;return t.slice(e,n)}function fM(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=n>r?n:r,a=Number.parseInt(t.toFixed(i).replace(".","")),l=Number.parseInt(e.toFixed(i).replace(".",""));return a%l/10**i}function Zt(t,e,n){Object.defineProperty(t,e,{get(){{const r=n();return t[e]=r,r}},set(r){Object.defineProperty(t,e,{value:r})},configurable:!0})}function Eu(t,e,n){Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0})}function mL(t,e){return e?e.reduce((n,r)=>n?.[r],t):t}function gL(t){const e=Object.keys(t),n=e.map(r=>t[r]);return Promise.all(n).then(r=>{const i={};for(let a=0;a<e.length;a++)i[e[a]]=r[a];return i})}function _L(t=10){const e="abcdefghijklmnopqrstuvwxyz";let n="";for(let r=0;r<t;r++)n+=e[Math.floor(Math.random()*e.length)];return n}function hl(t){return JSON.stringify(t)}const Qv=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function hu(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const hM=lp(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function pu(t){if(hu(t)===!1)return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(hu(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function vL(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}const yL=t=>{const e=typeof t;switch(e){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(t)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(t)?"array":t===null?"null":t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?"promise":typeof Map<"u"&&t instanceof Map?"map":typeof Set<"u"&&t instanceof Set?"set":typeof Date<"u"&&t instanceof Date?"date":typeof File<"u"&&t instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${e}`)}},Lh=new Set(["string","number","symbol"]),pM=new Set(["string","number","bigint","boolean","symbol","undefined"]);function yo(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ea(t,e,n){const r=new t._zod.constr(e??t._zod.def);return(!e||n?.parent)&&(r._zod.parent=t),r}function Ne(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function SL(t){let e;return new Proxy({},{get(n,r,i){return e??(e=t()),Reflect.get(e,r,i)},set(n,r,i,a){return e??(e=t()),Reflect.set(e,r,i,a)},has(n,r){return e??(e=t()),Reflect.has(e,r)},deleteProperty(n,r){return e??(e=t()),Reflect.deleteProperty(e,r)},ownKeys(n){return e??(e=t()),Reflect.ownKeys(e)},getOwnPropertyDescriptor(n,r){return e??(e=t()),Reflect.getOwnPropertyDescriptor(e,r)},defineProperty(n,r,i){return e??(e=t()),Reflect.defineProperty(e,r,i)}})}function mM(t){return typeof t=="bigint"?t.toString()+"n":typeof t=="string"?`"${t}"`:`${t}`}function gM(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const _M={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},vM={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function yM(t,e){const n={},r=t._zod.def;for(const i in e){if(!(i in r.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&(n[i]=r.shape[i])}return Ea(t,{...t._zod.def,shape:n,checks:[]})}function SM(t,e){const n={...t._zod.def.shape},r=t._zod.def;for(const i in e){if(!(i in r.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&delete n[i]}return Ea(t,{...t._zod.def,shape:n,checks:[]})}function wM(t,e){if(!pu(e))throw new Error("Invalid input to extend: expected a plain object");const n={...t._zod.def,get shape(){const r={...t._zod.def.shape,...e};return Eu(this,"shape",r),r},checks:[]};return Ea(t,n)}function xM(t,e){return Ea(t,{...t._zod.def,get shape(){const n={...t._zod.def.shape,...e._zod.def.shape};return Eu(this,"shape",n),n},catchall:e._zod.def.catchall,checks:[]})}function EM(t,e,n){const r=e._zod.def.shape,i={...r};if(n)for(const a in n){if(!(a in r))throw new Error(`Unrecognized key: "${a}"`);n[a]&&(i[a]=t?new t({type:"optional",innerType:r[a]}):r[a])}else for(const a in r)i[a]=t?new t({type:"optional",innerType:r[a]}):r[a];return Ea(e,{...e._zod.def,shape:i,checks:[]})}function bM(t,e,n){const r=e._zod.def.shape,i={...r};if(n)for(const a in n){if(!(a in i))throw new Error(`Unrecognized key: "${a}"`);n[a]&&(i[a]=new t({type:"nonoptional",innerType:r[a]}))}else for(const a in r)i[a]=new t({type:"nonoptional",innerType:r[a]});return Ea(e,{...e._zod.def,shape:i,checks:[]})}function bl(t,e=0){for(let n=e;n<t.issues.length;n++)if(t.issues[n]?.continue!==!0)return!0;return!1}function vi(t,e){return e.map(n=>{var r;return(r=n).path??(r.path=[]),n.path.unshift(t),n})}function Vc(t){return typeof t=="string"?t:t?.message}function Hi(t,e,n){const r={...t,path:t.path??[]};if(!t.message){const i=Vc(t.inst?._zod.def?.error?.(t))??Vc(e?.error?.(t))??Vc(n.customError?.(t))??Vc(n.localeError?.(t))??"Invalid input";r.message=i}return delete r.inst,delete r.continue,e?.reportInput||delete r.input,r}function up(t){return t instanceof Set?"set":t instanceof Map?"map":t instanceof File?"file":"unknown"}function dp(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Pl(...t){const[e,n,r]=t;return typeof e=="string"?{message:e,code:"custom",input:n,inst:r}:{...e}}function wL(t){return Object.entries(t).filter(([e,n])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}class xL{constructor(...e){}}const q6=Object.freeze(Object.defineProperty({__proto__:null,BIGINT_FORMAT_RANGES:vM,Class:xL,NUMBER_FORMAT_RANGES:_M,aborted:bl,allowsEval:hM,assert:hL,assertEqual:cL,assertIs:dL,assertNever:fL,assertNotEqual:uL,assignProp:Eu,cached:lp,captureStackTrace:Qv,cleanEnum:wL,cleanRegex:cp,clone:Ea,createTransparentProxy:SL,defineLazy:Zt,esc:hl,escapeRegex:yo,extend:wM,finalizeIssue:Hi,floatSafeRemainder:fM,getElementAtPath:mL,getEnumValues:Jv,getLengthableOrigin:dp,getParsedType:yL,getSizableOrigin:up,isObject:hu,isPlainObject:pu,issue:Pl,joinValues:pL,jsonStringifyReplacer:dM,merge:xM,normalizeParams:Ne,nullish:vo,numKeys:vL,omit:SM,optionalKeys:gM,partial:EM,pick:yM,prefixIssues:vi,primitiveTypes:pM,promiseAllObject:gL,propertyKeyTypes:Lh,randomString:_L,required:bM,stringifyPrimitive:mM,unwrapMessage:Vc},Symbol.toStringTag,{value:"Module"})),TM=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,dM,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},MM=_e("$ZodError",TM),fp=_e("$ZodError",TM,{Parent:Error});function EL(t,e=n=>n.message){const n={},r=[];for(const i of t.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(e(i))):r.push(e(i));return{formErrors:r,fieldErrors:n}}function bL(t,e){const n=e||function(a){return a.message},r={_errors:[]},i=a=>{for(const l of a.issues)if(l.code==="invalid_union"&&l.errors.length)l.errors.map(c=>i({issues:c}));else if(l.code==="invalid_key")i({issues:l.issues});else if(l.code==="invalid_element")i({issues:l.issues});else if(l.path.length===0)r._errors.push(n(l));else{let c=r,u=0;for(;u<l.path.length;){const f=l.path[u];u===l.path.length-1?(c[f]=c[f]||{_errors:[]},c[f]._errors.push(n(l))):c[f]=c[f]||{_errors:[]},c=c[f],u++}}};return i(t),r}function Z6(t,e){const n=e||function(a){return a.message},r={errors:[]},i=(a,l=[])=>{var c,u;for(const f of a.issues)if(f.code==="invalid_union"&&f.errors.length)f.errors.map(h=>i({issues:h},f.path));else if(f.code==="invalid_key")i({issues:f.issues},f.path);else if(f.code==="invalid_element")i({issues:f.issues},f.path);else{const h=[...l,...f.path];if(h.length===0){r.errors.push(n(f));continue}let p=r,m=0;for(;m<h.length;){const y=h[m],S=m===h.length-1;typeof y=="string"?(p.properties??(p.properties={}),(c=p.properties)[y]??(c[y]={errors:[]}),p=p.properties[y]):(p.items??(p.items=[]),(u=p.items)[y]??(u[y]={errors:[]}),p=p.items[y]),S&&p.errors.push(n(f)),m++}}};return i(t),r}function TL(t){const e=[];for(const n of t)typeof n=="number"?e.push(`[${n}]`):typeof n=="symbol"?e.push(`[${JSON.stringify(String(n))}]`):/[^\w$]/.test(n)?e.push(`[${JSON.stringify(n)}]`):(e.length&&e.push("."),e.push(n));return e.join("")}function X6(t){const e=[],n=[...t.issues].sort((r,i)=>r.path.length-i.path.length);for(const r of n)e.push(` ${r.message}`),r.path?.length&&e.push(`   at ${TL(r.path)}`);return e.join(`
`)}const RM=t=>(e,n,r,i)=>{const a=r?Object.assign(r,{async:!1}):{async:!1},l=e._zod.run({value:n,issues:[]},a);if(l instanceof Promise)throw new fu;if(l.issues.length){const c=new(i?.Err??t)(l.issues.map(u=>Hi(u,a,ns())));throw Qv(c,i?.callee),c}return l.value},K6=RM(fp),CM=t=>async(e,n,r,i)=>{const a=r?Object.assign(r,{async:!0}):{async:!0};let l=e._zod.run({value:n,issues:[]},a);if(l instanceof Promise&&(l=await l),l.issues.length){const c=new(i?.Err??t)(l.issues.map(u=>Hi(u,a,ns())));throw Qv(c,i?.callee),c}return l.value},Y6=CM(fp),AM=t=>(e,n,r)=>{const i=r?{...r,async:!1}:{async:!1},a=e._zod.run({value:n,issues:[]},i);if(a instanceof Promise)throw new fu;return a.issues.length?{success:!1,error:new(t??MM)(a.issues.map(l=>Hi(l,i,ns())))}:{success:!0,data:a.value}},PM=AM(fp),IM=t=>async(e,n,r)=>{const i=r?Object.assign(r,{async:!0}):{async:!0};let a=e._zod.run({value:n,issues:[]},i);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new t(a.issues.map(l=>Hi(l,i,ns())))}:{success:!0,data:a.value}},ML=IM(fp),NM=/^[cC][^\s-]{8,}$/,kM=/^[0-9a-z]+$/,LM=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,OM=/^[0-9a-vA-V]{20}$/,DM=/^[A-Za-z0-9]{27}$/,UM=/^[a-zA-Z0-9_-]{21}$/,FM=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,RL=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,zM=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Il=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,CL=Il(4),AL=Il(6),PL=Il(7),$M=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,IL=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,NL=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,kL=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u,LL=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,BM="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function VM(){return new RegExp(BM,"u")}const jM=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,HM=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,GM=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,WM=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,qM=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,ey=/^[A-Za-z0-9_-]*$/,ZM=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,OL=/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,XM=/^\+(?:[0-9]){6,14}[0-9]$/,KM="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",YM=new RegExp(`^${KM}$`);function JM(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function QM(t){return new RegExp(`^${JM(t)}$`)}function eR(t){const e=JM({precision:t.precision}),n=["Z"];t.local&&n.push(""),t.offset&&n.push("([+-]\\d{2}:\\d{2})");const r=`${e}(?:${n.join("|")})`;return new RegExp(`^${KM}T(?:${r})$`)}const tR=t=>{const e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},nR=/^\d+n?$/,rR=/^\d+$/,iR=/^-?\d+(?:\.\d+)?/i,sR=/true|false/i,aR=/null/i,oR=/undefined/i,lR=/^[^A-Z]*$/,cR=/^[^a-z]*$/,J6=Object.freeze(Object.defineProperty({__proto__:null,_emoji:BM,base64:qM,base64url:ey,bigint:nR,boolean:sR,browserEmail:LL,cidrv4:GM,cidrv6:WM,cuid:NM,cuid2:kM,date:YM,datetime:eR,domain:OL,duration:FM,e164:XM,email:$M,emoji:VM,extendedDuration:RL,guid:zM,hostname:ZM,html5Email:IL,integer:rR,ipv4:jM,ipv6:HM,ksuid:DM,lowercase:lR,nanoid:UM,null:aR,number:iR,rfc5322Email:NL,string:tR,time:QM,ulid:LM,undefined:oR,unicodeEmail:kL,uppercase:cR,uuid:Il,uuid4:CL,uuid6:AL,uuid7:PL,xid:OM},Symbol.toStringTag,{value:"Module"})),Dn=_e("$ZodCheck",(t,e)=>{var n;t._zod??(t._zod={}),t._zod.def=e,(n=t._zod).onattach??(n.onattach=[])}),uR={number:"number",bigint:"bigint",object:"date"},dR=_e("$ZodCheckLessThan",(t,e)=>{Dn.init(t,e);const n=uR[typeof e.value];t._zod.onattach.push(r=>{const i=r._zod.bag,a=(e.inclusive?i.maximum:i.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<a&&(e.inclusive?i.maximum=e.value:i.exclusiveMaximum=e.value)}),t._zod.check=r=>{(e.inclusive?r.value<=e.value:r.value<e.value)||r.issues.push({origin:n,code:"too_big",maximum:e.value,input:r.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),fR=_e("$ZodCheckGreaterThan",(t,e)=>{Dn.init(t,e);const n=uR[typeof e.value];t._zod.onattach.push(r=>{const i=r._zod.bag,a=(e.inclusive?i.minimum:i.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>a&&(e.inclusive?i.minimum=e.value:i.exclusiveMinimum=e.value)}),t._zod.check=r=>{(e.inclusive?r.value>=e.value:r.value>e.value)||r.issues.push({origin:n,code:"too_small",minimum:e.value,input:r.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),DL=_e("$ZodCheckMultipleOf",(t,e)=>{Dn.init(t,e),t._zod.onattach.push(n=>{var r;(r=n._zod.bag).multipleOf??(r.multipleOf=e.value)}),t._zod.check=n=>{if(typeof n.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%e.value===BigInt(0):fM(n.value,e.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:e.value,input:n.value,inst:t,continue:!e.abort})}}),UL=_e("$ZodCheckNumberFormat",(t,e)=>{Dn.init(t,e),e.format=e.format||"float64";const n=e.format?.includes("int"),r=n?"int":"number",[i,a]=_M[e.format];t._zod.onattach.push(l=>{const c=l._zod.bag;c.format=e.format,c.minimum=i,c.maximum=a,n&&(c.pattern=rR)}),t._zod.check=l=>{const c=l.value;if(n){if(!Number.isInteger(c)){l.issues.push({expected:r,format:e.format,code:"invalid_type",input:c,inst:t});return}if(!Number.isSafeInteger(c)){c>0?l.issues.push({input:c,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,continue:!e.abort}):l.issues.push({input:c,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,continue:!e.abort});return}}c<i&&l.issues.push({origin:"number",input:c,code:"too_small",minimum:i,inclusive:!0,inst:t,continue:!e.abort}),c>a&&l.issues.push({origin:"number",input:c,code:"too_big",maximum:a,inst:t})}}),FL=_e("$ZodCheckBigIntFormat",(t,e)=>{Dn.init(t,e);const[n,r]=vM[e.format];t._zod.onattach.push(i=>{const a=i._zod.bag;a.format=e.format,a.minimum=n,a.maximum=r}),t._zod.check=i=>{const a=i.value;a<n&&i.issues.push({origin:"bigint",input:a,code:"too_small",minimum:n,inclusive:!0,inst:t,continue:!e.abort}),a>r&&i.issues.push({origin:"bigint",input:a,code:"too_big",maximum:r,inst:t})}}),zL=_e("$ZodCheckMaxSize",(t,e)=>{var n;Dn.init(t,e),(n=t._zod.def).when??(n.when=r=>{const i=r.value;return!vo(i)&&i.size!==void 0}),t._zod.onattach.push(r=>{const i=r._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<i&&(r._zod.bag.maximum=e.maximum)}),t._zod.check=r=>{const i=r.value;i.size<=e.maximum||r.issues.push({origin:up(i),code:"too_big",maximum:e.maximum,input:i,inst:t,continue:!e.abort})}}),$L=_e("$ZodCheckMinSize",(t,e)=>{var n;Dn.init(t,e),(n=t._zod.def).when??(n.when=r=>{const i=r.value;return!vo(i)&&i.size!==void 0}),t._zod.onattach.push(r=>{const i=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>i&&(r._zod.bag.minimum=e.minimum)}),t._zod.check=r=>{const i=r.value;i.size>=e.minimum||r.issues.push({origin:up(i),code:"too_small",minimum:e.minimum,input:i,inst:t,continue:!e.abort})}}),BL=_e("$ZodCheckSizeEquals",(t,e)=>{var n;Dn.init(t,e),(n=t._zod.def).when??(n.when=r=>{const i=r.value;return!vo(i)&&i.size!==void 0}),t._zod.onattach.push(r=>{const i=r._zod.bag;i.minimum=e.size,i.maximum=e.size,i.size=e.size}),t._zod.check=r=>{const i=r.value,a=i.size;if(a===e.size)return;const l=a>e.size;r.issues.push({origin:up(i),...l?{code:"too_big",maximum:e.size}:{code:"too_small",minimum:e.size},inclusive:!0,exact:!0,input:r.value,inst:t,continue:!e.abort})}}),VL=_e("$ZodCheckMaxLength",(t,e)=>{var n;Dn.init(t,e),(n=t._zod.def).when??(n.when=r=>{const i=r.value;return!vo(i)&&i.length!==void 0}),t._zod.onattach.push(r=>{const i=r._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<i&&(r._zod.bag.maximum=e.maximum)}),t._zod.check=r=>{const i=r.value;if(i.length<=e.maximum)return;const l=dp(i);r.issues.push({origin:l,code:"too_big",maximum:e.maximum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),jL=_e("$ZodCheckMinLength",(t,e)=>{var n;Dn.init(t,e),(n=t._zod.def).when??(n.when=r=>{const i=r.value;return!vo(i)&&i.length!==void 0}),t._zod.onattach.push(r=>{const i=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>i&&(r._zod.bag.minimum=e.minimum)}),t._zod.check=r=>{const i=r.value;if(i.length>=e.minimum)return;const l=dp(i);r.issues.push({origin:l,code:"too_small",minimum:e.minimum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),HL=_e("$ZodCheckLengthEquals",(t,e)=>{var n;Dn.init(t,e),(n=t._zod.def).when??(n.when=r=>{const i=r.value;return!vo(i)&&i.length!==void 0}),t._zod.onattach.push(r=>{const i=r._zod.bag;i.minimum=e.length,i.maximum=e.length,i.length=e.length}),t._zod.check=r=>{const i=r.value,a=i.length;if(a===e.length)return;const l=dp(i),c=a>e.length;r.issues.push({origin:l,...c?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:r.value,inst:t,continue:!e.abort})}}),hp=_e("$ZodCheckStringFormat",(t,e)=>{var n,r;Dn.init(t,e),t._zod.onattach.push(i=>{const a=i._zod.bag;a.format=e.format,e.pattern&&(a.patterns??(a.patterns=new Set),a.patterns.add(e.pattern))}),e.pattern?(n=t._zod).check??(n.check=i=>{e.pattern.lastIndex=0,!e.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:e.format,input:i.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(r=t._zod).check??(r.check=()=>{})}),GL=_e("$ZodCheckRegex",(t,e)=>{hp.init(t,e),t._zod.check=n=>{e.pattern.lastIndex=0,!e.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),WL=_e("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=lR),hp.init(t,e)}),qL=_e("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=cR),hp.init(t,e)}),ZL=_e("$ZodCheckIncludes",(t,e)=>{Dn.init(t,e);const n=yo(e.includes),r=new RegExp(typeof e.position=="number"?`^.{${e.position}}${n}`:n);e.pattern=r,t._zod.onattach.push(i=>{const a=i._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(r)}),t._zod.check=i=>{i.value.includes(e.includes,e.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:i.value,inst:t,continue:!e.abort})}}),XL=_e("$ZodCheckStartsWith",(t,e)=>{Dn.init(t,e);const n=new RegExp(`^${yo(e.prefix)}.*`);e.pattern??(e.pattern=n),t._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(n)}),t._zod.check=r=>{r.value.startsWith(e.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:r.value,inst:t,continue:!e.abort})}}),KL=_e("$ZodCheckEndsWith",(t,e)=>{Dn.init(t,e);const n=new RegExp(`.*${yo(e.suffix)}$`);e.pattern??(e.pattern=n),t._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(n)}),t._zod.check=r=>{r.value.endsWith(e.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:r.value,inst:t,continue:!e.abort})}});function Bw(t,e,n){t.issues.length&&e.issues.push(...vi(n,t.issues))}const YL=_e("$ZodCheckProperty",(t,e)=>{Dn.init(t,e),t._zod.check=n=>{const r=e.schema._zod.run({value:n.value[e.property],issues:[]},{});if(r instanceof Promise)return r.then(i=>Bw(i,n,e.property));Bw(r,n,e.property)}}),JL=_e("$ZodCheckMimeType",(t,e)=>{Dn.init(t,e);const n=new Set(e.mime);t._zod.onattach.push(r=>{r._zod.bag.mime=e.mime}),t._zod.check=r=>{n.has(r.value.type)||r.issues.push({code:"invalid_value",values:e.mime,input:r.value.type,inst:t})}}),QL=_e("$ZodCheckOverwrite",(t,e)=>{Dn.init(t,e),t._zod.check=n=>{n.value=e.tx(n.value)}});class eO{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const r=e.split(`
`).filter(l=>l),i=Math.min(...r.map(l=>l.length-l.trimStart().length)),a=r.map(l=>l.slice(i)).map(l=>" ".repeat(this.indent*2)+l);for(const l of a)this.content.push(l)}compile(){const e=Function,n=this?.args,i=[...(this?.content??[""]).map(a=>`  ${a}`)];return new e(...n,i.join(`
`))}}const tO={major:4,minor:0,patch:0},Mt=_e("$ZodType",(t,e)=>{var n;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=tO;const r=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&r.unshift(t);for(const i of r)for(const a of i._zod.onattach)a(t);if(r.length===0)(n=t._zod).deferred??(n.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const i=(a,l,c)=>{let u=bl(a),f;for(const h of l){if(h._zod.def.when){if(!h._zod.def.when(a))continue}else if(u)continue;const p=a.issues.length,m=h._zod.check(a);if(m instanceof Promise&&c?.async===!1)throw new fu;if(f||m instanceof Promise)f=(f??Promise.resolve()).then(async()=>{await m,a.issues.length!==p&&(u||(u=bl(a,p)))});else{if(a.issues.length===p)continue;u||(u=bl(a,p))}}return f?f.then(()=>a):a};t._zod.run=(a,l)=>{const c=t._zod.parse(a,l);if(c instanceof Promise){if(l.async===!1)throw new fu;return c.then(u=>i(u,r,l))}return i(c,r,l)}}t["~standard"]={validate:i=>{try{const a=PM(t,i);return a.success?{value:a.data}:{issues:a.error?.issues}}catch{return ML(t,i).then(l=>l.success?{value:l.data}:{issues:l.error?.issues})}},vendor:"zod",version:1}}),pp=_e("$ZodString",(t,e)=>{Mt.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??tR(t._zod.bag),t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:t}),n}}),gn=_e("$ZodStringFormat",(t,e)=>{hp.init(t,e),pp.init(t,e)}),nO=_e("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=zM),gn.init(t,e)}),rO=_e("$ZodUUID",(t,e)=>{if(e.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(r===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Il(r))}else e.pattern??(e.pattern=Il());gn.init(t,e)}),iO=_e("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=$M),gn.init(t,e)}),sO=_e("$ZodURL",(t,e)=>{gn.init(t,e),t._zod.check=n=>{try{const r=n.value,i=new URL(r),a=i.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(i.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:ZM.source,input:n.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:n.value,inst:t,continue:!e.abort})),!r.endsWith("/")&&a.endsWith("/")?n.value=a.slice(0,-1):n.value=a;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:t,continue:!e.abort})}}}),aO=_e("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=VM()),gn.init(t,e)}),oO=_e("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=UM),gn.init(t,e)}),lO=_e("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=NM),gn.init(t,e)}),cO=_e("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=kM),gn.init(t,e)}),uO=_e("$ZodULID",(t,e)=>{e.pattern??(e.pattern=LM),gn.init(t,e)}),dO=_e("$ZodXID",(t,e)=>{e.pattern??(e.pattern=OM),gn.init(t,e)}),fO=_e("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=DM),gn.init(t,e)}),hO=_e("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=eR(e)),gn.init(t,e)}),pO=_e("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=YM),gn.init(t,e)}),mO=_e("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=QM(e)),gn.init(t,e)}),gO=_e("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=FM),gn.init(t,e)}),_O=_e("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=jM),gn.init(t,e),t._zod.onattach.push(n=>{const r=n._zod.bag;r.format="ipv4"})}),vO=_e("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=HM),gn.init(t,e),t._zod.onattach.push(n=>{const r=n._zod.bag;r.format="ipv6"}),t._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:t,continue:!e.abort})}}}),yO=_e("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=GM),gn.init(t,e)}),SO=_e("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=WM),gn.init(t,e),t._zod.check=n=>{const[r,i]=n.value.split("/");try{if(!i)throw new Error;const a=Number(i);if(`${a}`!==i)throw new Error;if(a<0||a>128)throw new Error;new URL(`http://[${r}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:t,continue:!e.abort})}}});function hR(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const wO=_e("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=qM),gn.init(t,e),t._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64"}),t._zod.check=n=>{hR(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:t,continue:!e.abort})}});function xO(t){if(!ey.test(t))return!1;const e=t.replace(/[-_]/g,r=>r==="-"?"+":"/"),n=e.padEnd(Math.ceil(e.length/4)*4,"=");return hR(n)}const EO=_e("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=ey),gn.init(t,e),t._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64url"}),t._zod.check=n=>{xO(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:t,continue:!e.abort})}}),bO=_e("$ZodE164",(t,e)=>{e.pattern??(e.pattern=XM),gn.init(t,e)});function TO(t,e=null){try{const n=t.split(".");if(n.length!==3)return!1;const[r]=n;if(!r)return!1;const i=JSON.parse(atob(r));return!("typ"in i&&i?.typ!=="JWT"||!i.alg||e&&(!("alg"in i)||i.alg!==e))}catch{return!1}}const MO=_e("$ZodJWT",(t,e)=>{gn.init(t,e),t._zod.check=n=>{TO(n.value,e.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:t,continue:!e.abort})}}),Q6=_e("$ZodCustomStringFormat",(t,e)=>{gn.init(t,e),t._zod.check=n=>{e.fn(n.value)||n.issues.push({code:"invalid_format",format:e.format,input:n.value,inst:t,continue:!e.abort})}}),pR=_e("$ZodNumber",(t,e)=>{Mt.init(t,e),t._zod.pattern=t._zod.bag.pattern??iR,t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=Number(n.value)}catch{}const i=n.value;if(typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i))return n;const a=typeof i=="number"?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:i,inst:t,...a?{received:a}:{}}),n}}),RO=_e("$ZodNumber",(t,e)=>{UL.init(t,e),pR.init(t,e)}),mR=_e("$ZodBoolean",(t,e)=>{Mt.init(t,e),t._zod.pattern=sR,t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=!!n.value}catch{}const i=n.value;return typeof i=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:t}),n}}),CO=_e("$ZodBigInt",(t,e)=>{Mt.init(t,e),t._zod.pattern=nR,t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=BigInt(n.value)}catch{}return typeof n.value=="bigint"||n.issues.push({expected:"bigint",code:"invalid_type",input:n.value,inst:t}),n}}),eq=_e("$ZodBigInt",(t,e)=>{FL.init(t,e),CO.init(t,e)}),tq=_e("$ZodSymbol",(t,e)=>{Mt.init(t,e),t._zod.parse=(n,r)=>{const i=n.value;return typeof i=="symbol"||n.issues.push({expected:"symbol",code:"invalid_type",input:i,inst:t}),n}}),nq=_e("$ZodUndefined",(t,e)=>{Mt.init(t,e),t._zod.pattern=oR,t._zod.values=new Set([void 0]),t._zod.optin="optional",t._zod.optout="optional",t._zod.parse=(n,r)=>{const i=n.value;return typeof i>"u"||n.issues.push({expected:"undefined",code:"invalid_type",input:i,inst:t}),n}}),AO=_e("$ZodNull",(t,e)=>{Mt.init(t,e),t._zod.pattern=aR,t._zod.values=new Set([null]),t._zod.parse=(n,r)=>{const i=n.value;return i===null||n.issues.push({expected:"null",code:"invalid_type",input:i,inst:t}),n}}),PO=_e("$ZodAny",(t,e)=>{Mt.init(t,e),t._zod.parse=n=>n}),IO=_e("$ZodUnknown",(t,e)=>{Mt.init(t,e),t._zod.parse=n=>n}),NO=_e("$ZodNever",(t,e)=>{Mt.init(t,e),t._zod.parse=(n,r)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:t}),n)}),rq=_e("$ZodVoid",(t,e)=>{Mt.init(t,e),t._zod.parse=(n,r)=>{const i=n.value;return typeof i>"u"||n.issues.push({expected:"void",code:"invalid_type",input:i,inst:t}),n}}),iq=_e("$ZodDate",(t,e)=>{Mt.init(t,e),t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=new Date(n.value)}catch{}const i=n.value,a=i instanceof Date;return a&&!Number.isNaN(i.getTime())||n.issues.push({expected:"date",code:"invalid_type",input:i,...a?{received:"Invalid Date"}:{},inst:t}),n}});function Vw(t,e,n){t.issues.length&&e.issues.push(...vi(n,t.issues)),e.value[n]=t.value}const kO=_e("$ZodArray",(t,e)=>{Mt.init(t,e),t._zod.parse=(n,r)=>{const i=n.value;if(!Array.isArray(i))return n.issues.push({expected:"array",code:"invalid_type",input:i,inst:t}),n;n.value=Array(i.length);const a=[];for(let l=0;l<i.length;l++){const c=i[l],u=e.element._zod.run({value:c,issues:[]},r);u instanceof Promise?a.push(u.then(f=>Vw(f,n,l))):Vw(u,n,l)}return a.length?Promise.all(a).then(()=>n):n}});function Zd(t,e,n){t.issues.length&&e.issues.push(...vi(n,t.issues)),e.value[n]=t.value}function jw(t,e,n,r){t.issues.length?r[n]===void 0?n in r?e.value[n]=void 0:e.value[n]=t.value:e.issues.push(...vi(n,t.issues)):t.value===void 0?n in r&&(e.value[n]=void 0):e.value[n]=t.value}const LO=_e("$ZodObject",(t,e)=>{Mt.init(t,e);const n=lp(()=>{const p=Object.keys(e.shape);for(const y of p)if(!(e.shape[y]instanceof Mt))throw new Error(`Invalid element at key "${y}": expected a Zod schema`);const m=gM(e.shape);return{shape:e.shape,keys:p,keySet:new Set(p),numKeys:p.length,optionalKeys:new Set(m)}});Zt(t._zod,"propValues",()=>{const p=e.shape,m={};for(const y in p){const S=p[y]._zod;if(S.values){m[y]??(m[y]=new Set);for(const E of S.values)m[y].add(E)}}return m});const r=p=>{const m=new eO(["shape","payload","ctx"]),y=n.value,S=x=>{const w=hl(x);return`shape[${w}]._zod.run({ value: input[${w}], issues: [] }, ctx)`};m.write("const input = payload.value;");const E=Object.create(null);let g=0;for(const x of y.keys)E[x]=`key_${g++}`;m.write("const newResult = {}");for(const x of y.keys)if(y.optionalKeys.has(x)){const w=E[x];m.write(`const ${w} = ${S(x)};`);const C=hl(x);m.write(`
        if (${w}.issues.length) {
          if (input[${C}] === undefined) {
            if (${C} in input) {
              newResult[${C}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${w}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${C}, ...iss.path] : [${C}],
              }))
            );
          }
        } else if (${w}.value === undefined) {
          if (${C} in input) newResult[${C}] = undefined;
        } else {
          newResult[${C}] = ${w}.value;
        }
        `)}else{const w=E[x];m.write(`const ${w} = ${S(x)};`),m.write(`
          if (${w}.issues.length) payload.issues = payload.issues.concat(${w}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${hl(x)}, ...iss.path] : [${hl(x)}]
          })));`),m.write(`newResult[${hl(x)}] = ${w}.value`)}m.write("payload.value = newResult;"),m.write("return payload;");const v=m.compile();return(x,w)=>v(p,x,w)};let i;const a=hu,l=!G_.jitless,u=l&&hM.value,f=e.catchall;let h;t._zod.parse=(p,m)=>{h??(h=n.value);const y=p.value;if(!a(y))return p.issues.push({expected:"object",code:"invalid_type",input:y,inst:t}),p;const S=[];if(l&&u&&m?.async===!1&&m.jitless!==!0)i||(i=r(e.shape)),p=i(p,m);else{p.value={};const w=h.shape;for(const C of h.keys){const T=w[C],M=T._zod.run({value:y[C],issues:[]},m),A=T._zod.optin==="optional"&&T._zod.optout==="optional";M instanceof Promise?S.push(M.then(F=>A?jw(F,p,C,y):Zd(F,p,C))):A?jw(M,p,C,y):Zd(M,p,C)}}if(!f)return S.length?Promise.all(S).then(()=>p):p;const E=[],g=h.keySet,v=f._zod,x=v.def.type;for(const w of Object.keys(y)){if(g.has(w))continue;if(x==="never"){E.push(w);continue}const C=v.run({value:y[w],issues:[]},m);C instanceof Promise?S.push(C.then(T=>Zd(T,p,w))):Zd(C,p,w)}return E.length&&p.issues.push({code:"unrecognized_keys",keys:E,input:y,inst:t}),S.length?Promise.all(S).then(()=>p):p}});function Hw(t,e,n,r){for(const i of t)if(i.issues.length===0)return e.value=i.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:n,errors:t.map(i=>i.issues.map(a=>Hi(a,r,ns())))}),e}const gR=_e("$ZodUnion",(t,e)=>{Mt.init(t,e),Zt(t._zod,"optin",()=>e.options.some(n=>n._zod.optin==="optional")?"optional":void 0),Zt(t._zod,"optout",()=>e.options.some(n=>n._zod.optout==="optional")?"optional":void 0),Zt(t._zod,"values",()=>{if(e.options.every(n=>n._zod.values))return new Set(e.options.flatMap(n=>Array.from(n._zod.values)))}),Zt(t._zod,"pattern",()=>{if(e.options.every(n=>n._zod.pattern)){const n=e.options.map(r=>r._zod.pattern);return new RegExp(`^(${n.map(r=>cp(r.source)).join("|")})$`)}}),t._zod.parse=(n,r)=>{let i=!1;const a=[];for(const l of e.options){const c=l._zod.run({value:n.value,issues:[]},r);if(c instanceof Promise)a.push(c),i=!0;else{if(c.issues.length===0)return c;a.push(c)}}return i?Promise.all(a).then(l=>Hw(l,n,t,r)):Hw(a,n,t,r)}}),OO=_e("$ZodDiscriminatedUnion",(t,e)=>{gR.init(t,e);const n=t._zod.parse;Zt(t._zod,"propValues",()=>{const i={};for(const a of e.options){const l=a._zod.propValues;if(!l||Object.keys(l).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(a)}"`);for(const[c,u]of Object.entries(l)){i[c]||(i[c]=new Set);for(const f of u)i[c].add(f)}}return i});const r=lp(()=>{const i=e.options,a=new Map;for(const l of i){const c=l._zod.propValues[e.discriminator];if(!c||c.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(l)}"`);for(const u of c){if(a.has(u))throw new Error(`Duplicate discriminator value "${String(u)}"`);a.set(u,l)}}return a});t._zod.parse=(i,a)=>{const l=i.value;if(!hu(l))return i.issues.push({code:"invalid_type",expected:"object",input:l,inst:t}),i;const c=r.value.get(l?.[e.discriminator]);return c?c._zod.run(i,a):e.unionFallback?n(i,a):(i.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:l,path:[e.discriminator],inst:t}),i)}}),DO=_e("$ZodIntersection",(t,e)=>{Mt.init(t,e),t._zod.parse=(n,r)=>{const i=n.value,a=e.left._zod.run({value:i,issues:[]},r),l=e.right._zod.run({value:i,issues:[]},r);return a instanceof Promise||l instanceof Promise?Promise.all([a,l]).then(([u,f])=>Gw(n,u,f)):Gw(n,a,l)}});function W_(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(pu(t)&&pu(e)){const n=Object.keys(e),r=Object.keys(t).filter(a=>n.indexOf(a)!==-1),i={...t,...e};for(const a of r){const l=W_(t[a],e[a]);if(!l.valid)return{valid:!1,mergeErrorPath:[a,...l.mergeErrorPath]};i[a]=l.data}return{valid:!0,data:i}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let r=0;r<t.length;r++){const i=t[r],a=e[r],l=W_(i,a);if(!l.valid)return{valid:!1,mergeErrorPath:[r,...l.mergeErrorPath]};n.push(l.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function Gw(t,e,n){if(e.issues.length&&t.issues.push(...e.issues),n.issues.length&&t.issues.push(...n.issues),bl(t))return t;const r=W_(e.value,n.value);if(!r.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return t.value=r.data,t}const sq=_e("$ZodTuple",(t,e)=>{Mt.init(t,e);const n=e.items,r=n.length-[...n].reverse().findIndex(i=>i._zod.optin!=="optional");t._zod.parse=(i,a)=>{const l=i.value;if(!Array.isArray(l))return i.issues.push({input:l,inst:t,expected:"tuple",code:"invalid_type"}),i;i.value=[];const c=[];if(!e.rest){const f=l.length>n.length,h=l.length<r-1;if(f||h)return i.issues.push({input:l,inst:t,origin:"array",...f?{code:"too_big",maximum:n.length}:{code:"too_small",minimum:n.length}}),i}let u=-1;for(const f of n){if(u++,u>=l.length&&u>=r)continue;const h=f._zod.run({value:l[u],issues:[]},a);h instanceof Promise?c.push(h.then(p=>Xd(p,i,u))):Xd(h,i,u)}if(e.rest){const f=l.slice(n.length);for(const h of f){u++;const p=e.rest._zod.run({value:h,issues:[]},a);p instanceof Promise?c.push(p.then(m=>Xd(m,i,u))):Xd(p,i,u)}}return c.length?Promise.all(c).then(()=>i):i}});function Xd(t,e,n){t.issues.length&&e.issues.push(...vi(n,t.issues)),e.value[n]=t.value}const UO=_e("$ZodRecord",(t,e)=>{Mt.init(t,e),t._zod.parse=(n,r)=>{const i=n.value;if(!pu(i))return n.issues.push({expected:"record",code:"invalid_type",input:i,inst:t}),n;const a=[];if(e.keyType._zod.values){const l=e.keyType._zod.values;n.value={};for(const u of l)if(typeof u=="string"||typeof u=="number"||typeof u=="symbol"){const f=e.valueType._zod.run({value:i[u],issues:[]},r);f instanceof Promise?a.push(f.then(h=>{h.issues.length&&n.issues.push(...vi(u,h.issues)),n.value[u]=h.value})):(f.issues.length&&n.issues.push(...vi(u,f.issues)),n.value[u]=f.value)}let c;for(const u in i)l.has(u)||(c=c??[],c.push(u));c&&c.length>0&&n.issues.push({code:"unrecognized_keys",input:i,inst:t,keys:c})}else{n.value={};for(const l of Reflect.ownKeys(i)){if(l==="__proto__")continue;const c=e.keyType._zod.run({value:l,issues:[]},r);if(c instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(c.issues.length){n.issues.push({origin:"record",code:"invalid_key",issues:c.issues.map(f=>Hi(f,r,ns())),input:l,path:[l],inst:t}),n.value[c.value]=c.value;continue}const u=e.valueType._zod.run({value:i[l],issues:[]},r);u instanceof Promise?a.push(u.then(f=>{f.issues.length&&n.issues.push(...vi(l,f.issues)),n.value[c.value]=f.value})):(u.issues.length&&n.issues.push(...vi(l,u.issues)),n.value[c.value]=u.value)}}return a.length?Promise.all(a).then(()=>n):n}}),aq=_e("$ZodMap",(t,e)=>{Mt.init(t,e),t._zod.parse=(n,r)=>{const i=n.value;if(!(i instanceof Map))return n.issues.push({expected:"map",code:"invalid_type",input:i,inst:t}),n;const a=[];n.value=new Map;for(const[l,c]of i){const u=e.keyType._zod.run({value:l,issues:[]},r),f=e.valueType._zod.run({value:c,issues:[]},r);u instanceof Promise||f instanceof Promise?a.push(Promise.all([u,f]).then(([h,p])=>{Ww(h,p,n,l,i,t,r)})):Ww(u,f,n,l,i,t,r)}return a.length?Promise.all(a).then(()=>n):n}});function Ww(t,e,n,r,i,a,l){t.issues.length&&(Lh.has(typeof r)?n.issues.push(...vi(r,t.issues)):n.issues.push({origin:"map",code:"invalid_key",input:i,inst:a,issues:t.issues.map(c=>Hi(c,l,ns()))})),e.issues.length&&(Lh.has(typeof r)?n.issues.push(...vi(r,e.issues)):n.issues.push({origin:"map",code:"invalid_element",input:i,inst:a,key:r,issues:e.issues.map(c=>Hi(c,l,ns()))})),n.value.set(t.value,e.value)}const oq=_e("$ZodSet",(t,e)=>{Mt.init(t,e),t._zod.parse=(n,r)=>{const i=n.value;if(!(i instanceof Set))return n.issues.push({input:i,inst:t,expected:"set",code:"invalid_type"}),n;const a=[];n.value=new Set;for(const l of i){const c=e.valueType._zod.run({value:l,issues:[]},r);c instanceof Promise?a.push(c.then(u=>qw(u,n))):qw(c,n)}return a.length?Promise.all(a).then(()=>n):n}});function qw(t,e){t.issues.length&&e.issues.push(...t.issues),e.value.add(t.value)}const FO=_e("$ZodEnum",(t,e)=>{Mt.init(t,e);const n=Jv(e.entries);t._zod.values=new Set(n),t._zod.pattern=new RegExp(`^(${n.filter(r=>Lh.has(typeof r)).map(r=>typeof r=="string"?yo(r):r.toString()).join("|")})$`),t._zod.parse=(r,i)=>{const a=r.value;return t._zod.values.has(a)||r.issues.push({code:"invalid_value",values:n,input:a,inst:t}),r}}),zO=_e("$ZodLiteral",(t,e)=>{Mt.init(t,e),t._zod.values=new Set(e.values),t._zod.pattern=new RegExp(`^(${e.values.map(n=>typeof n=="string"?yo(n):n?n.toString():String(n)).join("|")})$`),t._zod.parse=(n,r)=>{const i=n.value;return t._zod.values.has(i)||n.issues.push({code:"invalid_value",values:e.values,input:i,inst:t}),n}}),lq=_e("$ZodFile",(t,e)=>{Mt.init(t,e),t._zod.parse=(n,r)=>{const i=n.value;return i instanceof File||n.issues.push({expected:"file",code:"invalid_type",input:i,inst:t}),n}}),_R=_e("$ZodTransform",(t,e)=>{Mt.init(t,e),t._zod.parse=(n,r)=>{const i=e.transform(n.value,n);if(r.async)return(i instanceof Promise?i:Promise.resolve(i)).then(l=>(n.value=l,n));if(i instanceof Promise)throw new fu;return n.value=i,n}}),$O=_e("$ZodOptional",(t,e)=>{Mt.init(t,e),t._zod.optin="optional",t._zod.optout="optional",Zt(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),Zt(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${cp(n.source)})?$`):void 0}),t._zod.parse=(n,r)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(n,r):n.value===void 0?n:e.innerType._zod.run(n,r)}),BO=_e("$ZodNullable",(t,e)=>{Mt.init(t,e),Zt(t._zod,"optin",()=>e.innerType._zod.optin),Zt(t._zod,"optout",()=>e.innerType._zod.optout),Zt(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${cp(n.source)}|null)$`):void 0}),Zt(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(n,r)=>n.value===null?n:e.innerType._zod.run(n,r)}),VO=_e("$ZodDefault",(t,e)=>{Mt.init(t,e),t._zod.optin="optional",Zt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>{if(n.value===void 0)return n.value=e.defaultValue,n;const i=e.innerType._zod.run(n,r);return i instanceof Promise?i.then(a=>Zw(a,e)):Zw(i,e)}});function Zw(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const jO=_e("$ZodPrefault",(t,e)=>{Mt.init(t,e),t._zod.optin="optional",Zt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>(n.value===void 0&&(n.value=e.defaultValue),e.innerType._zod.run(n,r))}),HO=_e("$ZodNonOptional",(t,e)=>{Mt.init(t,e),Zt(t._zod,"values",()=>{const n=e.innerType._zod.values;return n?new Set([...n].filter(r=>r!==void 0)):void 0}),t._zod.parse=(n,r)=>{const i=e.innerType._zod.run(n,r);return i instanceof Promise?i.then(a=>Xw(a,t)):Xw(i,t)}});function Xw(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const cq=_e("$ZodSuccess",(t,e)=>{Mt.init(t,e),t._zod.parse=(n,r)=>{const i=e.innerType._zod.run(n,r);return i instanceof Promise?i.then(a=>(n.value=a.issues.length===0,n)):(n.value=i.issues.length===0,n)}}),GO=_e("$ZodCatch",(t,e)=>{Mt.init(t,e),t._zod.optin="optional",Zt(t._zod,"optout",()=>e.innerType._zod.optout),Zt(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>{const i=e.innerType._zod.run(n,r);return i instanceof Promise?i.then(a=>(n.value=a.value,a.issues.length&&(n.value=e.catchValue({...n,error:{issues:a.issues.map(l=>Hi(l,r,ns()))},input:n.value}),n.issues=[]),n)):(n.value=i.value,i.issues.length&&(n.value=e.catchValue({...n,error:{issues:i.issues.map(a=>Hi(a,r,ns()))},input:n.value}),n.issues=[]),n)}}),uq=_e("$ZodNaN",(t,e)=>{Mt.init(t,e),t._zod.parse=(n,r)=>((typeof n.value!="number"||!Number.isNaN(n.value))&&n.issues.push({input:n.value,inst:t,expected:"nan",code:"invalid_type"}),n)}),vR=_e("$ZodPipe",(t,e)=>{Mt.init(t,e),Zt(t._zod,"values",()=>e.in._zod.values),Zt(t._zod,"optin",()=>e.in._zod.optin),Zt(t._zod,"optout",()=>e.out._zod.optout),t._zod.parse=(n,r)=>{const i=e.in._zod.run(n,r);return i instanceof Promise?i.then(a=>Kw(a,e,r)):Kw(i,e,r)}});function Kw(t,e,n){return bl(t)?t:e.out._zod.run({value:t.value,issues:t.issues},n)}const WO=_e("$ZodReadonly",(t,e)=>{Mt.init(t,e),Zt(t._zod,"propValues",()=>e.innerType._zod.propValues),Zt(t._zod,"values",()=>e.innerType._zod.values),Zt(t._zod,"optin",()=>e.innerType._zod.optin),Zt(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(n,r)=>{const i=e.innerType._zod.run(n,r);return i instanceof Promise?i.then(Yw):Yw(i)}});function Yw(t){return t.value=Object.freeze(t.value),t}const dq=_e("$ZodTemplateLiteral",(t,e)=>{Mt.init(t,e);const n=[];for(const r of e.parts)if(r instanceof Mt){if(!r._zod.pattern)throw new Error(`Invalid template literal part, no pattern found: ${[...r._zod.traits].shift()}`);const i=r._zod.pattern instanceof RegExp?r._zod.pattern.source:r._zod.pattern;if(!i)throw new Error(`Invalid template literal part: ${r._zod.traits}`);const a=i.startsWith("^")?1:0,l=i.endsWith("$")?i.length-1:i.length;n.push(i.slice(a,l))}else if(r===null||pM.has(typeof r))n.push(yo(`${r}`));else throw new Error(`Invalid template literal part: ${r}`);t._zod.pattern=new RegExp(`^${n.join("")}$`),t._zod.parse=(r,i)=>typeof r.value!="string"?(r.issues.push({input:r.value,inst:t,expected:"template_literal",code:"invalid_type"}),r):(t._zod.pattern.lastIndex=0,t._zod.pattern.test(r.value)||r.issues.push({input:r.value,inst:t,code:"invalid_format",format:"template_literal",pattern:t._zod.pattern.source}),r)}),fq=_e("$ZodPromise",(t,e)=>{Mt.init(t,e),t._zod.parse=(n,r)=>Promise.resolve(n.value).then(i=>e.innerType._zod.run({value:i,issues:[]},r))}),hq=_e("$ZodLazy",(t,e)=>{Mt.init(t,e),Zt(t._zod,"innerType",()=>e.getter()),Zt(t._zod,"pattern",()=>t._zod.innerType._zod.pattern),Zt(t._zod,"propValues",()=>t._zod.innerType._zod.propValues),Zt(t._zod,"optin",()=>t._zod.innerType._zod.optin),Zt(t._zod,"optout",()=>t._zod.innerType._zod.optout),t._zod.parse=(n,r)=>t._zod.innerType._zod.run(n,r)}),qO=_e("$ZodCustom",(t,e)=>{Dn.init(t,e),Mt.init(t,e),t._zod.parse=(n,r)=>n,t._zod.check=n=>{const r=n.value,i=e.fn(r);if(i instanceof Promise)return i.then(a=>Jw(a,n,r,t));Jw(i,n,r,t)}});function Jw(t,e,n,r){if(!t){const i={code:"custom",input:n,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(i.params=r._zod.def.params),e.issues.push(Pl(i))}}const pq=Symbol("ZodOutput"),mq=Symbol("ZodInput");class yR{constructor(){this._map=new Map,this._idmap=new Map}add(e,...n){const r=n[0];if(this._map.set(e,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){const n=this._map.get(e);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(e),this}get(e){const n=e._zod.parent;if(n){const r={...this.get(n)??{}};return delete r.id,{...r,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}function ZO(){return new yR}const jc=ZO();function XO(t,e){return new t({type:"string",...Ne(e)})}function gq(t,e){return new t({type:"string",coerce:!0,...Ne(e)})}function KO(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...Ne(e)})}function Qw(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...Ne(e)})}function YO(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...Ne(e)})}function JO(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...Ne(e)})}function QO(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...Ne(e)})}function e2(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...Ne(e)})}function SR(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...Ne(e)})}function t2(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...Ne(e)})}function n2(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...Ne(e)})}function r2(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...Ne(e)})}function i2(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...Ne(e)})}function s2(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...Ne(e)})}function a2(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...Ne(e)})}function o2(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...Ne(e)})}function l2(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...Ne(e)})}function c2(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...Ne(e)})}function u2(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...Ne(e)})}function d2(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...Ne(e)})}function f2(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...Ne(e)})}function h2(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...Ne(e)})}function p2(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...Ne(e)})}function m2(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...Ne(e)})}const _q={Any:null,Minute:-1,Second:0,Millisecond:3,Microsecond:6};function g2(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...Ne(e)})}function _2(t,e){return new t({type:"string",format:"date",check:"string_format",...Ne(e)})}function v2(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...Ne(e)})}function y2(t,e){return new t({type:"string",format:"duration",check:"string_format",...Ne(e)})}function S2(t,e){return new t({type:"number",checks:[],...Ne(e)})}function w2(t,e){return new t({type:"number",coerce:!0,checks:[],...Ne(e)})}function x2(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...Ne(e)})}function vq(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"float32",...Ne(e)})}function yq(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"float64",...Ne(e)})}function Sq(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"int32",...Ne(e)})}function wq(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"uint32",...Ne(e)})}function E2(t,e){return new t({type:"boolean",...Ne(e)})}function xq(t,e){return new t({type:"boolean",coerce:!0,...Ne(e)})}function Eq(t,e){return new t({type:"bigint",...Ne(e)})}function bq(t,e){return new t({type:"bigint",coerce:!0,...Ne(e)})}function Tq(t,e){return new t({type:"bigint",check:"bigint_format",abort:!1,format:"int64",...Ne(e)})}function Mq(t,e){return new t({type:"bigint",check:"bigint_format",abort:!1,format:"uint64",...Ne(e)})}function Rq(t,e){return new t({type:"symbol",...Ne(e)})}function Cq(t,e){return new t({type:"undefined",...Ne(e)})}function b2(t,e){return new t({type:"null",...Ne(e)})}function T2(t){return new t({type:"any"})}function M2(t){return new t({type:"unknown"})}function R2(t,e){return new t({type:"never",...Ne(e)})}function Aq(t,e){return new t({type:"void",...Ne(e)})}function Pq(t,e){return new t({type:"date",...Ne(e)})}function Iq(t,e){return new t({type:"date",coerce:!0,...Ne(e)})}function Nq(t,e){return new t({type:"nan",...Ne(e)})}function q_(t,e){return new dR({check:"less_than",...Ne(e),value:t,inclusive:!1})}function ph(t,e){return new dR({check:"less_than",...Ne(e),value:t,inclusive:!0})}function Z_(t,e){return new fR({check:"greater_than",...Ne(e),value:t,inclusive:!1})}function mh(t,e){return new fR({check:"greater_than",...Ne(e),value:t,inclusive:!0})}function kq(t){return Z_(0,t)}function Lq(t){return q_(0,t)}function Oq(t){return ph(0,t)}function Dq(t){return mh(0,t)}function ex(t,e){return new DL({check:"multiple_of",...Ne(e),value:t})}function Uq(t,e){return new zL({check:"max_size",...Ne(e),maximum:t})}function Fq(t,e){return new $L({check:"min_size",...Ne(e),minimum:t})}function zq(t,e){return new BL({check:"size_equals",...Ne(e),size:t})}function wR(t,e){return new VL({check:"max_length",...Ne(e),maximum:t})}function Oh(t,e){return new jL({check:"min_length",...Ne(e),minimum:t})}function xR(t,e){return new HL({check:"length_equals",...Ne(e),length:t})}function C2(t,e){return new GL({check:"string_format",format:"regex",...Ne(e),pattern:t})}function A2(t){return new WL({check:"string_format",format:"lowercase",...Ne(t)})}function P2(t){return new qL({check:"string_format",format:"uppercase",...Ne(t)})}function I2(t,e){return new ZL({check:"string_format",format:"includes",...Ne(e),includes:t})}function N2(t,e){return new XL({check:"string_format",format:"starts_with",...Ne(e),prefix:t})}function k2(t,e){return new KL({check:"string_format",format:"ends_with",...Ne(e),suffix:t})}function $q(t,e,n){return new YL({check:"property",property:t,schema:e,...Ne(n)})}function Bq(t,e){return new JL({check:"mime_type",mime:t,...Ne(e)})}function bu(t){return new QL({check:"overwrite",tx:t})}function L2(t){return bu(e=>e.normalize(t))}function O2(){return bu(t=>t.trim())}function D2(){return bu(t=>t.toLowerCase())}function U2(){return bu(t=>t.toUpperCase())}function F2(t,e,n){return new t({type:"array",element:e,...Ne(n)})}function Vq(t,e,n){return new t({type:"union",options:e,...Ne(n)})}function jq(t,e,n,r){return new t({type:"union",options:n,discriminator:e,...Ne(r)})}function Hq(t,e,n){return new t({type:"intersection",left:e,right:n})}function Gq(t,e,n,r){const i=n instanceof Mt,a=i?r:n,l=i?n:null;return new t({type:"tuple",items:e,rest:l,...Ne(a)})}function Wq(t,e,n,r){return new t({type:"record",keyType:e,valueType:n,...Ne(r)})}function qq(t,e,n,r){return new t({type:"map",keyType:e,valueType:n,...Ne(r)})}function Zq(t,e,n){return new t({type:"set",valueType:e,...Ne(n)})}function Xq(t,e,n){const r=Array.isArray(e)?Object.fromEntries(e.map(i=>[i,i])):e;return new t({type:"enum",entries:r,...Ne(n)})}function Kq(t,e,n){return new t({type:"enum",entries:e,...Ne(n)})}function Yq(t,e,n){return new t({type:"literal",values:Array.isArray(e)?e:[e],...Ne(n)})}function Jq(t,e){return new t({type:"file",...Ne(e)})}function Qq(t,e){return new t({type:"transform",transform:e})}function e8(t,e){return new t({type:"optional",innerType:e})}function t8(t,e){return new t({type:"nullable",innerType:e})}function n8(t,e,n){return new t({type:"default",innerType:e,get defaultValue(){return typeof n=="function"?n():n}})}function r8(t,e,n){return new t({type:"nonoptional",innerType:e,...Ne(n)})}function i8(t,e){return new t({type:"success",innerType:e})}function s8(t,e,n){return new t({type:"catch",innerType:e,catchValue:typeof n=="function"?n:()=>n})}function a8(t,e,n){return new t({type:"pipe",in:e,out:n})}function o8(t,e){return new t({type:"readonly",innerType:e})}function l8(t,e,n){return new t({type:"template_literal",parts:e,...Ne(n)})}function c8(t,e){return new t({type:"lazy",getter:e})}function u8(t,e){return new t({type:"promise",innerType:e})}function z2(t,e,n){const r=Ne(n);return r.abort??(r.abort=!0),new t({type:"custom",check:"custom",fn:e,...r})}function $2(t,e,n){return new t({type:"custom",check:"custom",fn:e,...Ne(n)})}function d8(t,e){const n=Ne(e);let r=n.truthy??["true","1","yes","on","y","enabled"],i=n.falsy??["false","0","no","off","n","disabled"];n.case!=="sensitive"&&(r=r.map(S=>typeof S=="string"?S.toLowerCase():S),i=i.map(S=>typeof S=="string"?S.toLowerCase():S));const a=new Set(r),l=new Set(i),c=t.Pipe??vR,u=t.Boolean??mR,f=t.String??pp,h=t.Transform??_R,p=new h({type:"transform",transform:(S,E)=>{let g=S;return n.case!=="sensitive"&&(g=g.toLowerCase()),a.has(g)?!0:l.has(g)?!1:(E.issues.push({code:"invalid_value",expected:"stringbool",values:[...a,...l],input:E.value,inst:p}),{})},error:n.error}),m=new c({type:"pipe",in:new f({type:"string",error:n.error}),out:p,error:n.error});return new c({type:"pipe",in:m,out:new u({type:"boolean",error:n.error}),error:n.error})}function f8(t,e,n,r={}){const i=Ne(r),a={...Ne(r),check:"string_format",type:"string",format:e,fn:typeof n=="function"?n:c=>n.test(c),...i};return n instanceof RegExp&&(a.pattern=n),new t(a)}class tx{constructor(e){this.counter=0,this.metadataRegistry=e?.metadata??jc,this.target=e?.target??"draft-2020-12",this.unrepresentable=e?.unrepresentable??"throw",this.override=e?.override??(()=>{}),this.io=e?.io??"output",this.seen=new Map}process(e,n={path:[],schemaPath:[]}){var r;const i=e._zod.def,a={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},l=this.seen.get(e);if(l)return l.count++,n.schemaPath.includes(e)&&(l.cycle=n.path),l.schema;const c={schema:{},count:1,cycle:void 0,path:n.path};this.seen.set(e,c);const u=e._zod.toJSONSchema?.();if(u)c.schema=u;else{const p={...n,schemaPath:[...n.schemaPath,e],path:n.path},m=e._zod.parent;if(m)c.ref=m,this.process(m,p),this.seen.get(m).isParent=!0;else{const y=c.schema;switch(i.type){case"string":{const S=y;S.type="string";const{minimum:E,maximum:g,format:v,patterns:x,contentEncoding:w}=e._zod.bag;if(typeof E=="number"&&(S.minLength=E),typeof g=="number"&&(S.maxLength=g),v&&(S.format=a[v]??v,S.format===""&&delete S.format),w&&(S.contentEncoding=w),x&&x.size>0){const C=[...x];C.length===1?S.pattern=C[0].source:C.length>1&&(c.schema.allOf=[...C.map(T=>({...this.target==="draft-7"?{type:"string"}:{},pattern:T.source}))])}break}case"number":{const S=y,{minimum:E,maximum:g,format:v,multipleOf:x,exclusiveMaximum:w,exclusiveMinimum:C}=e._zod.bag;typeof v=="string"&&v.includes("int")?S.type="integer":S.type="number",typeof C=="number"&&(S.exclusiveMinimum=C),typeof E=="number"&&(S.minimum=E,typeof C=="number"&&(C>=E?delete S.minimum:delete S.exclusiveMinimum)),typeof w=="number"&&(S.exclusiveMaximum=w),typeof g=="number"&&(S.maximum=g,typeof w=="number"&&(w<=g?delete S.maximum:delete S.exclusiveMaximum)),typeof x=="number"&&(S.multipleOf=x);break}case"boolean":{const S=y;S.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{y.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{y.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{const S=y,{minimum:E,maximum:g}=e._zod.bag;typeof E=="number"&&(S.minItems=E),typeof g=="number"&&(S.maxItems=g),S.type="array",S.items=this.process(i.element,{...p,path:[...p.path,"items"]});break}case"object":{const S=y;S.type="object",S.properties={};const E=i.shape;for(const x in E)S.properties[x]=this.process(E[x],{...p,path:[...p.path,"properties",x]});const g=new Set(Object.keys(E)),v=new Set([...g].filter(x=>{const w=i.shape[x]._zod;return this.io==="input"?w.optin===void 0:w.optout===void 0}));v.size>0&&(S.required=Array.from(v)),i.catchall?._zod.def.type==="never"?S.additionalProperties=!1:i.catchall?i.catchall&&(S.additionalProperties=this.process(i.catchall,{...p,path:[...p.path,"additionalProperties"]})):this.io==="output"&&(S.additionalProperties=!1);break}case"union":{const S=y;S.anyOf=i.options.map((E,g)=>this.process(E,{...p,path:[...p.path,"anyOf",g]}));break}case"intersection":{const S=y,E=this.process(i.left,{...p,path:[...p.path,"allOf",0]}),g=this.process(i.right,{...p,path:[...p.path,"allOf",1]}),v=w=>"allOf"in w&&Object.keys(w).length===1,x=[...v(E)?E.allOf:[E],...v(g)?g.allOf:[g]];S.allOf=x;break}case"tuple":{const S=y;S.type="array";const E=i.items.map((x,w)=>this.process(x,{...p,path:[...p.path,"prefixItems",w]}));if(this.target==="draft-2020-12"?S.prefixItems=E:S.items=E,i.rest){const x=this.process(i.rest,{...p,path:[...p.path,"items"]});this.target==="draft-2020-12"?S.items=x:S.additionalItems=x}i.rest&&(S.items=this.process(i.rest,{...p,path:[...p.path,"items"]}));const{minimum:g,maximum:v}=e._zod.bag;typeof g=="number"&&(S.minItems=g),typeof v=="number"&&(S.maxItems=v);break}case"record":{const S=y;S.type="object",S.propertyNames=this.process(i.keyType,{...p,path:[...p.path,"propertyNames"]}),S.additionalProperties=this.process(i.valueType,{...p,path:[...p.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{const S=y,E=Jv(i.entries);E.every(g=>typeof g=="number")&&(S.type="number"),E.every(g=>typeof g=="string")&&(S.type="string"),S.enum=E;break}case"literal":{const S=y,E=[];for(const g of i.values)if(g===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof g=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");E.push(Number(g))}else E.push(g);if(E.length!==0)if(E.length===1){const g=E[0];S.type=g===null?"null":typeof g,S.const=g}else E.every(g=>typeof g=="number")&&(S.type="number"),E.every(g=>typeof g=="string")&&(S.type="string"),E.every(g=>typeof g=="boolean")&&(S.type="string"),E.every(g=>g===null)&&(S.type="null"),S.enum=E;break}case"file":{const S=y,E={type:"string",format:"binary",contentEncoding:"binary"},{minimum:g,maximum:v,mime:x}=e._zod.bag;g!==void 0&&(E.minLength=g),v!==void 0&&(E.maxLength=v),x?x.length===1?(E.contentMediaType=x[0],Object.assign(S,E)):S.anyOf=x.map(w=>({...E,contentMediaType:w})):Object.assign(S,E);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{const S=this.process(i.innerType,p);y.anyOf=[S,{type:"null"}];break}case"nonoptional":{this.process(i.innerType,p),c.ref=i.innerType;break}case"success":{const S=y;S.type="boolean";break}case"default":{this.process(i.innerType,p),c.ref=i.innerType,y.default=JSON.parse(JSON.stringify(i.defaultValue));break}case"prefault":{this.process(i.innerType,p),c.ref=i.innerType,this.io==="input"&&(y._prefault=JSON.parse(JSON.stringify(i.defaultValue)));break}case"catch":{this.process(i.innerType,p),c.ref=i.innerType;let S;try{S=i.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}y.default=S;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{const S=y,E=e._zod.pattern;if(!E)throw new Error("Pattern not found in template literal");S.type="string",S.pattern=E.source;break}case"pipe":{const S=this.io==="input"?i.in._zod.def.type==="transform"?i.out:i.in:i.out;this.process(S,p),c.ref=S;break}case"readonly":{this.process(i.innerType,p),c.ref=i.innerType,y.readOnly=!0;break}case"promise":{this.process(i.innerType,p),c.ref=i.innerType;break}case"optional":{this.process(i.innerType,p),c.ref=i.innerType;break}case"lazy":{const S=e._zod.innerType;this.process(S,p),c.ref=S;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}}}}const f=this.metadataRegistry.get(e);return f&&Object.assign(c.schema,f),this.io==="input"&&Bn(e)&&(delete c.schema.examples,delete c.schema.default),this.io==="input"&&c.schema._prefault&&((r=c.schema).default??(r.default=c.schema._prefault)),delete c.schema._prefault,this.seen.get(e).schema}emit(e,n){const r={cycles:n?.cycles??"ref",reused:n?.reused??"inline",external:n?.external??void 0},i=this.seen.get(e);if(!i)throw new Error("Unprocessed schema. This is a bug in Zod.");const a=h=>{const p=this.target==="draft-2020-12"?"$defs":"definitions";if(r.external){const E=r.external.registry.get(h[0])?.id,g=r.external.uri??(x=>x);if(E)return{ref:g(E)};const v=h[1].defId??h[1].schema.id??`schema${this.counter++}`;return h[1].defId=v,{defId:v,ref:`${g("__shared")}#/${p}/${v}`}}if(h[1]===i)return{ref:"#"};const y=`#/${p}/`,S=h[1].schema.id??`__schema${this.counter++}`;return{defId:S,ref:y+S}},l=h=>{if(h[1].schema.$ref)return;const p=h[1],{ref:m,defId:y}=a(h);p.def={...p.schema},y&&(p.defId=y);const S=p.schema;for(const E in S)delete S[E];S.$ref=m};if(r.cycles==="throw")for(const h of this.seen.entries()){const p=h[1];if(p.cycle)throw new Error(`Cycle detected: #/${p.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const h of this.seen.entries()){const p=h[1];if(e===h[0]){l(h);continue}if(r.external){const y=r.external.registry.get(h[0])?.id;if(e!==h[0]&&y){l(h);continue}}if(this.metadataRegistry.get(h[0])?.id){l(h);continue}if(p.cycle){l(h);continue}if(p.count>1&&r.reused==="ref"){l(h);continue}}const c=(h,p)=>{const m=this.seen.get(h),y=m.def??m.schema,S={...y};if(m.ref===null)return;const E=m.ref;if(m.ref=null,E){c(E,p);const g=this.seen.get(E).schema;g.$ref&&p.target==="draft-7"?(y.allOf=y.allOf??[],y.allOf.push(g)):(Object.assign(y,g),Object.assign(y,S))}m.isParent||this.override({zodSchema:h,jsonSchema:y,path:m.path??[]})};for(const h of[...this.seen.entries()].reverse())c(h[0],{target:this.target});const u={};if(this.target==="draft-2020-12"?u.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?u.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),r.external?.uri){const h=r.external.registry.get(e)?.id;if(!h)throw new Error("Schema is missing an `id` property");u.$id=r.external.uri(h)}Object.assign(u,i.def);const f=r.external?.defs??{};for(const h of this.seen.entries()){const p=h[1];p.def&&p.defId&&(f[p.defId]=p.def)}r.external||Object.keys(f).length>0&&(this.target==="draft-2020-12"?u.$defs=f:u.definitions=f);try{return JSON.parse(JSON.stringify(u))}catch{throw new Error("Error converting schema to JSON.")}}}function B2(t,e){if(t instanceof yR){const r=new tx(e),i={};for(const c of t._idmap.entries()){const[u,f]=c;r.process(f)}const a={},l={registry:t,uri:e?.uri,defs:i};for(const c of t._idmap.entries()){const[u,f]=c;a[u]=r.emit(f,{...e,external:l})}if(Object.keys(i).length>0){const c=r.target==="draft-2020-12"?"$defs":"definitions";a.__shared={[c]:i}}return{schemas:a}}const n=new tx(e);return n.process(t),n.emit(t,e)}function Bn(t,e){const n=e??{seen:new Set};if(n.seen.has(t))return!1;n.seen.add(t);const i=t._zod.def;switch(i.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return Bn(i.element,n);case"object":{for(const a in i.shape)if(Bn(i.shape[a],n))return!0;return!1}case"union":{for(const a of i.options)if(Bn(a,n))return!0;return!1}case"intersection":return Bn(i.left,n)||Bn(i.right,n);case"tuple":{for(const a of i.items)if(Bn(a,n))return!0;return!!(i.rest&&Bn(i.rest,n))}case"record":return Bn(i.keyType,n)||Bn(i.valueType,n);case"map":return Bn(i.keyType,n)||Bn(i.valueType,n);case"set":return Bn(i.valueType,n);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return Bn(i.innerType,n);case"lazy":return Bn(i.getter(),n);case"default":return Bn(i.innerType,n);case"prefault":return Bn(i.innerType,n);case"custom":return!1;case"transform":return!0;case"pipe":return Bn(i.in,n)||Bn(i.out,n);case"success":return!1;case"catch":return!1}throw new Error(`Unknown schema type: ${i.type}`)}const V2=_e("ZodISODateTime",(t,e)=>{hO.init(t,e),Tn.init(t,e)});function ER(t){return g2(V2,t)}const j2=_e("ZodISODate",(t,e)=>{pO.init(t,e),Tn.init(t,e)});function H2(t){return _2(j2,t)}const G2=_e("ZodISOTime",(t,e)=>{mO.init(t,e),Tn.init(t,e)});function W2(t){return v2(G2,t)}const q2=_e("ZodISODuration",(t,e)=>{gO.init(t,e),Tn.init(t,e)});function Z2(t){return y2(q2,t)}const X2=(t,e)=>{MM.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:n=>bL(t,n)},flatten:{value:n=>EL(t,n)},addIssue:{value:n=>t.issues.push(n)},addIssues:{value:n=>t.issues.push(...n)},isEmpty:{get(){return t.issues.length===0}}})},mp=_e("ZodError",X2,{Parent:Error}),K2=RM(mp),Y2=CM(mp),J2=AM(mp),Q2=IM(mp),wn=_e("ZodType",(t,e)=>(Mt.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...n)=>t.clone({...e,checks:[...e.checks??[],...n.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]}),t.clone=(n,r)=>Ea(t,n,r),t.brand=()=>t,t.register=((n,r)=>(n.add(t,r),t)),t.parse=(n,r)=>K2(t,n,r,{callee:t.parse}),t.safeParse=(n,r)=>J2(t,n,r),t.parseAsync=async(n,r)=>Y2(t,n,r,{callee:t.parseAsync}),t.safeParseAsync=async(n,r)=>Q2(t,n,r),t.spa=t.safeParseAsync,t.refine=(n,r)=>t.check(GD(n,r)),t.superRefine=n=>t.check(WD(n)),t.overwrite=n=>t.check(bu(n)),t.optional=()=>An(t),t.nullable=()=>ix(t),t.nullish=()=>An(ix(t)),t.nonoptional=n=>UD(t,n),t.array=()=>Fe(t),t.or=n=>an([t,n]),t.and=n=>ny(t,n),t.transform=n=>K_(t,PR(n)),t.default=n=>LD(t,n),t.prefault=n=>DD(t,n),t.catch=n=>zD(t,n),t.pipe=n=>K_(t,n),t.readonly=()=>VD(t),t.describe=n=>{const r=t.clone();return jc.add(r,{description:n}),r},Object.defineProperty(t,"description",{get(){return jc.get(t)?.description},configurable:!0}),t.meta=(...n)=>{if(n.length===0)return jc.get(t);const r=t.clone();return jc.add(r,n[0]),r},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),bR=_e("_ZodString",(t,e)=>{pp.init(t,e),wn.init(t,e);const n=t._zod.bag;t.format=n.format??null,t.minLength=n.minimum??null,t.maxLength=n.maximum??null,t.regex=(...r)=>t.check(C2(...r)),t.includes=(...r)=>t.check(I2(...r)),t.startsWith=(...r)=>t.check(N2(...r)),t.endsWith=(...r)=>t.check(k2(...r)),t.min=(...r)=>t.check(Oh(...r)),t.max=(...r)=>t.check(wR(...r)),t.length=(...r)=>t.check(xR(...r)),t.nonempty=(...r)=>t.check(Oh(1,...r)),t.lowercase=r=>t.check(A2(r)),t.uppercase=r=>t.check(P2(r)),t.trim=()=>t.check(O2()),t.normalize=(...r)=>t.check(L2(...r)),t.toLowerCase=()=>t.check(D2()),t.toUpperCase=()=>t.check(U2())}),eD=_e("ZodString",(t,e)=>{pp.init(t,e),bR.init(t,e),t.email=n=>t.check(KO(tD,n)),t.url=n=>t.check(SR(TR,n)),t.jwt=n=>t.check(m2(_D,n)),t.emoji=n=>t.check(t2(rD,n)),t.guid=n=>t.check(Qw(nx,n)),t.uuid=n=>t.check(YO(Kd,n)),t.uuidv4=n=>t.check(JO(Kd,n)),t.uuidv6=n=>t.check(QO(Kd,n)),t.uuidv7=n=>t.check(e2(Kd,n)),t.nanoid=n=>t.check(n2(iD,n)),t.guid=n=>t.check(Qw(nx,n)),t.cuid=n=>t.check(r2(sD,n)),t.cuid2=n=>t.check(i2(aD,n)),t.ulid=n=>t.check(s2(oD,n)),t.base64=n=>t.check(f2(pD,n)),t.base64url=n=>t.check(h2(mD,n)),t.xid=n=>t.check(a2(lD,n)),t.ksuid=n=>t.check(o2(cD,n)),t.ipv4=n=>t.check(l2(uD,n)),t.ipv6=n=>t.check(c2(dD,n)),t.cidrv4=n=>t.check(u2(fD,n)),t.cidrv6=n=>t.check(d2(hD,n)),t.e164=n=>t.check(p2(gD,n)),t.datetime=n=>t.check(ER(n)),t.date=n=>t.check(H2(n)),t.time=n=>t.check(W2(n)),t.duration=n=>t.check(Z2(n))});function ee(t){return XO(eD,t)}const Tn=_e("ZodStringFormat",(t,e)=>{gn.init(t,e),bR.init(t,e)}),tD=_e("ZodEmail",(t,e)=>{iO.init(t,e),Tn.init(t,e)}),nx=_e("ZodGUID",(t,e)=>{nO.init(t,e),Tn.init(t,e)}),Kd=_e("ZodUUID",(t,e)=>{rO.init(t,e),Tn.init(t,e)}),TR=_e("ZodURL",(t,e)=>{sO.init(t,e),Tn.init(t,e)});function nD(t){return SR(TR,t)}const rD=_e("ZodEmoji",(t,e)=>{aO.init(t,e),Tn.init(t,e)}),iD=_e("ZodNanoID",(t,e)=>{oO.init(t,e),Tn.init(t,e)}),sD=_e("ZodCUID",(t,e)=>{lO.init(t,e),Tn.init(t,e)}),aD=_e("ZodCUID2",(t,e)=>{cO.init(t,e),Tn.init(t,e)}),oD=_e("ZodULID",(t,e)=>{uO.init(t,e),Tn.init(t,e)}),lD=_e("ZodXID",(t,e)=>{dO.init(t,e),Tn.init(t,e)}),cD=_e("ZodKSUID",(t,e)=>{fO.init(t,e),Tn.init(t,e)}),uD=_e("ZodIPv4",(t,e)=>{_O.init(t,e),Tn.init(t,e)}),dD=_e("ZodIPv6",(t,e)=>{vO.init(t,e),Tn.init(t,e)}),fD=_e("ZodCIDRv4",(t,e)=>{yO.init(t,e),Tn.init(t,e)}),hD=_e("ZodCIDRv6",(t,e)=>{SO.init(t,e),Tn.init(t,e)}),pD=_e("ZodBase64",(t,e)=>{wO.init(t,e),Tn.init(t,e)}),mD=_e("ZodBase64URL",(t,e)=>{EO.init(t,e),Tn.init(t,e)}),gD=_e("ZodE164",(t,e)=>{bO.init(t,e),Tn.init(t,e)}),_D=_e("ZodJWT",(t,e)=>{MO.init(t,e),Tn.init(t,e)}),ty=_e("ZodNumber",(t,e)=>{pR.init(t,e),wn.init(t,e),t.gt=(r,i)=>t.check(Z_(r,i)),t.gte=(r,i)=>t.check(mh(r,i)),t.min=(r,i)=>t.check(mh(r,i)),t.lt=(r,i)=>t.check(q_(r,i)),t.lte=(r,i)=>t.check(ph(r,i)),t.max=(r,i)=>t.check(ph(r,i)),t.int=r=>t.check(rx(r)),t.safe=r=>t.check(rx(r)),t.positive=r=>t.check(Z_(0,r)),t.nonnegative=r=>t.check(mh(0,r)),t.negative=r=>t.check(q_(0,r)),t.nonpositive=r=>t.check(ph(0,r)),t.multipleOf=(r,i)=>t.check(ex(r,i)),t.step=(r,i)=>t.check(ex(r,i)),t.finite=()=>t;const n=t._zod.bag;t.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),t.isFinite=!0,t.format=n.format??null});function Kt(t){return S2(ty,t)}const vD=_e("ZodNumberFormat",(t,e)=>{RO.init(t,e),ty.init(t,e)});function rx(t){return x2(vD,t)}const yD=_e("ZodBoolean",(t,e)=>{mR.init(t,e),wn.init(t,e)});function dn(t){return E2(yD,t)}const SD=_e("ZodNull",(t,e)=>{AO.init(t,e),wn.init(t,e)});function MR(t){return b2(SD,t)}const wD=_e("ZodAny",(t,e)=>{PO.init(t,e),wn.init(t,e)});function xD(){return T2(wD)}const ED=_e("ZodUnknown",(t,e)=>{IO.init(t,e),wn.init(t,e)});function rn(){return M2(ED)}const bD=_e("ZodNever",(t,e)=>{NO.init(t,e),wn.init(t,e)});function TD(t){return R2(bD,t)}const MD=_e("ZodArray",(t,e)=>{kO.init(t,e),wn.init(t,e),t.element=e.element,t.min=(n,r)=>t.check(Oh(n,r)),t.nonempty=n=>t.check(Oh(1,n)),t.max=(n,r)=>t.check(wR(n,r)),t.length=(n,r)=>t.check(xR(n,r)),t.unwrap=()=>t.element});function Fe(t,e){return F2(MD,t,e)}const RR=_e("ZodObject",(t,e)=>{LO.init(t,e),wn.init(t,e),Zt(t,"shape",()=>e.shape),t.keyof=()=>ri(Object.keys(t._zod.def.shape)),t.catchall=n=>t.clone({...t._zod.def,catchall:n}),t.passthrough=()=>t.clone({...t._zod.def,catchall:rn()}),t.loose=()=>t.clone({...t._zod.def,catchall:rn()}),t.strict=()=>t.clone({...t._zod.def,catchall:TD()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=n=>wM(t,n),t.merge=n=>xM(t,n),t.pick=n=>yM(t,n),t.omit=n=>SM(t,n),t.partial=(...n)=>EM(IR,t,n[0]),t.required=(...n)=>bM(NR,t,n[0])});function je(t,e){const n={type:"object",get shape(){return Eu(this,"shape",{...t}),this.shape},...Ne(e)};return new RR(n)}function Kn(t,e){return new RR({type:"object",get shape(){return Eu(this,"shape",{...t}),this.shape},catchall:rn(),...Ne(e)})}const CR=_e("ZodUnion",(t,e)=>{gR.init(t,e),wn.init(t,e),t.options=e.options});function an(t,e){return new CR({type:"union",options:t,...Ne(e)})}const RD=_e("ZodDiscriminatedUnion",(t,e)=>{CR.init(t,e),OO.init(t,e)});function AR(t,e,n){return new RD({type:"union",options:e,discriminator:t,...Ne(n)})}const CD=_e("ZodIntersection",(t,e)=>{DO.init(t,e),wn.init(t,e)});function ny(t,e){return new CD({type:"intersection",left:t,right:e})}const AD=_e("ZodRecord",(t,e)=>{UO.init(t,e),wn.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function Sn(t,e,n){return new AD({type:"record",keyType:t,valueType:e,...Ne(n)})}const X_=_e("ZodEnum",(t,e)=>{FO.init(t,e),wn.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);const n=new Set(Object.keys(e.entries));t.extract=(r,i)=>{const a={};for(const l of r)if(n.has(l))a[l]=e.entries[l];else throw new Error(`Key ${l} not found in enum`);return new X_({...e,checks:[],...Ne(i),entries:a})},t.exclude=(r,i)=>{const a={...e.entries};for(const l of r)if(n.has(l))delete a[l];else throw new Error(`Key ${l} not found in enum`);return new X_({...e,checks:[],...Ne(i),entries:a})}});function ri(t,e){const n=Array.isArray(t)?Object.fromEntries(t.map(r=>[r,r])):t;return new X_({type:"enum",entries:n,...Ne(e)})}const PD=_e("ZodLiteral",(t,e)=>{zO.init(t,e),wn.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function Ge(t,e){return new PD({type:"literal",values:Array.isArray(t)?t:[t],...Ne(e)})}const ID=_e("ZodTransform",(t,e)=>{_R.init(t,e),wn.init(t,e),t._zod.parse=(n,r)=>{n.addIssue=a=>{if(typeof a=="string")n.issues.push(Pl(a,n.value,e));else{const l=a;l.fatal&&(l.continue=!1),l.code??(l.code="custom"),l.input??(l.input=n.value),l.inst??(l.inst=t),l.continue??(l.continue=!0),n.issues.push(Pl(l))}};const i=e.transform(n.value,n);return i instanceof Promise?i.then(a=>(n.value=a,n)):(n.value=i,n)}});function PR(t){return new ID({type:"transform",transform:t})}const IR=_e("ZodOptional",(t,e)=>{$O.init(t,e),wn.init(t,e),t.unwrap=()=>t._zod.def.innerType});function An(t){return new IR({type:"optional",innerType:t})}const ND=_e("ZodNullable",(t,e)=>{BO.init(t,e),wn.init(t,e),t.unwrap=()=>t._zod.def.innerType});function ix(t){return new ND({type:"nullable",innerType:t})}const kD=_e("ZodDefault",(t,e)=>{VO.init(t,e),wn.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function LD(t,e){return new kD({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}const OD=_e("ZodPrefault",(t,e)=>{jO.init(t,e),wn.init(t,e),t.unwrap=()=>t._zod.def.innerType});function DD(t,e){return new OD({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}const NR=_e("ZodNonOptional",(t,e)=>{HO.init(t,e),wn.init(t,e),t.unwrap=()=>t._zod.def.innerType});function UD(t,e){return new NR({type:"nonoptional",innerType:t,...Ne(e)})}const FD=_e("ZodCatch",(t,e)=>{GO.init(t,e),wn.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function zD(t,e){return new FD({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const $D=_e("ZodPipe",(t,e)=>{vR.init(t,e),wn.init(t,e),t.in=e.in,t.out=e.out});function K_(t,e){return new $D({type:"pipe",in:t,out:e})}const BD=_e("ZodReadonly",(t,e)=>{WO.init(t,e),wn.init(t,e)});function VD(t){return new BD({type:"readonly",innerType:t})}const kR=_e("ZodCustom",(t,e)=>{qO.init(t,e),wn.init(t,e)});function jD(t){const e=new Dn({check:"custom"});return e._zod.check=t,e}function HD(t,e){return z2(kR,t??(()=>!0),e)}function GD(t,e={}){return $2(kR,t,e)}function WD(t){const e=jD(n=>(n.addIssue=r=>{if(typeof r=="string")n.issues.push(Pl(r,n.value,e._zod.def));else{const i=r;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=n.value),i.inst??(i.inst=e),i.continue??(i.continue=!e._zod.def.abort),n.issues.push(Pl(i))}},t(n.value,n)));return e}function LR(t,e){return K_(PR(t),e)}const qD={custom:"custom"};function ZD(t){return w2(ty,t)}const XD=an([Ge("object"),Ge("array"),Ge("string"),Ge("number"),Ge("integer"),Ge("boolean"),Ge("null"),Fe(an([Ge("object"),Ge("array"),Ge("string"),Ge("number"),Ge("integer"),Ge("boolean"),Ge("null")]))]),KD=Kn({type:XD.optional(),properties:Sn(ee(),rn()).optional(),items:an([Fe(rn()),rn()]).optional(),required:Fe(ee()).optional(),additionalProperties:an([dn(),rn()]).optional(),enum:Fe(rn()).optional(),const:rn().optional(),$ref:ee().optional(),$id:ee().optional(),$schema:ee().optional(),title:ee().optional(),description:ee().optional()}).refine(t=>t.type!==void 0||t.properties!==void 0||t.items!==void 0||t.enum!==void 0||t.const!==void 0||t.$ref!==void 0);function ry(t){return t===null||typeof t!="object"?!1:KD.safeParse(t).success}function sx(t){const{required:e,...n}=t;return n}const YD="modulepreload",JD=function(t){return"/TrendPulse/"+t},ax={},Ho=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let u=function(f){return Promise.all(f.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");i=u(n.map(f=>{if(f=JD(f),f in ax)return;ax[f]=!0;const h=f.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":YD,h||(m.as="script"),m.crossOrigin="",m.href=f,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((y,S)=>{m.addEventListener("load",y),m.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return i.then(l=>{for(const c of l||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})},OR=Symbol.for("quansync.getIsAsync");class DR extends Error{constructor(e="Unexpected promise in sync context"){super(e),this.name="QuansyncError"}}function iy(t){return t&&typeof t=="object"&&typeof t.then=="function"}function QD(t){return t&&typeof t=="object"&&typeof t[Symbol.iterator]=="function"&&"__quansync"in t}function sy(t){const e=function*(...r){return(yield OR)?yield t.async.apply(this,r):t.sync.apply(this,r)};function n(...r){const i=e.apply(this,r);return i.then=(...a)=>t.async.apply(this,r).then(...a),i.__quansync=!0,i}return n.sync=t.sync,n.async=t.async,n}function eU(t){return sy({async:()=>Promise.resolve(t),sync:()=>{if(iy(t))throw new DR;return t}})}function Y_(t,e){if(t===OR)return e;if(QD(t))return e?zR(t):FR(t);if(!e&&iy(t))throw new DR;return t}const UR=t=>t;function FR(t,e=UR){let n=t.next();for(;!n.done;)try{n=t.next(Y_(e(n.value,!1)))}catch(r){n=t.throw(r)}return Y_(n.value)}async function zR(t,e=UR){let n=t.next();for(;!n.done;)try{n=t.next(await Y_(e(n.value,!0),!0))}catch(r){n=t.throw(r)}return n.value}function tU(t,e){return sy({name:t.name,async(...n){return zR(t.apply(this,n),e?.onYield)},sync(...n){return FR(t.apply(this,n),e?.onYield)}})}function $R(t,e){return iy(t)?eU(t):typeof t=="function"?tU(t,e):sy(t)}$R({async:()=>Promise.resolve(!0),sync:()=>!1});const Dh=new Map;class BR extends Error{constructor(e){super(`standard-json: Unsupported schema vendor "${e}".`)}}class h8 extends Error{constructor(e){super(`standard-json: Missing dependencies "${e}".`)}}const nU=async t=>{const e=Dh.get(t);if(e)return e;let n;switch(t){case"arktype":n=(await Ho(async()=>{const{default:i}=await import("./arktype-aI7TBD0R-Dg-cTJfT.js");return{default:i}},[])).default();break;case"effect":n=(await Ho(async()=>{const{default:i}=await import("./effect-QlVUlMFu-PQf_gZ5v.js");return{default:i}},[])).default();break;case"sury":n=(await Ho(async()=>{const{default:i}=await import("./sury-CWZTCd75-BAA2FT_k.js");return{default:i}},[])).default();break;case"typebox":n=(await Ho(async()=>{const{default:i}=await import("./typebox-Dei93FPO-DVTFrS1_.js");return{default:i}},[])).default();break;case"valibot":n=(await Ho(async()=>{const{default:i}=await import("./valibot--1zFm7rT-CT0pEYqF.js");return{default:i}},[])).default();break;case"zod":n=(await Ho(async()=>{const{default:i}=await import("./zod-Bwrt9trS-C6IOVgU7.js");return{default:i}},[])).default();break;default:throw new BR(t)}const r=await n;return Dh.set(t,r),r},rU=$R({sync:(t,e)=>{const n=t["~standard"].vendor,r=Dh.get(n);if(!r)throw new BR(n);return r(t,e)},async:async(t,e)=>(await nU(t["~standard"].vendor))(t,e)});function iU(t,e){Dh.set(t,e)}const sU=Symbol("Let zodToJsonSchema decide on which parser to use"),p8=(t,e)=>{if(e.description)try{return{...t,...JSON.parse(e.description)}}catch{}return t},ox={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},aU=t=>typeof t=="string"?{...ox,name:t}:{...ox,...t},oU=t=>{const e=aU(t),n=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,i])=>[i._def,{def:i._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function VR(t,e,n,r){r?.errorMessages&&n&&(t.errorMessage={...t.errorMessage,[e]:n})}function tn(t,e,n,r,i){t[e]=n,VR(t,e,r,i)}const jR=(t,e)=>{let n=0;for(;n<t.length&&n<e.length&&t[n]===e[n];n++);return[(t.length-n).toString(),...e.slice(n)].join("/")};function Hr(t){if(t.target!=="openAi")return{};const e=[...t.basePath,t.definitionPath,t.openAiAnyTypeName];return t.flags.hasReferencedOpenAiAnyType=!0,{$ref:t.$refStrategy==="relative"?jR(e,t.currentPath):e.join("/")}}function lU(t,e){const n={type:"array"};return t.type?._def&&t.type?._def?.typeName!==Oe.ZodAny&&(n.items=Xt(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&tn(n,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&tn(n,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(tn(n,"minItems",t.exactLength.value,t.exactLength.message,e),tn(n,"maxItems",t.exactLength.value,t.exactLength.message,e)),n}function cU(t,e){const n={type:"integer",format:"int64"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?tn(n,"minimum",r.value,r.message,e):tn(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),tn(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?tn(n,"maximum",r.value,r.message,e):tn(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),tn(n,"maximum",r.value,r.message,e));break;case"multipleOf":tn(n,"multipleOf",r.value,r.message,e);break}return n}function uU(){return{type:"boolean"}}function HR(t,e){return Xt(t.type._def,e)}const dU=(t,e)=>Xt(t.innerType._def,e);function GR(t,e,n){const r=n??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((i,a)=>GR(t,e,i))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return fU(t,e)}}const fU=(t,e)=>{const n={type:"integer",format:"unix-time"};if(e.target==="openApi3")return n;for(const r of t.checks)switch(r.kind){case"min":tn(n,"minimum",r.value,r.message,e);break;case"max":tn(n,"maximum",r.value,r.message,e);break}return n};function hU(t,e){return{...Xt(t.innerType._def,e),default:t.defaultValue()}}function pU(t,e){return e.effectStrategy==="input"?Xt(t.schema._def,e):Hr(e)}function mU(t){return{type:"string",enum:Array.from(t.values)}}const gU=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function _U(t,e){const n=[Xt(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Xt(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const i=[];return n.forEach(a=>{if(gU(a))i.push(...a.allOf),a.unevaluatedProperties===void 0&&(r=void 0);else{let l=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:c,...u}=a;l=u}else r=void 0;i.push(l)}}),i.length?{allOf:i,...r}:void 0}function vU(t,e){const n=typeof t.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[t.value]}:{type:n==="bigint"?"integer":n,const:t.value}}let Mg;const Pi={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Mg===void 0&&(Mg=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Mg),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function WR(t,e){const n={type:"string"};if(t.checks)for(const r of t.checks)switch(r.kind){case"min":tn(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,e);break;case"max":tn(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Ii(n,"email",r.message,e);break;case"format:idn-email":Ii(n,"idn-email",r.message,e);break;case"pattern:zod":Er(n,Pi.email,r.message,e);break}break;case"url":Ii(n,"uri",r.message,e);break;case"uuid":Ii(n,"uuid",r.message,e);break;case"regex":Er(n,r.regex,r.message,e);break;case"cuid":Er(n,Pi.cuid,r.message,e);break;case"cuid2":Er(n,Pi.cuid2,r.message,e);break;case"startsWith":Er(n,RegExp(`^${Rg(r.value,e)}`),r.message,e);break;case"endsWith":Er(n,RegExp(`${Rg(r.value,e)}$`),r.message,e);break;case"datetime":Ii(n,"date-time",r.message,e);break;case"date":Ii(n,"date",r.message,e);break;case"time":Ii(n,"time",r.message,e);break;case"duration":Ii(n,"duration",r.message,e);break;case"length":tn(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,e),tn(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,e);break;case"includes":{Er(n,RegExp(Rg(r.value,e)),r.message,e);break}case"ip":{r.version!=="v6"&&Ii(n,"ipv4",r.message,e),r.version!=="v4"&&Ii(n,"ipv6",r.message,e);break}case"base64url":Er(n,Pi.base64url,r.message,e);break;case"jwt":Er(n,Pi.jwt,r.message,e);break;case"cidr":{r.version!=="v6"&&Er(n,Pi.ipv4Cidr,r.message,e),r.version!=="v4"&&Er(n,Pi.ipv6Cidr,r.message,e);break}case"emoji":Er(n,Pi.emoji(),r.message,e);break;case"ulid":{Er(n,Pi.ulid,r.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Ii(n,"binary",r.message,e);break}case"contentEncoding:base64":{tn(n,"contentEncoding","base64",r.message,e);break}case"pattern:zod":{Er(n,Pi.base64,r.message,e);break}}break}case"nanoid":Er(n,Pi.nanoid,r.message,e)}return n}function Rg(t,e){return e.patternStrategy==="escape"?SU(t):t}const yU=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function SU(t){let e="";for(let n=0;n<t.length;n++)yU.has(t[n])||(e+="\\"),e+=t[n];return e}function Ii(t,e,n,r){t.format||t.anyOf?.some(i=>i.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&r.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...n&&r.errorMessages&&{errorMessage:{format:n}}})):tn(t,"format",e,n,r)}function Er(t,e,n,r){t.pattern||t.allOf?.some(i=>i.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&r.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:lx(e,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):tn(t,"pattern",lx(e,r),n,r)}function lx(t,e){if(!e.applyRegexFlags||!t.flags)return t.source;const n={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},r=n.i?t.source.toLowerCase():t.source;let i="",a=!1,l=!1,c=!1;for(let u=0;u<r.length;u++){if(a){i+=r[u],a=!1;continue}if(n.i){if(l){if(r[u].match(/[a-z]/)){c?(i+=r[u],i+=`${r[u-2]}-${r[u]}`.toUpperCase(),c=!1):r[u+1]==="-"&&r[u+2]?.match(/[a-z]/)?(i+=r[u],c=!0):i+=`${r[u]}${r[u].toUpperCase()}`;continue}}else if(r[u].match(/[a-z]/)){i+=`[${r[u]}${r[u].toUpperCase()}]`;continue}}if(n.m){if(r[u]==="^"){i+=`(^|(?<=[\r
]))`;continue}else if(r[u]==="$"){i+=`($|(?=[\r
]))`;continue}}if(n.s&&r[u]==="."){i+=l?`${r[u]}\r
`:`[${r[u]}\r
]`;continue}i+=r[u],r[u]==="\\"?a=!0:l&&r[u]==="]"?l=!1:!l&&r[u]==="["&&(l=!0)}try{new RegExp(i)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return i}function qR(t,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&t.keyType?._def.typeName===Oe.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((r,i)=>({...r,[i]:Xt(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",i]})??Hr(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};const n={type:"object",additionalProperties:Xt(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return n;if(t.keyType?._def.typeName===Oe.ZodString&&t.keyType._def.checks?.length){const{type:r,...i}=WR(t.keyType._def,e);return{...n,propertyNames:i}}else{if(t.keyType?._def.typeName===Oe.ZodEnum)return{...n,propertyNames:{enum:t.keyType._def.values}};if(t.keyType?._def.typeName===Oe.ZodBranded&&t.keyType._def.type._def.typeName===Oe.ZodString&&t.keyType._def.type._def.checks?.length){const{type:r,...i}=HR(t.keyType._def,e);return{...n,propertyNames:i}}}return n}function wU(t,e){if(e.mapStrategy==="record")return qR(t,e);const n=Xt(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||Hr(e),r=Xt(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||Hr(e);return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function xU(t){const e=t.values,r=Object.keys(t.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),i=Array.from(new Set(r.map(a=>typeof a)));return{type:i.length===1?i[0]==="string"?"string":"number":["string","number"],enum:r}}function EU(t){return t.target==="openAi"?void 0:{not:Hr({...t,currentPath:[...t.currentPath,"not"]})}}function bU(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Uh={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function TU(t,e){if(e.target==="openApi3")return cx(t,e);const n=t.options instanceof Map?Array.from(t.options.values()):t.options;if(n.every(r=>r._def.typeName in Uh&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((i,a)=>{const l=Uh[a._def.typeName];return l&&!i.includes(l)?[...i,l]:i},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((i,a)=>{const l=typeof a._def.value;switch(l){case"string":case"number":case"boolean":return[...i,l];case"bigint":return[...i,"integer"];case"object":if(a._def.value===null)return[...i,"null"];default:return i}},[]);if(r.length===n.length){const i=r.filter((a,l,c)=>c.indexOf(a)===l);return{type:i.length>1?i:i[0],enum:n.reduce((a,l)=>a.includes(l._def.value)?a:[...a,l._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,i)=>[...r,...i._def.values.filter(a=>!r.includes(a))],[])};return cx(t,e)}const cx=(t,e)=>{const n=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((r,i)=>Xt(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${i}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function MU(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:Uh[t.innerType._def.typeName],nullable:!0}:{type:[Uh[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=Xt(t.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=Xt(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function RU(t,e){const n={type:"number"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"int":n.type="integer",VR(n,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?tn(n,"minimum",r.value,r.message,e):tn(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),tn(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?tn(n,"maximum",r.value,r.message,e):tn(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),tn(n,"maximum",r.value,r.message,e));break;case"multipleOf":tn(n,"multipleOf",r.value,r.message,e);break}return n}function CU(t,e){const n=e.target==="openAi",r={type:"object",properties:{}},i=[],a=t.shape();for(const c in a){let u=a[c];if(u===void 0||u._def===void 0)continue;let f=PU(u);f&&n&&(u._def.typeName==="ZodOptional"&&(u=u._def.innerType),u.isNullable()||(u=u.nullable()),f=!1);const h=Xt(u._def,{...e,currentPath:[...e.currentPath,"properties",c],propertyPath:[...e.currentPath,"properties",c]});h!==void 0&&(r.properties[c]=h,f||i.push(c))}i.length&&(r.required=i);const l=AU(t,e);return l!==void 0&&(r.additionalProperties=l),r}function AU(t,e){if(t.catchall._def.typeName!=="ZodNever")return Xt(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(t.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function PU(t){try{return t.isOptional()}catch{return!0}}const IU=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return Xt(t.innerType._def,e);const n=Xt(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return n?{anyOf:[{not:Hr(e)},n]}:Hr(e)},NU=(t,e)=>{if(e.pipeStrategy==="input")return Xt(t.in._def,e);if(e.pipeStrategy==="output")return Xt(t.out._def,e);const n=Xt(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=Xt(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(i=>i!==void 0)}};function kU(t,e){return Xt(t.type._def,e)}function LU(t,e){const r={type:"array",uniqueItems:!0,items:Xt(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&tn(r,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&tn(r,"maxItems",t.maxSize.value,t.maxSize.message,e),r}function OU(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((n,r)=>Xt(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:Xt(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((n,r)=>Xt(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function DU(t){return{not:Hr(t)}}function UU(t){return Hr(t)}const FU=(t,e)=>Xt(t.innerType._def,e),zU=(t,e,n)=>{switch(e){case Oe.ZodString:return WR(t,n);case Oe.ZodNumber:return RU(t,n);case Oe.ZodObject:return CU(t,n);case Oe.ZodBigInt:return cU(t,n);case Oe.ZodBoolean:return uU();case Oe.ZodDate:return GR(t,n);case Oe.ZodUndefined:return DU(n);case Oe.ZodNull:return bU(n);case Oe.ZodArray:return lU(t,n);case Oe.ZodUnion:case Oe.ZodDiscriminatedUnion:return TU(t,n);case Oe.ZodIntersection:return _U(t,n);case Oe.ZodTuple:return OU(t,n);case Oe.ZodRecord:return qR(t,n);case Oe.ZodLiteral:return vU(t,n);case Oe.ZodEnum:return mU(t);case Oe.ZodNativeEnum:return xU(t);case Oe.ZodNullable:return MU(t,n);case Oe.ZodOptional:return IU(t,n);case Oe.ZodMap:return wU(t,n);case Oe.ZodSet:return LU(t,n);case Oe.ZodLazy:return()=>t.getter()._def;case Oe.ZodPromise:return kU(t,n);case Oe.ZodNaN:case Oe.ZodNever:return EU(n);case Oe.ZodEffects:return pU(t,n);case Oe.ZodAny:return Hr(n);case Oe.ZodUnknown:return UU(n);case Oe.ZodDefault:return hU(t,n);case Oe.ZodBranded:return HR(t,n);case Oe.ZodReadonly:return FU(t,n);case Oe.ZodCatch:return dU(t,n);case Oe.ZodPipeline:return NU(t,n);case Oe.ZodFunction:case Oe.ZodVoid:case Oe.ZodSymbol:return;default:return(r=>{})()}};function Xt(t,e,n=!1){const r=e.seen.get(t);if(e.override){const c=e.override?.(t,e,r,n);if(c!==sU)return c}if(r&&!n){const c=$U(r,e);if(c!==void 0)return c}const i={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,i);const a=zU(t,t.typeName,e),l=typeof a=="function"?Xt(a(),e):a;if(l&&BU(t,e,l),e.postProcess){const c=e.postProcess(l,t,e);return i.jsonSchema=l,c}return i.jsonSchema=l,l}const $U=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:jR(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((n,r)=>e.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),Hr(e)):e.$refStrategy==="seen"?Hr(e):void 0}},BU=(t,e,n)=>(t.description&&(n.description=t.description,e.markdownDescription&&(n.markdownDescription=t.description)),n),VU=(t,e)=>{const n=oU(e);let r=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((u,[f,h])=>({...u,[f]:Xt(h._def,{...n,currentPath:[...n.basePath,n.definitionPath,f]},!0)??Hr(n)}),{}):void 0;const i=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,a=Xt(t._def,i===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,i]},!1)??Hr(n),l=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;l!==void 0&&(a.title=l),n.flags.hasReferencedOpenAiAnyType&&(r||(r={}),r[n.openAiAnyTypeName]||(r[n.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:n.$refStrategy==="relative"?"1":[...n.basePath,n.definitionPath,n.openAiAnyTypeName].join("/")}}));const c=i===void 0?r?{...a,[n.definitionPath]:r}:a:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,i].join("/"),[n.definitionPath]:{...r,[i]:a}};return n.target==="jsonSchema7"?c.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(c.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in c||"oneOf"in c||"allOf"in c||"type"in c&&Array.isArray(c.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),c};function Bl(t){if(typeof t!="object"||t===null||!("~standard"in t))return!1;const e=t["~standard"];return typeof e!="object"||e===null?!1:"version"in e&&e.version===1&&"vendor"in e&&typeof e.vendor=="string"&&"validate"in e&&typeof e.validate=="function"}iU("zod",t=>t&&typeof t=="object"&&"_zod"in t?B2(t):VU(t));function Nl(t){return Bl(t)?rU.sync(t):t}function jU(t){const e=t.properties??{};return Object.entries(e).map(([n,r])=>({name:n,type:r&&typeof r=="object"&&"type"in r?r.type:"object",description:r&&typeof r=="object"&&"description"in r?r.description??"":"",isRequired:Array.isArray(t.required)?t.required.includes(n):!1,schema:typeof r=="object"&&r!==null?r:{}}))}function HU(t){const e=t.inputSchema;let n;if(ry(e))n=e;else if(Bl(e))n=Nl(e);else return console.warn("Unknown inputSchema type, returning empty parameters"),[];return jU(n)}function GU(t){return t.type==="object"&&typeof t.additionalProperties=="object"&&t.additionalProperties!==null}function Jr(t,e,n){if(GU(t)){const i=e.length?e.join("."):"(root)";throw new Error(`Record types (objects with dynamic keys) are not supported in ${n}. Found at path "${i}". Replace it with an object using explicit keys.`)}if(t.properties)for(const[i,a]of Object.entries(t.properties))typeof a=="object"&&a!==null&&Jr(a,[...e,i],n);typeof t.additionalProperties=="object"&&t.additionalProperties!==null&&Jr(t.additionalProperties,[...e,"[*]"],n),t.items&&(Array.isArray(t.items)?t.items.forEach((i,a)=>{typeof i=="object"&&i!==null&&Jr(i,[...e,`${a}`],n)}):typeof t.items=="object"&&Jr(t.items,[...e,"[]"],n));const r=t.prefixItems;Array.isArray(r)&&r.forEach((i,a)=>{typeof i=="object"&&i!==null&&Jr(i,[...e,`${a}`],n)}),t.allOf&&t.allOf.forEach((i,a)=>{typeof i=="object"&&i!==null&&Jr(i,[...e,`&${a}`],n)}),t.anyOf&&t.anyOf.forEach((i,a)=>{typeof i=="object"&&i!==null&&Jr(i,[...e,`|${a}`],n)}),t.oneOf&&t.oneOf.forEach((i,a)=>{typeof i=="object"&&i!==null&&Jr(i,[...e,`|${a}`],n)}),typeof t.not=="object"&&t.not!==null&&Jr(t.not,[...e,"!"],n),typeof t.if=="object"&&t.if!==null&&Jr(t.if,[...e,"if"],n),typeof t.then=="object"&&t.then!==null&&Jr(t.then,[...e,"then"],n),typeof t.else=="object"&&t.else!==null&&Jr(t.else,[...e,"else"],n)}function ZR(t,e="schema"){if(!t)return;let n;try{if(Bl(t)){const r=Nl(t);if(!r||Object.keys(r).length===0)return;n=r}else if(typeof t=="object"&&t!==null&&"type"in t)n=t;else return}catch{return}Jr(n,[],e)}function mu(t,e){if(!/^[a-zA-Z0-9_-]+$/.test(t))throw new Error(`${e} "${t}" must only contain letters, numbers, underscores, and hyphens.`)}var Sa;(function(t){t.SSE="sse",t.HTTP="http"})(Sa||(Sa={}));function XR(t){const e=t.customHeaders?JSON.stringify(Object.entries(t.customHeaders).map(([n,r])=>[n.toLowerCase(),r]).sort(([n],[r])=>n.localeCompare(r))):"";return`${t.url}|${t.transport??Sa.HTTP}|${e}`}function WU(t){try{const n=new URL(t).hostname;let i=[...n.split(".")];i.length>=3&&i[i.length-1].length<=3&&i[i.length-2].length<=3?i=i.slice(0,-2):i.length>=2&&(i=i.slice(0,-1));const a=new Set(["www","api","mcp","app","staging","dev","prod"]);for(let l=i.length-1;l>=0;l--){const c=i[l];if(c&&!a.has(c.toLowerCase()))return c.toLowerCase()}return i[i.length-1]?.toLowerCase()||n}catch{return t.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase()}}function Cg(t){const e=typeof t=="string"?{url:t,transport:Sa.HTTP}:t,n=e.serverKey??WU(e.url),r=e.transport??Sa.HTTP;return{...e,transport:r,serverKey:n}}function qU(t){if(t.length===0)return t;const e=new Map;for(const i of t){const a=XR(i);e.set(a,i)}const n=Array.from(e.values()),r=new Map;return n.map(i=>{const a=i.serverKey,l=(r.get(a)??0)+1;return r.set(a,l),l===1?i:{...i,serverKey:`${a}-${l}`}})}function ZU(t){return t.type==="object"||t.properties!==void 0}function XU(t,e){let n;if(Bl(t))try{n=Nl(t)}catch{return}else if(ry(t))n=t;else return;if(!ZU(n))throw new Error(`${e} must be an object schema (e.g., z.object({...})). Received type: "${n.type??"unknown"}". Tool parameters are passed as a single object argument.`)}function KU(t){if(!t||typeof t!="object")throw new Error("Tool must be an object");const e="name"in t&&typeof t.name=="string"?t.name:"<unknown>";if("toolSchema"in t)throw new Error(`Tool "${e}" uses deprecated "toolSchema" property. Migrate to "inputSchema" and "outputSchema" properties. See migration guide: https://tambo.ai/docs/migration/toolschema`);if(!("name"in t)||typeof t.name!="string")throw new Error("Tool must have a 'name' property of type string");if(!("description"in t)||typeof t.description!="string")throw new Error(`Tool "${t.name}" must have a 'description' property of type string`);if(!("tool"in t)||typeof t.tool!="function")throw new Error(`Tool "${t.name}" must have a 'tool' property of type function`);if(!("inputSchema"in t))throw new Error(`Tool "${t.name}" must have an 'inputSchema' property`);if(!("outputSchema"in t))throw new Error(`Tool "${t.name}" must have an 'outputSchema' property`);if(mu(t.name,"tool"),t.inputSchema&&(XU(t.inputSchema,`inputSchema of tool "${t.name}"`),ZR(t.inputSchema,`inputSchema of tool "${t.name}"`)),"maxCalls"in t&&t.maxCalls!==void 0&&t.maxCalls!==null){const n=t.maxCalls;if(typeof n!="number"||!Number.isInteger(n)||n<0)throw new Error(`maxCalls for tool "${t.name}" must be a positive integer`)}}function YU(t,e,n){if(t)return console.warn("propsDefinition is deprecated. Use propsSchema instead."),t;if(Bl(e))try{return Nl(e)}catch(r){throw console.error(`Error converting ${n} props schema to JSON Schema:`,r),new Error(`Error converting ${n} props schema to JSON Schema: ${r}`)}if(ry(e))return e;throw new Error(`Invalid props schema for ${n}`)}function JU(t){const{name:e,propsSchema:n,propsDefinition:r}=t;if(mu(e,"component"),!n&&!r)throw new Error(`Component ${e} must have either propsSchema (recommended) or propsDefinition defined`);if(n&&r)throw new Error(`Component ${e} cannot have both propsSchema and propsDefinition defined. Use only one. We recommend using propsSchema.`);return n&&ZR(n,`propsSchema of component "${e}"`),{props:YU(r,n,e)}}function QU(t,e,n,r){if(mu(t,"component"),mu(e,"tool"),!n)throw new Error(`Component ${t} not found in registry`);if(!r)throw new Error(`Tool ${e} not found in registry`)}function ux(t,e){const n=t!=null,r=e!=null;if(n!==r)throw new Error(`Both listResources and getResource must be provided together, or neither should be provided. Got: listResources=${n?"defined":"undefined"}, getResource=${r?"defined":"undefined"}`)}function Ag(t){if(!t.uri)throw new Error("Resource must have a 'uri' field");if(!t.name)throw new Error(`Resource with URI '${t.uri}' must have a 'name' field`)}const ay=V.createContext({componentList:{},toolRegistry:{},componentToolAssociations:{},mcpServerInfos:[],resources:[],resourceSource:null,registerComponent:()=>{},registerTool:()=>{},registerTools:()=>{},addToolAssociation:()=>{},registerMcpServer:()=>{},registerMcpServers:()=>{},registerResource:()=>{},registerResources:()=>{},registerResourceSource:()=>{}}),e3=({children:t,components:e,tools:n,mcpServers:r,resources:i,listResources:a,getResource:l,onCallUnregisteredTool:c})=>{const[u,f]=V.useState({}),[h,p]=V.useState({}),[m,y]=V.useState({}),[S,E]=V.useState([]),[g,v]=V.useState([]),[x,w]=V.useState([]),[C,T]=V.useState(null),M=V.useCallback(K=>(ne,j)=>(KU(j),ne[j.name]&&K&&console.warn(`Overwriting tool ${j.name}`),{...ne,[j.name]:j}),[]),A=V.useCallback((K,ne=!0)=>{p(j=>M(ne)(j,K))},[M]),F=V.useCallback((K,ne=!0)=>{p(j=>K.reduce(M(ne),j))},[M]),I=V.useCallback(K=>{const ne=Cg(K);v(j=>[...j,ne])},[]),O=V.useCallback(K=>{const ne=K.map(Cg);v(j=>[...j,...ne])},[]),W=V.useCallback((K,ne)=>{QU(K,ne.name,!!u[K],!!h[ne.name]),y(j=>({...j,[K]:[...j[K]||[],ne.name]}))},[u,h]),J=V.useCallback((K,ne=!0)=>{const{name:j,description:N,component:H,loadingComponent:U,associatedTools:P}=K,{props:L}=JU(K);f(G=>(G[j]&&ne&&console.warn(`overwriting component ${j}`),{...G,[j]:{component:H,loadingComponent:U,name:j,description:N,props:L,contextTools:[]}})),P&&(F(P),y(G=>({...G,[j]:P.map(Q=>Q.name)})))},[F]);V.useEffect(()=>{e&&e.forEach(K=>{J(K,!1)})},[J,e]),V.useEffect(()=>{n&&F(n,!1)},[F,n]),V.useEffect(()=>{if(!r||r.length===0){E([]);return}const K=r.map(Cg);E(K)},[r]),V.useEffect(()=>{ux(a,l),i?(i.forEach(K=>Ag(K)),w(i)):w([]),T(a&&l?{listResources:a,getResource:l}:null)},[i,a,l]);const ae=V.useCallback(K=>{Ag(K),w(ne=>[...ne,K])},[]),Z=V.useCallback(K=>{K.forEach(ne=>Ag(ne)),w(ne=>[...ne,...K])},[]),ie=V.useCallback(K=>{ux(K.listResources,K.getResource),T(K)},[]),de=V.useMemo(()=>{const K=[...S,...g];return qU(K)},[S,g]),pe={componentList:u,toolRegistry:h,componentToolAssociations:m,mcpServerInfos:de,resources:x,resourceSource:C,registerComponent:J,registerTool:A,registerTools:F,addToolAssociation:W,registerMcpServer:I,registerMcpServers:O,registerResource:ae,registerResources:Z,registerResourceSource:ie,onCallUnregisteredTool:c};return qt.createElement(ay.Provider,{value:pe},t)},Tu=()=>V.useContext(ay),t3=()=>V.useContext(ay).mcpServerInfos;async function n3(t){const e=Object.entries(t);return e.length===0?[]:(await Promise.all(e.map(async([r,i])=>{try{const a=await i();return a==null?null:{name:r,context:a}}catch(a){return console.error(`Error running context helper ${r}:`,a),null}}))).filter(Boolean)}const KR=V.createContext(null),r3=({children:t,contextHelpers:e})=>{const[n,r]=V.useState({}),i=V.useCallback((f,h)=>{r(p=>({...p,[f]:h}))},[]),a=V.useCallback((f,h)=>{r(p=>{const{[f]:m,...y}=p;return h===void 0||m===h?y:p})},[]);V.useEffect(()=>{const f=[];if(e)for(const[h,p]of Object.entries(e))i(h,p),f.push([h,p]);return()=>{for(const[h,p]of f)a(h,p)}},[i,e,a]);const l=V.useCallback(async()=>await n3(n),[n]),c=V.useCallback(()=>n,[n]),u=V.useMemo(()=>({getAdditionalContext:l,getContextHelpers:c,addContextHelper:i,removeContextHelper:a}),[l,c,i,a]);return qt.createElement(KR.Provider,{value:u},t)},gp=()=>{const t=V.useContext(KR);return t||{getAdditionalContext:async()=>{throw new Error("useTamboContextHelpers must be used within a TamboContextHelpersProvider")},getContextHelpers:()=>{throw new Error("useTamboContextHelpers must be used within a TamboContextHelpersProvider")},addContextHelper:(e,n)=>{throw new Error("useTamboContextHelpers must be used within a TamboContextHelpersProvider")},removeContextHelper:e=>{throw new Error("useTamboContextHelpers must be used within a TamboContextHelpersProvider")}}},YR=V.createContext({interactableComponents:[],addInteractableComponent:()=>"",removeInteractableComponent:()=>{},updateInteractableComponentProps:()=>"",getInteractableComponent:()=>{},getInteractableComponentsByName:()=>[],clearAllInteractableComponents:()=>{},setInteractableState:()=>{},getInteractableComponentState:()=>{},setInteractableSelected:()=>{},clearInteractableSelections:()=>{}}),i3=({children:t})=>{const[e,n]=V.useState([]),{registerTool:r}=Tu(),{addContextHelper:i,removeContextHelper:a}=gp(),l=V.useMemo(()=>oL(e),[e]);V.useEffect(()=>(i("interactables",l),()=>{a("interactables")}),[l,i,a]),V.useEffect(()=>{e.length>0&&(r({name:"get_all_interactable_components",description:"Only use this tool if the user is asking about interactable components.Get all currently interactable components with their details including their current props. These are components that you can interact with on behalf of the user.",tool:()=>({components:e}),inputSchema:Pt({}),outputSchema:Pt({components:ji(Pt({id:it(),name:it(),props:Wd(it(),Gd()),propsSchema:Wd(it(),Gd()).optional()}))})}),r({name:"get_interactable_component_by_id",description:"Get a specific interactable component by its ID",tool:({componentId:T})=>{const M=e.find(A=>A.id===T);return M?{success:!0,component:{id:M.id,componentName:M.name,props:M.props}}:{success:!1,error:`Component with ID ${T} not found`}},inputSchema:Pt({componentId:it().describe("The ID of the component")}),outputSchema:$w("success",[Pt({success:qd(!0),component:Pt({id:it(),componentName:it(),props:Wd(it(),Gd())}).optional()}),Pt({success:qd(!1),error:it()})])}),r({name:"remove_interactable_component",description:"Remove an interactable component from the system",tool:({componentId:T})=>{const M=e.find(A=>A.id===T);return M?(n(A=>A.filter(F=>F.id!==T)),{success:!0,componentId:T,removedComponent:{id:M.id,componentName:M.name,props:M.props}}):{success:!1,error:`Component with ID ${T} not found`}},inputSchema:Pt({componentId:it().describe("The ID of the component")}),outputSchema:$w("success",[Pt({success:qd(!0),componentId:it(),removedComponent:Pt({id:it(),componentName:it(),props:Wd(it(),Gd())})}),Pt({success:qd(!1),error:it()})])}))},[e,r]);const c=V.useCallback((T,M)=>!M||Object.keys(M).length===0?`Warning: No props provided for component with ID ${T}.`:(n(A=>{const F=A.find(ae=>ae.id===T);if(!F||!Object.entries(M).some(([ae,Z])=>F.props[ae]!==Z))return A;const O={...F,props:{...F.props,...M}},W=[...A],J=A.findIndex(ae=>ae.id===T);return W[J]=O,W}),"Updated successfully"),[]),u=V.useCallback((T,M)=>!M||Object.keys(M).length===0?`Warning: No state values provided for component with ID ${T}.`:(n((A=[])=>{const F=A.find(J=>J.id===T);if(!F)return A;const I=F.state??{},O={...I,...M};if(Lk(I,O))return A;const W={...F,state:O};return A.map(J=>J.id===T?W:J)}),"Updated successfully"),[]),f=V.useCallback((T,M=60)=>{const A="update_component_props_",F=M-A.length;if(T.id.length>F)throw new Error(`Interactable component id ${T.id} is too long. It must be less than ${F} characters.`);let I;if(T.propsSchema){const W=Nl(T.propsSchema);I=sx(W)}else I={type:"object",additionalProperties:!0};const O={type:"object",properties:{componentId:{type:"string",description:"The ID of the interactable component to update"},newProps:{...I,description:"The props to update. Provide only the props you want to change."}},required:["componentId","newProps"]};r({name:`${A}${T.id}`,description:`Update the props of interactable component ${T.id} (${T.name}). Provide partial props (only props to change).`,tool:({componentId:W,newProps:J})=>c(W,J),inputSchema:O,outputSchema:it()})},[r,c]),h=V.useCallback((T,M=60)=>{const A="update_component_state_",F=M-A.length;if(T.id.length>F)throw new Error(`Interactable component id ${T.id} is too long. It must be less than ${F} characters.`);let I={type:"object",additionalProperties:!0};if(T.stateSchema){const W=Nl(T.stateSchema);I=sx(W)}const O={type:"object",properties:{componentId:{type:"string",description:"The ID of the interactable component to update"},newState:{...I,description:"The state values to update. Provide only the keys you want to change."}},required:["componentId","newState"]};r({name:`${A}${T.id}`,description:`Update the state of interactable component ${T.id} (${T.name}). You may provide partial state (only keys to change).`,tool:({componentId:W,newState:J})=>u(W,J),inputSchema:O,outputSchema:it()})},[r,u]),p=V.useCallback(T=>{mu(T.name,"component");const M=`-${Math.random().toString(36).slice(2,5)}`,A=`${T.name}${M}`,F={...T,id:A,state:T.state??{}};return f(F),h(F),n(I=>[...I,F]),A},[f,h]),m=V.useCallback(T=>{n(M=>M.filter(A=>A.id!==T))},[]),y=V.useCallback(T=>e.find(M=>M.id===T),[e]),S=V.useCallback(T=>e.filter(M=>M.name===T),[e]),E=V.useCallback(()=>{n([])},[]),g=V.useCallback((T,M,A)=>{n(F=>{const I=F.find(J=>J.id===T);if(!I)return console.warn(`Tried to update state for component ${T} but it was not found.`),F;const O={...I,state:{...I.state,[M]:A}};return F.map(J=>J.id===T?O:J)})},[]),v=V.useCallback(T=>e.find(A=>A.id===T)?.state,[e]),x=V.useCallback((T,M)=>{n(A=>{let F=!1;const I=A.map(O=>O.id!==T?O:(F=!0,O.isSelected===M?O:{...O,isSelected:M}));return F?I:A})},[]),w=V.useCallback(()=>{n(T=>T.some(M=>M.isSelected)?T.map(M=>M.isSelected?{...M,isSelected:!1}:M):T)},[]),C={interactableComponents:e,addInteractableComponent:p,removeInteractableComponent:m,updateInteractableComponentProps:c,getInteractableComponent:y,getInteractableComponentsByName:S,clearAllInteractableComponents:E,setInteractableState:g,getInteractableComponentState:v,setInteractableSelected:x,clearInteractableSelections:w};return qt.createElement(YR.Provider,{value:C},t)},JR=()=>V.useContext(YR),s3=V.createContext(null),a3=({children:t,message:e,interactableMetadata:n})=>{const r=n?{...e,interactableMetadata:n}:e;return qt.createElement(s3.Provider,{value:r,key:e.id},t)};function o3(t,e,n){return qt.createElement(a3,{message:e,interactableMetadata:n},t)}function l3(){const[t,e]=V.useState([]),n=async c=>await new Promise((u,f)=>{const h=new FileReader;h.onload=()=>u(h.result),h.onerror=f,h.readAsDataURL(c)}),r=V.useCallback(async c=>{if(!c.type.startsWith("image/"))throw new Error("Only image files are allowed");const u=await n(c),f={id:crypto.randomUUID(),name:c.name,dataUrl:u,file:c,size:c.size,type:c.type};e(h=>[...h,f])},[]),i=V.useCallback(async c=>{const u=c.filter(h=>h.type.startsWith("image/"));if(u.length===0)throw new Error("No valid image files provided");const f=await Promise.all(u.map(async h=>{const p=await n(h);return{id:crypto.randomUUID(),name:h.name,dataUrl:p,file:h,size:h.size,type:h.type}}));e(h=>[...h,...f])},[]),a=V.useCallback(c=>{e(u=>u.filter(f=>f.id!==c))},[]),l=V.useCallback(()=>{e([])},[]);return{images:t,addImage:r,addImages:i,removeImage:a,clearImages:l}}var gr;(function(t){t.IDLE="IDLE",t.CHOOSING_COMPONENT="CHOOSING_COMPONENT",t.FETCHING_CONTEXT="FETCHING_CONTEXT",t.HYDRATING_COMPONENT="HYDRATING_COMPONENT",t.STREAMING_RESPONSE="STREAMING_RESPONSE",t.COMPLETE="COMPLETE",t.ERROR="ERROR",t.CANCELLED="CANCELLED"})(gr||(gr={}));function QR(t){return[gr.IDLE,gr.COMPLETE,gr.ERROR,gr.CANCELLED].includes(t)}function c3(t){const e=t.trim();return e.length===0?{isValid:!1,error:new Error("Message cannot be empty"),sanitizedInput:e}:e.length>1e4?{isValid:!1,error:new Error("Message is too long (max 10000 characters)"),sanitizedInput:e}:{isValid:!0,sanitizedInput:e}}function hi(t,e,n,r,i){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}function Nn(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)}let eC=function(){const{crypto:t}=globalThis;if(t?.randomUUID)return eC=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};function J_(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const Q_=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class ni extends Error{}class Ir extends ni{constructor(e,n,r,i){super(`${Ir.makeMessage(e,n,r)}`),this.status=e,this.headers=i,this.error=n}static makeMessage(e,n,r){const i=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,n,r,i){if(!e||!i)return new _p({message:r,cause:Q_(n)});const a=n;return e===400?new nC(e,a,r,i):e===401?new rC(e,a,r,i):e===403?new iC(e,a,r,i):e===404?new sC(e,a,r,i):e===409?new aC(e,a,r,i):e===422?new oC(e,a,r,i):e===429?new lC(e,a,r,i):e>=500?new cC(e,a,r,i):new Ir(e,a,r,i)}}class ev extends Ir{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class _p extends Ir{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class tC extends _p{constructor({message:e}={}){super({message:e??"Request timed out."})}}class nC extends Ir{}class rC extends Ir{}class iC extends Ir{}class sC extends Ir{}class aC extends Ir{}class oC extends Ir{}class lC extends Ir{}class cC extends Ir{}const u3=/^[a-z][a-z0-9+.-]*:/i,d3=t=>u3.test(t);let tv=t=>(tv=Array.isArray,tv(t)),dx=tv;function f3(t){return typeof t!="object"?{}:t??{}}function h3(t){if(!t)return!0;for(const e in t)return!1;return!0}function p3(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const m3=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new ni(`${t} must be an integer`);if(e<0)throw new ni(`${t} must be a positive integer`);return e},g3=t=>{try{return JSON.parse(t)}catch{return}},_3=t=>new Promise(e=>setTimeout(e,t)),pl="0.89.0";function v3(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const y3=()=>{const t=v3();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pl,"X-Stainless-OS":hx(Deno.build.os),"X-Stainless-Arch":fx(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pl,"X-Stainless-OS":hx(globalThis.process.platform??"unknown"),"X-Stainless-Arch":fx(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=S3();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function S3(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const i=r[1]||0,a=r[2]||0,l=r[3]||0;return{browser:e,version:`${i}.${a}.${l}`}}}return null}const fx=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",hx=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let px;const w3=()=>px??(px=y3());function x3(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new TamboAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function uC(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function dC(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return uC({start(){},async pull(n){const{done:r,value:i}=await e.next();r?n.close():n.enqueue(i)},async cancel(){await e.return?.()}})}function fC(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n?.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function E3(t){if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await t[Symbol.asyncIterator]().return?.();return}const e=t.getReader(),n=e.cancel();e.releaseLock(),await n}const b3=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});function T3(t){let e=0;for(const i of t)e+=i.length;const n=new Uint8Array(e);let r=0;for(const i of t)n.set(i,r),r+=i.length;return n}let mx;function oy(t){let e;return(mx??(e=new globalThis.TextEncoder,mx=e.encode.bind(e)))(t)}let gx;function _x(t){let e;return(gx??(e=new globalThis.TextDecoder,gx=e.decode.bind(e)))(t)}var Qr,ei;class vp{constructor(){Qr.set(this,void 0),ei.set(this,void 0),hi(this,Qr,new Uint8Array),hi(this,ei,null)}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?oy(e):e;hi(this,Qr,T3([Nn(this,Qr,"f"),n]));const r=[];let i;for(;(i=M3(Nn(this,Qr,"f"),Nn(this,ei,"f")))!=null;){if(i.carriage&&Nn(this,ei,"f")==null){hi(this,ei,i.index);continue}if(Nn(this,ei,"f")!=null&&(i.index!==Nn(this,ei,"f")+1||i.carriage)){r.push(_x(Nn(this,Qr,"f").subarray(0,Nn(this,ei,"f")-1))),hi(this,Qr,Nn(this,Qr,"f").subarray(Nn(this,ei,"f"))),hi(this,ei,null);continue}const a=Nn(this,ei,"f")!==null?i.preceding-1:i.preceding,l=_x(Nn(this,Qr,"f").subarray(0,a));r.push(l),hi(this,Qr,Nn(this,Qr,"f").subarray(i.index)),hi(this,ei,null)}return r}flush(){return Nn(this,Qr,"f").length?this.decode(`
`):[]}}Qr=new WeakMap,ei=new WeakMap;vp.NEWLINE_CHARS=new Set([`
`,"\r"]);vp.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function M3(t,e){for(let i=e??0;i<t.length;i++){if(t[i]===10)return{preceding:i,index:i+1,carriage:!1};if(t[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function R3(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}const Fh={off:0,error:200,warn:300,info:400,debug:500},vx=(t,e,n)=>{if(t){if(p3(Fh,t))return t;Mr(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(Fh))}`)}};function Hc(){}function Yd(t,e,n){return!e||Fh[t]>Fh[n]?Hc:e[t].bind(e)}const C3={error:Hc,warn:Hc,info:Hc,debug:Hc};let yx=new WeakMap;function Mr(t){const e=t.logger,n=t.logLevel??"off";if(!e)return C3;const r=yx.get(e);if(r&&r[0]===n)return r[1];const i={error:Yd("error",e,n),warn:Yd("warn",e,n),info:Yd("info",e,n),debug:Yd("debug",e,n)};return yx.set(e,[n,i]),i}const Xa=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="x-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);var Ic;class vl{constructor(e,n,r){this.iterator=e,Ic.set(this,void 0),this.controller=n,hi(this,Ic,r)}static fromSSEResponse(e,n,r){let i=!1;const a=r?Mr(r):console;async function*l(){if(i)throw new ni("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let c=!1;try{for await(const u of A3(e,n))try{yield JSON.parse(u.data)}catch(f){throw a.error("Could not parse message into JSON:",u.data),a.error("From chunk:",u.raw),f}c=!0}catch(u){if(J_(u))return;throw u}finally{c||n.abort()}}return new vl(l,n,r)}static fromReadableStream(e,n,r){let i=!1;async function*a(){const c=new vp,u=fC(e);for await(const f of u)for(const h of c.decode(f))yield h;for(const f of c.flush())yield f}async function*l(){if(i)throw new ni("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let c=!1;try{for await(const u of a())c||u&&(yield JSON.parse(u));c=!0}catch(u){if(J_(u))return;throw u}finally{c||n.abort()}}return new vl(l,n,r)}[(Ic=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),i=a=>({next:()=>{if(a.length===0){const l=r.next();e.push(l),n.push(l)}return a.shift()}});return[new vl(()=>i(e),this.controller,Nn(this,Ic,"f")),new vl(()=>i(n),this.controller,Nn(this,Ic,"f"))]}toReadableStream(){const e=this;let n;return uC({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{const{value:i,done:a}=await n.next();if(a)return r.close();const l=oy(JSON.stringify(i)+`
`);r.enqueue(l)}catch(i){r.error(i)}},async cancel(){await n.return?.()}})}}async function*A3(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new ni("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new ni("Attempted to iterate over a response with no body");const n=new I3,r=new vp,i=fC(t.body);for await(const a of P3(i))for(const l of r.decode(a)){const c=n.decode(l);c&&(yield c)}for(const a of r.flush()){const l=n.decode(a);l&&(yield l)}}async function*P3(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?oy(n):n;let i=new Uint8Array(e.length+r.length);i.set(e),i.set(r,e.length),e=i;let a;for(;(a=R3(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}class I3{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,i]=N3(e,":");return i.startsWith(" ")&&(i=i.substring(1)),n==="event"?this.event=i:n==="data"&&this.data.push(i),null}}function N3(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}async function hC(t,e){const{response:n,requestLogID:r,retryOfRequestLogID:i,startTime:a}=e,l=await(async()=>{if(e.options.stream)return Mr(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):vl.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const u=n.headers.get("content-type")?.split(";")[0]?.trim();return u?.includes("application/json")||u?.endsWith("+json")?n.headers.get("content-length")==="0"?void 0:await n.json():await n.text()})();return Mr(t).debug(`[${r}] response parsed`,Xa({retryOfRequestLogID:i,url:n.url,status:n.status,body:l,durationMs:Date.now()-a})),l}var Gc;class yp extends Promise{constructor(e,n,r=hC){super(i=>{i(null)}),this.responsePromise=n,this.parseResponse=r,Gc.set(this,void 0),hi(this,Gc,e)}_thenUnwrap(e){return new yp(Nn(this,Gc,"f"),this.responsePromise,async(n,r)=>e(await this.parseResponse(n,r),r))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(Nn(this,Gc,"f"),e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}Gc=new WeakMap;var Jd;class k3{constructor(e,n,r,i){Jd.set(this,void 0),hi(this,Jd,e),this.options=i,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new ni("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await Nn(this,Jd,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Jd=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class L3 extends yp{constructor(e,n,r){super(e,n,async(i,a)=>new r(i,a.response,await hC(i,a),a.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}class O3 extends k3{constructor(e,n,r,i){super(e,n,r,i),this.items=r.items||[],this.total=r.total||0,this.count=r.count||0}getPaginatedItems(){return this.items??[]}nextPageRequestOptions(){const e=this.options.query.offset??0,n=this.getPaginatedItems().length,r=e+n,i=this.total;return i&&r<i?{...this.options,query:{...f3(this.options.query),offset:r}}:null}}const pC=()=>{if(typeof File>"u"){const{process:t}=globalThis,e=typeof t?.versions?.node=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(e?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Jc(t,e,n){return pC(),new File(t,e??"unknown_file",n)}function gh(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const mC=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",D3=async(t,e)=>({...t,body:await F3(t.body,e)}),Sx=new WeakMap;function U3(t){const e=typeof t=="function"?t:t.fetch,n=Sx.get(e);if(n)return n;const r=(async()=>{try{const i="Response"in e?e.Response:(await e("data:,")).constructor,a=new FormData;return a.toString()!==await new i(a).text()}catch{return!0}})();return Sx.set(e,r),r}const F3=async(t,e)=>{if(!await U3(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(t||{}).map(([r,i])=>nv(n,r,i))),n},z3=t=>t instanceof Blob&&"name"in t,nv=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(n instanceof Response)t.append(e,Jc([await n.blob()],gh(n)));else if(mC(n))t.append(e,Jc([await new Response(dC(n)).blob()],gh(n)));else if(z3(n))t.append(e,n,gh(n));else if(Array.isArray(n))await Promise.all(n.map(r=>nv(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,i])=>nv(t,`${e}[${r}]`,i)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},gC=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",$3=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&gC(t),B3=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function V3(t,e,n){if(pC(),t=await t,$3(t))return t instanceof File?t:Jc([await t.arrayBuffer()],t.name);if(B3(t)){const i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),Jc(await rv(i),e,n)}const r=await rv(t);if(e||(e=gh(t)),!n?.type){const i=r.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof i=="string"&&(n={...n,type:i})}return Jc(r,e,n)}async function rv(t){let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(gC(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(mC(t))for await(const n of t)e.push(...await rv(n));else{const n=t?.constructor?.name;throw new Error(`Unexpected data type: ${typeof t}${n?`; constructor: ${n}`:""}${j3(t)}`)}return e}function j3(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}class vr{constructor(e){this._client=e}}class _C extends vr{transcribe(e,n){return this._client.post("/audio/transcribe",D3({body:e,...n},this._client))}}const vC=Symbol("brand.privateNullableHeaders");function*H3(t){if(!t)return;if(vC in t){const{values:r,nulls:i}=t;yield*r.entries();for(const a of i)yield[a,null];return}let e=!1,n;t instanceof Headers?n=t.entries():dx(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let r of n){const i=r[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const a=dx(r[1])?r[1]:[r[1]];let l=!1;for(const c of a)c!==void 0&&(e&&!l&&(l=!0,yield[i,null]),yield[i,c])}}const $i=t=>{const e=new Headers,n=new Set;for(const r of t){const i=new Set;for(const[a,l]of H3(r)){const c=a.toLowerCase();i.has(c)||(e.delete(a),i.add(c)),l===null?(e.delete(a),n.add(c)):(e.append(a,l),n.delete(c))}}return{[vC]:!0,values:e,nulls:n}};class yC extends vr{getMcpToken(e,n){return this._client.post("/auth/mcp/access-token",{body:e,...n})}getToken(e,n){return this._client.post("/oauth/token",{body:e,...n,headers:$i([{"Content-Type":"application/x-www-form-urlencoded"},n?.headers])})}}function SC(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const wx=Object.freeze(Object.create(null)),G3=(t=SC)=>function(n,...r){if(n.length===1)return n[0];let i=!1;const a=[],l=n.reduce((h,p,m)=>{/[?#]/.test(p)&&(i=!0);const y=r[m];let S=(i?encodeURIComponent:t)(""+y);return m!==r.length&&(y==null||typeof y=="object"&&y.toString===Object.getPrototypeOf(Object.getPrototypeOf(y.hasOwnProperty??wx)??wx)?.toString)&&(S=y+"",a.push({start:h.length+p.length,length:S.length,error:`Value of type ${Object.prototype.toString.call(y).slice(8,-1)} is not a valid path parameter`})),h+p+(m===r.length?"":S)},""),c=l.split(/[?#]/,1)[0],u=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let f;for(;(f=u.exec(c))!==null;)a.push({start:f.index,length:f[0].length,error:`Value "${f[0]}" can't be safely passed as a path parameter`});if(a.sort((h,p)=>h.start-p.start),a.length>0){let h=0;const p=a.reduce((m,y)=>{const S=" ".repeat(y.start-h),E="^".repeat(y.length);return h=y.start+y.length,m+S+E},"");throw new ni(`Path parameters result in path with invalid segments:
${a.map(m=>m.error).join(`
`)}
${l}
${p}`)}return l},nn=G3(SC);class wC extends vr{retrieve(e,n){return this._client.get(nn`/registry/${e}`,n)}}class xC extends vr{list(e,n){return this._client.get(nn`/projects/${e}/api-keys`,n)}delete(e,n,r){const{id:i}=n;return this._client.delete(nn`/projects/${i}/api-key/${e}`,r)}}class EC extends vr{list(e,n){return this._client.get(nn`/projects/${e}/provider-keys`,n)}delete(e,n,r){const{id:i}=n;return this._client.delete(nn`/projects/${i}/provider-key/${e}`,r)}}class Sp extends vr{constructor(){super(...arguments),this.apiKey=new xC(this._client),this.providerKey=new EC(this._client)}retrieve(e,n){return this._client.get(nn`/projects/${e}`,n)}delete(e,n){return this._client.delete(nn`/projects/${e}`,n)}getCurrent(e){return this._client.get("/projects",e)}}Sp.APIKey=xC;Sp.ProviderKey=EC;let bC=class extends vr{create(e,n,r){return this._client.post(nn`/threads/${e}/messages`,{body:n,...r})}list(e,n={},r){return this._client.get(nn`/threads/${e}/messages`,{query:n,...r})}delete(e,n,r){const{id:i}=n;return this._client.delete(nn`/threads/${i}/messages/${e}`,{...r,headers:$i([{Accept:"*/*"},r?.headers])})}updateComponentState(e,n,r){const{id:i,...a}=n;return this._client.put(nn`/threads/${i}/messages/${e}/component-state`,{body:a,...r})}},TC=class extends vr{list(e,n,r){const{id:i}=n;return this._client.get(nn`/threads/${i}/messages/${e}/suggestions`,r)}generate(e,n,r){const{id:i,...a}=n;return this._client.post(nn`/threads/${i}/messages/${e}/suggestions`,{body:a,...r})}},wp=class extends vr{constructor(){super(...arguments),this.messages=new bC(this._client),this.suggestions=new TC(this._client)}create(e,n){return this._client.post("/threads",{body:e,...n})}retrieve(e,n={},r){return this._client.get(nn`/threads/${e}`,{query:n,...r})}update(e,n,r){return this._client.put(nn`/threads/${e}`,{body:n,...r})}list(e,n={},r){return this._client.getAPIList(nn`/threads/project/${e}`,O3,{query:n,...r})}delete(e,n){return this._client.delete(nn`/threads/${e}`,{...n,headers:$i([{Accept:"*/*"},n?.headers])})}advance(e){return this._client.post("/threads/advance",e)}advanceByID(e,n,r){return this._client.post(nn`/threads/${e}/advance`,{body:n,...r})}cancel(e,n){return this._client.post(nn`/threads/${e}/cancel`,n)}generateName(e,n={},r){const{contextKey:i}=n??{};return this._client.post(nn`/threads/${e}/generate-name`,{query:{contextKey:i},...r})}};wp.Messages=bC;wp.Suggestions=TC;class So extends vr{constructor(){super(...arguments),this.registry=new wC(this._client),this.projects=new Sp(this._client),this.threads=new wp(this._client),this.auth=new yC(this._client),this.audio=new _C(this._client)}}So.Registry=wC;So.Projects=Sp;So.Threads=wp;So.Auth=yC;So.Audio=_C;class MC extends vr{presign(e,n){return this._client.post("/storage/presign",{body:e,...n})}}class RC extends vr{list(e,n={},r){return this._client.get(nn`/v1/threads/${e}/messages`,{query:n,...r})}get(e,n,r){const{threadId:i}=n;return this._client.get(nn`/v1/threads/${i}/messages/${e}`,r)}}class CC extends vr{create(e,n){return this._client.post("/v1/threads/runs",{body:e,...n,headers:$i([{Accept:"text/event-stream"},n?.headers]),stream:!0})}delete(e,n,r){const{threadId:i}=n;return this._client.delete(nn`/v1/threads/${i}/runs/${e}`,r)}run(e,n,r){return this._client.post(nn`/v1/threads/${e}/runs`,{body:n,...r,headers:$i([{Accept:"text/event-stream"},r?.headers]),stream:!0})}}class AC extends vr{updateState(e,n,r){const{threadId:i,...a}=n;return this._client.post(nn`/v1/threads/${i}/components/${e}/state`,{body:a,...r})}}class PC extends vr{create(e,n,r){const{threadId:i,...a}=n;return this._client.post(nn`/v1/threads/${i}/messages/${e}/suggestions`,{body:a,...r})}list(e,n,r){const{threadId:i,...a}=n;return this._client.get(nn`/v1/threads/${i}/messages/${e}/suggestions`,{query:a,...r})}}class Vl extends vr{constructor(){super(...arguments),this.state=new AC(this._client),this.messages=new RC(this._client),this.runs=new CC(this._client),this.suggestions=new PC(this._client)}create(e,n){return this._client.post("/v1/threads",{body:e,...n})}retrieve(e,n={},r){return this._client.get(nn`/v1/threads/${e}`,{query:n,...r})}list(e={},n){return this._client.get("/v1/threads",{query:e,...n})}delete(e,n){return this._client.delete(nn`/v1/threads/${e}`,{...n,headers:$i([{Accept:"*/*"},n?.headers])})}}Vl.State=AC;Vl.Messages=RC;Vl.Runs=CC;Vl.Suggestions=PC;var W3={};const Pg=t=>{if(typeof globalThis.process<"u")return W3?.[t]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(t)?.trim()};var iv,ly,_h,IC;const NC={production:"https://api.tambo.co",staging:"https://hydra-api-dev.up.railway.app"};class kn{constructor({baseURL:e=Pg("TAMBO_AI_BASE_URL"),apiKey:n=Pg("TAMBO_API_KEY")??null,bearer:r=null,...i}={}){iv.add(this),_h.set(this,void 0),this.beta=new So(this),this.storage=new MC(this),this.threads=new Vl(this);const a={apiKey:n,bearer:r,...i,baseURL:e,environment:i.environment??"production"};if(e&&i.environment)throw new ni("Ambiguous URL; The `baseURL` option (or TAMBO_AI_BASE_URL env var) and the `environment` option are given. If you want to use the environment you must pass baseURL: null");this.baseURL=a.baseURL||NC[a.environment||"production"],this.timeout=a.timeout??ly.DEFAULT_TIMEOUT,this.logger=a.logger??console;const l="warn";this.logLevel=l,this.logLevel=vx(a.logLevel,"ClientOptions.logLevel",this)??vx(Pg("TAMBO_AI_LOG"),"process.env['TAMBO_AI_LOG']",this)??l,this.fetchOptions=a.fetchOptions,this.maxRetries=a.maxRetries??0,this.fetch=a.fetch??x3(),hi(this,_h,b3),this._options=a,this.apiKey=n,this.bearer=r}withOptions(e){return new this.constructor({...this._options,environment:e.environment?e.environment:void 0,baseURL:e.environment?void 0:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,bearer:this.bearer,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){if(!(this.apiKey&&e.get("x-api-key"))&&!n.has("x-api-key")&&!(this.bearer&&e.get("authorization"))&&!n.has("authorization"))throw new Error('Could not resolve authentication method. Expected either apiKey or bearer to be set. Or for one of the "x-api-key" or "Authorization" headers to be explicitly omitted')}async authHeaders(e){return $i([await this.apiKeyAuth(e),await this.bearerAuth(e)])}async apiKeyAuth(e){if(this.apiKey!=null)return $i([{"x-api-key":this.apiKey}])}async bearerAuth(e){if(this.bearer!=null)return $i([{Authorization:`Bearer ${this.bearer}`}])}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new ni(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${pl}`}defaultIdempotencyKey(){return`stainless-node-retry-${eC()}`}makeStatusError(e,n,r,i){return Ir.generate(e,n,r,i)}buildURL(e,n,r){const i=!Nn(this,iv,"m",IC).call(this)&&r||this.baseURL,a=d3(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return h3(l)||(n={...l,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(a.search=this.stringifyQuery(n)),a.toString()}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(i=>({method:e,path:n,...i})))}request(e,n=null){return new yp(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,r){const i=await e,a=i.maxRetries??this.maxRetries;n==null&&(n=a),await this.prepareOptions(i);const{req:l,url:c,timeout:u}=await this.buildRequest(i,{retryCount:a-n});await this.prepareRequest(l,{url:c,options:i});const f="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),h=r===void 0?"":`, retryOf: ${r}`,p=Date.now();if(Mr(this).debug(`[${f}] sending request`,Xa({retryOfRequestLogID:r,method:i.method,url:c,options:i,headers:l.headers})),i.signal?.aborted)throw new ev;const m=new AbortController,y=await this.fetchWithTimeout(c,l,u,m).catch(Q_),S=Date.now();if(y instanceof globalThis.Error){const g=`retrying, ${n} attempts remaining`;if(i.signal?.aborted)throw new ev;const v=J_(y)||/timed? ?out/i.test(String(y)+("cause"in y?String(y.cause):""));if(n)return Mr(this).info(`[${f}] connection ${v?"timed out":"failed"} - ${g}`),Mr(this).debug(`[${f}] connection ${v?"timed out":"failed"} (${g})`,Xa({retryOfRequestLogID:r,url:c,durationMs:S-p,message:y.message})),this.retryRequest(i,n,r??f);throw Mr(this).info(`[${f}] connection ${v?"timed out":"failed"} - error; no more retries left`),Mr(this).debug(`[${f}] connection ${v?"timed out":"failed"} (error; no more retries left)`,Xa({retryOfRequestLogID:r,url:c,durationMs:S-p,message:y.message})),v?new tC:new _p({cause:y})}const E=`[${f}${h}] ${l.method} ${c} ${y.ok?"succeeded":"failed"} with status ${y.status} in ${S-p}ms`;if(!y.ok){const g=await this.shouldRetry(y);if(n&&g){const M=`retrying, ${n} attempts remaining`;return await E3(y.body),Mr(this).info(`${E} - ${M}`),Mr(this).debug(`[${f}] response error (${M})`,Xa({retryOfRequestLogID:r,url:y.url,status:y.status,headers:y.headers,durationMs:S-p})),this.retryRequest(i,n,r??f,y.headers)}const v=g?"error; no more retries left":"error; not retryable";Mr(this).info(`${E} - ${v}`);const x=await y.text().catch(M=>Q_(M).message),w=g3(x),C=w?void 0:x;throw Mr(this).debug(`[${f}] response error (${v})`,Xa({retryOfRequestLogID:r,url:y.url,status:y.status,headers:y.headers,message:C,durationMs:Date.now()-p})),this.makeStatusError(y.status,w,C,y.headers)}return Mr(this).info(E),Mr(this).debug(`[${f}] response start`,Xa({retryOfRequestLogID:r,url:y.url,status:y.status,headers:y.headers,durationMs:S-p})),{response:y,options:i,controller:m,requestLogID:f,retryOfRequestLogID:r,startTime:p}}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}requestAPIList(e,n){const r=this.makeRequest(n,null,void 0);return new L3(this,r,e)}async fetchWithTimeout(e,n,r,i){const{signal:a,method:l,...c}=n||{},u=i.abort.bind(i);a&&a.addEventListener("abort",u,{once:!0});const f=setTimeout(u,r),h=globalThis.ReadableStream&&c.body instanceof globalThis.ReadableStream||typeof c.body=="object"&&c.body!==null&&Symbol.asyncIterator in c.body,p={signal:i.signal,...h?{duplex:"half"}:{},method:"GET",...c};l&&(p.method=l.toUpperCase());try{return await this.fetch.call(void 0,e,p)}finally{clearTimeout(f)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r,i){let a;const l=i?.get("retry-after-ms");if(l){const u=parseFloat(l);Number.isNaN(u)||(a=u)}const c=i?.get("retry-after");if(c&&!a){const u=parseFloat(c);Number.isNaN(u)?a=Date.parse(c)-Date.now():a=u*1e3}if(!(a&&0<=a&&a<60*1e3)){const u=e.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(n,u)}return await _3(a),this.makeRequest(e,n-1,r)}calculateDefaultRetryTimeoutMillis(e,n){const a=n-e,l=Math.min(1*Math.pow(2,a),5),c=1-Math.random()*.25;return l*c*1e3}async buildRequest(e,{retryCount:n=0}={}){const r={...e},{method:i,path:a,query:l,defaultBaseURL:c}=r,u=this.buildURL(a,l,c);"timeout"in r&&m3("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const{bodyHeaders:f,body:h}=this.buildBody({options:r}),p=await this.buildHeaders({options:e,method:i,bodyHeaders:f,retryCount:n});return{req:{method:i,headers:p,...r.signal&&{signal:r.signal},...globalThis.ReadableStream&&h instanceof globalThis.ReadableStream&&{duplex:"half"},...h&&{body:h},...this.fetchOptions??{},...r.fetchOptions??{}},url:u,timeout:r.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:r,retryCount:i}){let a={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const l=$i([a,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...w3()},await this.authHeaders(e),this._options.defaultHeaders,r,e.headers]);return this.validateHeaders(l),l.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=$i([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:dC(e)}:Nn(this,_h,"f").call(this,{body:e,headers:r})}}ly=kn,_h=new WeakMap,iv=new WeakSet,IC=function(){return this.baseURL!==NC[this._options.environment||"production"]};kn.TamboAI=ly;kn.DEFAULT_TIMEOUT=6e4;kn.TamboAIError=ni;kn.APIError=Ir;kn.APIConnectionError=_p;kn.APIConnectionTimeoutError=tC;kn.APIUserAbortError=ev;kn.NotFoundError=sC;kn.ConflictError=aC;kn.RateLimitError=lC;kn.BadRequestError=nC;kn.AuthenticationError=rC;kn.InternalServerError=cC;kn.PermissionDeniedError=iC;kn.UnprocessableEntityError=oC;kn.toFile=V3;kn.Beta=So;kn.Storage=MC;kn.Threads=Vl;async function xx(t,e,n,r){let a=0;for(;;)try{const c=await t.post(`/threads${n?`/${n}`:""}/advancestream`,{body:e,...r,headers:{...r?.headers,Accept:"text/event-stream"}}).asResponse();return q3(c)}catch(l){if(a<2){a++,console.warn(`Request failed, attempting retry ${a}/2`);continue}throw l}}async function*q3(t){const e=new TextDecoder,n=5;let r=0;const i=t.body.getReader();for(;;)try{const{done:a,value:l}=await i.read();if(a)break;const u=e.decode(l).split(`
`).filter(f=>f.trim());for(const f of u){if(f==="data: DONE")continue;if(f.startsWith("error: "))throw new Error(f.slice(7));const h=f.startsWith("data: ")?f.slice(6):f;if(h)try{yield JSON.parse(h),r=0}catch{if(r<n){r++,console.warn(`Failed to parse JSON chunk, skipping. Attempt ${r}/${n}`);continue}throw new Error("Failed to parse JSON after multiple chunks.")}}}catch(a){throw i.releaseLock(),a}}var jl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Z3={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},X3=class{#e=Z3;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},ro=new X3;function K3(t){setTimeout(t,0)}var fo=typeof window>"u"||"Deno"in globalThis;function Rr(){}function Y3(t,e){return typeof t=="function"?t(e):t}function sv(t){return typeof t=="number"&&t>=0&&t!==1/0}function kC(t,e){return Math.max(t+(e||0)-Date.now(),0)}function ma(t,e){return typeof t=="function"?t(e):t}function pi(t,e){return typeof t=="function"?t(e):t}function Ex(t,e){const{type:n="all",exact:r,fetchStatus:i,predicate:a,queryKey:l,stale:c}=t;if(l){if(r){if(e.queryHash!==cy(l,e.options))return!1}else if(!gu(e.queryKey,l))return!1}if(n!=="all"){const u=e.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||i&&i!==e.state.fetchStatus||a&&!a(e))}function bx(t,e){const{exact:n,status:r,predicate:i,mutationKey:a}=t;if(a){if(!e.options.mutationKey)return!1;if(n){if(ho(e.options.mutationKey)!==ho(a))return!1}else if(!gu(e.options.mutationKey,a))return!1}return!(r&&e.state.status!==r||i&&!i(e))}function cy(t,e){return(e?.queryKeyHashFn||ho)(t)}function ho(t){return JSON.stringify(t,(e,n)=>av(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function gu(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>gu(t[n],e[n])):!1}var J3=Object.prototype.hasOwnProperty;function LC(t,e,n=0){if(t===e)return t;if(n>500)return e;const r=Tx(t)&&Tx(e);if(!r&&!(av(t)&&av(e)))return e;const a=(r?t:Object.keys(t)).length,l=r?e:Object.keys(e),c=l.length,u=r?new Array(c):{};let f=0;for(let h=0;h<c;h++){const p=r?h:l[h],m=t[p],y=e[p];if(m===y){u[p]=m,(r?h<a:J3.call(t,p))&&f++;continue}if(m===null||y===null||typeof m!="object"||typeof y!="object"){u[p]=y;continue}const S=LC(m,y,n+1);u[p]=S,S===m&&f++}return a===c&&f===a?t:u}function zh(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Tx(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function av(t){if(!Mx(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Mx(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Mx(t){return Object.prototype.toString.call(t)==="[object Object]"}function Q3(t){return new Promise(e=>{ro.setTimeout(e,t)})}function ov(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?LC(t,e):e}function eF(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function tF(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var uy=Symbol();function OC(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===uy?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function dy(t,e){return typeof t=="function"?t(...e):!!t}function nF(t,e,n){let r=!1,i;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(i??=e(),r||(r=!0,i.aborted?n():i.addEventListener("abort",n,{once:!0})),i)}),t}var rF=class extends jl{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!fo&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},fy=new rF;function lv(){let t,e;const n=new Promise((i,a)=>{t=i,e=a});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),t(i)},n.reject=i=>{r({status:"rejected",reason:i}),e(i)},n}var iF=K3;function sF(){let t=[],e=0,n=c=>{c()},r=c=>{c()},i=iF;const a=c=>{e?t.push(c):i(()=>{n(c)})},l=()=>{const c=t;t=[],c.length&&i(()=>{r(()=>{c.forEach(u=>{n(u)})})})};return{batch:c=>{let u;e++;try{u=c()}finally{e--,e||l()}return u},batchCalls:c=>(...u)=>{a(()=>{c(...u)})},schedule:a,setNotifyFunction:c=>{n=c},setBatchNotifyFunction:c=>{r=c},setScheduler:c=>{i=c}}}var Vn=sF(),aF=class extends jl{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!fo&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},$h=new aF;function oF(t){return Math.min(1e3*2**t,3e4)}function DC(t){return(t??"online")==="online"?$h.isOnline():!0}var cv=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function UC(t){let e=!1,n=0,r;const i=lv(),a=()=>i.status!=="pending",l=E=>{if(!a()){const g=new cv(E);m(g),t.onCancel?.(g)}},c=()=>{e=!0},u=()=>{e=!1},f=()=>fy.isFocused()&&(t.networkMode==="always"||$h.isOnline())&&t.canRun(),h=()=>DC(t.networkMode)&&t.canRun(),p=E=>{a()||(r?.(),i.resolve(E))},m=E=>{a()||(r?.(),i.reject(E))},y=()=>new Promise(E=>{r=g=>{(a()||f())&&E(g)},t.onPause?.()}).then(()=>{r=void 0,a()||t.onContinue?.()}),S=()=>{if(a())return;let E;const g=n===0?t.initialPromise:void 0;try{E=g??t.fn()}catch(v){E=Promise.reject(v)}Promise.resolve(E).then(p).catch(v=>{if(a())return;const x=t.retry??(fo?0:3),w=t.retryDelay??oF,C=typeof w=="function"?w(n,v):w,T=x===!0||typeof x=="number"&&n<x||typeof x=="function"&&x(n,v);if(e||!T){m(v);return}n++,t.onFail?.(n,v),Q3(C).then(()=>f()?void 0:y()).then(()=>{e?m(v):S()})})};return{promise:i,status:()=>i.status,cancel:l,continue:()=>(r?.(),i),cancelRetry:c,continueRetry:u,canStart:h,start:()=>(h()?S():y().then(S),i)}}var FC=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),sv(this.gcTime)&&(this.#e=ro.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(fo?1/0:300*1e3))}clearGcTimeout(){this.#e&&(ro.clearTimeout(this.#e),this.#e=void 0)}},lF=class extends FC{#e;#t;#n;#i;#r;#a;#o;constructor(t){super(),this.#o=!1,this.#a=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#i=t.client,this.#n=this.#i.getQueryCache(),this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#e=Cx(this.options),this.state=t.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(t){if(this.options={...this.#a,...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const e=Cx(this.options);e.data!==void 0&&(this.setState(Rx(e.data,e.dataUpdatedAt)),this.#e=e)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(t,e){const n=ov(this.state.data,t,this.options);return this.#s({data:n,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),n}setState(t,e){this.#s({type:"setState",state:t,setStateOptions:e})}cancel(t){const e=this.#r?.promise;return this.#r?.cancel(t),e?e.then(Rr).catch(Rr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(t=>pi(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===uy||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ma(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!kC(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(t,e){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(t&&this.setOptions(t),!this.options.queryFn){const c=this.observers.find(u=>u.options.queryFn);c&&this.setOptions(c.options)}const n=new AbortController,r=c=>{Object.defineProperty(c,"signal",{enumerable:!0,get:()=>(this.#o=!0,n.signal)})},i=()=>{const c=OC(this.options,e),f=(()=>{const h={client:this.#i,queryKey:this.queryKey,meta:this.meta};return r(h),h})();return this.#o=!1,this.options.persister?this.options.persister(c,f,this):c(f)},l=(()=>{const c={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:i};return r(c),c})();this.options.behavior?.onFetch(l,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==l.fetchOptions?.meta)&&this.#s({type:"fetch",meta:l.fetchOptions?.meta}),this.#r=UC({initialPromise:e?.initialPromise,fn:l.fetchFn,onCancel:c=>{c instanceof cv&&c.revert&&this.setState({...this.#t,fetchStatus:"idle"}),n.abort()},onFail:(c,u)=>{this.#s({type:"failed",failureCount:c,error:u})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0});try{const c=await this.#r.start();if(c===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(c),this.#n.config.onSuccess?.(c,this),this.#n.config.onSettled?.(c,this.state.error,this),c}catch(c){if(c instanceof cv){if(c.silent)return this.#r.promise;if(c.revert){if(this.state.data===void 0)throw c;return this.state.data}}throw this.#s({type:"error",error:c}),this.#n.config.onError?.(c,this),this.#n.config.onSettled?.(this.state.data,c,this),c}finally{this.scheduleGc()}}#s(t){const e=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...zC(n.data,this.options),fetchMeta:t.meta??null};case"success":const r={...n,...Rx(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=t.manual?r:void 0,r;case"error":const i=t.error;return{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=e(this.state),Vn.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:t})})}};function zC(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:DC(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Rx(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Cx(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var cF=class extends jl{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#o=lv(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#a;#o;#s;#m;#f;#h;#c;#u;#l;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),Ax(this.#t,this.options)?this.#d():this.updateResult(),this.#y())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return uv(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return uv(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#S(),this.#w(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof pi(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#x(),this.#t.setOptions(this.options),e._defaulted&&!zh(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const r=this.hasListeners();r&&Px(this.#t,n,this.options,e)&&this.#d(),this.updateResult(),r&&(this.#t!==n||pi(this.options.enabled,this.#t)!==pi(e.enabled,this.#t)||ma(this.options.staleTime,this.#t)!==ma(e.staleTime,this.#t))&&this.#g();const i=this.#_();r&&(this.#t!==n||pi(this.options.enabled,this.#t)!==pi(e.enabled,this.#t)||i!==this.#l)&&this.#v(i)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return dF(this,n)&&(this.#i=n,this.#a=this.options,this.#r=this.#t.state),n}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(n,r)=>(this.trackProp(r),e?.(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,r))})}trackProp(t){this.#p.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#x();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(Rr)),e}#g(){this.#S();const t=ma(this.options.staleTime,this.#t);if(fo||this.#i.isStale||!sv(t))return;const n=kC(this.#i.dataUpdatedAt,t)+1;this.#c=ro.setTimeout(()=>{this.#i.isStale||this.updateResult()},n)}#_(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#v(t){this.#w(),this.#l=t,!(fo||pi(this.options.enabled,this.#t)===!1||!sv(this.#l)||this.#l===0)&&(this.#u=ro.setInterval(()=>{(this.options.refetchIntervalInBackground||fy.isFocused())&&this.#d()},this.#l))}#y(){this.#g(),this.#v(this.#_())}#S(){this.#c&&(ro.clearTimeout(this.#c),this.#c=void 0)}#w(){this.#u&&(ro.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const n=this.#t,r=this.options,i=this.#i,a=this.#r,l=this.#a,u=t!==n?t.state:this.#n,{state:f}=t;let h={...f},p=!1,m;if(e._optimisticResults){const F=this.hasListeners(),I=!F&&Ax(t,e),O=F&&Px(t,n,e,r);(I||O)&&(h={...h,...zC(f.data,t.options)}),e._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:y,errorUpdatedAt:S,status:E}=h;m=h.data;let g=!1;if(e.placeholderData!==void 0&&m===void 0&&E==="pending"){let F;i?.isPlaceholderData&&e.placeholderData===l?.placeholderData?(F=i.data,g=!0):F=typeof e.placeholderData=="function"?e.placeholderData(this.#h?.state.data,this.#h):e.placeholderData,F!==void 0&&(E="success",m=ov(i?.data,F,e),p=!0)}if(e.select&&m!==void 0&&!g)if(i&&m===a?.data&&e.select===this.#m)m=this.#f;else try{this.#m=e.select,m=e.select(m),m=ov(i?.data,m,e),this.#f=m,this.#s=null}catch(F){this.#s=F}this.#s&&(y=this.#s,m=this.#f,S=Date.now(),E="error");const v=h.fetchStatus==="fetching",x=E==="pending",w=E==="error",C=x&&v,T=m!==void 0,A={status:E,fetchStatus:h.fetchStatus,isPending:x,isSuccess:E==="success",isError:w,isInitialLoading:C,isLoading:C,data:m,dataUpdatedAt:h.dataUpdatedAt,error:y,errorUpdatedAt:S,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:v,isRefetching:v&&!x,isLoadingError:w&&!T,isPaused:h.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:w&&T,isStale:hy(t,e),refetch:this.refetch,promise:this.#o,isEnabled:pi(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const F=A.data!==void 0,I=A.status==="error"&&!F,O=ae=>{I?ae.reject(A.error):F&&ae.resolve(A.data)},W=()=>{const ae=this.#o=A.promise=lv();O(ae)},J=this.#o;switch(J.status){case"pending":t.queryHash===n.queryHash&&O(J);break;case"fulfilled":(I||A.data!==J.value)&&W();break;case"rejected":(!I||A.error!==J.reason)&&W();break}}return A}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#a=this.options,this.#r.data!==void 0&&(this.#h=this.#t),zh(e,t))return;this.#i=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:r}=this.options,i=typeof r=="function"?r():r;if(i==="all"||!i&&!this.#p.size)return!0;const a=new Set(i??this.#p);return this.options.throwOnError&&a.add("error"),Object.keys(this.#i).some(l=>{const c=l;return this.#i[c]!==t[c]&&a.has(c)})};this.#E({listeners:n()})}#x(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#y()}#E(t){Vn.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function uF(t,e){return pi(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Ax(t,e){return uF(t,e)||t.state.data!==void 0&&uv(t,e,e.refetchOnMount)}function uv(t,e,n){if(pi(e.enabled,t)!==!1&&ma(e.staleTime,t)!=="static"){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&hy(t,e)}return!1}function Px(t,e,n,r){return(t!==e||pi(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&hy(t,n)}function hy(t,e){return pi(e.enabled,t)!==!1&&t.isStaleByTime(ma(e.staleTime,t))}function dF(t,e){return!zh(t.getCurrentResult(),e)}function Ix(t){return{onFetch:(e,n)=>{const r=e.options,i=e.fetchOptions?.meta?.fetchMore?.direction,a=e.state.data?.pages||[],l=e.state.data?.pageParams||[];let c={pages:[],pageParams:[]},u=0;const f=async()=>{let h=!1;const p=S=>{nF(S,()=>e.signal,()=>h=!0)},m=OC(e.options,e.fetchOptions),y=async(S,E,g)=>{if(h)return Promise.reject();if(E==null&&S.pages.length)return Promise.resolve(S);const x=(()=>{const M={client:e.client,queryKey:e.queryKey,pageParam:E,direction:g?"backward":"forward",meta:e.options.meta};return p(M),M})(),w=await m(x),{maxPages:C}=e.options,T=g?tF:eF;return{pages:T(S.pages,w,C),pageParams:T(S.pageParams,E,C)}};if(i&&a.length){const S=i==="backward",E=S?fF:Nx,g={pages:a,pageParams:l},v=E(r,g);c=await y(g,v,S)}else{const S=t??a.length;do{const E=u===0?l[0]??r.initialPageParam:Nx(r,c);if(u>0&&E==null)break;c=await y(c,E),u++}while(u<S)}return c};e.options.persister?e.fetchFn=()=>e.options.persister?.(f,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=f}}}function Nx(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function fF(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var hF=class extends FC{#e;#t;#n;#i;constructor(t){super(),this.#e=t.client,this.mutationId=t.mutationId,this.#n=t.mutationCache,this.#t=[],this.state=t.state||$C(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#t.includes(t)||(this.#t.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#t=this.#t.filter(e=>e!==t),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(t){const e=()=>{this.#r({type:"continue"})},n={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=UC({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(a,l)=>{this.#r({type:"failed",failureCount:a,error:l})},onPause:()=>{this.#r({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const r=this.state.status==="pending",i=!this.#i.canStart();try{if(r)e();else{this.#r({type:"pending",variables:t,isPaused:i}),this.#n.config.onMutate&&await this.#n.config.onMutate(t,this,n);const l=await this.options.onMutate?.(t,n);l!==this.state.context&&this.#r({type:"pending",context:l,variables:t,isPaused:i})}const a=await this.#i.start();return await this.#n.config.onSuccess?.(a,t,this.state.context,this,n),await this.options.onSuccess?.(a,t,this.state.context,n),await this.#n.config.onSettled?.(a,null,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(a,null,t,this.state.context,n),this.#r({type:"success",data:a}),a}catch(a){try{await this.#n.config.onError?.(a,t,this.state.context,this,n)}catch(l){Promise.reject(l)}try{await this.options.onError?.(a,t,this.state.context,n)}catch(l){Promise.reject(l)}try{await this.#n.config.onSettled?.(void 0,a,this.state.variables,this.state.context,this,n)}catch(l){Promise.reject(l)}try{await this.options.onSettled?.(void 0,a,t,this.state.context,n)}catch(l){Promise.reject(l)}throw this.#r({type:"error",error:a}),a}finally{this.#n.runNext(this)}}#r(t){const e=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),Vn.batch(()=>{this.#t.forEach(n=>{n.onMutationUpdate(t)}),this.#n.notify({mutation:this,type:"updated",action:t})})}};function $C(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var pF=class extends jl{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const r=new hF({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(r),r}add(t){this.#e.add(t);const e=Qd(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=Qd(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const r=n.indexOf(t);r!==-1&&n.splice(r,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Qd(t);if(typeof e=="string"){const r=this.#t.get(e)?.find(i=>i.state.status==="pending");return!r||r===t}else return!0}runNext(t){const e=Qd(t);return typeof e=="string"?this.#t.get(e)?.find(r=>r!==t&&r.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Vn.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>bx(e,n))}findAll(t={}){return this.getAll().filter(e=>bx(t,e))}notify(t){Vn.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return Vn.batch(()=>Promise.all(t.map(e=>e.continue().catch(Rr))))}};function Qd(t){return t.options.scope?.id}var mF=class extends jl{#e;#t=void 0;#n;#i;constructor(e,n){super(),this.#e=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#e.defaultMutationOptions(e),zh(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&ho(n.mutationKey)!==ho(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#a()}mutate(e,n){return this.#i=n,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??$C();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){Vn.batch(()=>{if(this.#i&&this.hasListeners()){const n=this.#t.variables,r=this.#t.context,i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#i.onSuccess?.(e.data,n,r,i)}catch(a){Promise.reject(a)}try{this.#i.onSettled?.(e.data,null,n,r,i)}catch(a){Promise.reject(a)}}else if(e?.type==="error"){try{this.#i.onError?.(e.error,n,r,i)}catch(a){Promise.reject(a)}try{this.#i.onSettled?.(void 0,e.error,n,r,i)}catch(a){Promise.reject(a)}}}this.listeners.forEach(n=>{n(this.#t)})})}},gF=class extends jl{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const r=e.queryKey,i=e.queryHash??cy(r,e);let a=this.get(i);return a||(a=new lF({client:t,queryKey:r,queryHash:i,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(r)}),this.add(a)),a}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Vn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Ex(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>Ex(t,n)):e}notify(t){Vn.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){Vn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Vn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},_F=class{#e;#t;#n;#i;#r;#a;#o;#s;constructor(t={}){this.#e=t.queryCache||new gF,this.#t=t.mutationCache||new pF,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=fy.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=$h.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(ma(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),a=this.#e.get(r.queryHash)?.state.data,l=Y3(e,a);if(l!==void 0)return this.#e.build(this,r).setData(l,{...n,manual:!0})}setQueriesData(t,e,n){return Vn.batch(()=>this.#e.findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;Vn.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return Vn.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=Vn.batch(()=>this.#e.findAll(t).map(i=>i.cancel(n)));return Promise.all(r).then(Rr).catch(Rr)}invalidateQueries(t,e={}){return Vn.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=Vn.batch(()=>this.#e.findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let a=i.fetch(void 0,n);return n.throwOnError||(a=a.catch(Rr)),i.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(r).then(Rr)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(ma(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Rr).catch(Rr)}fetchInfiniteQuery(t){return t.behavior=Ix(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Rr).catch(Rr)}ensureInfiniteQueryData(t){return t.behavior=Ix(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return $h.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(ho(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],n={};return e.forEach(r=>{gu(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(ho(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(r=>{gu(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=cy(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===uy&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},vF=V.createContext(void 0),BC=t=>{const e=V.useContext(vF);if(t)return t;if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},VC=V.createContext(!1),yF=()=>V.useContext(VC);VC.Provider;function SF(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var wF=V.createContext(SF()),xF=()=>V.useContext(wF),EF=(t,e,n)=>{const r=n?.state.error&&typeof t.throwOnError=="function"?dy(t.throwOnError,[n.state.error,n]):t.throwOnError;(t.suspense||t.experimental_prefetchInRender||r)&&(e.isReset()||(t.retryOnMount=!1))},bF=t=>{V.useEffect(()=>{t.clearReset()},[t])},TF=({result:t,errorResetBoundary:e,throwOnError:n,query:r,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(i&&t.data===void 0||dy(n,[t.error,r])),MF=t=>{if(t.suspense){const n=i=>i==="static"?i:Math.max(i??1e3,1e3),r=t.staleTime;t.staleTime=typeof r=="function"?(...i)=>n(r(...i)):n(r),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},RF=(t,e)=>t.isLoading&&t.isFetching&&!e,CF=(t,e)=>t?.suspense&&e.isPending,kx=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function AF(t,e,n){const r=yF(),i=xF(),a=BC(n),l=a.defaultQueryOptions(t);a.getDefaultOptions().queries?._experimental_beforeQuery?.(l);const c=a.getQueryCache().get(l.queryHash);l._optimisticResults=r?"isRestoring":"optimistic",MF(l),EF(l,i,c),bF(i);const u=!a.getQueryCache().get(l.queryHash),[f]=V.useState(()=>new e(a,l)),h=f.getOptimisticResult(l),p=!r&&t.subscribed!==!1;if(V.useSyncExternalStore(V.useCallback(m=>{const y=p?f.subscribe(Vn.batchCalls(m)):Rr;return f.updateResult(),y},[f,p]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),V.useEffect(()=>{f.setOptions(l)},[l,f]),CF(l,h))throw kx(l,f,i);if(TF({result:h,errorResetBoundary:i,throwOnError:l.throwOnError,query:c,suspense:l.suspense}))throw h.error;return a.getDefaultOptions().queries?._experimental_afterQuery?.(l,h),l.experimental_prefetchInRender&&!fo&&RF(h,r)&&(u?kx(l,f,i):c?.promise)?.catch(Rr).finally(()=>{f.updateResult()}),l.notifyOnChangeProps?h:f.trackResult(h)}function PF(t,e){return AF(t,cF,e)}function IF(t,e){const n=BC(e),[r]=V.useState(()=>new mF(n,t));V.useEffect(()=>{r.setOptions(t)},[r,t]);const i=V.useSyncExternalStore(V.useCallback(l=>r.subscribe(Vn.batchCalls(l)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),a=V.useCallback((l,c)=>{r.mutate(l,c).catch(Rr)},[r]);if(i.error&&dy(r.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:a,mutateAsync:i.mutate}}const NF="0.74.1",kF={version:NF};function LF(t,e,n){const r=PF({queryKey:["tambo-session-token",n],queryFn:async()=>{const a={grant_type:"urn:ietf:params:oauth:grant-type:token-exchange",subject_token:n,subject_token_type:"urn:ietf:params:oauth:token-type:access_token"},l=new URLSearchParams(a).toString(),c=new TextEncoder().encode(l);return await t.beta.auth.getToken(c)},enabled:!!n,refetchInterval:a=>a.state.data?.expires_in?a.state.data.expires_in*1e3:!1},e),i=r.data?.access_token??null;return V.useEffect(()=>{t.bearer=i},[i,t]),r}const Hl=V.createContext(void 0),OF=({children:t,tamboUrl:e,apiKey:n,environment:r,userToken:i,additionalHeaders:a})=>{const l=V.useMemo(()=>({apiKey:n,defaultHeaders:{"X-Tambo-React-Version":kF.version,...a},baseURL:e??void 0,environment:r??void 0}),[a,n,e,r]),c=V.useMemo(()=>new kn(l),[l]),u=V.useMemo(()=>new _F,[]),{isFetching:f}=LF(c,u,i);return qt.createElement(Hl.Provider,{value:{client:c,queryClient:u,isUpdatingToken:f,additionalHeaders:l.defaultHeaders}},t)},jC=()=>{const t=qt.useContext(Hl);if(t===void 0)throw new Error("useTamboClient must be used within a TamboClientProvider");return t.client},HC=()=>{const t=qt.useContext(Hl);if(t===void 0)throw new Error("useTamboQueryClient must be used within a TamboClientProvider");return t.queryClient},Qc={BROWSER_SIDE:"browser-side",TAMBO_INTERNAL:"tambo-internal",TAMBO_REGISTRY:"tambo-registry"},DF="registry";function UF(t){return!!t&&typeof t=="object"&&"type"in t&&typeof t.type=="string"}function FF(t){return Array.isArray(t)&&t.every(e=>UF(e))}function dv(t){if(typeof t=="string")return t;try{return JSON.stringify(t)??String(t)}catch{return String(t)}}var $a={},Ig={},Lx;function Ox(){return Lx||(Lx=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Allow=t.ALL=t.COLLECTION=t.ATOM=t.SPECIAL=t.INF=t._INFINITY=t.INFINITY=t.NAN=t.BOOL=t.NULL=t.OBJ=t.ARR=t.NUM=t.STR=void 0,t.STR=1,t.NUM=2,t.ARR=4,t.OBJ=8,t.NULL=16,t.BOOL=32,t.NAN=64,t.INFINITY=128,t._INFINITY=256,t.INF=t.INFINITY|t._INFINITY,t.SPECIAL=t.NULL|t.BOOL|t.INF|t.NAN,t.ATOM=t.STR|t.NUM|t.SPECIAL,t.COLLECTION=t.ARR|t.OBJ,t.ALL=t.ATOM|t.COLLECTION,t.Allow={STR:t.STR,NUM:t.NUM,ARR:t.ARR,OBJ:t.OBJ,NULL:t.NULL,BOOL:t.BOOL,NAN:t.NAN,INFINITY:t.INFINITY,_INFINITY:t._INFINITY,INF:t.INF,SPECIAL:t.SPECIAL,ATOM:t.ATOM,COLLECTION:t.COLLECTION,ALL:t.ALL},t.default=t.Allow})(Ig)),Ig}var Dx;function zF(){return Dx||(Dx=1,(function(t){var e=$a&&$a.__createBinding||(Object.create?(function(f,h,p,m){m===void 0&&(m=p);var y=Object.getOwnPropertyDescriptor(h,p);(!y||("get"in y?!h.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return h[p]}}),Object.defineProperty(f,m,y)}):(function(f,h,p,m){m===void 0&&(m=p),f[m]=h[p]})),n=$a&&$a.__exportStar||function(f,h){for(var p in f)p!=="default"&&!Object.prototype.hasOwnProperty.call(h,p)&&e(h,f,p)};Object.defineProperty(t,"__esModule",{value:!0}),t.Allow=t.MalformedJSON=t.PartialJSON=t.parseJSON=t.parse=void 0;const r=Ox();Object.defineProperty(t,"Allow",{enumerable:!0,get:function(){return r.Allow}}),n(Ox(),t);class i extends Error{}t.PartialJSON=i;class a extends Error{}t.MalformedJSON=a;function l(f,h=r.Allow.ALL){if(typeof f!="string")throw new TypeError(`expecting str, got ${typeof f}`);if(!f.trim())throw new Error(`${f} is empty`);return c(f.trim(),h)}t.parseJSON=l;const c=(f,h)=>{const p=f.length;let m=0;const y=T=>{throw new i(`${T} at position ${m}`)},S=T=>{throw new a(`${T} at position ${m}`)},E=()=>(C(),m>=p&&y("Unexpected end of input"),f[m]==='"'?g():f[m]==="{"?v():f[m]==="["?x():f.substring(m,m+4)==="null"||r.Allow.NULL&h&&p-m<4&&"null".startsWith(f.substring(m))?(m+=4,null):f.substring(m,m+4)==="true"||r.Allow.BOOL&h&&p-m<4&&"true".startsWith(f.substring(m))?(m+=4,!0):f.substring(m,m+5)==="false"||r.Allow.BOOL&h&&p-m<5&&"false".startsWith(f.substring(m))?(m+=5,!1):f.substring(m,m+8)==="Infinity"||r.Allow.INFINITY&h&&p-m<8&&"Infinity".startsWith(f.substring(m))?(m+=8,1/0):f.substring(m,m+9)==="-Infinity"||r.Allow._INFINITY&h&&1<p-m&&p-m<9&&"-Infinity".startsWith(f.substring(m))?(m+=9,-1/0):f.substring(m,m+3)==="NaN"||r.Allow.NAN&h&&p-m<3&&"NaN".startsWith(f.substring(m))?(m+=3,NaN):w()),g=()=>{const T=m;let M=!1;for(m++;m<p&&(f[m]!=='"'||M&&f[m-1]==="\\");)M=f[m]==="\\"?!M:!1,m++;if(f.charAt(m)=='"')try{return JSON.parse(f.substring(T,++m-Number(M)))}catch(A){S(String(A))}else if(r.Allow.STR&h)try{return JSON.parse(f.substring(T,m-Number(M))+'"')}catch{return JSON.parse(f.substring(T,f.lastIndexOf("\\"))+'"')}y("Unterminated string literal")},v=()=>{m++,C();const T={};try{for(;f[m]!=="}";){if(C(),m>=p&&r.Allow.OBJ&h)return T;const M=g();C(),m++;try{const A=E();T[M]=A}catch(A){if(r.Allow.OBJ&h)return T;throw A}C(),f[m]===","&&m++}}catch{if(r.Allow.OBJ&h)return T;y("Expected '}' at end of object")}return m++,T},x=()=>{m++;const T=[];try{for(;f[m]!=="]";)T.push(E()),C(),f[m]===","&&m++}catch{if(r.Allow.ARR&h)return T;y("Expected ']' at end of array")}return m++,T},w=()=>{if(m===0){f==="-"&&S("Not sure what '-' is");try{return JSON.parse(f)}catch(M){if(r.Allow.NUM&h)try{return JSON.parse(f.substring(0,f.lastIndexOf("e")))}catch{}S(String(M))}}const T=m;for(f[m]==="-"&&m++;f[m]&&",]}".indexOf(f[m])===-1;)m++;m==p&&!(r.Allow.NUM&h)&&y("Unterminated number literal");try{return JSON.parse(f.substring(T,m))}catch{f.substring(T,m)==="-"&&y("Not sure what '-' is");try{return JSON.parse(f.substring(T,f.lastIndexOf("e")))}catch(A){S(String(A))}}},C=()=>{for(;m<p&&` 
\r	`.includes(f[m]);)m++};return E()},u=l;t.parse=u})($a)),$a}var $F=zF();function BF(t){return t===null||typeof t!="object"&&typeof t!="function"?!1:typeof t.then=="function"}const VF=(t,e,n)=>{const r=[];for(const[i,a]of Object.entries(t)){const c=(n[i]||[]).map(u=>{const f=e[u];return f?py(f):null}).filter(u=>u!==null);r.push({name:a.name,description:a.description,props:a.props,contextTools:c})}return r},jF=(t,e)=>Object.values(t).filter(n=>!Object.values(e).flat().includes(n.name)),HF=(t,e)=>{const n=e[t];if(!n)throw new Error(`Tambo tried to use Component ${t}, but it was not found.`);return n},py=t=>{const e=HU(t);return{name:t.name,description:t.description,parameters:e,..."maxCalls"in t&&t.maxCalls!==void 0?{maxCalls:t.maxCalls}:{},..."annotations"in t&&t.annotations!==void 0?{annotations:t.annotations}:{}}};function Ng(t,e){if(!t.component?.componentName)throw new Error("Component not found");const n=$F.parse(JSON.stringify(t.component.props)),r=HF(t.component.componentName,e);let i=n;if(Bl(r.props)){const u=r.props["~standard"].validate(n);if(BF(u))throw new Error("Async schema validation is not supported for component props");if("value"in u)i=u.value;else{const f=u.issues?.[0]?.message??"Schema validation failed";throw new Error(`Component props validation failed: ${f}`)}}const a=qt.createElement(r.component,i),l={...t,component:{...t.component,props:i}},c=o3(a,l);return{...l,renderedComponent:c}}const Ux=async(t,e,n)=>{if(!t?.toolName)throw new Error("Tool name is required");try{const{tool:r,tamboTool:i}=GF(t.toolName,e);if(!r){if(n)return{result:await n(t.toolName,t.parameters)};throw new Error(`Tool ${t.toolName} not found in registry`)}return{result:await WF(t,r),tamboTool:i}}catch(r){return console.error("Error in calling tool: ",r),{result:`When attempting to call tool ${t.toolName} the following error occurred: ${r}. Explain to the user that the tool call failed and try again if needed.`,error:r instanceof Error?r.message:"Unknown error"}}},GF=(t,e)=>{const n=e[t];if(!n)return{tool:null,tamboTool:null};const r=py(n);return{tool:{getComponentContext:n.tool,definition:r},tamboTool:n}},WF=async(t,e)=>{const n=t.parameters??[],r=Object.fromEntries(n.map(i=>[i.parameterName,i.parameterValue]));return await e.getComponentContext(r)},GC=V.createContext(void 0),qF=({children:t,generationStage:e,statusMessage:n})=>{const r=QR(e),i=V.useMemo(()=>({generationStage:e,generationStatusMessage:n,isIdle:r}),[e,n,r]);return qt.createElement(GC.Provider,{value:i},t)},Ji={id:"placeholder",messages:[],createdAt:"",projectId:"",updatedAt:"",metadata:{}},xp=V.createContext({thread:Ji,currentThreadId:Ji.id,currentThread:Ji,threadMap:{[Ji.id]:Ji},setThreadMap:()=>{throw new Error("setThreadMap not implemented")},switchCurrentThread:()=>{throw new Error("switchCurrentThread not implemented")},startNewThread:()=>{throw new Error("startNewThread not implemented")},updateThreadName:()=>{throw new Error("updateThreadName not implemented")},generateThreadName:()=>{throw new Error("generateThreadName not implemented")},addThreadMessage:()=>{throw new Error("updateThreadMessageHistory not implemented")},streaming:!0,updateThreadMessage:()=>{throw new Error("updateThreadMessage not implemented")},sendThreadMessage:()=>{throw new Error("sendThreadMessage not implemented")},cancel:()=>{throw new Error("cancel not implemented")}}),ZF=({children:t,streaming:e=!0,initialMessages:n=[],autoGenerateThreadName:r=!0,autoGenerateNameThreshold:i=3,contextKey:a})=>{const l=V.useMemo(()=>({id:"placeholder",messages:n.map(P=>({...P,id:P.id??crypto.randomUUID(),threadId:"placeholder",createdAt:P.createdAt??new Date().toISOString(),componentState:P.componentState??{}})),createdAt:"",projectId:"",updatedAt:"",metadata:{},contextKey:a}),[a,n]),[c,u]=V.useState({[l.id]:l}),f=jC(),h=HC(),{componentList:p,toolRegistry:m,componentToolAssociations:y,onCallUnregisteredTool:S}=Tu(),{getAdditionalContext:E}=gp(),[g,v]=V.useState(!1),x=V.useRef(g),[w,C]=V.useState(l.id),T=c[w],M=T?.generationStage??gr.IDLE,A=T?.statusMessage??"",F=V.useMemo(()=>{const P=new Map;if(T)for(const L of T.messages)P.set(L.id,L);return P},[T]);V.useEffect(()=>{x.current=g},[g]);const I=V.useCallback(async(P,L)=>{try{const G=await f.beta.projects.getCurrent();h.setQueryData(["threads",G.id,L],P),await h.invalidateQueries({queryKey:["threads"]})}catch(G){console.warn("Failed to update threads cache:",G)}},[f.beta.projects,h]),O=V.useCallback(async(P,L)=>{const G={...Ji,id:P,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await I(Q=>Q&&{...Q,items:[G,...Q.items??[]],total:(Q.total??0)+1,count:(Q.count??0)+1},L)},[I]),W=V.useCallback(async(P,L,G)=>{await I(Q=>Q?.items?{...Q,items:Q.items.map(le=>le.id===P?L(le):le),total:Q.total,count:Q.count}:Q,G)},[I]),J=V.useCallback(async P=>{const L=await f.beta.threads.retrieve(P),G={...L,messages:L.messages.map(Q=>F.has(Q.id)?{...F.get(Q.id),...Q}:Q.component?.componentName?Ng(Q,p):Q)};u(Q=>({...Q,[P]:G}))},[f.beta.threads,p,F]);V.useEffect(()=>{async function P(){try{await J(w)}catch(L){console.error("Failed to fetch thread:",L)}}w&&w!==l.id&&!c[w]&&P().catch(L=>{console.error("Unexpected error in loadThread:",L)})},[w,J,c,l.id]);const ae=V.useCallback(async(P,L=!0,G=new Date().toISOString())=>{if(!T)return console.warn("Cannot add messages if we do not have a current thread"),[];const Q={...P,createdAt:G},le=P.threadId,xe=Q.id;if(u(Te=>{if(!le)return Te;const X=Te[le]?.messages||[],ve=X.find(be=>be.id===xe)?X.map(be=>be.id===xe?Q:be):[...X,Q];return{...Te,[le]:{...Te[le],messages:ve}}}),L)try{await f.beta.threads.messages.create(P.threadId,{content:P.content,role:P.role,additionalContext:Q.additionalContext})}catch(Te){throw console.error("Failed to add message to server",Te),u(X=>{const ve=(X[le]?.messages||[]).filter(he=>he.id!==xe);return{...X,[le]:{...X[le],messages:ve}}}),Te}return c[le]?.messages||[]},[f.beta.threads.messages,T,c]),Z=V.useCallback(async(P,L,G=!0,Q=new Date().toISOString())=>{if(u(le=>{const Te=(le[L.threadId]?.messages||[]).map(X=>X.id===P?{...X,...L,id:X.id,createdAt:L.createdAt??X.createdAt??Q}:X);return{...le,[L.threadId]:{...le[L.threadId],messages:Te}}}),G&&L.content&&L.role)try{await f.beta.threads.messages.create(L.threadId,{content:L.content,role:L.role,additionalContext:L.additionalContext})}catch(le){throw console.error("Failed to update message on server",le),u(xe=>{const Te=xe[L.threadId]?.messages?.filter(X=>X.id!==P);return{...xe,[L.threadId]:{...xe[L.threadId],messages:Te}}}),le}},[f.beta.threads.messages]),ie=V.useCallback(async(P,L)=>{if(P??=w,P===l.id)return console.warn("Cannot generate name for empty thread"),c[P];const G=await f.beta.threads.generateName(P);return u(Q=>Q[P]?{...Q,[P]:{...Q[P],name:G.name}}:Q),await W(P,Q=>({...Q,name:G.name}),L),G},[f.beta.threads,w,c,l.id,W]),de=V.useCallback((P,L)=>{u(G=>{const Q=G[P];if(!Q||!r||i==null||Q.id===l.id)return G;const le=Q.messages.length;return!Q.name&&le>=i&&ie(P,L).catch(xe=>{console.error("Failed to generate thread name:",xe)}),G})},[r,i,l.id,ie]),pe=V.useCallback(()=>{C(l.id),u(P=>({...P,[l.id]:l}))},[l]),K=V.useCallback(async(P,L)=>{L??=w;const G=c[L]?.name;if(u(Q=>Q[L]?{...Q,[L]:{...Q[L],name:P}}:Q),L!==l.id)try{const Q=await f.beta.projects.getCurrent();await f.beta.threads.update(L,{name:P,projectId:Q.id})}catch(Q){throw console.error("Failed to update thread name on server",Q),u(le=>le[L]?{...le,[L]:{...le[L],name:G}}:le),Q}},[w,f.beta.projects,f.beta.threads,l.id,c]),ne=V.useCallback(async(P,L=!0)=>{if(P===l.id){console.warn("Switching to placeholder thread, may be a bug.");return}C(P),u(G=>G[P]?G:{...G,[P]:{...G[l.id],id:P}}),L&&await J(P)},[J,l]),j=V.useCallback((P,L,G)=>{u(Q=>({...Q,[P]:{...Q[P],generationStage:L,statusMessage:G}}))},[]),N=V.useCallback(async P=>{P??=w;const L=T?.generationStage??gr.IDLE;QR(L)||(v(!0),u(G=>G[P]?{...G,[P]:{...G[P],generationStage:gr.CANCELLED,messages:G[P].messages.map(Q=>Q.id===G[P].messages[G[P].messages.length-1].id?{...Q,isCancelled:!0}:Q)}}:G),await f.beta.threads.cancel(P))},[f.beta.threads,w,T?.generationStage]),H=V.useCallback(async(P,L,G,Q)=>{if(x.current)return v(!1),ef(G);let le,xe=!1;j(G,gr.STREAMING_RESPONSE);for await(const X of P)if(X.mcpAccessToken&&u(z=>{const ve=z[G];return ve?{...z,[G]:{...ve,mcpAccessToken:X.mcpAccessToken}}:z}),X.responseMessageDto.toolCallRequest){const z=X.responseMessageDto.toolCallRequest.toolName;j(X.responseMessageDto.threadId,gr.FETCHING_CONTEXT),await Z(X.responseMessageDto.id,{...X.responseMessageDto},!1);const ve=await Ux(X.responseMessageDto.toolCallRequest,m,S);if(x.current)return v(!1),ef(G);const he=await XF(ve),be={...L,initialMessages:void 0,...z?{toolCallCounts:{...L.toolCallCounts??{},[z]:(L.toolCallCounts?.[z]??0)+1}}:{},messageToAppend:{content:he,role:"tool",actionType:"tool_response",component:X.responseMessageDto.component,tool_call_id:X.responseMessageDto.tool_call_id,error:ve.error}};await Z(X.responseMessageDto.id,{...X.responseMessageDto,error:ve.error},!1),await ae({threadId:X.responseMessageDto.threadId,content:he,role:"tool",id:crypto.randomUUID(),createdAt:new Date().toISOString(),componentState:{},actionType:"tool_response",tool_call_id:X.responseMessageDto.tool_call_id,error:ve.error},!1),j(X.responseMessageDto.threadId,gr.STREAMING_RESPONSE);const Re=await xx(f,be,X.responseMessageDto.threadId);return await H(Re,be,X.responseMessageDto.threadId,Q)}else{if(x.current)return v(!1),le??ef(G);if(!xe&&X.responseMessageDto.threadId&&X.responseMessageDto.threadId!==T?.id){xe=!0;const z=w===Ji.id;await ne(X.responseMessageDto.threadId,!1),z&&(await O(X.responseMessageDto.threadId,Q),de(X.responseMessageDto.threadId,Q))}if(!le)le=X.responseMessageDto.component?.componentName?Ng(X.responseMessageDto,p):X.responseMessageDto,await ae(le,!1);else{if(X.responseMessageDto.component?.toolCallRequest){const{toolName:he}=X.responseMessageDto.component.toolCallRequest;((he?m[he]:void 0)?.annotations?.tamboStreamableHint??!1)&&await Ux(X.responseMessageDto.component.toolCallRequest,m,S)}const z=le.id;X.responseMessageDto.component?.componentName?le=Ng(X.responseMessageDto,p):le=X.responseMessageDto,X.responseMessageDto.id!==z?await ae(le,!1):await Z(le.id,le,!1)}}const Te=le?.threadId??G;return j(Te,gr.COMPLETE),de(Te,Q),le??{...ef(Te),content:[{type:"text",text:"Error processing stream"}]}},[ae,O,de,f,p,T?.id,w,S,ne,m,Z,j]),U=V.useCallback(async(P,L={})=>{v(!1);const{threadId:G=w??l.id,streamResponse:Q=e,forceToolChoice:le,contextKey:xe,additionalContext:Te,content:X}=L;if(!Q)throw new Error("Non-streaming mode is deprecated. Use streaming mode instead.");j(G,gr.FETCHING_CONTEXT);const z=await E(),ve={...Te??{}};for(const oe of z)ve[oe.name]=oe.context;const he=crypto.randomUUID(),be=X??[{type:"text",text:P}];await ae({content:be,renderedComponent:null,role:"user",threadId:G,id:he,createdAt:new Date().toISOString(),componentState:{},additionalContext:ve},!1),de(G,xe);const Re=VF(p,m,y),gt=jF(m,y),at={},$={messageToAppend:{content:be,role:"user",additionalContext:ve},contextKey:xe,availableComponents:Re,clientTools:gt.map(oe=>py(oe)),forceToolChoice:le,toolCallCounts:at,...G===l.id&&n.length>0&&{initialMessages:n.map(oe=>({content:oe.content,role:oe.role,additionalContext:oe.additionalContext}))}};let D;try{D=await xx(f,$,G===l.id?void 0:G)}catch(oe){throw j(G,gr.ERROR),u(Me=>{const Ee=Me[G];return Ee?{...Me,[G]:{...Ee,messages:Ee.messages.filter(Ie=>Ie.id!==he)}}:Me}),oe}try{return await H(D,$,G,xe)}catch(oe){throw j(G,gr.ERROR),u(Me=>{const Ee=Me[G];return Ee?{...Me,[G]:{...Ee,messages:Ee.messages.filter(Ie=>Ie.id!==he)}}:Me}),oe}},[p,m,y,w,ae,f,j,H,e,E,l.id,n,de]);return qt.createElement(xp.Provider,{value:{thread:T,currentThreadId:w,currentThread:T,threadMap:c,setThreadMap:u,switchCurrentThread:ne,startNewThread:pe,updateThreadName:K,generateThreadName:ie,addThreadMessage:ae,updateThreadMessage:Z,streaming:e,cancel:N,sendThreadMessage:U,contextKey:a}},qt.createElement(qF,{generationStage:M,statusMessage:A},t))},WC=()=>{const t=V.useContext(xp),e=V.useContext(GC);if(t===void 0)throw new Error("useTamboThread must be used within a TamboThreadProvider");if(e===void 0)throw new Error("useTamboThread must be used within a TamboThreadProvider");return{...t,...e}};async function XF(t){return t.error?[{type:"text",text:dv(t.result)}]:t.tamboTool?.transformToContent?await t.tamboTool.transformToContent(t.result):[{type:"text",text:dv(t.result)}]}function ef(t){return{threadId:t,content:[{type:"text",text:""}],role:"assistant",createdAt:new Date().toISOString(),id:crypto.randomUUID(),componentState:{}}}const qC=V.createContext(void 0),KF=({children:t})=>{const e=V.useContext(Hl);if(!e)throw new Error("TamboMcpTokenProvider must be used within a TamboClientProvider");const{client:n}=e,r=n.baseURL,i=V.useContext(xp),a=i?.currentThread??null,l=i?.currentThreadId??null,c=V.useMemo(()=>i?.setThreadMap??(()=>{}),[i?.setThreadMap]),u=V.useRef(null),f=V.useMemo(()=>a?.mcpAccessToken??null,[a]);V.useEffect(()=>{const p=u.current!==l;u.current=l;const m=l===Ji.id;p&&l&&!m&&a&&!a.mcpAccessToken&&(async()=>{try{const E=await n.beta.auth.getMcpToken({threadId:l});E.mcpAccessToken&&c(g=>{const v=g[l];return v?{...g,[l]:{...v,mcpAccessToken:E.mcpAccessToken}}:g})}catch(E){console.error(`Failed to fetch MCP token for thread ${l}:`,E)}})()},[l,a,n,c]);const h=V.useMemo(()=>({mcpAccessToken:f,tamboBaseUrl:r}),[f,r]);return qt.createElement(qC.Provider,{value:h},t)},YF=t=>{const e=V.useContext(qC);if(e===void 0)throw new Error("useTamboMcpToken must be used within a TamboMcpTokenProvider");const n=V.useContext(Hl);if(!n)throw new Error("useTamboMcpToken must be used within a TamboClientProvider");const{client:r}=n,a=V.useContext(xp)?.currentThreadId??null,[l,c]=V.useState(null),u=V.useRef(!1),f=a===Ji.id,h=t&&(!a||f)&&!e.mcpAccessToken&&!l&&!u.current;return V.useEffect(()=>{h&&(u.current=!0,(async()=>{try{const y=await r.beta.auth.getMcpToken({contextKey:t});y.mcpAccessToken&&c(y.mcpAccessToken)}catch(y){console.error("Failed to fetch threadless MCP token:",y)}})())},[h,r,t]),V.useEffect(()=>{a&&a!==Ji.id&&(c(null),u.current=!1)},[a]),{mcpAccessToken:e.mcpAccessToken??l,tamboBaseUrl:e.tamboBaseUrl}};function JF(t){return"requestedSchema"in t}function QF(){const[t,e]=V.useState(null),[n,r]=V.useState(null),i=V.useCallback(async(a,l)=>await new Promise((c,u)=>{if(!JF(a.params)){const h="mode"in a.params?String(a.params.mode):"unknown";u(new Error(`Unsupported MCP elicitation params: expected requestedSchema (form mode), got mode=${h}`));return}if(e({message:a.params.message,requestedSchema:a.params.requestedSchema,signal:l.signal}),l.signal.aborted){e(null),u(new Error("Request aborted"));return}const f=()=>{e(null),r(null),u(new Error("Request aborted"))};l.signal.addEventListener("abort",f,{once:!0}),r(()=>h=>{l.signal.removeEventListener("abort",f),e(null),r(null),c(h)})}),[]);return{elicitation:t,setElicitation:e,resolveElicitation:n,setResolveElicitation:r,defaultElicitationHandler:i}}function Ep(t){return!!t._zod}function da(t,e){return Ep(t)?PM(t,e):t.safeParse(e)}function ZC(t){if(!t)return;let e;if(Ep(t)?e=t._zod?.def?.shape:e=t.shape,!!e){if(typeof e=="function")try{return e()}catch{return}return e}}function ez(t){if(Ep(t)){const a=t._zod?.def;if(a){if(a.value!==void 0)return a.value;if(Array.isArray(a.values)&&a.values.length>0)return a.values[0]}}const n=t._def;if(n){if(n.value!==void 0)return n.value;if(Array.isArray(n.values)&&n.values.length>0)return n.values[0]}const r=t.value;if(r!==void 0)return r}const bp="2025-11-25",tz=[bp,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],Ka="io.modelcontextprotocol/related-task",Tp="2.0",ir=HD(t=>t!==null&&(typeof t=="object"||typeof t=="function")),XC=an([ee(),Kt().int()]),KC=ee();Kn({ttl:an([Kt(),MR()]).optional(),pollInterval:Kt().optional()});const nz=je({ttl:Kt().optional()}),rz=je({taskId:ee()}),my=Kn({progressToken:XC.optional(),[Ka]:rz.optional()}),ii=je({_meta:my.optional()}),Mu=ii.extend({task:nz.optional()}),iz=t=>Mu.safeParse(t).success,or=je({method:ee(),params:ii.loose().optional()}),xi=je({_meta:my.optional()}),Ei=je({method:ee(),params:xi.loose().optional()}),lr=Kn({_meta:my.optional()}),Mp=an([ee(),Kt().int()]),YC=je({jsonrpc:Ge(Tp),id:Mp,...or.shape}).strict(),fv=t=>YC.safeParse(t).success,JC=je({jsonrpc:Ge(Tp),...Ei.shape}).strict(),sz=t=>JC.safeParse(t).success,gy=je({jsonrpc:Ge(Tp),id:Mp,result:lr}).strict(),Wc=t=>gy.safeParse(t).success;var Et;(function(t){t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(Et||(Et={}));const _y=je({jsonrpc:Ge(Tp),id:Mp.optional(),error:je({code:Kt().int(),message:ee(),data:rn().optional()})}).strict(),az=t=>_y.safeParse(t).success,vh=an([YC,JC,gy,_y]);an([gy,_y]);const yl=lr.strict(),oz=xi.extend({requestId:Mp.optional(),reason:ee().optional()}),vy=Ei.extend({method:Ge("notifications/cancelled"),params:oz}),lz=je({src:ee(),mimeType:ee().optional(),sizes:Fe(ee()).optional(),theme:ri(["light","dark"]).optional()}),Ru=je({icons:Fe(lz).optional()}),kl=je({name:ee(),title:ee().optional()}),QC=kl.extend({...kl.shape,...Ru.shape,version:ee(),websiteUrl:ee().optional(),description:ee().optional()}),cz=ny(je({applyDefaults:dn().optional()}),Sn(ee(),rn())),uz=LR(t=>t&&typeof t=="object"&&!Array.isArray(t)&&Object.keys(t).length===0?{form:{}}:t,ny(je({form:cz.optional(),url:ir.optional()}),Sn(ee(),rn()).optional())),dz=Kn({list:ir.optional(),cancel:ir.optional(),requests:Kn({sampling:Kn({createMessage:ir.optional()}).optional(),elicitation:Kn({create:ir.optional()}).optional()}).optional()}),fz=Kn({list:ir.optional(),cancel:ir.optional(),requests:Kn({tools:Kn({call:ir.optional()}).optional()}).optional()}),hz=je({experimental:Sn(ee(),ir).optional(),sampling:je({context:ir.optional(),tools:ir.optional()}).optional(),elicitation:uz.optional(),roots:je({listChanged:dn().optional()}).optional(),tasks:dz.optional()}),pz=ii.extend({protocolVersion:ee(),capabilities:hz,clientInfo:QC}),mz=or.extend({method:Ge("initialize"),params:pz}),gz=je({experimental:Sn(ee(),ir).optional(),logging:ir.optional(),completions:ir.optional(),prompts:je({listChanged:dn().optional()}).optional(),resources:je({subscribe:dn().optional(),listChanged:dn().optional()}).optional(),tools:je({listChanged:dn().optional()}).optional(),tasks:fz.optional()}),eA=lr.extend({protocolVersion:ee(),capabilities:gz,serverInfo:QC,instructions:ee().optional()}),tA=Ei.extend({method:Ge("notifications/initialized"),params:xi.optional()}),_z=t=>tA.safeParse(t).success,yy=or.extend({method:Ge("ping"),params:ii.optional()}),vz=je({progress:Kt(),total:An(Kt()),message:An(ee())}),yz=je({...xi.shape,...vz.shape,progressToken:XC}),Sy=Ei.extend({method:Ge("notifications/progress"),params:yz}),Sz=ii.extend({cursor:KC.optional()}),Cu=or.extend({params:Sz.optional()}),Au=lr.extend({nextCursor:KC.optional()}),wz=ri(["working","input_required","completed","failed","cancelled"]),Pu=je({taskId:ee(),status:wz,ttl:an([Kt(),MR()]),createdAt:ee(),lastUpdatedAt:ee(),pollInterval:An(Kt()),statusMessage:An(ee())}),_u=lr.extend({task:Pu}),xz=xi.merge(Pu),Bh=Ei.extend({method:Ge("notifications/tasks/status"),params:xz}),wy=or.extend({method:Ge("tasks/get"),params:ii.extend({taskId:ee()})}),xy=lr.merge(Pu),Ey=or.extend({method:Ge("tasks/result"),params:ii.extend({taskId:ee()})});lr.loose();const by=Cu.extend({method:Ge("tasks/list")}),Ty=Au.extend({tasks:Fe(Pu)}),My=or.extend({method:Ge("tasks/cancel"),params:ii.extend({taskId:ee()})}),Ez=lr.merge(Pu),nA=je({uri:ee(),mimeType:An(ee()),_meta:Sn(ee(),rn()).optional()}),rA=nA.extend({text:ee()}),Ry=ee().refine(t=>{try{return atob(t),!0}catch{return!1}},{message:"Invalid Base64 string"}),iA=nA.extend({blob:Ry}),Iu=ri(["user","assistant"]),Gl=je({audience:Fe(Iu).optional(),priority:Kt().min(0).max(1).optional(),lastModified:ER({offset:!0}).optional()}),sA=je({...kl.shape,...Ru.shape,uri:ee(),description:An(ee()),mimeType:An(ee()),annotations:Gl.optional(),_meta:An(Kn({}))}),bz=je({...kl.shape,...Ru.shape,uriTemplate:ee(),description:An(ee()),mimeType:An(ee()),annotations:Gl.optional(),_meta:An(Kn({}))}),Tz=Cu.extend({method:Ge("resources/list")}),aA=Au.extend({resources:Fe(sA)}),Mz=Cu.extend({method:Ge("resources/templates/list")}),oA=Au.extend({resourceTemplates:Fe(bz)}),Cy=ii.extend({uri:ee()}),Rz=Cy,Cz=or.extend({method:Ge("resources/read"),params:Rz}),lA=lr.extend({contents:Fe(an([rA,iA]))}),cA=Ei.extend({method:Ge("notifications/resources/list_changed"),params:xi.optional()}),Az=Cy,Pz=or.extend({method:Ge("resources/subscribe"),params:Az}),Iz=Cy,Nz=or.extend({method:Ge("resources/unsubscribe"),params:Iz}),kz=xi.extend({uri:ee()}),Lz=Ei.extend({method:Ge("notifications/resources/updated"),params:kz}),Oz=je({name:ee(),description:An(ee()),required:An(dn())}),Dz=je({...kl.shape,...Ru.shape,description:An(ee()),arguments:An(Fe(Oz)),_meta:An(Kn({}))}),Uz=Cu.extend({method:Ge("prompts/list")}),uA=Au.extend({prompts:Fe(Dz)}),Fz=ii.extend({name:ee(),arguments:Sn(ee(),ee()).optional()}),zz=or.extend({method:Ge("prompts/get"),params:Fz}),Ay=je({type:Ge("text"),text:ee(),annotations:Gl.optional(),_meta:Sn(ee(),rn()).optional()}),Py=je({type:Ge("image"),data:Ry,mimeType:ee(),annotations:Gl.optional(),_meta:Sn(ee(),rn()).optional()}),Iy=je({type:Ge("audio"),data:Ry,mimeType:ee(),annotations:Gl.optional(),_meta:Sn(ee(),rn()).optional()}),$z=je({type:Ge("tool_use"),name:ee(),id:ee(),input:Sn(ee(),rn()),_meta:Sn(ee(),rn()).optional()}),Bz=je({type:Ge("resource"),resource:an([rA,iA]),annotations:Gl.optional(),_meta:Sn(ee(),rn()).optional()}),Vz=sA.extend({type:Ge("resource_link")}),Ny=an([Ay,Py,Iy,Vz,Bz]),jz=je({role:Iu,content:Ny}),dA=lr.extend({description:ee().optional(),messages:Fe(jz)}),fA=Ei.extend({method:Ge("notifications/prompts/list_changed"),params:xi.optional()}),Hz=je({title:ee().optional(),readOnlyHint:dn().optional(),destructiveHint:dn().optional(),idempotentHint:dn().optional(),openWorldHint:dn().optional()}),Gz=je({taskSupport:ri(["required","optional","forbidden"]).optional()}),hA=je({...kl.shape,...Ru.shape,description:ee().optional(),inputSchema:je({type:Ge("object"),properties:Sn(ee(),ir).optional(),required:Fe(ee()).optional()}).catchall(rn()),outputSchema:je({type:Ge("object"),properties:Sn(ee(),ir).optional(),required:Fe(ee()).optional()}).catchall(rn()).optional(),annotations:Hz.optional(),execution:Gz.optional(),_meta:Sn(ee(),rn()).optional()}),Wz=Cu.extend({method:Ge("tools/list")}),pA=Au.extend({tools:Fe(hA)}),Rp=lr.extend({content:Fe(Ny).default([]),structuredContent:Sn(ee(),rn()).optional(),isError:dn().optional()});Rp.or(lr.extend({toolResult:rn()}));const qz=Mu.extend({name:ee(),arguments:Sn(ee(),rn()).optional()}),Zz=or.extend({method:Ge("tools/call"),params:qz}),mA=Ei.extend({method:Ge("notifications/tools/list_changed"),params:xi.optional()}),Xz=je({autoRefresh:dn().default(!0),debounceMs:Kt().int().nonnegative().default(300)}),gA=ri(["debug","info","notice","warning","error","critical","alert","emergency"]),Kz=ii.extend({level:gA}),Yz=or.extend({method:Ge("logging/setLevel"),params:Kz}),Jz=xi.extend({level:gA,logger:ee().optional(),data:rn()}),Qz=Ei.extend({method:Ge("notifications/message"),params:Jz}),e$=je({name:ee().optional()}),t$=je({hints:Fe(e$).optional(),costPriority:Kt().min(0).max(1).optional(),speedPriority:Kt().min(0).max(1).optional(),intelligencePriority:Kt().min(0).max(1).optional()}),n$=je({mode:ri(["auto","required","none"]).optional()}),r$=je({type:Ge("tool_result"),toolUseId:ee().describe("The unique identifier for the corresponding tool call."),content:Fe(Ny).default([]),structuredContent:je({}).loose().optional(),isError:dn().optional(),_meta:Sn(ee(),rn()).optional()}),i$=AR("type",[Ay,Py,Iy]),Vh=AR("type",[Ay,Py,Iy,$z,r$]),s$=je({role:Iu,content:an([Vh,Fe(Vh)]),_meta:Sn(ee(),rn()).optional()}),a$=Mu.extend({messages:Fe(s$),modelPreferences:t$.optional(),systemPrompt:ee().optional(),includeContext:ri(["none","thisServer","allServers"]).optional(),temperature:Kt().optional(),maxTokens:Kt().int(),stopSequences:Fe(ee()).optional(),metadata:ir.optional(),tools:Fe(hA).optional(),toolChoice:n$.optional()}),eu=or.extend({method:Ge("sampling/createMessage"),params:a$}),_A=lr.extend({model:ee(),stopReason:An(ri(["endTurn","stopSequence","maxTokens"]).or(ee())),role:Iu,content:i$}),vA=lr.extend({model:ee(),stopReason:An(ri(["endTurn","stopSequence","maxTokens","toolUse"]).or(ee())),role:Iu,content:an([Vh,Fe(Vh)])}),o$=je({type:Ge("boolean"),title:ee().optional(),description:ee().optional(),default:dn().optional()}),l$=je({type:Ge("string"),title:ee().optional(),description:ee().optional(),minLength:Kt().optional(),maxLength:Kt().optional(),format:ri(["email","uri","date","date-time"]).optional(),default:ee().optional()}),c$=je({type:ri(["number","integer"]),title:ee().optional(),description:ee().optional(),minimum:Kt().optional(),maximum:Kt().optional(),default:Kt().optional()}),u$=je({type:Ge("string"),title:ee().optional(),description:ee().optional(),enum:Fe(ee()),default:ee().optional()}),d$=je({type:Ge("string"),title:ee().optional(),description:ee().optional(),oneOf:Fe(je({const:ee(),title:ee()})),default:ee().optional()}),f$=je({type:Ge("string"),title:ee().optional(),description:ee().optional(),enum:Fe(ee()),enumNames:Fe(ee()).optional(),default:ee().optional()}),h$=an([u$,d$]),p$=je({type:Ge("array"),title:ee().optional(),description:ee().optional(),minItems:Kt().optional(),maxItems:Kt().optional(),items:je({type:Ge("string"),enum:Fe(ee())}),default:Fe(ee()).optional()}),m$=je({type:Ge("array"),title:ee().optional(),description:ee().optional(),minItems:Kt().optional(),maxItems:Kt().optional(),items:je({anyOf:Fe(je({const:ee(),title:ee()}))}),default:Fe(ee()).optional()}),g$=an([p$,m$]),_$=an([f$,h$,g$]),v$=an([_$,o$,l$,c$]),y$=Mu.extend({mode:Ge("form").optional(),message:ee(),requestedSchema:je({type:Ge("object"),properties:Sn(ee(),v$),required:Fe(ee()).optional()})}),S$=Mu.extend({mode:Ge("url"),message:ee(),elicitationId:ee(),url:ee().url()}),w$=an([y$,S$]),tu=or.extend({method:Ge("elicitation/create"),params:w$}),x$=xi.extend({elicitationId:ee()}),E$=Ei.extend({method:Ge("notifications/elicitation/complete"),params:x$}),yA=lr.extend({action:ri(["accept","decline","cancel"]),content:LR(t=>t===null?void 0:t,Sn(ee(),an([ee(),Kt(),dn(),Fe(ee())])).optional())}),b$=je({type:Ge("ref/resource"),uri:ee()}),T$=je({type:Ge("ref/prompt"),name:ee()}),M$=ii.extend({ref:an([T$,b$]),argument:je({name:ee(),value:ee()}),context:je({arguments:Sn(ee(),ee()).optional()}).optional()}),R$=or.extend({method:Ge("completion/complete"),params:M$}),SA=lr.extend({completion:Kn({values:Fe(ee()).max(100),total:An(Kt().int()),hasMore:An(dn())})}),C$=je({uri:ee().startsWith("file://"),name:ee().optional(),_meta:Sn(ee(),rn()).optional()}),A$=or.extend({method:Ge("roots/list"),params:ii.optional()}),P$=lr.extend({roots:Fe(C$)}),I$=Ei.extend({method:Ge("notifications/roots/list_changed"),params:xi.optional()});an([yy,mz,R$,Yz,zz,Uz,Tz,Mz,Cz,Pz,Nz,Zz,Wz,wy,Ey,by,My]);an([vy,Sy,tA,I$,Bh]);an([yl,_A,vA,yA,P$,xy,Ty,_u]);an([yy,eu,tu,A$,wy,Ey,by,My]);an([vy,Sy,Qz,Lz,cA,mA,fA,Bh,E$]);an([yl,eA,SA,dA,uA,aA,oA,lA,Rp,pA,xy,Ty,_u]);class ht extends Error{constructor(e,n,r){super(`MCP error ${e}: ${n}`),this.code=e,this.data=r,this.name="McpError"}static fromError(e,n,r){if(e===Et.UrlElicitationRequired&&r){const i=r;if(i.elicitations)return new N$(i.elicitations,n)}return new ht(e,n,r)}}class N$ extends ht{constructor(e,n=`URL elicitation${e.length>1?"s":""} required`){super(Et.UrlElicitationRequired,n,{elicitations:e})}get elicitations(){return this.data?.elicitations??[]}}function Ba(t){return t==="completed"||t==="failed"||t==="cancelled"}function Fx(t){const n=ZC(t)?.method;if(!n)throw new Error("Schema is missing a method literal");const r=ez(n);if(typeof r!="string")throw new Error("Schema method literal must be a string");return r}function zx(t,e){const n=da(t,e);if(!n.success)throw n.error;return n.data}const k$=6e4;class L${constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(vy,n=>{this._oncancel(n)}),this.setNotificationHandler(Sy,n=>{this._onprogress(n)}),this.setRequestHandler(yy,n=>({})),this._taskStore=e?.taskStore,this._taskMessageQueue=e?.taskMessageQueue,this._taskStore&&(this.setRequestHandler(wy,async(n,r)=>{const i=await this._taskStore.getTask(n.params.taskId,r.sessionId);if(!i)throw new ht(Et.InvalidParams,"Failed to retrieve task: Task not found");return{...i}}),this.setRequestHandler(Ey,async(n,r)=>{const i=async()=>{const a=n.params.taskId;if(this._taskMessageQueue){let c;for(;c=await this._taskMessageQueue.dequeue(a,r.sessionId);){if(c.type==="response"||c.type==="error"){const u=c.message,f=u.id,h=this._requestResolvers.get(f);if(h)if(this._requestResolvers.delete(f),c.type==="response")h(u);else{const p=u,m=new ht(p.error.code,p.error.message,p.error.data);h(m)}else{const p=c.type==="response"?"Response":"Error";this._onerror(new Error(`${p} handler missing for request ${f}`))}continue}await this._transport?.send(c.message,{relatedRequestId:r.requestId})}}const l=await this._taskStore.getTask(a,r.sessionId);if(!l)throw new ht(Et.InvalidParams,`Task not found: ${a}`);if(!Ba(l.status))return await this._waitForTaskUpdate(a,r.signal),await i();if(Ba(l.status)){const c=await this._taskStore.getTaskResult(a,r.sessionId);return this._clearTaskQueue(a),{...c,_meta:{...c._meta,[Ka]:{taskId:a}}}}return await i()};return await i()}),this.setRequestHandler(by,async(n,r)=>{try{const{tasks:i,nextCursor:a}=await this._taskStore.listTasks(n.params?.cursor,r.sessionId);return{tasks:i,nextCursor:a,_meta:{}}}catch(i){throw new ht(Et.InvalidParams,`Failed to list tasks: ${i instanceof Error?i.message:String(i)}`)}}),this.setRequestHandler(My,async(n,r)=>{try{const i=await this._taskStore.getTask(n.params.taskId,r.sessionId);if(!i)throw new ht(Et.InvalidParams,`Task not found: ${n.params.taskId}`);if(Ba(i.status))throw new ht(Et.InvalidParams,`Cannot cancel task in terminal status: ${i.status}`);await this._taskStore.updateTaskStatus(n.params.taskId,"cancelled","Client cancelled task execution.",r.sessionId),this._clearTaskQueue(n.params.taskId);const a=await this._taskStore.getTask(n.params.taskId,r.sessionId);if(!a)throw new ht(Et.InvalidParams,`Task not found after cancellation: ${n.params.taskId}`);return{_meta:{},...a}}catch(i){throw i instanceof ht?i:new ht(Et.InvalidRequest,`Failed to cancel task: ${i instanceof Error?i.message:String(i)}`)}}))}async _oncancel(e){if(!e.params.requestId)return;this._requestHandlerAbortControllers.get(e.params.requestId)?.abort(e.params.reason)}_setupTimeout(e,n,r,i,a=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(i,n),startTime:Date.now(),timeout:n,maxTotalTimeout:r,resetTimeoutOnProgress:a,onTimeout:i})}_resetTimeout(e){const n=this._timeoutInfo.get(e);if(!n)return!1;const r=Date.now()-n.startTime;if(n.maxTotalTimeout&&r>=n.maxTotalTimeout)throw this._timeoutInfo.delete(e),ht.fromError(Et.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:n.maxTotalTimeout,totalElapsed:r});return clearTimeout(n.timeoutId),n.timeoutId=setTimeout(n.onTimeout,n.timeout),!0}_cleanupTimeout(e){const n=this._timeoutInfo.get(e);n&&(clearTimeout(n.timeoutId),this._timeoutInfo.delete(e))}async connect(e){if(this._transport)throw new Error("Already connected to a transport. Call close() before connecting to a new transport, or use a separate Protocol instance per connection.");this._transport=e;const n=this.transport?.onclose;this._transport.onclose=()=>{n?.(),this._onclose()};const r=this.transport?.onerror;this._transport.onerror=a=>{r?.(a),this._onerror(a)};const i=this._transport?.onmessage;this._transport.onmessage=(a,l)=>{i?.(a,l),Wc(a)||az(a)?this._onresponse(a):fv(a)?this._onrequest(a,l):sz(a)?this._onnotification(a):this._onerror(new Error(`Unknown message type: ${JSON.stringify(a)}`))},await this._transport.start()}_onclose(){const e=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();for(const r of this._requestHandlerAbortControllers.values())r.abort();this._requestHandlerAbortControllers.clear();const n=ht.fromError(Et.ConnectionClosed,"Connection closed");this._transport=void 0,this.onclose?.();for(const r of e.values())r(n)}_onerror(e){this.onerror?.(e)}_onnotification(e){const n=this._notificationHandlers.get(e.method)??this.fallbackNotificationHandler;n!==void 0&&Promise.resolve().then(()=>n(e)).catch(r=>this._onerror(new Error(`Uncaught error in notification handler: ${r}`)))}_onrequest(e,n){const r=this._requestHandlers.get(e.method)??this.fallbackRequestHandler,i=this._transport,a=e.params?._meta?.[Ka]?.taskId;if(r===void 0){const h={jsonrpc:"2.0",id:e.id,error:{code:Et.MethodNotFound,message:"Method not found"}};a&&this._taskMessageQueue?this._enqueueTaskMessage(a,{type:"error",message:h,timestamp:Date.now()},i?.sessionId).catch(p=>this._onerror(new Error(`Failed to enqueue error response: ${p}`))):i?.send(h).catch(p=>this._onerror(new Error(`Failed to send an error response: ${p}`)));return}const l=new AbortController;this._requestHandlerAbortControllers.set(e.id,l);const c=iz(e.params)?e.params.task:void 0,u=this._taskStore?this.requestTaskStore(e,i?.sessionId):void 0,f={signal:l.signal,sessionId:i?.sessionId,_meta:e.params?._meta,sendNotification:async h=>{if(l.signal.aborted)return;const p={relatedRequestId:e.id};a&&(p.relatedTask={taskId:a}),await this.notification(h,p)},sendRequest:async(h,p,m)=>{if(l.signal.aborted)throw new ht(Et.ConnectionClosed,"Request was cancelled");const y={...m,relatedRequestId:e.id};a&&!y.relatedTask&&(y.relatedTask={taskId:a});const S=y.relatedTask?.taskId??a;return S&&u&&await u.updateTaskStatus(S,"input_required"),await this.request(h,p,y)},authInfo:n?.authInfo,requestId:e.id,requestInfo:n?.requestInfo,taskId:a,taskStore:u,taskRequestedTtl:c?.ttl,closeSSEStream:n?.closeSSEStream,closeStandaloneSSEStream:n?.closeStandaloneSSEStream};Promise.resolve().then(()=>{c&&this.assertTaskHandlerCapability(e.method)}).then(()=>r(e,f)).then(async h=>{if(l.signal.aborted)return;const p={result:h,jsonrpc:"2.0",id:e.id};a&&this._taskMessageQueue?await this._enqueueTaskMessage(a,{type:"response",message:p,timestamp:Date.now()},i?.sessionId):await i?.send(p)},async h=>{if(l.signal.aborted)return;const p={jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(h.code)?h.code:Et.InternalError,message:h.message??"Internal error",...h.data!==void 0&&{data:h.data}}};a&&this._taskMessageQueue?await this._enqueueTaskMessage(a,{type:"error",message:p,timestamp:Date.now()},i?.sessionId):await i?.send(p)}).catch(h=>this._onerror(new Error(`Failed to send response: ${h}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){const{progressToken:n,...r}=e.params,i=Number(n),a=this._progressHandlers.get(i);if(!a){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}const l=this._responseHandlers.get(i),c=this._timeoutInfo.get(i);if(c&&l&&c.resetTimeoutOnProgress)try{this._resetTimeout(i)}catch(u){this._responseHandlers.delete(i),this._progressHandlers.delete(i),this._cleanupTimeout(i),l(u);return}a(r)}_onresponse(e){const n=Number(e.id),r=this._requestResolvers.get(n);if(r){if(this._requestResolvers.delete(n),Wc(e))r(e);else{const l=new ht(e.error.code,e.error.message,e.error.data);r(l)}return}const i=this._responseHandlers.get(n);if(i===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}this._responseHandlers.delete(n),this._cleanupTimeout(n);let a=!1;if(Wc(e)&&e.result&&typeof e.result=="object"){const l=e.result;if(l.task&&typeof l.task=="object"){const c=l.task;typeof c.taskId=="string"&&(a=!0,this._taskProgressTokens.set(c.taskId,n))}}if(a||this._progressHandlers.delete(n),Wc(e))i(e);else{const l=ht.fromError(e.error.code,e.error.message,e.error.data);i(l)}}get transport(){return this._transport}async close(){await this._transport?.close()}async*requestStream(e,n,r){const{task:i}=r??{};if(!i){try{yield{type:"result",result:await this.request(e,n,r)}}catch(l){yield{type:"error",error:l instanceof ht?l:new ht(Et.InternalError,String(l))}}return}let a;try{const l=await this.request(e,_u,r);if(l.task)a=l.task.taskId,yield{type:"taskCreated",task:l.task};else throw new ht(Et.InternalError,"Task creation did not return a task");for(;;){const c=await this.getTask({taskId:a},r);if(yield{type:"taskStatus",task:c},Ba(c.status)){c.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:a},n,r)}:c.status==="failed"?yield{type:"error",error:new ht(Et.InternalError,`Task ${a} failed`)}:c.status==="cancelled"&&(yield{type:"error",error:new ht(Et.InternalError,`Task ${a} was cancelled`)});return}if(c.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:a},n,r)};return}const u=c.pollInterval??this._options?.defaultTaskPollInterval??1e3;await new Promise(f=>setTimeout(f,u)),r?.signal?.throwIfAborted()}}catch(l){yield{type:"error",error:l instanceof ht?l:new ht(Et.InternalError,String(l))}}}request(e,n,r){const{relatedRequestId:i,resumptionToken:a,onresumptiontoken:l,task:c,relatedTask:u}=r??{};return new Promise((f,h)=>{const p=x=>{h(x)};if(!this._transport){p(new Error("Not connected"));return}if(this._options?.enforceStrictCapabilities===!0)try{this.assertCapabilityForMethod(e.method),c&&this.assertTaskCapability(e.method)}catch(x){p(x);return}r?.signal?.throwIfAborted();const m=this._requestMessageId++,y={...e,jsonrpc:"2.0",id:m};r?.onprogress&&(this._progressHandlers.set(m,r.onprogress),y.params={...e.params,_meta:{...e.params?._meta||{},progressToken:m}}),c&&(y.params={...y.params,task:c}),u&&(y.params={...y.params,_meta:{...y.params?._meta||{},[Ka]:u}});const S=x=>{this._responseHandlers.delete(m),this._progressHandlers.delete(m),this._cleanupTimeout(m),this._transport?.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:m,reason:String(x)}},{relatedRequestId:i,resumptionToken:a,onresumptiontoken:l}).catch(C=>this._onerror(new Error(`Failed to send cancellation: ${C}`)));const w=x instanceof ht?x:new ht(Et.RequestTimeout,String(x));h(w)};this._responseHandlers.set(m,x=>{if(!r?.signal?.aborted){if(x instanceof Error)return h(x);try{const w=da(n,x.result);w.success?f(w.data):h(w.error)}catch(w){h(w)}}}),r?.signal?.addEventListener("abort",()=>{S(r?.signal?.reason)});const E=r?.timeout??k$,g=()=>S(ht.fromError(Et.RequestTimeout,"Request timed out",{timeout:E}));this._setupTimeout(m,E,r?.maxTotalTimeout,g,r?.resetTimeoutOnProgress??!1);const v=u?.taskId;if(v){const x=w=>{const C=this._responseHandlers.get(m);C?C(w):this._onerror(new Error(`Response handler missing for side-channeled request ${m}`))};this._requestResolvers.set(m,x),this._enqueueTaskMessage(v,{type:"request",message:y,timestamp:Date.now()}).catch(w=>{this._cleanupTimeout(m),h(w)})}else this._transport.send(y,{relatedRequestId:i,resumptionToken:a,onresumptiontoken:l}).catch(x=>{this._cleanupTimeout(m),h(x)})})}async getTask(e,n){return this.request({method:"tasks/get",params:e},xy,n)}async getTaskResult(e,n,r){return this.request({method:"tasks/result",params:e},n,r)}async listTasks(e,n){return this.request({method:"tasks/list",params:e},Ty,n)}async cancelTask(e,n){return this.request({method:"tasks/cancel",params:e},Ez,n)}async notification(e,n){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);const r=n?.relatedTask?.taskId;if(r){const c={...e,jsonrpc:"2.0",params:{...e.params,_meta:{...e.params?._meta||{},[Ka]:n.relatedTask}}};await this._enqueueTaskMessage(r,{type:"notification",message:c,timestamp:Date.now()});return}if((this._options?.debouncedNotificationMethods??[]).includes(e.method)&&!e.params&&!n?.relatedRequestId&&!n?.relatedTask){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let c={...e,jsonrpc:"2.0"};n?.relatedTask&&(c={...c,params:{...c.params,_meta:{...c.params?._meta||{},[Ka]:n.relatedTask}}}),this._transport?.send(c,n).catch(u=>this._onerror(u))});return}let l={...e,jsonrpc:"2.0"};n?.relatedTask&&(l={...l,params:{...l.params,_meta:{...l.params?._meta||{},[Ka]:n.relatedTask}}}),await this._transport.send(l,n)}setRequestHandler(e,n){const r=Fx(e);this.assertRequestHandlerCapability(r),this._requestHandlers.set(r,(i,a)=>{const l=zx(e,i);return Promise.resolve(n(l,a))})}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,n){const r=Fx(e);this._notificationHandlers.set(r,i=>{const a=zx(e,i);return Promise.resolve(n(a))})}removeNotificationHandler(e){this._notificationHandlers.delete(e)}_cleanupTaskProgressHandler(e){const n=this._taskProgressTokens.get(e);n!==void 0&&(this._progressHandlers.delete(n),this._taskProgressTokens.delete(e))}async _enqueueTaskMessage(e,n,r){if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");const i=this._options?.maxTaskQueueSize;await this._taskMessageQueue.enqueue(e,n,r,i)}async _clearTaskQueue(e,n){if(this._taskMessageQueue){const r=await this._taskMessageQueue.dequeueAll(e,n);for(const i of r)if(i.type==="request"&&fv(i.message)){const a=i.message.id,l=this._requestResolvers.get(a);l?(l(new ht(Et.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(a)):this._onerror(new Error(`Resolver missing for request ${a} during task ${e} cleanup`))}}}async _waitForTaskUpdate(e,n){let r=this._options?.defaultTaskPollInterval??1e3;try{const i=await this._taskStore?.getTask(e);i?.pollInterval&&(r=i.pollInterval)}catch{}return new Promise((i,a)=>{if(n.aborted){a(new ht(Et.InvalidRequest,"Request cancelled"));return}const l=setTimeout(i,r);n.addEventListener("abort",()=>{clearTimeout(l),a(new ht(Et.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(e,n){const r=this._taskStore;if(!r)throw new Error("No task store configured");return{createTask:async i=>{if(!e)throw new Error("No request provided");return await r.createTask(i,e.id,{method:e.method,params:e.params},n)},getTask:async i=>{const a=await r.getTask(i,n);if(!a)throw new ht(Et.InvalidParams,"Failed to retrieve task: Task not found");return a},storeTaskResult:async(i,a,l)=>{await r.storeTaskResult(i,a,l,n);const c=await r.getTask(i,n);if(c){const u=Bh.parse({method:"notifications/tasks/status",params:c});await this.notification(u),Ba(c.status)&&this._cleanupTaskProgressHandler(i)}},getTaskResult:i=>r.getTaskResult(i,n),updateTaskStatus:async(i,a,l)=>{const c=await r.getTask(i,n);if(!c)throw new ht(Et.InvalidParams,`Task "${i}" not found - it may have been cleaned up`);if(Ba(c.status))throw new ht(Et.InvalidParams,`Cannot update task "${i}" from terminal status "${c.status}" to "${a}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await r.updateTaskStatus(i,a,l,n);const u=await r.getTask(i,n);if(u){const f=Bh.parse({method:"notifications/tasks/status",params:u});await this.notification(f),Ba(u.status)&&this._cleanupTaskProgressHandler(i)}},listTasks:i=>r.listTasks(i,n)}}}function $x(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function O$(t,e){const n={...t};for(const r in e){const i=r,a=e[i];if(a===void 0)continue;const l=n[i];$x(l)&&$x(a)?n[i]={...l,...a}:n[i]=a}return n}var tf={exports:{}},kg={},gs={},Va={},Lg={},Og={},Dg={},Bx;function jh(){return Bx||(Bx=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class e{}t._CodeOrName=e,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class n extends e{constructor(x){if(super(),!t.IDENTIFIER.test(x))throw new Error("CodeGen: name must be a valid identifier");this.str=x}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=n;class r extends e{constructor(x){super(),this._items=typeof x=="string"?[x]:x}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const x=this._items[0];return x===""||x==='""'}get str(){var x;return(x=this._str)!==null&&x!==void 0?x:this._str=this._items.reduce((w,C)=>`${w}${C}`,"")}get names(){var x;return(x=this._names)!==null&&x!==void 0?x:this._names=this._items.reduce((w,C)=>(C instanceof n&&(w[C.str]=(w[C.str]||0)+1),w),{})}}t._Code=r,t.nil=new r("");function i(v,...x){const w=[v[0]];let C=0;for(;C<x.length;)c(w,x[C]),w.push(v[++C]);return new r(w)}t._=i;const a=new r("+");function l(v,...x){const w=[y(v[0])];let C=0;for(;C<x.length;)w.push(a),c(w,x[C]),w.push(a,y(v[++C]));return u(w),new r(w)}t.str=l;function c(v,x){x instanceof r?v.push(...x._items):x instanceof n?v.push(x):v.push(p(x))}t.addCodeArg=c;function u(v){let x=1;for(;x<v.length-1;){if(v[x]===a){const w=f(v[x-1],v[x+1]);if(w!==void 0){v.splice(x-1,3,w);continue}v[x++]="+"}x++}}function f(v,x){if(x==='""')return v;if(v==='""')return x;if(typeof v=="string")return x instanceof n||v[v.length-1]!=='"'?void 0:typeof x!="string"?`${v.slice(0,-1)}${x}"`:x[0]==='"'?v.slice(0,-1)+x.slice(1):void 0;if(typeof x=="string"&&x[0]==='"'&&!(v instanceof n))return`"${v}${x.slice(1)}`}function h(v,x){return x.emptyStr()?v:v.emptyStr()?x:l`${v}${x}`}t.strConcat=h;function p(v){return typeof v=="number"||typeof v=="boolean"||v===null?v:y(Array.isArray(v)?v.join(","):v)}function m(v){return new r(y(v))}t.stringify=m;function y(v){return JSON.stringify(v).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.safeStringify=y;function S(v){return typeof v=="string"&&t.IDENTIFIER.test(v)?new r(`.${v}`):i`[${v}]`}t.getProperty=S;function E(v){if(typeof v=="string"&&t.IDENTIFIER.test(v))return new r(`${v}`);throw new Error(`CodeGen: invalid export name: ${v}, use explicit $id name mapping`)}t.getEsmExportName=E;function g(v){return new r(v.toString())}t.regexpCode=g})(Dg)),Dg}var Ug={},Vx;function jx(){return Vx||(Vx=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const e=jh();class n extends Error{constructor(f){super(`CodeGen: "code" for ${f} not defined`),this.value=f.value}}var r;(function(u){u[u.Started=0]="Started",u[u.Completed=1]="Completed"})(r||(t.UsedValueState=r={})),t.varKinds={const:new e.Name("const"),let:new e.Name("let"),var:new e.Name("var")};class i{constructor({prefixes:f,parent:h}={}){this._names={},this._prefixes=f,this._parent=h}toName(f){return f instanceof e.Name?f:this.name(f)}name(f){return new e.Name(this._newName(f))}_newName(f){const h=this._names[f]||this._nameGroup(f);return`${f}${h.index++}`}_nameGroup(f){var h,p;if(!((p=(h=this._parent)===null||h===void 0?void 0:h._prefixes)===null||p===void 0)&&p.has(f)||this._prefixes&&!this._prefixes.has(f))throw new Error(`CodeGen: prefix "${f}" is not allowed in this scope`);return this._names[f]={prefix:f,index:0}}}t.Scope=i;class a extends e.Name{constructor(f,h){super(h),this.prefix=f}setValue(f,{property:h,itemIndex:p}){this.value=f,this.scopePath=(0,e._)`.${new e.Name(h)}[${p}]`}}t.ValueScopeName=a;const l=(0,e._)`\n`;class c extends i{constructor(f){super(f),this._values={},this._scope=f.scope,this.opts={...f,_n:f.lines?l:e.nil}}get(){return this._scope}name(f){return new a(f,this._newName(f))}value(f,h){var p;if(h.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const m=this.toName(f),{prefix:y}=m,S=(p=h.key)!==null&&p!==void 0?p:h.ref;let E=this._values[y];if(E){const x=E.get(S);if(x)return x}else E=this._values[y]=new Map;E.set(S,m);const g=this._scope[y]||(this._scope[y]=[]),v=g.length;return g[v]=h.ref,m.setValue(h,{property:y,itemIndex:v}),m}getValue(f,h){const p=this._values[f];if(p)return p.get(h)}scopeRefs(f,h=this._values){return this._reduceValues(h,p=>{if(p.scopePath===void 0)throw new Error(`CodeGen: name "${p}" has no value`);return(0,e._)`${f}${p.scopePath}`})}scopeCode(f=this._values,h,p){return this._reduceValues(f,m=>{if(m.value===void 0)throw new Error(`CodeGen: name "${m}" has no value`);return m.value.code},h,p)}_reduceValues(f,h,p={},m){let y=e.nil;for(const S in f){const E=f[S];if(!E)continue;const g=p[S]=p[S]||new Map;E.forEach(v=>{if(g.has(v))return;g.set(v,r.Started);let x=h(v);if(x){const w=this.opts.es5?t.varKinds.var:t.varKinds.const;y=(0,e._)`${y}${w} ${v} = ${x};${this.opts._n}`}else if(x=m?.(v))y=(0,e._)`${y}${x}${this.opts._n}`;else throw new n(v);g.set(v,r.Completed)})}return y}}t.ValueScope=c})(Ug)),Ug}var Hx;function Lt(){return Hx||(Hx=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const e=jh(),n=jx();var r=jh();Object.defineProperty(t,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return r.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return r.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return r.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return r.Name}});var i=jx();Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return i.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return i.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return i.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return i.varKinds}}),t.operators={GT:new e._Code(">"),GTE:new e._Code(">="),LT:new e._Code("<"),LTE:new e._Code("<="),EQ:new e._Code("==="),NEQ:new e._Code("!=="),NOT:new e._Code("!"),OR:new e._Code("||"),AND:new e._Code("&&"),ADD:new e._Code("+")};class a{optimizeNodes(){return this}optimizeNames(P,L){return this}}class l extends a{constructor(P,L,G){super(),this.varKind=P,this.name=L,this.rhs=G}render({es5:P,_n:L}){const G=P?n.varKinds.var:this.varKind,Q=this.rhs===void 0?"":` = ${this.rhs}`;return`${G} ${this.name}${Q};`+L}optimizeNames(P,L){if(P[this.name.str])return this.rhs&&(this.rhs=Z(this.rhs,P,L)),this}get names(){return this.rhs instanceof e._CodeOrName?this.rhs.names:{}}}class c extends a{constructor(P,L,G){super(),this.lhs=P,this.rhs=L,this.sideEffects=G}render({_n:P}){return`${this.lhs} = ${this.rhs};`+P}optimizeNames(P,L){if(!(this.lhs instanceof e.Name&&!P[this.lhs.str]&&!this.sideEffects))return this.rhs=Z(this.rhs,P,L),this}get names(){const P=this.lhs instanceof e.Name?{}:{...this.lhs.names};return ae(P,this.rhs)}}class u extends c{constructor(P,L,G,Q){super(P,G,Q),this.op=L}render({_n:P}){return`${this.lhs} ${this.op}= ${this.rhs};`+P}}class f extends a{constructor(P){super(),this.label=P,this.names={}}render({_n:P}){return`${this.label}:`+P}}class h extends a{constructor(P){super(),this.label=P,this.names={}}render({_n:P}){return`break${this.label?` ${this.label}`:""};`+P}}class p extends a{constructor(P){super(),this.error=P}render({_n:P}){return`throw ${this.error};`+P}get names(){return this.error.names}}class m extends a{constructor(P){super(),this.code=P}render({_n:P}){return`${this.code};`+P}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(P,L){return this.code=Z(this.code,P,L),this}get names(){return this.code instanceof e._CodeOrName?this.code.names:{}}}class y extends a{constructor(P=[]){super(),this.nodes=P}render(P){return this.nodes.reduce((L,G)=>L+G.render(P),"")}optimizeNodes(){const{nodes:P}=this;let L=P.length;for(;L--;){const G=P[L].optimizeNodes();Array.isArray(G)?P.splice(L,1,...G):G?P[L]=G:P.splice(L,1)}return P.length>0?this:void 0}optimizeNames(P,L){const{nodes:G}=this;let Q=G.length;for(;Q--;){const le=G[Q];le.optimizeNames(P,L)||(ie(P,le.names),G.splice(Q,1))}return G.length>0?this:void 0}get names(){return this.nodes.reduce((P,L)=>J(P,L.names),{})}}class S extends y{render(P){return"{"+P._n+super.render(P)+"}"+P._n}}class E extends y{}class g extends S{}g.kind="else";class v extends S{constructor(P,L){super(L),this.condition=P}render(P){let L=`if(${this.condition})`+super.render(P);return this.else&&(L+="else "+this.else.render(P)),L}optimizeNodes(){super.optimizeNodes();const P=this.condition;if(P===!0)return this.nodes;let L=this.else;if(L){const G=L.optimizeNodes();L=this.else=Array.isArray(G)?new g(G):G}if(L)return P===!1?L instanceof v?L:L.nodes:this.nodes.length?this:new v(de(P),L instanceof v?[L]:L.nodes);if(!(P===!1||!this.nodes.length))return this}optimizeNames(P,L){var G;if(this.else=(G=this.else)===null||G===void 0?void 0:G.optimizeNames(P,L),!!(super.optimizeNames(P,L)||this.else))return this.condition=Z(this.condition,P,L),this}get names(){const P=super.names;return ae(P,this.condition),this.else&&J(P,this.else.names),P}}v.kind="if";class x extends S{}x.kind="for";class w extends x{constructor(P){super(),this.iteration=P}render(P){return`for(${this.iteration})`+super.render(P)}optimizeNames(P,L){if(super.optimizeNames(P,L))return this.iteration=Z(this.iteration,P,L),this}get names(){return J(super.names,this.iteration.names)}}class C extends x{constructor(P,L,G,Q){super(),this.varKind=P,this.name=L,this.from=G,this.to=Q}render(P){const L=P.es5?n.varKinds.var:this.varKind,{name:G,from:Q,to:le}=this;return`for(${L} ${G}=${Q}; ${G}<${le}; ${G}++)`+super.render(P)}get names(){const P=ae(super.names,this.from);return ae(P,this.to)}}class T extends x{constructor(P,L,G,Q){super(),this.loop=P,this.varKind=L,this.name=G,this.iterable=Q}render(P){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(P)}optimizeNames(P,L){if(super.optimizeNames(P,L))return this.iterable=Z(this.iterable,P,L),this}get names(){return J(super.names,this.iterable.names)}}class M extends S{constructor(P,L,G){super(),this.name=P,this.args=L,this.async=G}render(P){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(P)}}M.kind="func";class A extends y{render(P){return"return "+super.render(P)}}A.kind="return";class F extends S{render(P){let L="try"+super.render(P);return this.catch&&(L+=this.catch.render(P)),this.finally&&(L+=this.finally.render(P)),L}optimizeNodes(){var P,L;return super.optimizeNodes(),(P=this.catch)===null||P===void 0||P.optimizeNodes(),(L=this.finally)===null||L===void 0||L.optimizeNodes(),this}optimizeNames(P,L){var G,Q;return super.optimizeNames(P,L),(G=this.catch)===null||G===void 0||G.optimizeNames(P,L),(Q=this.finally)===null||Q===void 0||Q.optimizeNames(P,L),this}get names(){const P=super.names;return this.catch&&J(P,this.catch.names),this.finally&&J(P,this.finally.names),P}}class I extends S{constructor(P){super(),this.error=P}render(P){return`catch(${this.error})`+super.render(P)}}I.kind="catch";class O extends S{render(P){return"finally"+super.render(P)}}O.kind="finally";class W{constructor(P,L={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...L,_n:L.lines?`
`:""},this._extScope=P,this._scope=new n.Scope({parent:P}),this._nodes=[new E]}toString(){return this._root.render(this.opts)}name(P){return this._scope.name(P)}scopeName(P){return this._extScope.name(P)}scopeValue(P,L){const G=this._extScope.value(P,L);return(this._values[G.prefix]||(this._values[G.prefix]=new Set)).add(G),G}getScopeValue(P,L){return this._extScope.getValue(P,L)}scopeRefs(P){return this._extScope.scopeRefs(P,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(P,L,G,Q){const le=this._scope.toName(L);return G!==void 0&&Q&&(this._constants[le.str]=G),this._leafNode(new l(P,le,G)),le}const(P,L,G){return this._def(n.varKinds.const,P,L,G)}let(P,L,G){return this._def(n.varKinds.let,P,L,G)}var(P,L,G){return this._def(n.varKinds.var,P,L,G)}assign(P,L,G){return this._leafNode(new c(P,L,G))}add(P,L){return this._leafNode(new u(P,t.operators.ADD,L))}code(P){return typeof P=="function"?P():P!==e.nil&&this._leafNode(new m(P)),this}object(...P){const L=["{"];for(const[G,Q]of P)L.length>1&&L.push(","),L.push(G),(G!==Q||this.opts.es5)&&(L.push(":"),(0,e.addCodeArg)(L,Q));return L.push("}"),new e._Code(L)}if(P,L,G){if(this._blockNode(new v(P)),L&&G)this.code(L).else().code(G).endIf();else if(L)this.code(L).endIf();else if(G)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(P){return this._elseNode(new v(P))}else(){return this._elseNode(new g)}endIf(){return this._endBlockNode(v,g)}_for(P,L){return this._blockNode(P),L&&this.code(L).endFor(),this}for(P,L){return this._for(new w(P),L)}forRange(P,L,G,Q,le=this.opts.es5?n.varKinds.var:n.varKinds.let){const xe=this._scope.toName(P);return this._for(new C(le,xe,L,G),()=>Q(xe))}forOf(P,L,G,Q=n.varKinds.const){const le=this._scope.toName(P);if(this.opts.es5){const xe=L instanceof e.Name?L:this.var("_arr",L);return this.forRange("_i",0,(0,e._)`${xe}.length`,Te=>{this.var(le,(0,e._)`${xe}[${Te}]`),G(le)})}return this._for(new T("of",Q,le,L),()=>G(le))}forIn(P,L,G,Q=this.opts.es5?n.varKinds.var:n.varKinds.const){if(this.opts.ownProperties)return this.forOf(P,(0,e._)`Object.keys(${L})`,G);const le=this._scope.toName(P);return this._for(new T("in",Q,le,L),()=>G(le))}endFor(){return this._endBlockNode(x)}label(P){return this._leafNode(new f(P))}break(P){return this._leafNode(new h(P))}return(P){const L=new A;if(this._blockNode(L),this.code(P),L.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(A)}try(P,L,G){if(!L&&!G)throw new Error('CodeGen: "try" without "catch" and "finally"');const Q=new F;if(this._blockNode(Q),this.code(P),L){const le=this.name("e");this._currNode=Q.catch=new I(le),L(le)}return G&&(this._currNode=Q.finally=new O,this.code(G)),this._endBlockNode(I,O)}throw(P){return this._leafNode(new p(P))}block(P,L){return this._blockStarts.push(this._nodes.length),P&&this.code(P).endBlock(L),this}endBlock(P){const L=this._blockStarts.pop();if(L===void 0)throw new Error("CodeGen: not in self-balancing block");const G=this._nodes.length-L;if(G<0||P!==void 0&&G!==P)throw new Error(`CodeGen: wrong number of nodes: ${G} vs ${P} expected`);return this._nodes.length=L,this}func(P,L=e.nil,G,Q){return this._blockNode(new M(P,L,G)),Q&&this.code(Q).endFunc(),this}endFunc(){return this._endBlockNode(M)}optimize(P=1){for(;P-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(P){return this._currNode.nodes.push(P),this}_blockNode(P){this._currNode.nodes.push(P),this._nodes.push(P)}_endBlockNode(P,L){const G=this._currNode;if(G instanceof P||L&&G instanceof L)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${L?`${P.kind}/${L.kind}`:P.kind}"`)}_elseNode(P){const L=this._currNode;if(!(L instanceof v))throw new Error('CodeGen: "else" without "if"');return this._currNode=L.else=P,this}get _root(){return this._nodes[0]}get _currNode(){const P=this._nodes;return P[P.length-1]}set _currNode(P){const L=this._nodes;L[L.length-1]=P}}t.CodeGen=W;function J(U,P){for(const L in P)U[L]=(U[L]||0)+(P[L]||0);return U}function ae(U,P){return P instanceof e._CodeOrName?J(U,P.names):U}function Z(U,P,L){if(U instanceof e.Name)return G(U);if(!Q(U))return U;return new e._Code(U._items.reduce((le,xe)=>(xe instanceof e.Name&&(xe=G(xe)),xe instanceof e._Code?le.push(...xe._items):le.push(xe),le),[]));function G(le){const xe=L[le.str];return xe===void 0||P[le.str]!==1?le:(delete P[le.str],xe)}function Q(le){return le instanceof e._Code&&le._items.some(xe=>xe instanceof e.Name&&P[xe.str]===1&&L[xe.str]!==void 0)}}function ie(U,P){for(const L in P)U[L]=(U[L]||0)-(P[L]||0)}function de(U){return typeof U=="boolean"||typeof U=="number"||U===null?!U:(0,e._)`!${H(U)}`}t.not=de;const pe=N(t.operators.AND);function K(...U){return U.reduce(pe)}t.and=K;const ne=N(t.operators.OR);function j(...U){return U.reduce(ne)}t.or=j;function N(U){return(P,L)=>P===e.nil?L:L===e.nil?P:(0,e._)`${H(P)} ${U} ${H(L)}`}function H(U){return U instanceof e.Name?U:(0,e._)`(${U})`}})(Og)),Og}var kt={},Gx;function Wt(){if(Gx)return kt;Gx=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.checkStrictMode=kt.getErrorPath=kt.Type=kt.useFunc=kt.setEvaluated=kt.evaluatedPropsToName=kt.mergeEvaluated=kt.eachItem=kt.unescapeJsonPointer=kt.escapeJsonPointer=kt.escapeFragment=kt.unescapeFragment=kt.schemaRefOrVal=kt.schemaHasRulesButRef=kt.schemaHasRules=kt.checkUnknownRules=kt.alwaysValidSchema=kt.toHash=void 0;const t=Lt(),e=jh();function n(T){const M={};for(const A of T)M[A]=!0;return M}kt.toHash=n;function r(T,M){return typeof M=="boolean"?M:Object.keys(M).length===0?!0:(i(T,M),!a(M,T.self.RULES.all))}kt.alwaysValidSchema=r;function i(T,M=T.schema){const{opts:A,self:F}=T;if(!A.strictSchema||typeof M=="boolean")return;const I=F.RULES.keywords;for(const O in M)I[O]||C(T,`unknown keyword: "${O}"`)}kt.checkUnknownRules=i;function a(T,M){if(typeof T=="boolean")return!T;for(const A in T)if(M[A])return!0;return!1}kt.schemaHasRules=a;function l(T,M){if(typeof T=="boolean")return!T;for(const A in T)if(A!=="$ref"&&M.all[A])return!0;return!1}kt.schemaHasRulesButRef=l;function c({topSchemaRef:T,schemaPath:M},A,F,I){if(!I){if(typeof A=="number"||typeof A=="boolean")return A;if(typeof A=="string")return(0,t._)`${A}`}return(0,t._)`${T}${M}${(0,t.getProperty)(F)}`}kt.schemaRefOrVal=c;function u(T){return p(decodeURIComponent(T))}kt.unescapeFragment=u;function f(T){return encodeURIComponent(h(T))}kt.escapeFragment=f;function h(T){return typeof T=="number"?`${T}`:T.replace(/~/g,"~0").replace(/\//g,"~1")}kt.escapeJsonPointer=h;function p(T){return T.replace(/~1/g,"/").replace(/~0/g,"~")}kt.unescapeJsonPointer=p;function m(T,M){if(Array.isArray(T))for(const A of T)M(A);else M(T)}kt.eachItem=m;function y({mergeNames:T,mergeToName:M,mergeValues:A,resultToName:F}){return(I,O,W,J)=>{const ae=W===void 0?O:W instanceof t.Name?(O instanceof t.Name?T(I,O,W):M(I,O,W),W):O instanceof t.Name?(M(I,W,O),O):A(O,W);return J===t.Name&&!(ae instanceof t.Name)?F(I,ae):ae}}kt.mergeEvaluated={props:y({mergeNames:(T,M,A)=>T.if((0,t._)`${A} !== true && ${M} !== undefined`,()=>{T.if((0,t._)`${M} === true`,()=>T.assign(A,!0),()=>T.assign(A,(0,t._)`${A} || {}`).code((0,t._)`Object.assign(${A}, ${M})`))}),mergeToName:(T,M,A)=>T.if((0,t._)`${A} !== true`,()=>{M===!0?T.assign(A,!0):(T.assign(A,(0,t._)`${A} || {}`),E(T,A,M))}),mergeValues:(T,M)=>T===!0?!0:{...T,...M},resultToName:S}),items:y({mergeNames:(T,M,A)=>T.if((0,t._)`${A} !== true && ${M} !== undefined`,()=>T.assign(A,(0,t._)`${M} === true ? true : ${A} > ${M} ? ${A} : ${M}`)),mergeToName:(T,M,A)=>T.if((0,t._)`${A} !== true`,()=>T.assign(A,M===!0?!0:(0,t._)`${A} > ${M} ? ${A} : ${M}`)),mergeValues:(T,M)=>T===!0?!0:Math.max(T,M),resultToName:(T,M)=>T.var("items",M)})};function S(T,M){if(M===!0)return T.var("props",!0);const A=T.var("props",(0,t._)`{}`);return M!==void 0&&E(T,A,M),A}kt.evaluatedPropsToName=S;function E(T,M,A){Object.keys(A).forEach(F=>T.assign((0,t._)`${M}${(0,t.getProperty)(F)}`,!0))}kt.setEvaluated=E;const g={};function v(T,M){return T.scopeValue("func",{ref:M,code:g[M.code]||(g[M.code]=new e._Code(M.code))})}kt.useFunc=v;var x;(function(T){T[T.Num=0]="Num",T[T.Str=1]="Str"})(x||(kt.Type=x={}));function w(T,M,A){if(T instanceof t.Name){const F=M===x.Num;return A?F?(0,t._)`"[" + ${T} + "]"`:(0,t._)`"['" + ${T} + "']"`:F?(0,t._)`"/" + ${T}`:(0,t._)`"/" + ${T}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return A?(0,t.getProperty)(T).toString():"/"+h(T)}kt.getErrorPath=w;function C(T,M,A=T.opts.strictSchema){if(A){if(M=`strict mode: ${M}`,A===!0)throw new Error(M);T.self.logger.warn(M)}}return kt.checkStrictMode=C,kt}var nf={},Wx;function ba(){if(Wx)return nf;Wx=1,Object.defineProperty(nf,"__esModule",{value:!0});const t=Lt(),e={data:new t.Name("data"),valCxt:new t.Name("valCxt"),instancePath:new t.Name("instancePath"),parentData:new t.Name("parentData"),parentDataProperty:new t.Name("parentDataProperty"),rootData:new t.Name("rootData"),dynamicAnchors:new t.Name("dynamicAnchors"),vErrors:new t.Name("vErrors"),errors:new t.Name("errors"),this:new t.Name("this"),self:new t.Name("self"),scope:new t.Name("scope"),json:new t.Name("json"),jsonPos:new t.Name("jsonPos"),jsonLen:new t.Name("jsonLen"),jsonPart:new t.Name("jsonPart")};return nf.default=e,nf}var qx;function Cp(){return qx||(qx=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const e=Lt(),n=Wt(),r=ba();t.keywordError={message:({keyword:g})=>(0,e.str)`must pass "${g}" keyword validation`},t.keyword$DataError={message:({keyword:g,schemaType:v})=>v?(0,e.str)`"${g}" keyword must be ${v} ($data)`:(0,e.str)`"${g}" keyword is invalid ($data)`};function i(g,v=t.keywordError,x,w){const{it:C}=g,{gen:T,compositeRule:M,allErrors:A}=C,F=p(g,v,x);w??(M||A)?u(T,F):f(C,(0,e._)`[${F}]`)}t.reportError=i;function a(g,v=t.keywordError,x){const{it:w}=g,{gen:C,compositeRule:T,allErrors:M}=w,A=p(g,v,x);u(C,A),T||M||f(w,r.default.vErrors)}t.reportExtraError=a;function l(g,v){g.assign(r.default.errors,v),g.if((0,e._)`${r.default.vErrors} !== null`,()=>g.if(v,()=>g.assign((0,e._)`${r.default.vErrors}.length`,v),()=>g.assign(r.default.vErrors,null)))}t.resetErrorsCount=l;function c({gen:g,keyword:v,schemaValue:x,data:w,errsCount:C,it:T}){if(C===void 0)throw new Error("ajv implementation error");const M=g.name("err");g.forRange("i",C,r.default.errors,A=>{g.const(M,(0,e._)`${r.default.vErrors}[${A}]`),g.if((0,e._)`${M}.instancePath === undefined`,()=>g.assign((0,e._)`${M}.instancePath`,(0,e.strConcat)(r.default.instancePath,T.errorPath))),g.assign((0,e._)`${M}.schemaPath`,(0,e.str)`${T.errSchemaPath}/${v}`),T.opts.verbose&&(g.assign((0,e._)`${M}.schema`,x),g.assign((0,e._)`${M}.data`,w))})}t.extendErrors=c;function u(g,v){const x=g.const("err",v);g.if((0,e._)`${r.default.vErrors} === null`,()=>g.assign(r.default.vErrors,(0,e._)`[${x}]`),(0,e._)`${r.default.vErrors}.push(${x})`),g.code((0,e._)`${r.default.errors}++`)}function f(g,v){const{gen:x,validateName:w,schemaEnv:C}=g;C.$async?x.throw((0,e._)`new ${g.ValidationError}(${v})`):(x.assign((0,e._)`${w}.errors`,v),x.return(!1))}const h={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")};function p(g,v,x){const{createErrors:w}=g.it;return w===!1?(0,e._)`{}`:m(g,v,x)}function m(g,v,x={}){const{gen:w,it:C}=g,T=[y(C,x),S(g,x)];return E(g,v,T),w.object(...T)}function y({errorPath:g},{instancePath:v}){const x=v?(0,e.str)`${g}${(0,n.getErrorPath)(v,n.Type.Str)}`:g;return[r.default.instancePath,(0,e.strConcat)(r.default.instancePath,x)]}function S({keyword:g,it:{errSchemaPath:v}},{schemaPath:x,parentSchema:w}){let C=w?v:(0,e.str)`${v}/${g}`;return x&&(C=(0,e.str)`${C}${(0,n.getErrorPath)(x,n.Type.Str)}`),[h.schemaPath,C]}function E(g,{params:v,message:x},w){const{keyword:C,data:T,schemaValue:M,it:A}=g,{opts:F,propertyName:I,topSchemaRef:O,schemaPath:W}=A;w.push([h.keyword,C],[h.params,typeof v=="function"?v(g):v||(0,e._)`{}`]),F.messages&&w.push([h.message,typeof x=="function"?x(g):x]),F.verbose&&w.push([h.schema,M],[h.parentSchema,(0,e._)`${O}${W}`],[r.default.data,T]),I&&w.push([h.propertyName,I])}})(Lg)),Lg}var Zx;function D$(){if(Zx)return Va;Zx=1,Object.defineProperty(Va,"__esModule",{value:!0}),Va.boolOrEmptySchema=Va.topBoolOrEmptySchema=void 0;const t=Cp(),e=Lt(),n=ba(),r={message:"boolean schema is false"};function i(c){const{gen:u,schema:f,validateName:h}=c;f===!1?l(c,!1):typeof f=="object"&&f.$async===!0?u.return(n.default.data):(u.assign((0,e._)`${h}.errors`,null),u.return(!0))}Va.topBoolOrEmptySchema=i;function a(c,u){const{gen:f,schema:h}=c;h===!1?(f.var(u,!1),l(c)):f.var(u,!0)}Va.boolOrEmptySchema=a;function l(c,u){const{gen:f,data:h}=c,p={gen:f,keyword:"false schema",data:h,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:c};(0,t.reportError)(p,r,void 0,u)}return Va}var tr={},ja={},Xx;function wA(){if(Xx)return ja;Xx=1,Object.defineProperty(ja,"__esModule",{value:!0}),ja.getRules=ja.isJSONType=void 0;const t=["string","number","integer","boolean","null","object","array"],e=new Set(t);function n(i){return typeof i=="string"&&e.has(i)}ja.isJSONType=n;function r(){const i={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...i,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},i.number,i.string,i.array,i.object],post:{rules:[]},all:{},keywords:{}}}return ja.getRules=r,ja}var _s={},Kx;function xA(){if(Kx)return _s;Kx=1,Object.defineProperty(_s,"__esModule",{value:!0}),_s.shouldUseRule=_s.shouldUseGroup=_s.schemaHasRulesForType=void 0;function t({schema:r,self:i},a){const l=i.RULES.types[a];return l&&l!==!0&&e(r,l)}_s.schemaHasRulesForType=t;function e(r,i){return i.rules.some(a=>n(r,a))}_s.shouldUseGroup=e;function n(r,i){var a;return r[i.keyword]!==void 0||((a=i.definition.implements)===null||a===void 0?void 0:a.some(l=>r[l]!==void 0))}return _s.shouldUseRule=n,_s}var Yx;function Hh(){if(Yx)return tr;Yx=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.reportTypeError=tr.checkDataTypes=tr.checkDataType=tr.coerceAndCheckDataType=tr.getJSONTypes=tr.getSchemaTypes=tr.DataType=void 0;const t=wA(),e=xA(),n=Cp(),r=Lt(),i=Wt();var a;(function(x){x[x.Correct=0]="Correct",x[x.Wrong=1]="Wrong"})(a||(tr.DataType=a={}));function l(x){const w=c(x.type);if(w.includes("null")){if(x.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!w.length&&x.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');x.nullable===!0&&w.push("null")}return w}tr.getSchemaTypes=l;function c(x){const w=Array.isArray(x)?x:x?[x]:[];if(w.every(t.isJSONType))return w;throw new Error("type must be JSONType or JSONType[]: "+w.join(","))}tr.getJSONTypes=c;function u(x,w){const{gen:C,data:T,opts:M}=x,A=h(w,M.coerceTypes),F=w.length>0&&!(A.length===0&&w.length===1&&(0,e.schemaHasRulesForType)(x,w[0]));if(F){const I=S(w,T,M.strictNumbers,a.Wrong);C.if(I,()=>{A.length?p(x,w,A):g(x)})}return F}tr.coerceAndCheckDataType=u;const f=new Set(["string","number","integer","boolean","null"]);function h(x,w){return w?x.filter(C=>f.has(C)||w==="array"&&C==="array"):[]}function p(x,w,C){const{gen:T,data:M,opts:A}=x,F=T.let("dataType",(0,r._)`typeof ${M}`),I=T.let("coerced",(0,r._)`undefined`);A.coerceTypes==="array"&&T.if((0,r._)`${F} == 'object' && Array.isArray(${M}) && ${M}.length == 1`,()=>T.assign(M,(0,r._)`${M}[0]`).assign(F,(0,r._)`typeof ${M}`).if(S(w,M,A.strictNumbers),()=>T.assign(I,M))),T.if((0,r._)`${I} !== undefined`);for(const W of C)(f.has(W)||W==="array"&&A.coerceTypes==="array")&&O(W);T.else(),g(x),T.endIf(),T.if((0,r._)`${I} !== undefined`,()=>{T.assign(M,I),m(x,I)});function O(W){switch(W){case"string":T.elseIf((0,r._)`${F} == "number" || ${F} == "boolean"`).assign(I,(0,r._)`"" + ${M}`).elseIf((0,r._)`${M} === null`).assign(I,(0,r._)`""`);return;case"number":T.elseIf((0,r._)`${F} == "boolean" || ${M} === null
              || (${F} == "string" && ${M} && ${M} == +${M})`).assign(I,(0,r._)`+${M}`);return;case"integer":T.elseIf((0,r._)`${F} === "boolean" || ${M} === null
              || (${F} === "string" && ${M} && ${M} == +${M} && !(${M} % 1))`).assign(I,(0,r._)`+${M}`);return;case"boolean":T.elseIf((0,r._)`${M} === "false" || ${M} === 0 || ${M} === null`).assign(I,!1).elseIf((0,r._)`${M} === "true" || ${M} === 1`).assign(I,!0);return;case"null":T.elseIf((0,r._)`${M} === "" || ${M} === 0 || ${M} === false`),T.assign(I,null);return;case"array":T.elseIf((0,r._)`${F} === "string" || ${F} === "number"
              || ${F} === "boolean" || ${M} === null`).assign(I,(0,r._)`[${M}]`)}}}function m({gen:x,parentData:w,parentDataProperty:C},T){x.if((0,r._)`${w} !== undefined`,()=>x.assign((0,r._)`${w}[${C}]`,T))}function y(x,w,C,T=a.Correct){const M=T===a.Correct?r.operators.EQ:r.operators.NEQ;let A;switch(x){case"null":return(0,r._)`${w} ${M} null`;case"array":A=(0,r._)`Array.isArray(${w})`;break;case"object":A=(0,r._)`${w} && typeof ${w} == "object" && !Array.isArray(${w})`;break;case"integer":A=F((0,r._)`!(${w} % 1) && !isNaN(${w})`);break;case"number":A=F();break;default:return(0,r._)`typeof ${w} ${M} ${x}`}return T===a.Correct?A:(0,r.not)(A);function F(I=r.nil){return(0,r.and)((0,r._)`typeof ${w} == "number"`,I,C?(0,r._)`isFinite(${w})`:r.nil)}}tr.checkDataType=y;function S(x,w,C,T){if(x.length===1)return y(x[0],w,C,T);let M;const A=(0,i.toHash)(x);if(A.array&&A.object){const F=(0,r._)`typeof ${w} != "object"`;M=A.null?F:(0,r._)`!${w} || ${F}`,delete A.null,delete A.array,delete A.object}else M=r.nil;A.number&&delete A.integer;for(const F in A)M=(0,r.and)(M,y(F,w,C,T));return M}tr.checkDataTypes=S;const E={message:({schema:x})=>`must be ${x}`,params:({schema:x,schemaValue:w})=>typeof x=="string"?(0,r._)`{type: ${x}}`:(0,r._)`{type: ${w}}`};function g(x){const w=v(x);(0,n.reportError)(w,E)}tr.reportTypeError=g;function v(x){const{gen:w,data:C,schema:T}=x,M=(0,i.schemaRefOrVal)(x,T,"type");return{gen:w,keyword:"type",data:C,schema:T.type,schemaCode:M,schemaValue:M,parentSchema:T,params:{},it:x}}return tr}var Nc={},Jx;function U$(){if(Jx)return Nc;Jx=1,Object.defineProperty(Nc,"__esModule",{value:!0}),Nc.assignDefaults=void 0;const t=Lt(),e=Wt();function n(i,a){const{properties:l,items:c}=i.schema;if(a==="object"&&l)for(const u in l)r(i,u,l[u].default);else a==="array"&&Array.isArray(c)&&c.forEach((u,f)=>r(i,f,u.default))}Nc.assignDefaults=n;function r(i,a,l){const{gen:c,compositeRule:u,data:f,opts:h}=i;if(l===void 0)return;const p=(0,t._)`${f}${(0,t.getProperty)(a)}`;if(u){(0,e.checkStrictMode)(i,`default is ignored for: ${p}`);return}let m=(0,t._)`${p} === undefined`;h.useDefaults==="empty"&&(m=(0,t._)`${m} || ${p} === null || ${p} === ""`),c.if(m,(0,t._)`${p} = ${(0,t.stringify)(l)}`)}return Nc}var Ni={},en={},Qx;function Gi(){if(Qx)return en;Qx=1,Object.defineProperty(en,"__esModule",{value:!0}),en.validateUnion=en.validateArray=en.usePattern=en.callValidateCode=en.schemaProperties=en.allSchemaProperties=en.noPropertyInData=en.propertyInData=en.isOwnProperty=en.hasPropFunc=en.reportMissingProp=en.checkMissingProp=en.checkReportMissingProp=void 0;const t=Lt(),e=Wt(),n=ba(),r=Wt();function i(x,w){const{gen:C,data:T,it:M}=x;C.if(h(C,T,w,M.opts.ownProperties),()=>{x.setParams({missingProperty:(0,t._)`${w}`},!0),x.error()})}en.checkReportMissingProp=i;function a({gen:x,data:w,it:{opts:C}},T,M){return(0,t.or)(...T.map(A=>(0,t.and)(h(x,w,A,C.ownProperties),(0,t._)`${M} = ${A}`)))}en.checkMissingProp=a;function l(x,w){x.setParams({missingProperty:w},!0),x.error()}en.reportMissingProp=l;function c(x){return x.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,t._)`Object.prototype.hasOwnProperty`})}en.hasPropFunc=c;function u(x,w,C){return(0,t._)`${c(x)}.call(${w}, ${C})`}en.isOwnProperty=u;function f(x,w,C,T){const M=(0,t._)`${w}${(0,t.getProperty)(C)} !== undefined`;return T?(0,t._)`${M} && ${u(x,w,C)}`:M}en.propertyInData=f;function h(x,w,C,T){const M=(0,t._)`${w}${(0,t.getProperty)(C)} === undefined`;return T?(0,t.or)(M,(0,t.not)(u(x,w,C))):M}en.noPropertyInData=h;function p(x){return x?Object.keys(x).filter(w=>w!=="__proto__"):[]}en.allSchemaProperties=p;function m(x,w){return p(w).filter(C=>!(0,e.alwaysValidSchema)(x,w[C]))}en.schemaProperties=m;function y({schemaCode:x,data:w,it:{gen:C,topSchemaRef:T,schemaPath:M,errorPath:A},it:F},I,O,W){const J=W?(0,t._)`${x}, ${w}, ${T}${M}`:w,ae=[[n.default.instancePath,(0,t.strConcat)(n.default.instancePath,A)],[n.default.parentData,F.parentData],[n.default.parentDataProperty,F.parentDataProperty],[n.default.rootData,n.default.rootData]];F.opts.dynamicRef&&ae.push([n.default.dynamicAnchors,n.default.dynamicAnchors]);const Z=(0,t._)`${J}, ${C.object(...ae)}`;return O!==t.nil?(0,t._)`${I}.call(${O}, ${Z})`:(0,t._)`${I}(${Z})`}en.callValidateCode=y;const S=(0,t._)`new RegExp`;function E({gen:x,it:{opts:w}},C){const T=w.unicodeRegExp?"u":"",{regExp:M}=w.code,A=M(C,T);return x.scopeValue("pattern",{key:A.toString(),ref:A,code:(0,t._)`${M.code==="new RegExp"?S:(0,r.useFunc)(x,M)}(${C}, ${T})`})}en.usePattern=E;function g(x){const{gen:w,data:C,keyword:T,it:M}=x,A=w.name("valid");if(M.allErrors){const I=w.let("valid",!0);return F(()=>w.assign(I,!1)),I}return w.var(A,!0),F(()=>w.break()),A;function F(I){const O=w.const("len",(0,t._)`${C}.length`);w.forRange("i",0,O,W=>{x.subschema({keyword:T,dataProp:W,dataPropType:e.Type.Num},A),w.if((0,t.not)(A),I)})}}en.validateArray=g;function v(x){const{gen:w,schema:C,keyword:T,it:M}=x;if(!Array.isArray(C))throw new Error("ajv implementation error");if(C.some(O=>(0,e.alwaysValidSchema)(M,O))&&!M.opts.unevaluated)return;const F=w.let("valid",!1),I=w.name("_valid");w.block(()=>C.forEach((O,W)=>{const J=x.subschema({keyword:T,schemaProp:W,compositeRule:!0},I);w.assign(F,(0,t._)`${F} || ${I}`),x.mergeValidEvaluated(J,I)||w.if((0,t.not)(F))})),x.result(F,()=>x.reset(),()=>x.error(!0))}return en.validateUnion=v,en}var eE;function F$(){if(eE)return Ni;eE=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.validateKeywordUsage=Ni.validSchemaType=Ni.funcKeywordCode=Ni.macroKeywordCode=void 0;const t=Lt(),e=ba(),n=Gi(),r=Cp();function i(m,y){const{gen:S,keyword:E,schema:g,parentSchema:v,it:x}=m,w=y.macro.call(x.self,g,v,x),C=f(S,E,w);x.opts.validateSchema!==!1&&x.self.validateSchema(w,!0);const T=S.name("valid");m.subschema({schema:w,schemaPath:t.nil,errSchemaPath:`${x.errSchemaPath}/${E}`,topSchemaRef:C,compositeRule:!0},T),m.pass(T,()=>m.error(!0))}Ni.macroKeywordCode=i;function a(m,y){var S;const{gen:E,keyword:g,schema:v,parentSchema:x,$data:w,it:C}=m;u(C,y);const T=!w&&y.compile?y.compile.call(C.self,v,x,C):y.validate,M=f(E,g,T),A=E.let("valid");m.block$data(A,F),m.ok((S=y.valid)!==null&&S!==void 0?S:A);function F(){if(y.errors===!1)W(),y.modifying&&l(m),J(()=>m.error());else{const ae=y.async?I():O();y.modifying&&l(m),J(()=>c(m,ae))}}function I(){const ae=E.let("ruleErrs",null);return E.try(()=>W((0,t._)`await `),Z=>E.assign(A,!1).if((0,t._)`${Z} instanceof ${C.ValidationError}`,()=>E.assign(ae,(0,t._)`${Z}.errors`),()=>E.throw(Z))),ae}function O(){const ae=(0,t._)`${M}.errors`;return E.assign(ae,null),W(t.nil),ae}function W(ae=y.async?(0,t._)`await `:t.nil){const Z=C.opts.passContext?e.default.this:e.default.self,ie=!("compile"in y&&!w||y.schema===!1);E.assign(A,(0,t._)`${ae}${(0,n.callValidateCode)(m,M,Z,ie)}`,y.modifying)}function J(ae){var Z;E.if((0,t.not)((Z=y.valid)!==null&&Z!==void 0?Z:A),ae)}}Ni.funcKeywordCode=a;function l(m){const{gen:y,data:S,it:E}=m;y.if(E.parentData,()=>y.assign(S,(0,t._)`${E.parentData}[${E.parentDataProperty}]`))}function c(m,y){const{gen:S}=m;S.if((0,t._)`Array.isArray(${y})`,()=>{S.assign(e.default.vErrors,(0,t._)`${e.default.vErrors} === null ? ${y} : ${e.default.vErrors}.concat(${y})`).assign(e.default.errors,(0,t._)`${e.default.vErrors}.length`),(0,r.extendErrors)(m)},()=>m.error())}function u({schemaEnv:m},y){if(y.async&&!m.$async)throw new Error("async keyword in sync schema")}function f(m,y,S){if(S===void 0)throw new Error(`keyword "${y}" failed to compile`);return m.scopeValue("keyword",typeof S=="function"?{ref:S}:{ref:S,code:(0,t.stringify)(S)})}function h(m,y,S=!1){return!y.length||y.some(E=>E==="array"?Array.isArray(m):E==="object"?m&&typeof m=="object"&&!Array.isArray(m):typeof m==E||S&&typeof m>"u")}Ni.validSchemaType=h;function p({schema:m,opts:y,self:S,errSchemaPath:E},g,v){if(Array.isArray(g.keyword)?!g.keyword.includes(v):g.keyword!==v)throw new Error("ajv implementation error");const x=g.dependencies;if(x?.some(w=>!Object.prototype.hasOwnProperty.call(m,w)))throw new Error(`parent schema must have dependencies of ${v}: ${x.join(",")}`);if(g.validateSchema&&!g.validateSchema(m[v])){const C=`keyword "${v}" value is invalid at path "${E}": `+S.errorsText(g.validateSchema.errors);if(y.validateSchema==="log")S.logger.error(C);else throw new Error(C)}}return Ni.validateKeywordUsage=p,Ni}var vs={},tE;function z$(){if(tE)return vs;tE=1,Object.defineProperty(vs,"__esModule",{value:!0}),vs.extendSubschemaMode=vs.extendSubschemaData=vs.getSubschema=void 0;const t=Lt(),e=Wt();function n(a,{keyword:l,schemaProp:c,schema:u,schemaPath:f,errSchemaPath:h,topSchemaRef:p}){if(l!==void 0&&u!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(l!==void 0){const m=a.schema[l];return c===void 0?{schema:m,schemaPath:(0,t._)`${a.schemaPath}${(0,t.getProperty)(l)}`,errSchemaPath:`${a.errSchemaPath}/${l}`}:{schema:m[c],schemaPath:(0,t._)`${a.schemaPath}${(0,t.getProperty)(l)}${(0,t.getProperty)(c)}`,errSchemaPath:`${a.errSchemaPath}/${l}/${(0,e.escapeFragment)(c)}`}}if(u!==void 0){if(f===void 0||h===void 0||p===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:u,schemaPath:f,topSchemaRef:p,errSchemaPath:h}}throw new Error('either "keyword" or "schema" must be passed')}vs.getSubschema=n;function r(a,l,{dataProp:c,dataPropType:u,data:f,dataTypes:h,propertyName:p}){if(f!==void 0&&c!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:m}=l;if(c!==void 0){const{errorPath:S,dataPathArr:E,opts:g}=l,v=m.let("data",(0,t._)`${l.data}${(0,t.getProperty)(c)}`,!0);y(v),a.errorPath=(0,t.str)`${S}${(0,e.getErrorPath)(c,u,g.jsPropertySyntax)}`,a.parentDataProperty=(0,t._)`${c}`,a.dataPathArr=[...E,a.parentDataProperty]}if(f!==void 0){const S=f instanceof t.Name?f:m.let("data",f,!0);y(S),p!==void 0&&(a.propertyName=p)}h&&(a.dataTypes=h);function y(S){a.data=S,a.dataLevel=l.dataLevel+1,a.dataTypes=[],l.definedProperties=new Set,a.parentData=l.data,a.dataNames=[...l.dataNames,S]}}vs.extendSubschemaData=r;function i(a,{jtdDiscriminator:l,jtdMetadata:c,compositeRule:u,createErrors:f,allErrors:h}){u!==void 0&&(a.compositeRule=u),f!==void 0&&(a.createErrors=f),h!==void 0&&(a.allErrors=h),a.jtdDiscriminator=l,a.jtdMetadata=c}return vs.extendSubschemaMode=i,vs}var br={},Fg,nE;function EA(){return nE||(nE=1,Fg=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(a=Object.keys(e),r=a.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;i--!==0;){var l=a[i];if(!t(e[l],n[l]))return!1}return!0}return e!==e&&n!==n}),Fg}var zg={exports:{}},rE;function $$(){if(rE)return zg.exports;rE=1;var t=zg.exports=function(r,i,a){typeof i=="function"&&(a=i,i={}),a=i.cb||a;var l=typeof a=="function"?a:a.pre||function(){},c=a.post||function(){};e(i,l,c,r,"",r)};t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},t.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},t.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function e(r,i,a,l,c,u,f,h,p,m){if(l&&typeof l=="object"&&!Array.isArray(l)){i(l,c,u,f,h,p,m);for(var y in l){var S=l[y];if(Array.isArray(S)){if(y in t.arrayKeywords)for(var E=0;E<S.length;E++)e(r,i,a,S[E],c+"/"+y+"/"+E,u,c,y,l,E)}else if(y in t.propsKeywords){if(S&&typeof S=="object")for(var g in S)e(r,i,a,S[g],c+"/"+y+"/"+n(g),u,c,y,l,g)}else(y in t.keywords||r.allKeys&&!(y in t.skipKeywords))&&e(r,i,a,S,c+"/"+y,u,c,y,l)}a(l,c,u,f,h,p,m)}}function n(r){return r.replace(/~/g,"~0").replace(/\//g,"~1")}return zg.exports}var iE;function Ap(){if(iE)return br;iE=1,Object.defineProperty(br,"__esModule",{value:!0}),br.getSchemaRefs=br.resolveUrl=br.normalizeId=br._getFullPath=br.getFullPath=br.inlineRef=void 0;const t=Wt(),e=EA(),n=$$(),r=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function i(E,g=!0){return typeof E=="boolean"?!0:g===!0?!l(E):g?c(E)<=g:!1}br.inlineRef=i;const a=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function l(E){for(const g in E){if(a.has(g))return!0;const v=E[g];if(Array.isArray(v)&&v.some(l)||typeof v=="object"&&l(v))return!0}return!1}function c(E){let g=0;for(const v in E){if(v==="$ref")return 1/0;if(g++,!r.has(v)&&(typeof E[v]=="object"&&(0,t.eachItem)(E[v],x=>g+=c(x)),g===1/0))return 1/0}return g}function u(E,g="",v){v!==!1&&(g=p(g));const x=E.parse(g);return f(E,x)}br.getFullPath=u;function f(E,g){return E.serialize(g).split("#")[0]+"#"}br._getFullPath=f;const h=/#\/?$/;function p(E){return E?E.replace(h,""):""}br.normalizeId=p;function m(E,g,v){return v=p(v),E.resolve(g,v)}br.resolveUrl=m;const y=/^[a-z_][-a-z0-9._]*$/i;function S(E,g){if(typeof E=="boolean")return{};const{schemaId:v,uriResolver:x}=this.opts,w=p(E[v]||g),C={"":w},T=u(x,w,!1),M={},A=new Set;return n(E,{allKeys:!0},(O,W,J,ae)=>{if(ae===void 0)return;const Z=T+W;let ie=C[ae];typeof O[v]=="string"&&(ie=de.call(this,O[v])),pe.call(this,O.$anchor),pe.call(this,O.$dynamicAnchor),C[W]=ie;function de(K){const ne=this.opts.uriResolver.resolve;if(K=p(ie?ne(ie,K):K),A.has(K))throw I(K);A.add(K);let j=this.refs[K];return typeof j=="string"&&(j=this.refs[j]),typeof j=="object"?F(O,j.schema,K):K!==p(Z)&&(K[0]==="#"?(F(O,M[K],K),M[K]=O):this.refs[K]=Z),K}function pe(K){if(typeof K=="string"){if(!y.test(K))throw new Error(`invalid anchor "${K}"`);de.call(this,`#${K}`)}}}),M;function F(O,W,J){if(W!==void 0&&!e(O,W))throw I(J)}function I(O){return new Error(`reference "${O}" resolves to more than one schema`)}}return br.getSchemaRefs=S,br}var sE;function Pp(){if(sE)return gs;sE=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.getData=gs.KeywordCxt=gs.validateFunctionCode=void 0;const t=D$(),e=Hh(),n=xA(),r=Hh(),i=U$(),a=F$(),l=z$(),c=Lt(),u=ba(),f=Ap(),h=Wt(),p=Cp();function m(X){if(T(X)&&(A(X),C(X))){g(X);return}y(X,()=>(0,t.topBoolOrEmptySchema)(X))}gs.validateFunctionCode=m;function y({gen:X,validateName:z,schema:ve,schemaEnv:he,opts:be},Re){be.code.es5?X.func(z,(0,c._)`${u.default.data}, ${u.default.valCxt}`,he.$async,()=>{X.code((0,c._)`"use strict"; ${x(ve,be)}`),E(X,be),X.code(Re)}):X.func(z,(0,c._)`${u.default.data}, ${S(be)}`,he.$async,()=>X.code(x(ve,be)).code(Re))}function S(X){return(0,c._)`{${u.default.instancePath}="", ${u.default.parentData}, ${u.default.parentDataProperty}, ${u.default.rootData}=${u.default.data}${X.dynamicRef?(0,c._)`, ${u.default.dynamicAnchors}={}`:c.nil}}={}`}function E(X,z){X.if(u.default.valCxt,()=>{X.var(u.default.instancePath,(0,c._)`${u.default.valCxt}.${u.default.instancePath}`),X.var(u.default.parentData,(0,c._)`${u.default.valCxt}.${u.default.parentData}`),X.var(u.default.parentDataProperty,(0,c._)`${u.default.valCxt}.${u.default.parentDataProperty}`),X.var(u.default.rootData,(0,c._)`${u.default.valCxt}.${u.default.rootData}`),z.dynamicRef&&X.var(u.default.dynamicAnchors,(0,c._)`${u.default.valCxt}.${u.default.dynamicAnchors}`)},()=>{X.var(u.default.instancePath,(0,c._)`""`),X.var(u.default.parentData,(0,c._)`undefined`),X.var(u.default.parentDataProperty,(0,c._)`undefined`),X.var(u.default.rootData,u.default.data),z.dynamicRef&&X.var(u.default.dynamicAnchors,(0,c._)`{}`)})}function g(X){const{schema:z,opts:ve,gen:he}=X;y(X,()=>{ve.$comment&&z.$comment&&ae(X),O(X),he.let(u.default.vErrors,null),he.let(u.default.errors,0),ve.unevaluated&&v(X),F(X),Z(X)})}function v(X){const{gen:z,validateName:ve}=X;X.evaluated=z.const("evaluated",(0,c._)`${ve}.evaluated`),z.if((0,c._)`${X.evaluated}.dynamicProps`,()=>z.assign((0,c._)`${X.evaluated}.props`,(0,c._)`undefined`)),z.if((0,c._)`${X.evaluated}.dynamicItems`,()=>z.assign((0,c._)`${X.evaluated}.items`,(0,c._)`undefined`))}function x(X,z){const ve=typeof X=="object"&&X[z.schemaId];return ve&&(z.code.source||z.code.process)?(0,c._)`/*# sourceURL=${ve} */`:c.nil}function w(X,z){if(T(X)&&(A(X),C(X))){M(X,z);return}(0,t.boolOrEmptySchema)(X,z)}function C({schema:X,self:z}){if(typeof X=="boolean")return!X;for(const ve in X)if(z.RULES.all[ve])return!0;return!1}function T(X){return typeof X.schema!="boolean"}function M(X,z){const{schema:ve,gen:he,opts:be}=X;be.$comment&&ve.$comment&&ae(X),W(X),J(X);const Re=he.const("_errs",u.default.errors);F(X,Re),he.var(z,(0,c._)`${Re} === ${u.default.errors}`)}function A(X){(0,h.checkUnknownRules)(X),I(X)}function F(X,z){if(X.opts.jtd)return de(X,[],!1,z);const ve=(0,e.getSchemaTypes)(X.schema),he=(0,e.coerceAndCheckDataType)(X,ve);de(X,ve,!he,z)}function I(X){const{schema:z,errSchemaPath:ve,opts:he,self:be}=X;z.$ref&&he.ignoreKeywordsWithRef&&(0,h.schemaHasRulesButRef)(z,be.RULES)&&be.logger.warn(`$ref: keywords ignored in schema at path "${ve}"`)}function O(X){const{schema:z,opts:ve}=X;z.default!==void 0&&ve.useDefaults&&ve.strictSchema&&(0,h.checkStrictMode)(X,"default is ignored in the schema root")}function W(X){const z=X.schema[X.opts.schemaId];z&&(X.baseId=(0,f.resolveUrl)(X.opts.uriResolver,X.baseId,z))}function J(X){if(X.schema.$async&&!X.schemaEnv.$async)throw new Error("async schema in sync schema")}function ae({gen:X,schemaEnv:z,schema:ve,errSchemaPath:he,opts:be}){const Re=ve.$comment;if(be.$comment===!0)X.code((0,c._)`${u.default.self}.logger.log(${Re})`);else if(typeof be.$comment=="function"){const gt=(0,c.str)`${he}/$comment`,at=X.scopeValue("root",{ref:z.root});X.code((0,c._)`${u.default.self}.opts.$comment(${Re}, ${gt}, ${at}.schema)`)}}function Z(X){const{gen:z,schemaEnv:ve,validateName:he,ValidationError:be,opts:Re}=X;ve.$async?z.if((0,c._)`${u.default.errors} === 0`,()=>z.return(u.default.data),()=>z.throw((0,c._)`new ${be}(${u.default.vErrors})`)):(z.assign((0,c._)`${he}.errors`,u.default.vErrors),Re.unevaluated&&ie(X),z.return((0,c._)`${u.default.errors} === 0`))}function ie({gen:X,evaluated:z,props:ve,items:he}){ve instanceof c.Name&&X.assign((0,c._)`${z}.props`,ve),he instanceof c.Name&&X.assign((0,c._)`${z}.items`,he)}function de(X,z,ve,he){const{gen:be,schema:Re,data:gt,allErrors:at,opts:$,self:D}=X,{RULES:oe}=D;if(Re.$ref&&($.ignoreKeywordsWithRef||!(0,h.schemaHasRulesButRef)(Re,oe))){be.block(()=>Q(X,"$ref",oe.all.$ref.definition));return}$.jtd||K(X,z),be.block(()=>{for(const Ee of oe.rules)Me(Ee);Me(oe.post)});function Me(Ee){(0,n.shouldUseGroup)(Re,Ee)&&(Ee.type?(be.if((0,r.checkDataType)(Ee.type,gt,$.strictNumbers)),pe(X,Ee),z.length===1&&z[0]===Ee.type&&ve&&(be.else(),(0,r.reportTypeError)(X)),be.endIf()):pe(X,Ee),at||be.if((0,c._)`${u.default.errors} === ${he||0}`))}}function pe(X,z){const{gen:ve,schema:he,opts:{useDefaults:be}}=X;be&&(0,i.assignDefaults)(X,z.type),ve.block(()=>{for(const Re of z.rules)(0,n.shouldUseRule)(he,Re)&&Q(X,Re.keyword,Re.definition,z.type)})}function K(X,z){X.schemaEnv.meta||!X.opts.strictTypes||(ne(X,z),X.opts.allowUnionTypes||j(X,z),N(X,X.dataTypes))}function ne(X,z){if(z.length){if(!X.dataTypes.length){X.dataTypes=z;return}z.forEach(ve=>{U(X.dataTypes,ve)||L(X,`type "${ve}" not allowed by context "${X.dataTypes.join(",")}"`)}),P(X,z)}}function j(X,z){z.length>1&&!(z.length===2&&z.includes("null"))&&L(X,"use allowUnionTypes to allow union type keyword")}function N(X,z){const ve=X.self.RULES.all;for(const he in ve){const be=ve[he];if(typeof be=="object"&&(0,n.shouldUseRule)(X.schema,be)){const{type:Re}=be.definition;Re.length&&!Re.some(gt=>H(z,gt))&&L(X,`missing type "${Re.join(",")}" for keyword "${he}"`)}}}function H(X,z){return X.includes(z)||z==="number"&&X.includes("integer")}function U(X,z){return X.includes(z)||z==="integer"&&X.includes("number")}function P(X,z){const ve=[];for(const he of X.dataTypes)U(z,he)?ve.push(he):z.includes("integer")&&he==="number"&&ve.push("integer");X.dataTypes=ve}function L(X,z){const ve=X.schemaEnv.baseId+X.errSchemaPath;z+=` at "${ve}" (strictTypes)`,(0,h.checkStrictMode)(X,z,X.opts.strictTypes)}class G{constructor(z,ve,he){if((0,a.validateKeywordUsage)(z,ve,he),this.gen=z.gen,this.allErrors=z.allErrors,this.keyword=he,this.data=z.data,this.schema=z.schema[he],this.$data=ve.$data&&z.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,h.schemaRefOrVal)(z,this.schema,he,this.$data),this.schemaType=ve.schemaType,this.parentSchema=z.schema,this.params={},this.it=z,this.def=ve,this.$data)this.schemaCode=z.gen.const("vSchema",Te(this.$data,z));else if(this.schemaCode=this.schemaValue,!(0,a.validSchemaType)(this.schema,ve.schemaType,ve.allowUndefined))throw new Error(`${he} value must be ${JSON.stringify(ve.schemaType)}`);("code"in ve?ve.trackErrors:ve.errors!==!1)&&(this.errsCount=z.gen.const("_errs",u.default.errors))}result(z,ve,he){this.failResult((0,c.not)(z),ve,he)}failResult(z,ve,he){this.gen.if(z),he?he():this.error(),ve?(this.gen.else(),ve(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(z,ve){this.failResult((0,c.not)(z),void 0,ve)}fail(z){if(z===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(z),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(z){if(!this.$data)return this.fail(z);const{schemaCode:ve}=this;this.fail((0,c._)`${ve} !== undefined && (${(0,c.or)(this.invalid$data(),z)})`)}error(z,ve,he){if(ve){this.setParams(ve),this._error(z,he),this.setParams({});return}this._error(z,he)}_error(z,ve){(z?p.reportExtraError:p.reportError)(this,this.def.error,ve)}$dataError(){(0,p.reportError)(this,this.def.$dataError||p.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,p.resetErrorsCount)(this.gen,this.errsCount)}ok(z){this.allErrors||this.gen.if(z)}setParams(z,ve){ve?Object.assign(this.params,z):this.params=z}block$data(z,ve,he=c.nil){this.gen.block(()=>{this.check$data(z,he),ve()})}check$data(z=c.nil,ve=c.nil){if(!this.$data)return;const{gen:he,schemaCode:be,schemaType:Re,def:gt}=this;he.if((0,c.or)((0,c._)`${be} === undefined`,ve)),z!==c.nil&&he.assign(z,!0),(Re.length||gt.validateSchema)&&(he.elseIf(this.invalid$data()),this.$dataError(),z!==c.nil&&he.assign(z,!1)),he.else()}invalid$data(){const{gen:z,schemaCode:ve,schemaType:he,def:be,it:Re}=this;return(0,c.or)(gt(),at());function gt(){if(he.length){if(!(ve instanceof c.Name))throw new Error("ajv implementation error");const $=Array.isArray(he)?he:[he];return(0,c._)`${(0,r.checkDataTypes)($,ve,Re.opts.strictNumbers,r.DataType.Wrong)}`}return c.nil}function at(){if(be.validateSchema){const $=z.scopeValue("validate$data",{ref:be.validateSchema});return(0,c._)`!${$}(${ve})`}return c.nil}}subschema(z,ve){const he=(0,l.getSubschema)(this.it,z);(0,l.extendSubschemaData)(he,this.it,z),(0,l.extendSubschemaMode)(he,z);const be={...this.it,...he,items:void 0,props:void 0};return w(be,ve),be}mergeEvaluated(z,ve){const{it:he,gen:be}=this;he.opts.unevaluated&&(he.props!==!0&&z.props!==void 0&&(he.props=h.mergeEvaluated.props(be,z.props,he.props,ve)),he.items!==!0&&z.items!==void 0&&(he.items=h.mergeEvaluated.items(be,z.items,he.items,ve)))}mergeValidEvaluated(z,ve){const{it:he,gen:be}=this;if(he.opts.unevaluated&&(he.props!==!0||he.items!==!0))return be.if(ve,()=>this.mergeEvaluated(z,c.Name)),!0}}gs.KeywordCxt=G;function Q(X,z,ve,he){const be=new G(X,ve,z);"code"in ve?ve.code(be,he):be.$data&&ve.validate?(0,a.funcKeywordCode)(be,ve):"macro"in ve?(0,a.macroKeywordCode)(be,ve):(ve.compile||ve.validate)&&(0,a.funcKeywordCode)(be,ve)}const le=/^\/(?:[^~]|~0|~1)*$/,xe=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Te(X,{dataLevel:z,dataNames:ve,dataPathArr:he}){let be,Re;if(X==="")return u.default.rootData;if(X[0]==="/"){if(!le.test(X))throw new Error(`Invalid JSON-pointer: ${X}`);be=X,Re=u.default.rootData}else{const D=xe.exec(X);if(!D)throw new Error(`Invalid JSON-pointer: ${X}`);const oe=+D[1];if(be=D[2],be==="#"){if(oe>=z)throw new Error($("property/index",oe));return he[z-oe]}if(oe>z)throw new Error($("data",oe));if(Re=ve[z-oe],!be)return Re}let gt=Re;const at=be.split("/");for(const D of at)D&&(Re=(0,c._)`${Re}${(0,c.getProperty)((0,h.unescapeJsonPointer)(D))}`,gt=(0,c._)`${gt} && ${Re}`);return gt;function $(D,oe){return`Cannot access ${D} ${oe} levels up, current level is ${z}`}}return gs.getData=Te,gs}var rf={},aE;function ky(){if(aE)return rf;aE=1,Object.defineProperty(rf,"__esModule",{value:!0});class t extends Error{constructor(n){super("validation failed"),this.errors=n,this.ajv=this.validation=!0}}return rf.default=t,rf}var sf={},oE;function Ip(){if(oE)return sf;oE=1,Object.defineProperty(sf,"__esModule",{value:!0});const t=Ap();class e extends Error{constructor(r,i,a,l){super(l||`can't resolve reference ${a} from id ${i}`),this.missingRef=(0,t.resolveUrl)(r,i,a),this.missingSchema=(0,t.normalizeId)((0,t.getFullPath)(r,this.missingRef))}}return sf.default=e,sf}var Xr={},lE;function Ly(){if(lE)return Xr;lE=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.resolveSchema=Xr.getCompilingSchema=Xr.resolveRef=Xr.compileSchema=Xr.SchemaEnv=void 0;const t=Lt(),e=ky(),n=ba(),r=Ap(),i=Wt(),a=Pp();class l{constructor(v){var x;this.refs={},this.dynamicAnchors={};let w;typeof v.schema=="object"&&(w=v.schema),this.schema=v.schema,this.schemaId=v.schemaId,this.root=v.root||this,this.baseId=(x=v.baseId)!==null&&x!==void 0?x:(0,r.normalizeId)(w?.[v.schemaId||"$id"]),this.schemaPath=v.schemaPath,this.localRefs=v.localRefs,this.meta=v.meta,this.$async=w?.$async,this.refs={}}}Xr.SchemaEnv=l;function c(g){const v=h.call(this,g);if(v)return v;const x=(0,r.getFullPath)(this.opts.uriResolver,g.root.baseId),{es5:w,lines:C}=this.opts.code,{ownProperties:T}=this.opts,M=new t.CodeGen(this.scope,{es5:w,lines:C,ownProperties:T});let A;g.$async&&(A=M.scopeValue("Error",{ref:e.default,code:(0,t._)`require("ajv/dist/runtime/validation_error").default`}));const F=M.scopeName("validate");g.validateName=F;const I={gen:M,allErrors:this.opts.allErrors,data:n.default.data,parentData:n.default.parentData,parentDataProperty:n.default.parentDataProperty,dataNames:[n.default.data],dataPathArr:[t.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:M.scopeValue("schema",this.opts.code.source===!0?{ref:g.schema,code:(0,t.stringify)(g.schema)}:{ref:g.schema}),validateName:F,ValidationError:A,schema:g.schema,schemaEnv:g,rootId:x,baseId:g.baseId||x,schemaPath:t.nil,errSchemaPath:g.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,t._)`""`,opts:this.opts,self:this};let O;try{this._compilations.add(g),(0,a.validateFunctionCode)(I),M.optimize(this.opts.code.optimize);const W=M.toString();O=`${M.scopeRefs(n.default.scope)}return ${W}`,this.opts.code.process&&(O=this.opts.code.process(O,g));const ae=new Function(`${n.default.self}`,`${n.default.scope}`,O)(this,this.scope.get());if(this.scope.value(F,{ref:ae}),ae.errors=null,ae.schema=g.schema,ae.schemaEnv=g,g.$async&&(ae.$async=!0),this.opts.code.source===!0&&(ae.source={validateName:F,validateCode:W,scopeValues:M._values}),this.opts.unevaluated){const{props:Z,items:ie}=I;ae.evaluated={props:Z instanceof t.Name?void 0:Z,items:ie instanceof t.Name?void 0:ie,dynamicProps:Z instanceof t.Name,dynamicItems:ie instanceof t.Name},ae.source&&(ae.source.evaluated=(0,t.stringify)(ae.evaluated))}return g.validate=ae,g}catch(W){throw delete g.validate,delete g.validateName,O&&this.logger.error("Error compiling schema, function code:",O),W}finally{this._compilations.delete(g)}}Xr.compileSchema=c;function u(g,v,x){var w;x=(0,r.resolveUrl)(this.opts.uriResolver,v,x);const C=g.refs[x];if(C)return C;let T=m.call(this,g,x);if(T===void 0){const M=(w=g.localRefs)===null||w===void 0?void 0:w[x],{schemaId:A}=this.opts;M&&(T=new l({schema:M,schemaId:A,root:g,baseId:v}))}if(T!==void 0)return g.refs[x]=f.call(this,T)}Xr.resolveRef=u;function f(g){return(0,r.inlineRef)(g.schema,this.opts.inlineRefs)?g.schema:g.validate?g:c.call(this,g)}function h(g){for(const v of this._compilations)if(p(v,g))return v}Xr.getCompilingSchema=h;function p(g,v){return g.schema===v.schema&&g.root===v.root&&g.baseId===v.baseId}function m(g,v){let x;for(;typeof(x=this.refs[v])=="string";)v=x;return x||this.schemas[v]||y.call(this,g,v)}function y(g,v){const x=this.opts.uriResolver.parse(v),w=(0,r._getFullPath)(this.opts.uriResolver,x);let C=(0,r.getFullPath)(this.opts.uriResolver,g.baseId,void 0);if(Object.keys(g.schema).length>0&&w===C)return E.call(this,x,g);const T=(0,r.normalizeId)(w),M=this.refs[T]||this.schemas[T];if(typeof M=="string"){const A=y.call(this,g,M);return typeof A?.schema!="object"?void 0:E.call(this,x,A)}if(typeof M?.schema=="object"){if(M.validate||c.call(this,M),T===(0,r.normalizeId)(v)){const{schema:A}=M,{schemaId:F}=this.opts,I=A[F];return I&&(C=(0,r.resolveUrl)(this.opts.uriResolver,C,I)),new l({schema:A,schemaId:F,root:g,baseId:C})}return E.call(this,x,M)}}Xr.resolveSchema=y;const S=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function E(g,{baseId:v,schema:x,root:w}){var C;if(((C=g.fragment)===null||C===void 0?void 0:C[0])!=="/")return;for(const A of g.fragment.slice(1).split("/")){if(typeof x=="boolean")return;const F=x[(0,i.unescapeFragment)(A)];if(F===void 0)return;x=F;const I=typeof x=="object"&&x[this.opts.schemaId];!S.has(A)&&I&&(v=(0,r.resolveUrl)(this.opts.uriResolver,v,I))}let T;if(typeof x!="boolean"&&x.$ref&&!(0,i.schemaHasRulesButRef)(x,this.RULES)){const A=(0,r.resolveUrl)(this.opts.uriResolver,v,x.$ref);T=y.call(this,w,A)}const{schemaId:M}=this.opts;if(T=T||new l({schema:x,schemaId:M,root:w,baseId:v}),T.schema!==T.root.schema)return T}return Xr}const B$="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",V$="Meta-schema for $data reference (JSON AnySchema extension proposal)",j$="object",H$=["$data"],G$={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},W$=!1,q$={$id:B$,description:V$,type:j$,required:H$,properties:G$,additionalProperties:W$};var af={},kc={exports:{}},$g,cE;function bA(){if(cE)return $g;cE=1;const t=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),e=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function n(m){let y="",S=0,E=0;for(E=0;E<m.length;E++)if(S=m[E].charCodeAt(0),S!==48){if(!(S>=48&&S<=57||S>=65&&S<=70||S>=97&&S<=102))return"";y+=m[E];break}for(E+=1;E<m.length;E++){if(S=m[E].charCodeAt(0),!(S>=48&&S<=57||S>=65&&S<=70||S>=97&&S<=102))return"";y+=m[E]}return y}const r=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function i(m){return m.length=0,!0}function a(m,y,S){if(m.length){const E=n(m);if(E!=="")y.push(E);else return S.error=!0,!1;m.length=0}return!0}function l(m){let y=0;const S={error:!1,address:"",zone:""},E=[],g=[];let v=!1,x=!1,w=a;for(let C=0;C<m.length;C++){const T=m[C];if(!(T==="["||T==="]"))if(T===":"){if(v===!0&&(x=!0),!w(g,E,S))break;if(++y>7){S.error=!0;break}C>0&&m[C-1]===":"&&(v=!0),E.push(":");continue}else if(T==="%"){if(!w(g,E,S))break;w=i}else{g.push(T);continue}}return g.length&&(w===i?S.zone=g.join(""):x?E.push(g.join("")):E.push(n(g))),S.address=E.join(""),S}function c(m){if(u(m,":")<2)return{host:m,isIPV6:!1};const y=l(m);if(y.error)return{host:m,isIPV6:!1};{let S=y.address,E=y.address;return y.zone&&(S+="%"+y.zone,E+="%25"+y.zone),{host:S,isIPV6:!0,escapedHost:E}}}function u(m,y){let S=0;for(let E=0;E<m.length;E++)m[E]===y&&S++;return S}function f(m){let y=m;const S=[];let E=-1,g=0;for(;g=y.length;){if(g===1){if(y===".")break;if(y==="/"){S.push("/");break}else{S.push(y);break}}else if(g===2){if(y[0]==="."){if(y[1]===".")break;if(y[1]==="/"){y=y.slice(2);continue}}else if(y[0]==="/"&&(y[1]==="."||y[1]==="/")){S.push("/");break}}else if(g===3&&y==="/.."){S.length!==0&&S.pop(),S.push("/");break}if(y[0]==="."){if(y[1]==="."){if(y[2]==="/"){y=y.slice(3);continue}}else if(y[1]==="/"){y=y.slice(2);continue}}else if(y[0]==="/"&&y[1]==="."){if(y[2]==="/"){y=y.slice(2);continue}else if(y[2]==="."&&y[3]==="/"){y=y.slice(3),S.length!==0&&S.pop();continue}}if((E=y.indexOf("/",1))===-1){S.push(y);break}else S.push(y.slice(0,E)),y=y.slice(E)}return S.join("")}function h(m,y){const S=y!==!0?escape:unescape;return m.scheme!==void 0&&(m.scheme=S(m.scheme)),m.userinfo!==void 0&&(m.userinfo=S(m.userinfo)),m.host!==void 0&&(m.host=S(m.host)),m.path!==void 0&&(m.path=S(m.path)),m.query!==void 0&&(m.query=S(m.query)),m.fragment!==void 0&&(m.fragment=S(m.fragment)),m}function p(m){const y=[];if(m.userinfo!==void 0&&(y.push(m.userinfo),y.push("@")),m.host!==void 0){let S=unescape(m.host);if(!e(S)){const E=c(S);E.isIPV6===!0?S=`[${E.escapedHost}]`:S=m.host}y.push(S)}return(typeof m.port=="number"||typeof m.port=="string")&&(y.push(":"),y.push(String(m.port))),y.length?y.join(""):void 0}return $g={nonSimpleDomain:r,recomposeAuthority:p,normalizeComponentEncoding:h,removeDotSegments:f,isIPv4:e,isUUID:t,normalizeIPv6:c,stringArrayToHexStripped:n},$g}var Bg,uE;function Z$(){if(uE)return Bg;uE=1;const{isUUID:t}=bA(),e=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,n=["http","https","ws","wss","urn","urn:uuid"];function r(T){return n.indexOf(T)!==-1}function i(T){return T.secure===!0?!0:T.secure===!1?!1:T.scheme?T.scheme.length===3&&(T.scheme[0]==="w"||T.scheme[0]==="W")&&(T.scheme[1]==="s"||T.scheme[1]==="S")&&(T.scheme[2]==="s"||T.scheme[2]==="S"):!1}function a(T){return T.host||(T.error=T.error||"HTTP URIs must have a host."),T}function l(T){const M=String(T.scheme).toLowerCase()==="https";return(T.port===(M?443:80)||T.port==="")&&(T.port=void 0),T.path||(T.path="/"),T}function c(T){return T.secure=i(T),T.resourceName=(T.path||"/")+(T.query?"?"+T.query:""),T.path=void 0,T.query=void 0,T}function u(T){if((T.port===(i(T)?443:80)||T.port==="")&&(T.port=void 0),typeof T.secure=="boolean"&&(T.scheme=T.secure?"wss":"ws",T.secure=void 0),T.resourceName){const[M,A]=T.resourceName.split("?");T.path=M&&M!=="/"?M:void 0,T.query=A,T.resourceName=void 0}return T.fragment=void 0,T}function f(T,M){if(!T.path)return T.error="URN can not be parsed",T;const A=T.path.match(e);if(A){const F=M.scheme||T.scheme||"urn";T.nid=A[1].toLowerCase(),T.nss=A[2];const I=`${F}:${M.nid||T.nid}`,O=C(I);T.path=void 0,O&&(T=O.parse(T,M))}else T.error=T.error||"URN can not be parsed.";return T}function h(T,M){if(T.nid===void 0)throw new Error("URN without nid cannot be serialized");const A=M.scheme||T.scheme||"urn",F=T.nid.toLowerCase(),I=`${A}:${M.nid||F}`,O=C(I);O&&(T=O.serialize(T,M));const W=T,J=T.nss;return W.path=`${F||M.nid}:${J}`,M.skipEscape=!0,W}function p(T,M){const A=T;return A.uuid=A.nss,A.nss=void 0,!M.tolerant&&(!A.uuid||!t(A.uuid))&&(A.error=A.error||"UUID is not valid."),A}function m(T){const M=T;return M.nss=(T.uuid||"").toLowerCase(),M}const y={scheme:"http",domainHost:!0,parse:a,serialize:l},S={scheme:"https",domainHost:y.domainHost,parse:a,serialize:l},E={scheme:"ws",domainHost:!0,parse:c,serialize:u},g={scheme:"wss",domainHost:E.domainHost,parse:E.parse,serialize:E.serialize},w={http:y,https:S,ws:E,wss:g,urn:{scheme:"urn",parse:f,serialize:h,skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:p,serialize:m,skipNormalize:!0}};Object.setPrototypeOf(w,null);function C(T){return T&&(w[T]||w[T.toLowerCase()])||void 0}return Bg={wsIsSecure:i,SCHEMES:w,isValidSchemeName:r,getSchemeHandler:C},Bg}var dE;function X$(){if(dE)return kc.exports;dE=1;const{normalizeIPv6:t,removeDotSegments:e,recomposeAuthority:n,normalizeComponentEncoding:r,isIPv4:i,nonSimpleDomain:a}=bA(),{SCHEMES:l,getSchemeHandler:c}=Z$();function u(g,v){return typeof g=="string"?g=m(S(g,v),v):typeof g=="object"&&(g=S(m(g,v),v)),g}function f(g,v,x){const w=x?Object.assign({scheme:"null"},x):{scheme:"null"},C=h(S(g,w),S(v,w),w,!0);return w.skipEscape=!0,m(C,w)}function h(g,v,x,w){const C={};return w||(g=S(m(g,x),x),v=S(m(v,x),x)),x=x||{},!x.tolerant&&v.scheme?(C.scheme=v.scheme,C.userinfo=v.userinfo,C.host=v.host,C.port=v.port,C.path=e(v.path||""),C.query=v.query):(v.userinfo!==void 0||v.host!==void 0||v.port!==void 0?(C.userinfo=v.userinfo,C.host=v.host,C.port=v.port,C.path=e(v.path||""),C.query=v.query):(v.path?(v.path[0]==="/"?C.path=e(v.path):((g.userinfo!==void 0||g.host!==void 0||g.port!==void 0)&&!g.path?C.path="/"+v.path:g.path?C.path=g.path.slice(0,g.path.lastIndexOf("/")+1)+v.path:C.path=v.path,C.path=e(C.path)),C.query=v.query):(C.path=g.path,v.query!==void 0?C.query=v.query:C.query=g.query),C.userinfo=g.userinfo,C.host=g.host,C.port=g.port),C.scheme=g.scheme),C.fragment=v.fragment,C}function p(g,v,x){return typeof g=="string"?(g=unescape(g),g=m(r(S(g,x),!0),{...x,skipEscape:!0})):typeof g=="object"&&(g=m(r(g,!0),{...x,skipEscape:!0})),typeof v=="string"?(v=unescape(v),v=m(r(S(v,x),!0),{...x,skipEscape:!0})):typeof v=="object"&&(v=m(r(v,!0),{...x,skipEscape:!0})),g.toLowerCase()===v.toLowerCase()}function m(g,v){const x={host:g.host,scheme:g.scheme,userinfo:g.userinfo,port:g.port,path:g.path,query:g.query,nid:g.nid,nss:g.nss,uuid:g.uuid,fragment:g.fragment,reference:g.reference,resourceName:g.resourceName,secure:g.secure,error:""},w=Object.assign({},v),C=[],T=c(w.scheme||x.scheme);T&&T.serialize&&T.serialize(x,w),x.path!==void 0&&(w.skipEscape?x.path=unescape(x.path):(x.path=escape(x.path),x.scheme!==void 0&&(x.path=x.path.split("%3A").join(":")))),w.reference!=="suffix"&&x.scheme&&C.push(x.scheme,":");const M=n(x);if(M!==void 0&&(w.reference!=="suffix"&&C.push("//"),C.push(M),x.path&&x.path[0]!=="/"&&C.push("/")),x.path!==void 0){let A=x.path;!w.absolutePath&&(!T||!T.absolutePath)&&(A=e(A)),M===void 0&&A[0]==="/"&&A[1]==="/"&&(A="/%2F"+A.slice(2)),C.push(A)}return x.query!==void 0&&C.push("?",x.query),x.fragment!==void 0&&C.push("#",x.fragment),C.join("")}const y=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function S(g,v){const x=Object.assign({},v),w={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0};let C=!1;x.reference==="suffix"&&(x.scheme?g=x.scheme+":"+g:g="//"+g);const T=g.match(y);if(T){if(w.scheme=T[1],w.userinfo=T[3],w.host=T[4],w.port=parseInt(T[5],10),w.path=T[6]||"",w.query=T[7],w.fragment=T[8],isNaN(w.port)&&(w.port=T[5]),w.host)if(i(w.host)===!1){const F=t(w.host);w.host=F.host.toLowerCase(),C=F.isIPV6}else C=!0;w.scheme===void 0&&w.userinfo===void 0&&w.host===void 0&&w.port===void 0&&w.query===void 0&&!w.path?w.reference="same-document":w.scheme===void 0?w.reference="relative":w.fragment===void 0?w.reference="absolute":w.reference="uri",x.reference&&x.reference!=="suffix"&&x.reference!==w.reference&&(w.error=w.error||"URI is not a "+x.reference+" reference.");const M=c(x.scheme||w.scheme);if(!x.unicodeSupport&&(!M||!M.unicodeSupport)&&w.host&&(x.domainHost||M&&M.domainHost)&&C===!1&&a(w.host))try{w.host=URL.domainToASCII(w.host.toLowerCase())}catch(A){w.error=w.error||"Host's domain name can not be converted to ASCII: "+A}(!M||M&&!M.skipNormalize)&&(g.indexOf("%")!==-1&&(w.scheme!==void 0&&(w.scheme=unescape(w.scheme)),w.host!==void 0&&(w.host=unescape(w.host))),w.path&&(w.path=escape(unescape(w.path))),w.fragment&&(w.fragment=encodeURI(decodeURIComponent(w.fragment)))),M&&M.parse&&M.parse(w,x)}else w.error=w.error||"URI can not be parsed.";return w}const E={SCHEMES:l,normalize:u,resolve:f,resolveComponent:h,equal:p,serialize:m,parse:S};return kc.exports=E,kc.exports.default=E,kc.exports.fastUri=E,kc.exports}var fE;function K$(){if(fE)return af;fE=1,Object.defineProperty(af,"__esModule",{value:!0});const t=X$();return t.code='require("ajv/dist/runtime/uri").default',af.default=t,af}var hE;function Y$(){return hE||(hE=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var e=Pp();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return e.KeywordCxt}});var n=Lt();Object.defineProperty(t,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return n.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return n.CodeGen}});const r=ky(),i=Ip(),a=wA(),l=Ly(),c=Lt(),u=Ap(),f=Hh(),h=Wt(),p=q$,m=K$(),y=(j,N)=>new RegExp(j,N);y.code="new RegExp";const S=["removeAdditional","useDefaults","coerceTypes"],E=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),g={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},v={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},x=200;function w(j){var N,H,U,P,L,G,Q,le,xe,Te,X,z,ve,he,be,Re,gt,at,$,D,oe,Me,Ee,Ie,et;const ze=j.strict,Ze=(N=j.code)===null||N===void 0?void 0:N.optimize,ot=Ze===!0||Ze===void 0?1:Ze||0,St=(U=(H=j.code)===null||H===void 0?void 0:H.regExp)!==null&&U!==void 0?U:y,Ae=(P=j.uriResolver)!==null&&P!==void 0?P:m.default;return{strictSchema:(G=(L=j.strictSchema)!==null&&L!==void 0?L:ze)!==null&&G!==void 0?G:!0,strictNumbers:(le=(Q=j.strictNumbers)!==null&&Q!==void 0?Q:ze)!==null&&le!==void 0?le:!0,strictTypes:(Te=(xe=j.strictTypes)!==null&&xe!==void 0?xe:ze)!==null&&Te!==void 0?Te:"log",strictTuples:(z=(X=j.strictTuples)!==null&&X!==void 0?X:ze)!==null&&z!==void 0?z:"log",strictRequired:(he=(ve=j.strictRequired)!==null&&ve!==void 0?ve:ze)!==null&&he!==void 0?he:!1,code:j.code?{...j.code,optimize:ot,regExp:St}:{optimize:ot,regExp:St},loopRequired:(be=j.loopRequired)!==null&&be!==void 0?be:x,loopEnum:(Re=j.loopEnum)!==null&&Re!==void 0?Re:x,meta:(gt=j.meta)!==null&&gt!==void 0?gt:!0,messages:(at=j.messages)!==null&&at!==void 0?at:!0,inlineRefs:($=j.inlineRefs)!==null&&$!==void 0?$:!0,schemaId:(D=j.schemaId)!==null&&D!==void 0?D:"$id",addUsedSchema:(oe=j.addUsedSchema)!==null&&oe!==void 0?oe:!0,validateSchema:(Me=j.validateSchema)!==null&&Me!==void 0?Me:!0,validateFormats:(Ee=j.validateFormats)!==null&&Ee!==void 0?Ee:!0,unicodeRegExp:(Ie=j.unicodeRegExp)!==null&&Ie!==void 0?Ie:!0,int32range:(et=j.int32range)!==null&&et!==void 0?et:!0,uriResolver:Ae}}class C{constructor(N={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,N=this.opts={...N,...w(N)};const{es5:H,lines:U}=this.opts.code;this.scope=new c.ValueScope({scope:{},prefixes:E,es5:H,lines:U}),this.logger=J(N.logger);const P=N.validateFormats;N.validateFormats=!1,this.RULES=(0,a.getRules)(),T.call(this,g,N,"NOT SUPPORTED"),T.call(this,v,N,"DEPRECATED","warn"),this._metaOpts=O.call(this),N.formats&&F.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),N.keywords&&I.call(this,N.keywords),typeof N.meta=="object"&&this.addMetaSchema(N.meta),A.call(this),N.validateFormats=P}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:N,meta:H,schemaId:U}=this.opts;let P=p;U==="id"&&(P={...p},P.id=P.$id,delete P.$id),H&&N&&this.addMetaSchema(P,P[U],!1)}defaultMeta(){const{meta:N,schemaId:H}=this.opts;return this.opts.defaultMeta=typeof N=="object"?N[H]||N:void 0}validate(N,H){let U;if(typeof N=="string"){if(U=this.getSchema(N),!U)throw new Error(`no schema with key or ref "${N}"`)}else U=this.compile(N);const P=U(H);return"$async"in U||(this.errors=U.errors),P}compile(N,H){const U=this._addSchema(N,H);return U.validate||this._compileSchemaEnv(U)}compileAsync(N,H){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:U}=this.opts;return P.call(this,N,H);async function P(Te,X){await L.call(this,Te.$schema);const z=this._addSchema(Te,X);return z.validate||G.call(this,z)}async function L(Te){Te&&!this.getSchema(Te)&&await P.call(this,{$ref:Te},!0)}async function G(Te){try{return this._compileSchemaEnv(Te)}catch(X){if(!(X instanceof i.default))throw X;return Q.call(this,X),await le.call(this,X.missingSchema),G.call(this,Te)}}function Q({missingSchema:Te,missingRef:X}){if(this.refs[Te])throw new Error(`AnySchema ${Te} is loaded but ${X} cannot be resolved`)}async function le(Te){const X=await xe.call(this,Te);this.refs[Te]||await L.call(this,X.$schema),this.refs[Te]||this.addSchema(X,Te,H)}async function xe(Te){const X=this._loading[Te];if(X)return X;try{return await(this._loading[Te]=U(Te))}finally{delete this._loading[Te]}}}addSchema(N,H,U,P=this.opts.validateSchema){if(Array.isArray(N)){for(const G of N)this.addSchema(G,void 0,U,P);return this}let L;if(typeof N=="object"){const{schemaId:G}=this.opts;if(L=N[G],L!==void 0&&typeof L!="string")throw new Error(`schema ${G} must be string`)}return H=(0,u.normalizeId)(H||L),this._checkUnique(H),this.schemas[H]=this._addSchema(N,U,H,P,!0),this}addMetaSchema(N,H,U=this.opts.validateSchema){return this.addSchema(N,H,!0,U),this}validateSchema(N,H){if(typeof N=="boolean")return!0;let U;if(U=N.$schema,U!==void 0&&typeof U!="string")throw new Error("$schema must be a string");if(U=U||this.opts.defaultMeta||this.defaultMeta(),!U)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const P=this.validate(U,N);if(!P&&H){const L="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(L);else throw new Error(L)}return P}getSchema(N){let H;for(;typeof(H=M.call(this,N))=="string";)N=H;if(H===void 0){const{schemaId:U}=this.opts,P=new l.SchemaEnv({schema:{},schemaId:U});if(H=l.resolveSchema.call(this,P,N),!H)return;this.refs[N]=H}return H.validate||this._compileSchemaEnv(H)}removeSchema(N){if(N instanceof RegExp)return this._removeAllSchemas(this.schemas,N),this._removeAllSchemas(this.refs,N),this;switch(typeof N){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const H=M.call(this,N);return typeof H=="object"&&this._cache.delete(H.schema),delete this.schemas[N],delete this.refs[N],this}case"object":{const H=N;this._cache.delete(H);let U=N[this.opts.schemaId];return U&&(U=(0,u.normalizeId)(U),delete this.schemas[U],delete this.refs[U]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(N){for(const H of N)this.addKeyword(H);return this}addKeyword(N,H){let U;if(typeof N=="string")U=N,typeof H=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),H.keyword=U);else if(typeof N=="object"&&H===void 0){if(H=N,U=H.keyword,Array.isArray(U)&&!U.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(Z.call(this,U,H),!H)return(0,h.eachItem)(U,L=>ie.call(this,L)),this;pe.call(this,H);const P={...H,type:(0,f.getJSONTypes)(H.type),schemaType:(0,f.getJSONTypes)(H.schemaType)};return(0,h.eachItem)(U,P.type.length===0?L=>ie.call(this,L,P):L=>P.type.forEach(G=>ie.call(this,L,P,G))),this}getKeyword(N){const H=this.RULES.all[N];return typeof H=="object"?H.definition:!!H}removeKeyword(N){const{RULES:H}=this;delete H.keywords[N],delete H.all[N];for(const U of H.rules){const P=U.rules.findIndex(L=>L.keyword===N);P>=0&&U.rules.splice(P,1)}return this}addFormat(N,H){return typeof H=="string"&&(H=new RegExp(H)),this.formats[N]=H,this}errorsText(N=this.errors,{separator:H=", ",dataVar:U="data"}={}){return!N||N.length===0?"No errors":N.map(P=>`${U}${P.instancePath} ${P.message}`).reduce((P,L)=>P+H+L)}$dataMetaSchema(N,H){const U=this.RULES.all;N=JSON.parse(JSON.stringify(N));for(const P of H){const L=P.split("/").slice(1);let G=N;for(const Q of L)G=G[Q];for(const Q in U){const le=U[Q];if(typeof le!="object")continue;const{$data:xe}=le.definition,Te=G[Q];xe&&Te&&(G[Q]=ne(Te))}}return N}_removeAllSchemas(N,H){for(const U in N){const P=N[U];(!H||H.test(U))&&(typeof P=="string"?delete N[U]:P&&!P.meta&&(this._cache.delete(P.schema),delete N[U]))}}_addSchema(N,H,U,P=this.opts.validateSchema,L=this.opts.addUsedSchema){let G;const{schemaId:Q}=this.opts;if(typeof N=="object")G=N[Q];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof N!="boolean")throw new Error("schema must be object or boolean")}let le=this._cache.get(N);if(le!==void 0)return le;U=(0,u.normalizeId)(G||U);const xe=u.getSchemaRefs.call(this,N,U);return le=new l.SchemaEnv({schema:N,schemaId:Q,meta:H,baseId:U,localRefs:xe}),this._cache.set(le.schema,le),L&&!U.startsWith("#")&&(U&&this._checkUnique(U),this.refs[U]=le),P&&this.validateSchema(N,!0),le}_checkUnique(N){if(this.schemas[N]||this.refs[N])throw new Error(`schema with key or id "${N}" already exists`)}_compileSchemaEnv(N){if(N.meta?this._compileMetaSchema(N):l.compileSchema.call(this,N),!N.validate)throw new Error("ajv implementation error");return N.validate}_compileMetaSchema(N){const H=this.opts;this.opts=this._metaOpts;try{l.compileSchema.call(this,N)}finally{this.opts=H}}}C.ValidationError=r.default,C.MissingRefError=i.default,t.default=C;function T(j,N,H,U="error"){for(const P in j){const L=P;L in N&&this.logger[U](`${H}: option ${P}. ${j[L]}`)}}function M(j){return j=(0,u.normalizeId)(j),this.schemas[j]||this.refs[j]}function A(){const j=this.opts.schemas;if(j)if(Array.isArray(j))this.addSchema(j);else for(const N in j)this.addSchema(j[N],N)}function F(){for(const j in this.opts.formats){const N=this.opts.formats[j];N&&this.addFormat(j,N)}}function I(j){if(Array.isArray(j)){this.addVocabulary(j);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const N in j){const H=j[N];H.keyword||(H.keyword=N),this.addKeyword(H)}}function O(){const j={...this.opts};for(const N of S)delete j[N];return j}const W={log(){},warn(){},error(){}};function J(j){if(j===!1)return W;if(j===void 0)return console;if(j.log&&j.warn&&j.error)return j;throw new Error("logger must implement log, warn and error methods")}const ae=/^[a-z_$][a-z0-9_$:-]*$/i;function Z(j,N){const{RULES:H}=this;if((0,h.eachItem)(j,U=>{if(H.keywords[U])throw new Error(`Keyword ${U} is already defined`);if(!ae.test(U))throw new Error(`Keyword ${U} has invalid name`)}),!!N&&N.$data&&!("code"in N||"validate"in N))throw new Error('$data keyword must have "code" or "validate" function')}function ie(j,N,H){var U;const P=N?.post;if(H&&P)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:L}=this;let G=P?L.post:L.rules.find(({type:le})=>le===H);if(G||(G={type:H,rules:[]},L.rules.push(G)),L.keywords[j]=!0,!N)return;const Q={keyword:j,definition:{...N,type:(0,f.getJSONTypes)(N.type),schemaType:(0,f.getJSONTypes)(N.schemaType)}};N.before?de.call(this,G,Q,N.before):G.rules.push(Q),L.all[j]=Q,(U=N.implements)===null||U===void 0||U.forEach(le=>this.addKeyword(le))}function de(j,N,H){const U=j.rules.findIndex(P=>P.keyword===H);U>=0?j.rules.splice(U,0,N):(j.rules.push(N),this.logger.warn(`rule ${H} is not defined`))}function pe(j){let{metaSchema:N}=j;N!==void 0&&(j.$data&&this.opts.$data&&(N=ne(N)),j.validateSchema=this.compile(N,!0))}const K={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function ne(j){return{anyOf:[j,K]}}})(kg)),kg}var of={},lf={},cf={},pE;function J$(){if(pE)return cf;pE=1,Object.defineProperty(cf,"__esModule",{value:!0});const t={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};return cf.default=t,cf}var ia={},mE;function Q$(){if(mE)return ia;mE=1,Object.defineProperty(ia,"__esModule",{value:!0}),ia.callRef=ia.getValidate=void 0;const t=Ip(),e=Gi(),n=Lt(),r=ba(),i=Ly(),a=Wt(),l={keyword:"$ref",schemaType:"string",code(f){const{gen:h,schema:p,it:m}=f,{baseId:y,schemaEnv:S,validateName:E,opts:g,self:v}=m,{root:x}=S;if((p==="#"||p==="#/")&&y===x.baseId)return C();const w=i.resolveRef.call(v,x,y,p);if(w===void 0)throw new t.default(m.opts.uriResolver,y,p);if(w instanceof i.SchemaEnv)return T(w);return M(w);function C(){if(S===x)return u(f,E,S,S.$async);const A=h.scopeValue("root",{ref:x});return u(f,(0,n._)`${A}.validate`,x,x.$async)}function T(A){const F=c(f,A);u(f,F,A,A.$async)}function M(A){const F=h.scopeValue("schema",g.code.source===!0?{ref:A,code:(0,n.stringify)(A)}:{ref:A}),I=h.name("valid"),O=f.subschema({schema:A,dataTypes:[],schemaPath:n.nil,topSchemaRef:F,errSchemaPath:p},I);f.mergeEvaluated(O),f.ok(I)}}};function c(f,h){const{gen:p}=f;return h.validate?p.scopeValue("validate",{ref:h.validate}):(0,n._)`${p.scopeValue("wrapper",{ref:h})}.validate`}ia.getValidate=c;function u(f,h,p,m){const{gen:y,it:S}=f,{allErrors:E,schemaEnv:g,opts:v}=S,x=v.passContext?r.default.this:n.nil;m?w():C();function w(){if(!g.$async)throw new Error("async schema referenced by sync schema");const A=y.let("valid");y.try(()=>{y.code((0,n._)`await ${(0,e.callValidateCode)(f,h,x)}`),M(h),E||y.assign(A,!0)},F=>{y.if((0,n._)`!(${F} instanceof ${S.ValidationError})`,()=>y.throw(F)),T(F),E||y.assign(A,!1)}),f.ok(A)}function C(){f.result((0,e.callValidateCode)(f,h,x),()=>M(h),()=>T(h))}function T(A){const F=(0,n._)`${A}.errors`;y.assign(r.default.vErrors,(0,n._)`${r.default.vErrors} === null ? ${F} : ${r.default.vErrors}.concat(${F})`),y.assign(r.default.errors,(0,n._)`${r.default.vErrors}.length`)}function M(A){var F;if(!S.opts.unevaluated)return;const I=(F=p?.validate)===null||F===void 0?void 0:F.evaluated;if(S.props!==!0)if(I&&!I.dynamicProps)I.props!==void 0&&(S.props=a.mergeEvaluated.props(y,I.props,S.props));else{const O=y.var("props",(0,n._)`${A}.evaluated.props`);S.props=a.mergeEvaluated.props(y,O,S.props,n.Name)}if(S.items!==!0)if(I&&!I.dynamicItems)I.items!==void 0&&(S.items=a.mergeEvaluated.items(y,I.items,S.items));else{const O=y.var("items",(0,n._)`${A}.evaluated.items`);S.items=a.mergeEvaluated.items(y,O,S.items,n.Name)}}}return ia.callRef=u,ia.default=l,ia}var gE;function e4(){if(gE)return lf;gE=1,Object.defineProperty(lf,"__esModule",{value:!0});const t=J$(),e=Q$(),n=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",t.default,e.default];return lf.default=n,lf}var uf={},df={},_E;function t4(){if(_E)return df;_E=1,Object.defineProperty(df,"__esModule",{value:!0});const t=Lt(),e=t.operators,n={maximum:{okStr:"<=",ok:e.LTE,fail:e.GT},minimum:{okStr:">=",ok:e.GTE,fail:e.LT},exclusiveMaximum:{okStr:"<",ok:e.LT,fail:e.GTE},exclusiveMinimum:{okStr:">",ok:e.GT,fail:e.LTE}},r={message:({keyword:a,schemaCode:l})=>(0,t.str)`must be ${n[a].okStr} ${l}`,params:({keyword:a,schemaCode:l})=>(0,t._)`{comparison: ${n[a].okStr}, limit: ${l}}`},i={keyword:Object.keys(n),type:"number",schemaType:"number",$data:!0,error:r,code(a){const{keyword:l,data:c,schemaCode:u}=a;a.fail$data((0,t._)`${c} ${n[l].fail} ${u} || isNaN(${c})`)}};return df.default=i,df}var ff={},vE;function n4(){if(vE)return ff;vE=1,Object.defineProperty(ff,"__esModule",{value:!0});const t=Lt(),n={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:r})=>(0,t.str)`must be multiple of ${r}`,params:({schemaCode:r})=>(0,t._)`{multipleOf: ${r}}`},code(r){const{gen:i,data:a,schemaCode:l,it:c}=r,u=c.opts.multipleOfPrecision,f=i.let("res"),h=u?(0,t._)`Math.abs(Math.round(${f}) - ${f}) > 1e-${u}`:(0,t._)`${f} !== parseInt(${f})`;r.fail$data((0,t._)`(${l} === 0 || (${f} = ${a}/${l}, ${h}))`)}};return ff.default=n,ff}var hf={},pf={},yE;function r4(){if(yE)return pf;yE=1,Object.defineProperty(pf,"__esModule",{value:!0});function t(e){const n=e.length;let r=0,i=0,a;for(;i<n;)r++,a=e.charCodeAt(i++),a>=55296&&a<=56319&&i<n&&(a=e.charCodeAt(i),(a&64512)===56320&&i++);return r}return pf.default=t,t.code='require("ajv/dist/runtime/ucs2length").default',pf}var SE;function i4(){if(SE)return hf;SE=1,Object.defineProperty(hf,"__esModule",{value:!0});const t=Lt(),e=Wt(),n=r4(),i={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:a,schemaCode:l}){const c=a==="maxLength"?"more":"fewer";return(0,t.str)`must NOT have ${c} than ${l} characters`},params:({schemaCode:a})=>(0,t._)`{limit: ${a}}`},code(a){const{keyword:l,data:c,schemaCode:u,it:f}=a,h=l==="maxLength"?t.operators.GT:t.operators.LT,p=f.opts.unicode===!1?(0,t._)`${c}.length`:(0,t._)`${(0,e.useFunc)(a.gen,n.default)}(${c})`;a.fail$data((0,t._)`${p} ${h} ${u}`)}};return hf.default=i,hf}var mf={},wE;function s4(){if(wE)return mf;wE=1,Object.defineProperty(mf,"__esModule",{value:!0});const t=Gi(),e=Lt(),r={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:i})=>(0,e.str)`must match pattern "${i}"`,params:({schemaCode:i})=>(0,e._)`{pattern: ${i}}`},code(i){const{data:a,$data:l,schema:c,schemaCode:u,it:f}=i,h=f.opts.unicodeRegExp?"u":"",p=l?(0,e._)`(new RegExp(${u}, ${h}))`:(0,t.usePattern)(i,c);i.fail$data((0,e._)`!${p}.test(${a})`)}};return mf.default=r,mf}var gf={},xE;function a4(){if(xE)return gf;xE=1,Object.defineProperty(gf,"__esModule",{value:!0});const t=Lt(),n={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:r,schemaCode:i}){const a=r==="maxProperties"?"more":"fewer";return(0,t.str)`must NOT have ${a} than ${i} properties`},params:({schemaCode:r})=>(0,t._)`{limit: ${r}}`},code(r){const{keyword:i,data:a,schemaCode:l}=r,c=i==="maxProperties"?t.operators.GT:t.operators.LT;r.fail$data((0,t._)`Object.keys(${a}).length ${c} ${l}`)}};return gf.default=n,gf}var _f={},EE;function o4(){if(EE)return _f;EE=1,Object.defineProperty(_f,"__esModule",{value:!0});const t=Gi(),e=Lt(),n=Wt(),i={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:a}})=>(0,e.str)`must have required property '${a}'`,params:({params:{missingProperty:a}})=>(0,e._)`{missingProperty: ${a}}`},code(a){const{gen:l,schema:c,schemaCode:u,data:f,$data:h,it:p}=a,{opts:m}=p;if(!h&&c.length===0)return;const y=c.length>=m.loopRequired;if(p.allErrors?S():E(),m.strictRequired){const x=a.parentSchema.properties,{definedProperties:w}=a.it;for(const C of c)if(x?.[C]===void 0&&!w.has(C)){const T=p.schemaEnv.baseId+p.errSchemaPath,M=`required property "${C}" is not defined at "${T}" (strictRequired)`;(0,n.checkStrictMode)(p,M,p.opts.strictRequired)}}function S(){if(y||h)a.block$data(e.nil,g);else for(const x of c)(0,t.checkReportMissingProp)(a,x)}function E(){const x=l.let("missing");if(y||h){const w=l.let("valid",!0);a.block$data(w,()=>v(x,w)),a.ok(w)}else l.if((0,t.checkMissingProp)(a,c,x)),(0,t.reportMissingProp)(a,x),l.else()}function g(){l.forOf("prop",u,x=>{a.setParams({missingProperty:x}),l.if((0,t.noPropertyInData)(l,f,x,m.ownProperties),()=>a.error())})}function v(x,w){a.setParams({missingProperty:x}),l.forOf(x,u,()=>{l.assign(w,(0,t.propertyInData)(l,f,x,m.ownProperties)),l.if((0,e.not)(w),()=>{a.error(),l.break()})},e.nil)}}};return _f.default=i,_f}var vf={},bE;function l4(){if(bE)return vf;bE=1,Object.defineProperty(vf,"__esModule",{value:!0});const t=Lt(),n={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:r,schemaCode:i}){const a=r==="maxItems"?"more":"fewer";return(0,t.str)`must NOT have ${a} than ${i} items`},params:({schemaCode:r})=>(0,t._)`{limit: ${r}}`},code(r){const{keyword:i,data:a,schemaCode:l}=r,c=i==="maxItems"?t.operators.GT:t.operators.LT;r.fail$data((0,t._)`${a}.length ${c} ${l}`)}};return vf.default=n,vf}var yf={},Sf={},TE;function Oy(){if(TE)return Sf;TE=1,Object.defineProperty(Sf,"__esModule",{value:!0});const t=EA();return t.code='require("ajv/dist/runtime/equal").default',Sf.default=t,Sf}var ME;function c4(){if(ME)return yf;ME=1,Object.defineProperty(yf,"__esModule",{value:!0});const t=Hh(),e=Lt(),n=Wt(),r=Oy(),a={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:l,j:c}})=>(0,e.str)`must NOT have duplicate items (items ## ${c} and ${l} are identical)`,params:({params:{i:l,j:c}})=>(0,e._)`{i: ${l}, j: ${c}}`},code(l){const{gen:c,data:u,$data:f,schema:h,parentSchema:p,schemaCode:m,it:y}=l;if(!f&&!h)return;const S=c.let("valid"),E=p.items?(0,t.getSchemaTypes)(p.items):[];l.block$data(S,g,(0,e._)`${m} === false`),l.ok(S);function g(){const C=c.let("i",(0,e._)`${u}.length`),T=c.let("j");l.setParams({i:C,j:T}),c.assign(S,!0),c.if((0,e._)`${C} > 1`,()=>(v()?x:w)(C,T))}function v(){return E.length>0&&!E.some(C=>C==="object"||C==="array")}function x(C,T){const M=c.name("item"),A=(0,t.checkDataTypes)(E,M,y.opts.strictNumbers,t.DataType.Wrong),F=c.const("indices",(0,e._)`{}`);c.for((0,e._)`;${C}--;`,()=>{c.let(M,(0,e._)`${u}[${C}]`),c.if(A,(0,e._)`continue`),E.length>1&&c.if((0,e._)`typeof ${M} == "string"`,(0,e._)`${M} += "_"`),c.if((0,e._)`typeof ${F}[${M}] == "number"`,()=>{c.assign(T,(0,e._)`${F}[${M}]`),l.error(),c.assign(S,!1).break()}).code((0,e._)`${F}[${M}] = ${C}`)})}function w(C,T){const M=(0,n.useFunc)(c,r.default),A=c.name("outer");c.label(A).for((0,e._)`;${C}--;`,()=>c.for((0,e._)`${T} = ${C}; ${T}--;`,()=>c.if((0,e._)`${M}(${u}[${C}], ${u}[${T}])`,()=>{l.error(),c.assign(S,!1).break(A)})))}}};return yf.default=a,yf}var wf={},RE;function u4(){if(RE)return wf;RE=1,Object.defineProperty(wf,"__esModule",{value:!0});const t=Lt(),e=Wt(),n=Oy(),i={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:a})=>(0,t._)`{allowedValue: ${a}}`},code(a){const{gen:l,data:c,$data:u,schemaCode:f,schema:h}=a;u||h&&typeof h=="object"?a.fail$data((0,t._)`!${(0,e.useFunc)(l,n.default)}(${c}, ${f})`):a.fail((0,t._)`${h} !== ${c}`)}};return wf.default=i,wf}var xf={},CE;function d4(){if(CE)return xf;CE=1,Object.defineProperty(xf,"__esModule",{value:!0});const t=Lt(),e=Wt(),n=Oy(),i={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:a})=>(0,t._)`{allowedValues: ${a}}`},code(a){const{gen:l,data:c,$data:u,schema:f,schemaCode:h,it:p}=a;if(!u&&f.length===0)throw new Error("enum must have non-empty array");const m=f.length>=p.opts.loopEnum;let y;const S=()=>y??(y=(0,e.useFunc)(l,n.default));let E;if(m||u)E=l.let("valid"),a.block$data(E,g);else{if(!Array.isArray(f))throw new Error("ajv implementation error");const x=l.const("vSchema",h);E=(0,t.or)(...f.map((w,C)=>v(x,C)))}a.pass(E);function g(){l.assign(E,!1),l.forOf("v",h,x=>l.if((0,t._)`${S()}(${c}, ${x})`,()=>l.assign(E,!0).break()))}function v(x,w){const C=f[w];return typeof C=="object"&&C!==null?(0,t._)`${S()}(${c}, ${x}[${w}])`:(0,t._)`${c} === ${C}`}}};return xf.default=i,xf}var AE;function f4(){if(AE)return uf;AE=1,Object.defineProperty(uf,"__esModule",{value:!0});const t=t4(),e=n4(),n=i4(),r=s4(),i=a4(),a=o4(),l=l4(),c=c4(),u=u4(),f=d4(),h=[t.default,e.default,n.default,r.default,i.default,a.default,l.default,c.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},u.default,f.default];return uf.default=h,uf}var Ef={},Go={},PE;function TA(){if(PE)return Go;PE=1,Object.defineProperty(Go,"__esModule",{value:!0}),Go.validateAdditionalItems=void 0;const t=Lt(),e=Wt(),r={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:a}})=>(0,t.str)`must NOT have more than ${a} items`,params:({params:{len:a}})=>(0,t._)`{limit: ${a}}`},code(a){const{parentSchema:l,it:c}=a,{items:u}=l;if(!Array.isArray(u)){(0,e.checkStrictMode)(c,'"additionalItems" is ignored when "items" is not an array of schemas');return}i(a,u)}};function i(a,l){const{gen:c,schema:u,data:f,keyword:h,it:p}=a;p.items=!0;const m=c.const("len",(0,t._)`${f}.length`);if(u===!1)a.setParams({len:l.length}),a.pass((0,t._)`${m} <= ${l.length}`);else if(typeof u=="object"&&!(0,e.alwaysValidSchema)(p,u)){const S=c.var("valid",(0,t._)`${m} <= ${l.length}`);c.if((0,t.not)(S),()=>y(S)),a.ok(S)}function y(S){c.forRange("i",l.length,m,E=>{a.subschema({keyword:h,dataProp:E,dataPropType:e.Type.Num},S),p.allErrors||c.if((0,t.not)(S),()=>c.break())})}}return Go.validateAdditionalItems=i,Go.default=r,Go}var bf={},Wo={},IE;function MA(){if(IE)return Wo;IE=1,Object.defineProperty(Wo,"__esModule",{value:!0}),Wo.validateTuple=void 0;const t=Lt(),e=Wt(),n=Gi(),r={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(a){const{schema:l,it:c}=a;if(Array.isArray(l))return i(a,"additionalItems",l);c.items=!0,!(0,e.alwaysValidSchema)(c,l)&&a.ok((0,n.validateArray)(a))}};function i(a,l,c=a.schema){const{gen:u,parentSchema:f,data:h,keyword:p,it:m}=a;E(f),m.opts.unevaluated&&c.length&&m.items!==!0&&(m.items=e.mergeEvaluated.items(u,c.length,m.items));const y=u.name("valid"),S=u.const("len",(0,t._)`${h}.length`);c.forEach((g,v)=>{(0,e.alwaysValidSchema)(m,g)||(u.if((0,t._)`${S} > ${v}`,()=>a.subschema({keyword:p,schemaProp:v,dataProp:v},y)),a.ok(y))});function E(g){const{opts:v,errSchemaPath:x}=m,w=c.length,C=w===g.minItems&&(w===g.maxItems||g[l]===!1);if(v.strictTuples&&!C){const T=`"${p}" is ${w}-tuple, but minItems or maxItems/${l} are not specified or different at path "${x}"`;(0,e.checkStrictMode)(m,T,v.strictTuples)}}}return Wo.validateTuple=i,Wo.default=r,Wo}var NE;function h4(){if(NE)return bf;NE=1,Object.defineProperty(bf,"__esModule",{value:!0});const t=MA(),e={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:n=>(0,t.validateTuple)(n,"items")};return bf.default=e,bf}var Tf={},kE;function p4(){if(kE)return Tf;kE=1,Object.defineProperty(Tf,"__esModule",{value:!0});const t=Lt(),e=Wt(),n=Gi(),r=TA(),a={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:l}})=>(0,t.str)`must NOT have more than ${l} items`,params:({params:{len:l}})=>(0,t._)`{limit: ${l}}`},code(l){const{schema:c,parentSchema:u,it:f}=l,{prefixItems:h}=u;f.items=!0,!(0,e.alwaysValidSchema)(f,c)&&(h?(0,r.validateAdditionalItems)(l,h):l.ok((0,n.validateArray)(l)))}};return Tf.default=a,Tf}var Mf={},LE;function m4(){if(LE)return Mf;LE=1,Object.defineProperty(Mf,"__esModule",{value:!0});const t=Lt(),e=Wt(),r={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:i,max:a}})=>a===void 0?(0,t.str)`must contain at least ${i} valid item(s)`:(0,t.str)`must contain at least ${i} and no more than ${a} valid item(s)`,params:({params:{min:i,max:a}})=>a===void 0?(0,t._)`{minContains: ${i}}`:(0,t._)`{minContains: ${i}, maxContains: ${a}}`},code(i){const{gen:a,schema:l,parentSchema:c,data:u,it:f}=i;let h,p;const{minContains:m,maxContains:y}=c;f.opts.next?(h=m===void 0?1:m,p=y):h=1;const S=a.const("len",(0,t._)`${u}.length`);if(i.setParams({min:h,max:p}),p===void 0&&h===0){(0,e.checkStrictMode)(f,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(p!==void 0&&h>p){(0,e.checkStrictMode)(f,'"minContains" > "maxContains" is always invalid'),i.fail();return}if((0,e.alwaysValidSchema)(f,l)){let w=(0,t._)`${S} >= ${h}`;p!==void 0&&(w=(0,t._)`${w} && ${S} <= ${p}`),i.pass(w);return}f.items=!0;const E=a.name("valid");p===void 0&&h===1?v(E,()=>a.if(E,()=>a.break())):h===0?(a.let(E,!0),p!==void 0&&a.if((0,t._)`${u}.length > 0`,g)):(a.let(E,!1),g()),i.result(E,()=>i.reset());function g(){const w=a.name("_valid"),C=a.let("count",0);v(w,()=>a.if(w,()=>x(C)))}function v(w,C){a.forRange("i",0,S,T=>{i.subschema({keyword:"contains",dataProp:T,dataPropType:e.Type.Num,compositeRule:!0},w),C()})}function x(w){a.code((0,t._)`${w}++`),p===void 0?a.if((0,t._)`${w} >= ${h}`,()=>a.assign(E,!0).break()):(a.if((0,t._)`${w} > ${p}`,()=>a.assign(E,!1).break()),h===1?a.assign(E,!0):a.if((0,t._)`${w} >= ${h}`,()=>a.assign(E,!0)))}}};return Mf.default=r,Mf}var Vg={},OE;function g4(){return OE||(OE=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const e=Lt(),n=Wt(),r=Gi();t.error={message:({params:{property:u,depsCount:f,deps:h}})=>{const p=f===1?"property":"properties";return(0,e.str)`must have ${p} ${h} when property ${u} is present`},params:({params:{property:u,depsCount:f,deps:h,missingProperty:p}})=>(0,e._)`{property: ${u},
    missingProperty: ${p},
    depsCount: ${f},
    deps: ${h}}`};const i={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(u){const[f,h]=a(u);l(u,f),c(u,h)}};function a({schema:u}){const f={},h={};for(const p in u){if(p==="__proto__")continue;const m=Array.isArray(u[p])?f:h;m[p]=u[p]}return[f,h]}function l(u,f=u.schema){const{gen:h,data:p,it:m}=u;if(Object.keys(f).length===0)return;const y=h.let("missing");for(const S in f){const E=f[S];if(E.length===0)continue;const g=(0,r.propertyInData)(h,p,S,m.opts.ownProperties);u.setParams({property:S,depsCount:E.length,deps:E.join(", ")}),m.allErrors?h.if(g,()=>{for(const v of E)(0,r.checkReportMissingProp)(u,v)}):(h.if((0,e._)`${g} && (${(0,r.checkMissingProp)(u,E,y)})`),(0,r.reportMissingProp)(u,y),h.else())}}t.validatePropertyDeps=l;function c(u,f=u.schema){const{gen:h,data:p,keyword:m,it:y}=u,S=h.name("valid");for(const E in f)(0,n.alwaysValidSchema)(y,f[E])||(h.if((0,r.propertyInData)(h,p,E,y.opts.ownProperties),()=>{const g=u.subschema({keyword:m,schemaProp:E},S);u.mergeValidEvaluated(g,S)},()=>h.var(S,!0)),u.ok(S))}t.validateSchemaDeps=c,t.default=i})(Vg)),Vg}var Rf={},DE;function _4(){if(DE)return Rf;DE=1,Object.defineProperty(Rf,"__esModule",{value:!0});const t=Lt(),e=Wt(),r={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:i})=>(0,t._)`{propertyName: ${i.propertyName}}`},code(i){const{gen:a,schema:l,data:c,it:u}=i;if((0,e.alwaysValidSchema)(u,l))return;const f=a.name("valid");a.forIn("key",c,h=>{i.setParams({propertyName:h}),i.subschema({keyword:"propertyNames",data:h,dataTypes:["string"],propertyName:h,compositeRule:!0},f),a.if((0,t.not)(f),()=>{i.error(!0),u.allErrors||a.break()})}),i.ok(f)}};return Rf.default=r,Rf}var Cf={},UE;function RA(){if(UE)return Cf;UE=1,Object.defineProperty(Cf,"__esModule",{value:!0});const t=Gi(),e=Lt(),n=ba(),r=Wt(),a={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:l})=>(0,e._)`{additionalProperty: ${l.additionalProperty}}`},code(l){const{gen:c,schema:u,parentSchema:f,data:h,errsCount:p,it:m}=l;if(!p)throw new Error("ajv implementation error");const{allErrors:y,opts:S}=m;if(m.props=!0,S.removeAdditional!=="all"&&(0,r.alwaysValidSchema)(m,u))return;const E=(0,t.allSchemaProperties)(f.properties),g=(0,t.allSchemaProperties)(f.patternProperties);v(),l.ok((0,e._)`${p} === ${n.default.errors}`);function v(){c.forIn("key",h,M=>{!E.length&&!g.length?C(M):c.if(x(M),()=>C(M))})}function x(M){let A;if(E.length>8){const F=(0,r.schemaRefOrVal)(m,f.properties,"properties");A=(0,t.isOwnProperty)(c,F,M)}else E.length?A=(0,e.or)(...E.map(F=>(0,e._)`${M} === ${F}`)):A=e.nil;return g.length&&(A=(0,e.or)(A,...g.map(F=>(0,e._)`${(0,t.usePattern)(l,F)}.test(${M})`))),(0,e.not)(A)}function w(M){c.code((0,e._)`delete ${h}[${M}]`)}function C(M){if(S.removeAdditional==="all"||S.removeAdditional&&u===!1){w(M);return}if(u===!1){l.setParams({additionalProperty:M}),l.error(),y||c.break();return}if(typeof u=="object"&&!(0,r.alwaysValidSchema)(m,u)){const A=c.name("valid");S.removeAdditional==="failing"?(T(M,A,!1),c.if((0,e.not)(A),()=>{l.reset(),w(M)})):(T(M,A),y||c.if((0,e.not)(A),()=>c.break()))}}function T(M,A,F){const I={keyword:"additionalProperties",dataProp:M,dataPropType:r.Type.Str};F===!1&&Object.assign(I,{compositeRule:!0,createErrors:!1,allErrors:!1}),l.subschema(I,A)}}};return Cf.default=a,Cf}var Af={},FE;function v4(){if(FE)return Af;FE=1,Object.defineProperty(Af,"__esModule",{value:!0});const t=Pp(),e=Gi(),n=Wt(),r=RA(),i={keyword:"properties",type:"object",schemaType:"object",code(a){const{gen:l,schema:c,parentSchema:u,data:f,it:h}=a;h.opts.removeAdditional==="all"&&u.additionalProperties===void 0&&r.default.code(new t.KeywordCxt(h,r.default,"additionalProperties"));const p=(0,e.allSchemaProperties)(c);for(const g of p)h.definedProperties.add(g);h.opts.unevaluated&&p.length&&h.props!==!0&&(h.props=n.mergeEvaluated.props(l,(0,n.toHash)(p),h.props));const m=p.filter(g=>!(0,n.alwaysValidSchema)(h,c[g]));if(m.length===0)return;const y=l.name("valid");for(const g of m)S(g)?E(g):(l.if((0,e.propertyInData)(l,f,g,h.opts.ownProperties)),E(g),h.allErrors||l.else().var(y,!0),l.endIf()),a.it.definedProperties.add(g),a.ok(y);function S(g){return h.opts.useDefaults&&!h.compositeRule&&c[g].default!==void 0}function E(g){a.subschema({keyword:"properties",schemaProp:g,dataProp:g},y)}}};return Af.default=i,Af}var Pf={},zE;function y4(){if(zE)return Pf;zE=1,Object.defineProperty(Pf,"__esModule",{value:!0});const t=Gi(),e=Lt(),n=Wt(),r=Wt(),i={keyword:"patternProperties",type:"object",schemaType:"object",code(a){const{gen:l,schema:c,data:u,parentSchema:f,it:h}=a,{opts:p}=h,m=(0,t.allSchemaProperties)(c),y=m.filter(C=>(0,n.alwaysValidSchema)(h,c[C]));if(m.length===0||y.length===m.length&&(!h.opts.unevaluated||h.props===!0))return;const S=p.strictSchema&&!p.allowMatchingProperties&&f.properties,E=l.name("valid");h.props!==!0&&!(h.props instanceof e.Name)&&(h.props=(0,r.evaluatedPropsToName)(l,h.props));const{props:g}=h;v();function v(){for(const C of m)S&&x(C),h.allErrors?w(C):(l.var(E,!0),w(C),l.if(E))}function x(C){for(const T in S)new RegExp(C).test(T)&&(0,n.checkStrictMode)(h,`property ${T} matches pattern ${C} (use allowMatchingProperties)`)}function w(C){l.forIn("key",u,T=>{l.if((0,e._)`${(0,t.usePattern)(a,C)}.test(${T})`,()=>{const M=y.includes(C);M||a.subschema({keyword:"patternProperties",schemaProp:C,dataProp:T,dataPropType:r.Type.Str},E),h.opts.unevaluated&&g!==!0?l.assign((0,e._)`${g}[${T}]`,!0):!M&&!h.allErrors&&l.if((0,e.not)(E),()=>l.break())})})}}};return Pf.default=i,Pf}var If={},$E;function S4(){if($E)return If;$E=1,Object.defineProperty(If,"__esModule",{value:!0});const t=Wt(),e={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(n){const{gen:r,schema:i,it:a}=n;if((0,t.alwaysValidSchema)(a,i)){n.fail();return}const l=r.name("valid");n.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},l),n.failResult(l,()=>n.reset(),()=>n.error())},error:{message:"must NOT be valid"}};return If.default=e,If}var Nf={},BE;function w4(){if(BE)return Nf;BE=1,Object.defineProperty(Nf,"__esModule",{value:!0});const e={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Gi().validateUnion,error:{message:"must match a schema in anyOf"}};return Nf.default=e,Nf}var kf={},VE;function x4(){if(VE)return kf;VE=1,Object.defineProperty(kf,"__esModule",{value:!0});const t=Lt(),e=Wt(),r={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:i})=>(0,t._)`{passingSchemas: ${i.passing}}`},code(i){const{gen:a,schema:l,parentSchema:c,it:u}=i;if(!Array.isArray(l))throw new Error("ajv implementation error");if(u.opts.discriminator&&c.discriminator)return;const f=l,h=a.let("valid",!1),p=a.let("passing",null),m=a.name("_valid");i.setParams({passing:p}),a.block(y),i.result(h,()=>i.reset(),()=>i.error(!0));function y(){f.forEach((S,E)=>{let g;(0,e.alwaysValidSchema)(u,S)?a.var(m,!0):g=i.subschema({keyword:"oneOf",schemaProp:E,compositeRule:!0},m),E>0&&a.if((0,t._)`${m} && ${h}`).assign(h,!1).assign(p,(0,t._)`[${p}, ${E}]`).else(),a.if(m,()=>{a.assign(h,!0),a.assign(p,E),g&&i.mergeEvaluated(g,t.Name)})})}}};return kf.default=r,kf}var Lf={},jE;function E4(){if(jE)return Lf;jE=1,Object.defineProperty(Lf,"__esModule",{value:!0});const t=Wt(),e={keyword:"allOf",schemaType:"array",code(n){const{gen:r,schema:i,it:a}=n;if(!Array.isArray(i))throw new Error("ajv implementation error");const l=r.name("valid");i.forEach((c,u)=>{if((0,t.alwaysValidSchema)(a,c))return;const f=n.subschema({keyword:"allOf",schemaProp:u},l);n.ok(l),n.mergeEvaluated(f)})}};return Lf.default=e,Lf}var Of={},HE;function b4(){if(HE)return Of;HE=1,Object.defineProperty(Of,"__esModule",{value:!0});const t=Lt(),e=Wt(),r={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:a})=>(0,t.str)`must match "${a.ifClause}" schema`,params:({params:a})=>(0,t._)`{failingKeyword: ${a.ifClause}}`},code(a){const{gen:l,parentSchema:c,it:u}=a;c.then===void 0&&c.else===void 0&&(0,e.checkStrictMode)(u,'"if" without "then" and "else" is ignored');const f=i(u,"then"),h=i(u,"else");if(!f&&!h)return;const p=l.let("valid",!0),m=l.name("_valid");if(y(),a.reset(),f&&h){const E=l.let("ifClause");a.setParams({ifClause:E}),l.if(m,S("then",E),S("else",E))}else f?l.if(m,S("then")):l.if((0,t.not)(m),S("else"));a.pass(p,()=>a.error(!0));function y(){const E=a.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},m);a.mergeEvaluated(E)}function S(E,g){return()=>{const v=a.subschema({keyword:E},m);l.assign(p,m),a.mergeValidEvaluated(v,p),g?l.assign(g,(0,t._)`${E}`):a.setParams({ifClause:E})}}}};function i(a,l){const c=a.schema[l];return c!==void 0&&!(0,e.alwaysValidSchema)(a,c)}return Of.default=r,Of}var Df={},GE;function T4(){if(GE)return Df;GE=1,Object.defineProperty(Df,"__esModule",{value:!0});const t=Wt(),e={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:n,parentSchema:r,it:i}){r.if===void 0&&(0,t.checkStrictMode)(i,`"${n}" without "if" is ignored`)}};return Df.default=e,Df}var WE;function M4(){if(WE)return Ef;WE=1,Object.defineProperty(Ef,"__esModule",{value:!0});const t=TA(),e=h4(),n=MA(),r=p4(),i=m4(),a=g4(),l=_4(),c=RA(),u=v4(),f=y4(),h=S4(),p=w4(),m=x4(),y=E4(),S=b4(),E=T4();function g(v=!1){const x=[h.default,p.default,m.default,y.default,S.default,E.default,l.default,c.default,a.default,u.default,f.default];return v?x.push(e.default,r.default):x.push(t.default,n.default),x.push(i.default),x}return Ef.default=g,Ef}var Uf={},Ff={},qE;function R4(){if(qE)return Ff;qE=1,Object.defineProperty(Ff,"__esModule",{value:!0});const t=Lt(),n={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:r})=>(0,t.str)`must match format "${r}"`,params:({schemaCode:r})=>(0,t._)`{format: ${r}}`},code(r,i){const{gen:a,data:l,$data:c,schema:u,schemaCode:f,it:h}=r,{opts:p,errSchemaPath:m,schemaEnv:y,self:S}=h;if(!p.validateFormats)return;c?E():g();function E(){const v=a.scopeValue("formats",{ref:S.formats,code:p.code.formats}),x=a.const("fDef",(0,t._)`${v}[${f}]`),w=a.let("fType"),C=a.let("format");a.if((0,t._)`typeof ${x} == "object" && !(${x} instanceof RegExp)`,()=>a.assign(w,(0,t._)`${x}.type || "string"`).assign(C,(0,t._)`${x}.validate`),()=>a.assign(w,(0,t._)`"string"`).assign(C,x)),r.fail$data((0,t.or)(T(),M()));function T(){return p.strictSchema===!1?t.nil:(0,t._)`${f} && !${C}`}function M(){const A=y.$async?(0,t._)`(${x}.async ? await ${C}(${l}) : ${C}(${l}))`:(0,t._)`${C}(${l})`,F=(0,t._)`(typeof ${C} == "function" ? ${A} : ${C}.test(${l}))`;return(0,t._)`${C} && ${C} !== true && ${w} === ${i} && !${F}`}}function g(){const v=S.formats[u];if(!v){T();return}if(v===!0)return;const[x,w,C]=M(v);x===i&&r.pass(A());function T(){if(p.strictSchema===!1){S.logger.warn(F());return}throw new Error(F());function F(){return`unknown format "${u}" ignored in schema at path "${m}"`}}function M(F){const I=F instanceof RegExp?(0,t.regexpCode)(F):p.code.formats?(0,t._)`${p.code.formats}${(0,t.getProperty)(u)}`:void 0,O=a.scopeValue("formats",{key:u,ref:F,code:I});return typeof F=="object"&&!(F instanceof RegExp)?[F.type||"string",F.validate,(0,t._)`${O}.validate`]:["string",F,O]}function A(){if(typeof v=="object"&&!(v instanceof RegExp)&&v.async){if(!y.$async)throw new Error("async format in sync schema");return(0,t._)`await ${C}(${l})`}return typeof w=="function"?(0,t._)`${C}(${l})`:(0,t._)`${C}.test(${l})`}}}};return Ff.default=n,Ff}var ZE;function C4(){if(ZE)return Uf;ZE=1,Object.defineProperty(Uf,"__esModule",{value:!0});const e=[R4().default];return Uf.default=e,Uf}var Ha={},XE;function A4(){return XE||(XE=1,Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.contentVocabulary=Ha.metadataVocabulary=void 0,Ha.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],Ha.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]),Ha}var KE;function P4(){if(KE)return of;KE=1,Object.defineProperty(of,"__esModule",{value:!0});const t=e4(),e=f4(),n=M4(),r=C4(),i=A4(),a=[t.default,e.default,(0,n.default)(),r.default,i.metadataVocabulary,i.contentVocabulary];return of.default=a,of}var zf={},Lc={},YE;function I4(){if(YE)return Lc;YE=1,Object.defineProperty(Lc,"__esModule",{value:!0}),Lc.DiscrError=void 0;var t;return(function(e){e.Tag="tag",e.Mapping="mapping"})(t||(Lc.DiscrError=t={})),Lc}var JE;function N4(){if(JE)return zf;JE=1,Object.defineProperty(zf,"__esModule",{value:!0});const t=Lt(),e=I4(),n=Ly(),r=Ip(),i=Wt(),l={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:c,tagName:u}})=>c===e.DiscrError.Tag?`tag "${u}" must be string`:`value of tag "${u}" must be in oneOf`,params:({params:{discrError:c,tag:u,tagName:f}})=>(0,t._)`{error: ${c}, tag: ${f}, tagValue: ${u}}`},code(c){const{gen:u,data:f,schema:h,parentSchema:p,it:m}=c,{oneOf:y}=p;if(!m.opts.discriminator)throw new Error("discriminator: requires discriminator option");const S=h.propertyName;if(typeof S!="string")throw new Error("discriminator: requires propertyName");if(h.mapping)throw new Error("discriminator: mapping is not supported");if(!y)throw new Error("discriminator: requires oneOf keyword");const E=u.let("valid",!1),g=u.const("tag",(0,t._)`${f}${(0,t.getProperty)(S)}`);u.if((0,t._)`typeof ${g} == "string"`,()=>v(),()=>c.error(!1,{discrError:e.DiscrError.Tag,tag:g,tagName:S})),c.ok(E);function v(){const C=w();u.if(!1);for(const T in C)u.elseIf((0,t._)`${g} === ${T}`),u.assign(E,x(C[T]));u.else(),c.error(!1,{discrError:e.DiscrError.Mapping,tag:g,tagName:S}),u.endIf()}function x(C){const T=u.name("valid"),M=c.subschema({keyword:"oneOf",schemaProp:C},T);return c.mergeEvaluated(M,t.Name),T}function w(){var C;const T={},M=F(p);let A=!0;for(let W=0;W<y.length;W++){let J=y[W];if(J?.$ref&&!(0,i.schemaHasRulesButRef)(J,m.self.RULES)){const Z=J.$ref;if(J=n.resolveRef.call(m.self,m.schemaEnv.root,m.baseId,Z),J instanceof n.SchemaEnv&&(J=J.schema),J===void 0)throw new r.default(m.opts.uriResolver,m.baseId,Z)}const ae=(C=J?.properties)===null||C===void 0?void 0:C[S];if(typeof ae!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${S}"`);A=A&&(M||F(J)),I(ae,W)}if(!A)throw new Error(`discriminator: "${S}" must be required`);return T;function F({required:W}){return Array.isArray(W)&&W.includes(S)}function I(W,J){if(W.const)O(W.const,J);else if(W.enum)for(const ae of W.enum)O(ae,J);else throw new Error(`discriminator: "properties/${S}" must have "const" or "enum"`)}function O(W,J){if(typeof W!="string"||W in T)throw new Error(`discriminator: "${S}" values must be unique strings`);T[W]=J}}}};return zf.default=l,zf}const k4="http://json-schema.org/draft-07/schema#",L4="http://json-schema.org/draft-07/schema#",O4="Core schema meta-schema",D4={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},U4=["object","boolean"],F4={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},z4={$schema:k4,$id:L4,title:O4,definitions:D4,type:U4,properties:F4,default:!0};var QE;function CA(){return QE||(QE=1,(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.MissingRefError=e.ValidationError=e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=e.Ajv=void 0;const n=Y$(),r=P4(),i=N4(),a=z4,l=["/properties"],c="http://json-schema.org/draft-07/schema";class u extends n.default{_addVocabularies(){super._addVocabularies(),r.default.forEach(S=>this.addVocabulary(S)),this.opts.discriminator&&this.addKeyword(i.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const S=this.opts.$data?this.$dataMetaSchema(a,l):a;this.addMetaSchema(S,c,!1),this.refs["http://json-schema.org/schema"]=c}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(c)?c:void 0)}}e.Ajv=u,t.exports=e=u,t.exports.Ajv=u,Object.defineProperty(e,"__esModule",{value:!0}),e.default=u;var f=Pp();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return f.KeywordCxt}});var h=Lt();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return h._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return h.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return h.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return h.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return h.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return h.CodeGen}});var p=ky();Object.defineProperty(e,"ValidationError",{enumerable:!0,get:function(){return p.default}});var m=Ip();Object.defineProperty(e,"MissingRefError",{enumerable:!0,get:function(){return m.default}})})(tf,tf.exports)),tf.exports}var $4=CA();const B4=ip($4);var $f={exports:{}},jg={},eb;function V4(){return eb||(eb=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatNames=t.fastFormats=t.fullFormats=void 0;function e(W,J){return{validate:W,compare:J}}t.fullFormats={date:e(a,l),time:e(u(!0),f),"date-time":e(m(!0),y),"iso-time":e(u(),h),"iso-date-time":e(m(),S),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:v,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:O,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:w,int32:{type:"number",validate:M},int64:{type:"number",validate:A},float:{type:"number",validate:F},double:{type:"number",validate:F},password:!0,binary:!0},t.fastFormats={...t.fullFormats,date:e(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,l),time:e(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,f),"date-time":e(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,y),"iso-time":e(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,h),"iso-date-time":e(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,S),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},t.formatNames=Object.keys(t.fullFormats);function n(W){return W%4===0&&(W%100!==0||W%400===0)}const r=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,i=[0,31,28,31,30,31,30,31,31,30,31,30,31];function a(W){const J=r.exec(W);if(!J)return!1;const ae=+J[1],Z=+J[2],ie=+J[3];return Z>=1&&Z<=12&&ie>=1&&ie<=(Z===2&&n(ae)?29:i[Z])}function l(W,J){if(W&&J)return W>J?1:W<J?-1:0}const c=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function u(W){return function(ae){const Z=c.exec(ae);if(!Z)return!1;const ie=+Z[1],de=+Z[2],pe=+Z[3],K=Z[4],ne=Z[5]==="-"?-1:1,j=+(Z[6]||0),N=+(Z[7]||0);if(j>23||N>59||W&&!K)return!1;if(ie<=23&&de<=59&&pe<60)return!0;const H=de-N*ne,U=ie-j*ne-(H<0?1:0);return(U===23||U===-1)&&(H===59||H===-1)&&pe<61}}function f(W,J){if(!(W&&J))return;const ae=new Date("2020-01-01T"+W).valueOf(),Z=new Date("2020-01-01T"+J).valueOf();if(ae&&Z)return ae-Z}function h(W,J){if(!(W&&J))return;const ae=c.exec(W),Z=c.exec(J);if(ae&&Z)return W=ae[1]+ae[2]+ae[3],J=Z[1]+Z[2]+Z[3],W>J?1:W<J?-1:0}const p=/t|\s/i;function m(W){const J=u(W);return function(Z){const ie=Z.split(p);return ie.length===2&&a(ie[0])&&J(ie[1])}}function y(W,J){if(!(W&&J))return;const ae=new Date(W).valueOf(),Z=new Date(J).valueOf();if(ae&&Z)return ae-Z}function S(W,J){if(!(W&&J))return;const[ae,Z]=W.split(p),[ie,de]=J.split(p),pe=l(ae,ie);if(pe!==void 0)return pe||f(Z,de)}const E=/\/|:/,g=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function v(W){return E.test(W)&&g.test(W)}const x=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function w(W){return x.lastIndex=0,x.test(W)}const C=-2147483648,T=2**31-1;function M(W){return Number.isInteger(W)&&W<=T&&W>=C}function A(W){return Number.isInteger(W)}function F(){return!0}const I=/[^\\]\\Z/;function O(W){if(I.test(W))return!1;try{return new RegExp(W),!0}catch{return!1}}})(jg)),jg}var Hg={},tb;function j4(){return tb||(tb=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatLimitDefinition=void 0;const e=CA(),n=Lt(),r=n.operators,i={formatMaximum:{okStr:"<=",ok:r.LTE,fail:r.GT},formatMinimum:{okStr:">=",ok:r.GTE,fail:r.LT},formatExclusiveMaximum:{okStr:"<",ok:r.LT,fail:r.GTE},formatExclusiveMinimum:{okStr:">",ok:r.GT,fail:r.LTE}},a={message:({keyword:c,schemaCode:u})=>(0,n.str)`should be ${i[c].okStr} ${u}`,params:({keyword:c,schemaCode:u})=>(0,n._)`{comparison: ${i[c].okStr}, limit: ${u}}`};t.formatLimitDefinition={keyword:Object.keys(i),type:"string",schemaType:"string",$data:!0,error:a,code(c){const{gen:u,data:f,schemaCode:h,keyword:p,it:m}=c,{opts:y,self:S}=m;if(!y.validateFormats)return;const E=new e.KeywordCxt(m,S.RULES.all.format.definition,"format");E.$data?g():v();function g(){const w=u.scopeValue("formats",{ref:S.formats,code:y.code.formats}),C=u.const("fmt",(0,n._)`${w}[${E.schemaCode}]`);c.fail$data((0,n.or)((0,n._)`typeof ${C} != "object"`,(0,n._)`${C} instanceof RegExp`,(0,n._)`typeof ${C}.compare != "function"`,x(C)))}function v(){const w=E.schema,C=S.formats[w];if(!C||C===!0)return;if(typeof C!="object"||C instanceof RegExp||typeof C.compare!="function")throw new Error(`"${p}": format "${w}" does not define "compare" function`);const T=u.scopeValue("formats",{key:w,ref:C,code:y.code.formats?(0,n._)`${y.code.formats}${(0,n.getProperty)(w)}`:void 0});c.fail$data(x(T))}function x(w){return(0,n._)`${w}.compare(${f}, ${h}) ${i[p].fail} 0`}},dependencies:["format"]};const l=c=>(c.addKeyword(t.formatLimitDefinition),c);t.default=l})(Hg)),Hg}var nb;function H4(){return nb||(nb=1,(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});const n=V4(),r=j4(),i=Lt(),a=new i.Name("fullFormats"),l=new i.Name("fastFormats"),c=(f,h={keywords:!0})=>{if(Array.isArray(h))return u(f,h,n.fullFormats,a),f;const[p,m]=h.mode==="fast"?[n.fastFormats,l]:[n.fullFormats,a],y=h.formats||n.formatNames;return u(f,y,p,m),h.keywords&&(0,r.default)(f),f};c.get=(f,h="full")=>{const m=(h==="fast"?n.fastFormats:n.fullFormats)[f];if(!m)throw new Error(`Unknown format "${f}"`);return m};function u(f,h,p,m){var y,S;(y=(S=f.opts.code).formats)!==null&&y!==void 0||(S.formats=(0,i._)`require("ajv-formats/dist/formats").${m}`);for(const E of h)f.addFormat(E,p[E])}t.exports=e=c,Object.defineProperty(e,"__esModule",{value:!0}),e.default=c})($f,$f.exports)),$f.exports}var G4=H4();const W4=ip(G4);function q4(){const t=new B4({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return W4(t),t}class Z4{constructor(e){this._ajv=e??q4()}getValidator(e){const n="$id"in e&&typeof e.$id=="string"?this._ajv.getSchema(e.$id)??this._ajv.compile(e):this._ajv.compile(e);return r=>n(r)?{valid:!0,data:r,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(n.errors)}}}class X4{constructor(e){this._client=e}async*callToolStream(e,n=Rp,r){const i=this._client,a={...r,task:r?.task??(i.isToolTask(e.name)?{}:void 0)},l=i.requestStream({method:"tools/call",params:e},n,a),c=i.getToolOutputValidator(e.name);for await(const u of l){if(u.type==="result"&&c){const f=u.result;if(!f.structuredContent&&!f.isError){yield{type:"error",error:new ht(Et.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`)};return}if(f.structuredContent)try{const h=c(f.structuredContent);if(!h.valid){yield{type:"error",error:new ht(Et.InvalidParams,`Structured content does not match the tool's output schema: ${h.errorMessage}`)};return}}catch(h){if(h instanceof ht){yield{type:"error",error:h};return}yield{type:"error",error:new ht(Et.InvalidParams,`Failed to validate structured content: ${h instanceof Error?h.message:String(h)}`)};return}}yield u}}async getTask(e,n){return this._client.getTask({taskId:e},n)}async getTaskResult(e,n,r){return this._client.getTaskResult({taskId:e},n,r)}async listTasks(e,n){return this._client.listTasks(e?{cursor:e}:void 0,n)}async cancelTask(e,n){return this._client.cancelTask({taskId:e},n)}requestStream(e,n,r){return this._client.requestStream(e,n,r)}}function K4(t,e,n){if(!t)throw new Error(`${n} does not support task creation (required for ${e})`);switch(e){case"tools/call":if(!t.tools?.call)throw new Error(`${n} does not support task creation for tools/call (required for ${e})`);break}}function Y4(t,e,n){if(!t)throw new Error(`${n} does not support task creation (required for ${e})`);switch(e){case"sampling/createMessage":if(!t.sampling?.createMessage)throw new Error(`${n} does not support task creation for sampling/createMessage (required for ${e})`);break;case"elicitation/create":if(!t.elicitation?.create)throw new Error(`${n} does not support task creation for elicitation/create (required for ${e})`);break}}function yh(t,e){if(!(!t||e===null||typeof e!="object")){if(t.type==="object"&&t.properties&&typeof t.properties=="object"){const n=e,r=t.properties;for(const i of Object.keys(r)){const a=r[i];n[i]===void 0&&Object.prototype.hasOwnProperty.call(a,"default")&&(n[i]=a.default),n[i]!==void 0&&yh(a,n[i])}}if(Array.isArray(t.anyOf))for(const n of t.anyOf)typeof n!="boolean"&&yh(n,e);if(Array.isArray(t.oneOf))for(const n of t.oneOf)typeof n!="boolean"&&yh(n,e)}}function J4(t){if(!t)return{supportsFormMode:!1,supportsUrlMode:!1};const e=t.form!==void 0,n=t.url!==void 0;return{supportsFormMode:e||!e&&!n,supportsUrlMode:n}}class Q4 extends L${constructor(e,n){super(n),this._clientInfo=e,this._cachedToolOutputValidators=new Map,this._cachedKnownTaskTools=new Set,this._cachedRequiredTaskTools=new Set,this._listChangedDebounceTimers=new Map,this._capabilities=n?.capabilities??{},this._jsonSchemaValidator=n?.jsonSchemaValidator??new Z4,n?.listChanged&&(this._pendingListChangedConfig=n.listChanged)}_setupListChangedHandlers(e){e.tools&&this._serverCapabilities?.tools?.listChanged&&this._setupListChangedHandler("tools",mA,e.tools,async()=>(await this.listTools()).tools),e.prompts&&this._serverCapabilities?.prompts?.listChanged&&this._setupListChangedHandler("prompts",fA,e.prompts,async()=>(await this.listPrompts()).prompts),e.resources&&this._serverCapabilities?.resources?.listChanged&&this._setupListChangedHandler("resources",cA,e.resources,async()=>(await this.listResources()).resources)}get experimental(){return this._experimental||(this._experimental={tasks:new X4(this)}),this._experimental}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=O$(this._capabilities,e)}setRequestHandler(e,n){const i=ZC(e)?.method;if(!i)throw new Error("Schema is missing a method literal");let a;if(Ep(i)){const c=i;a=c._zod?.def?.value??c.value}else{const c=i;a=c._def?.value??c.value}if(typeof a!="string")throw new Error("Schema method literal must be a string");const l=a;if(l==="elicitation/create"){const c=async(u,f)=>{const h=da(tu,u);if(!h.success){const x=h.error instanceof Error?h.error.message:String(h.error);throw new ht(Et.InvalidParams,`Invalid elicitation request: ${x}`)}const{params:p}=h.data;p.mode=p.mode??"form";const{supportsFormMode:m,supportsUrlMode:y}=J4(this._capabilities.elicitation);if(p.mode==="form"&&!m)throw new ht(Et.InvalidParams,"Client does not support form-mode elicitation requests");if(p.mode==="url"&&!y)throw new ht(Et.InvalidParams,"Client does not support URL-mode elicitation requests");const S=await Promise.resolve(n(u,f));if(p.task){const x=da(_u,S);if(!x.success){const w=x.error instanceof Error?x.error.message:String(x.error);throw new ht(Et.InvalidParams,`Invalid task creation result: ${w}`)}return x.data}const E=da(yA,S);if(!E.success){const x=E.error instanceof Error?E.error.message:String(E.error);throw new ht(Et.InvalidParams,`Invalid elicitation result: ${x}`)}const g=E.data,v=p.mode==="form"?p.requestedSchema:void 0;if(p.mode==="form"&&g.action==="accept"&&g.content&&v&&this._capabilities.elicitation?.form?.applyDefaults)try{yh(v,g.content)}catch{}return g};return super.setRequestHandler(e,c)}if(l==="sampling/createMessage"){const c=async(u,f)=>{const h=da(eu,u);if(!h.success){const g=h.error instanceof Error?h.error.message:String(h.error);throw new ht(Et.InvalidParams,`Invalid sampling request: ${g}`)}const{params:p}=h.data,m=await Promise.resolve(n(u,f));if(p.task){const g=da(_u,m);if(!g.success){const v=g.error instanceof Error?g.error.message:String(g.error);throw new ht(Et.InvalidParams,`Invalid task creation result: ${v}`)}return g.data}const S=p.tools||p.toolChoice?vA:_A,E=da(S,m);if(!E.success){const g=E.error instanceof Error?E.error.message:String(E.error);throw new ht(Et.InvalidParams,`Invalid sampling result: ${g}`)}return E.data};return super.setRequestHandler(e,c)}return super.setRequestHandler(e,n)}assertCapability(e,n){if(!this._serverCapabilities?.[e])throw new Error(`Server does not support ${e} (required for ${n})`)}async connect(e,n){if(await super.connect(e),e.sessionId===void 0)try{const r=await this.request({method:"initialize",params:{protocolVersion:bp,capabilities:this._capabilities,clientInfo:this._clientInfo}},eA,n);if(r===void 0)throw new Error(`Server sent invalid initialize result: ${r}`);if(!tz.includes(r.protocolVersion))throw new Error(`Server's protocol version is not supported: ${r.protocolVersion}`);this._serverCapabilities=r.capabilities,this._serverVersion=r.serverInfo,e.setProtocolVersion&&e.setProtocolVersion(r.protocolVersion),this._instructions=r.instructions,await this.notification({method:"notifications/initialized"}),this._pendingListChangedConfig&&(this._setupListChangedHandlers(this._pendingListChangedConfig),this._pendingListChangedConfig=void 0)}catch(r){throw this.close(),r}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(e){switch(e){case"logging/setLevel":if(!this._serverCapabilities?.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._serverCapabilities?.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!this._serverCapabilities?.resources)throw new Error(`Server does not support resources (required for ${e})`);if(e==="resources/subscribe"&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._serverCapabilities?.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"completion/complete":if(!this._serverCapabilities?.completions)throw new Error(`Server does not support completions (required for ${e})`);break}}assertNotificationCapability(e){switch(e){case"notifications/roots/list_changed":if(!this._capabilities.roots?.listChanged)throw new Error(`Client does not support roots list changed notifications (required for ${e})`);break}}assertRequestHandlerCapability(e){if(this._capabilities)switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${e})`);break;case"elicitation/create":if(!this._capabilities.elicitation)throw new Error(`Client does not support elicitation capability (required for ${e})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${e})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Client does not support tasks capability (required for ${e})`);break}}assertTaskCapability(e){K4(this._serverCapabilities?.tasks?.requests,e,"Server")}assertTaskHandlerCapability(e){this._capabilities&&Y4(this._capabilities.tasks?.requests,e,"Client")}async ping(e){return this.request({method:"ping"},yl,e)}async complete(e,n){return this.request({method:"completion/complete",params:e},SA,n)}async setLoggingLevel(e,n){return this.request({method:"logging/setLevel",params:{level:e}},yl,n)}async getPrompt(e,n){return this.request({method:"prompts/get",params:e},dA,n)}async listPrompts(e,n){return this.request({method:"prompts/list",params:e},uA,n)}async listResources(e,n){return this.request({method:"resources/list",params:e},aA,n)}async listResourceTemplates(e,n){return this.request({method:"resources/templates/list",params:e},oA,n)}async readResource(e,n){return this.request({method:"resources/read",params:e},lA,n)}async subscribeResource(e,n){return this.request({method:"resources/subscribe",params:e},yl,n)}async unsubscribeResource(e,n){return this.request({method:"resources/unsubscribe",params:e},yl,n)}async callTool(e,n=Rp,r){if(this.isToolTaskRequired(e.name))throw new ht(Et.InvalidRequest,`Tool "${e.name}" requires task-based execution. Use client.experimental.tasks.callToolStream() instead.`);const i=await this.request({method:"tools/call",params:e},n,r),a=this.getToolOutputValidator(e.name);if(a){if(!i.structuredContent&&!i.isError)throw new ht(Et.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`);if(i.structuredContent)try{const l=a(i.structuredContent);if(!l.valid)throw new ht(Et.InvalidParams,`Structured content does not match the tool's output schema: ${l.errorMessage}`)}catch(l){throw l instanceof ht?l:new ht(Et.InvalidParams,`Failed to validate structured content: ${l instanceof Error?l.message:String(l)}`)}}return i}isToolTask(e){return this._serverCapabilities?.tasks?.requests?.tools?.call?this._cachedKnownTaskTools.has(e):!1}isToolTaskRequired(e){return this._cachedRequiredTaskTools.has(e)}cacheToolMetadata(e){this._cachedToolOutputValidators.clear(),this._cachedKnownTaskTools.clear(),this._cachedRequiredTaskTools.clear();for(const n of e){if(n.outputSchema){const i=this._jsonSchemaValidator.getValidator(n.outputSchema);this._cachedToolOutputValidators.set(n.name,i)}const r=n.execution?.taskSupport;(r==="required"||r==="optional")&&this._cachedKnownTaskTools.add(n.name),r==="required"&&this._cachedRequiredTaskTools.add(n.name)}}getToolOutputValidator(e){return this._cachedToolOutputValidators.get(e)}async listTools(e,n){const r=await this.request({method:"tools/list",params:e},pA,n);return this.cacheToolMetadata(r.tools),r}_setupListChangedHandler(e,n,r,i){const a=Xz.safeParse(r);if(!a.success)throw new Error(`Invalid ${e} listChanged options: ${a.error.message}`);if(typeof r.onChanged!="function")throw new Error(`Invalid ${e} listChanged options: onChanged must be a function`);const{autoRefresh:l,debounceMs:c}=a.data,{onChanged:u}=r,f=async()=>{if(!l){u(null,null);return}try{const p=await i();u(null,p)}catch(p){const m=p instanceof Error?p:new Error(String(p));u(m,null)}},h=()=>{if(c){const p=this._listChangedDebounceTimers.get(e);p&&clearTimeout(p);const m=setTimeout(f,c);this._listChangedDebounceTimers.set(e,m)}else f()};this.setNotificationHandler(n,h)}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}}class rb extends Error{constructor(e,n){super(e),this.name="ParseError",this.type=n.type,this.field=n.field,this.value=n.value,this.line=n.line}}function Gg(t){}function AA(t){if(typeof t=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:e=Gg,onError:n=Gg,onRetry:r=Gg,onComment:i}=t;let a="",l=!0,c,u="",f="";function h(E){const g=l?E.replace(/^\xEF\xBB\xBF/,""):E,[v,x]=eB(`${a}${g}`);for(const w of v)p(w);a=x,l=!1}function p(E){if(E===""){y();return}if(E.startsWith(":")){i&&i(E.slice(E.startsWith(": ")?2:1));return}const g=E.indexOf(":");if(g!==-1){const v=E.slice(0,g),x=E[g+1]===" "?2:1,w=E.slice(g+x);m(v,w,E);return}m(E,"",E)}function m(E,g,v){switch(E){case"event":f=g;break;case"data":u=`${u}${g}
`;break;case"id":c=g.includes("\0")?void 0:g;break;case"retry":/^\d+$/.test(g)?r(parseInt(g,10)):n(new rb(`Invalid \`retry\` value: "${g}"`,{type:"invalid-retry",value:g,line:v}));break;default:n(new rb(`Unknown field "${E.length>20?`${E.slice(0,20)}`:E}"`,{type:"unknown-field",field:E,value:g,line:v}));break}}function y(){u.length>0&&e({id:c,event:f||void 0,data:u.endsWith(`
`)?u.slice(0,-1):u}),c=void 0,u="",f=""}function S(E={}){a&&E.consume&&p(a),l=!0,c=void 0,u="",f="",a=""}return{feed:h,reset:S}}function eB(t){const e=[];let n="",r=0;for(;r<t.length;){const i=t.indexOf("\r",r),a=t.indexOf(`
`,r);let l=-1;if(i!==-1&&a!==-1?l=Math.min(i,a):i!==-1?i===t.length-1?l=-1:l=i:a!==-1&&(l=a),l===-1){n=t.slice(r);break}else{const c=t.slice(r,l);e.push(c),r=l+1,t[r-1]==="\r"&&t[r]===`
`&&r++}}return[e,n]}class ib extends Event{constructor(e,n){var r,i;super(e),this.code=(r=n?.code)!=null?r:void 0,this.message=(i=n?.message)!=null?i:void 0}[Symbol.for("nodejs.util.inspect.custom")](e,n,r){return r(sb(this),n)}[Symbol.for("Deno.customInspect")](e,n){return e(sb(this),n)}}function tB(t){const e=globalThis.DOMException;return typeof e=="function"?new e(t,"SyntaxError"):new SyntaxError(t)}function hv(t){return t instanceof Error?"errors"in t&&Array.isArray(t.errors)?t.errors.map(hv).join(", "):"cause"in t&&t.cause instanceof Error?`${t}: ${hv(t.cause)}`:t.message:`${t}`}function sb(t){return{type:t.type,message:t.message,code:t.code,defaultPrevented:t.defaultPrevented,cancelable:t.cancelable,timeStamp:t.timeStamp}}var PA=t=>{throw TypeError(t)},Dy=(t,e,n)=>e.has(t)||PA("Cannot "+n),Ut=(t,e,n)=>(Dy(t,e,"read from private field"),n?n.call(t):e.get(t)),$n=(t,e,n)=>e.has(t)?PA("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),yn=(t,e,n,r)=>(Dy(t,e,"write to private field"),e.set(t,n),n),Ts=(t,e,n)=>(Dy(t,e,"access private method"),n),Br,Qa,ml,Sh,Gh,nu,Sl,ru,fa,gl,Tl,_l,qc,Ui,pv,mv,gv,ab,_v,vv,Zc,yv,Sv;class wh extends EventTarget{constructor(e,n){var r,i;super(),$n(this,Ui),this.CONNECTING=0,this.OPEN=1,this.CLOSED=2,$n(this,Br),$n(this,Qa),$n(this,ml),$n(this,Sh),$n(this,Gh),$n(this,nu),$n(this,Sl),$n(this,ru,null),$n(this,fa),$n(this,gl),$n(this,Tl,null),$n(this,_l,null),$n(this,qc,null),$n(this,mv,async a=>{var l;Ut(this,gl).reset();const{body:c,redirected:u,status:f,headers:h}=a;if(f===204){Ts(this,Ui,Zc).call(this,"Server sent HTTP 204, not reconnecting",204),this.close();return}if(u?yn(this,ml,new URL(a.url)):yn(this,ml,void 0),f!==200){Ts(this,Ui,Zc).call(this,`Non-200 status code (${f})`,f);return}if(!(h.get("content-type")||"").startsWith("text/event-stream")){Ts(this,Ui,Zc).call(this,'Invalid content type, expected "text/event-stream"',f);return}if(Ut(this,Br)===this.CLOSED)return;yn(this,Br,this.OPEN);const p=new Event("open");if((l=Ut(this,qc))==null||l.call(this,p),this.dispatchEvent(p),typeof c!="object"||!c||!("getReader"in c)){Ts(this,Ui,Zc).call(this,"Invalid response body, expected a web ReadableStream",f),this.close();return}const m=new TextDecoder,y=c.getReader();let S=!0;do{const{done:E,value:g}=await y.read();g&&Ut(this,gl).feed(m.decode(g,{stream:!E})),E&&(S=!1,Ut(this,gl).reset(),Ts(this,Ui,yv).call(this))}while(S)}),$n(this,gv,a=>{yn(this,fa,void 0),!(a.name==="AbortError"||a.type==="aborted")&&Ts(this,Ui,yv).call(this,hv(a))}),$n(this,_v,a=>{typeof a.id=="string"&&yn(this,ru,a.id);const l=new MessageEvent(a.event||"message",{data:a.data,origin:Ut(this,ml)?Ut(this,ml).origin:Ut(this,Qa).origin,lastEventId:a.id||""});Ut(this,_l)&&(!a.event||a.event==="message")&&Ut(this,_l).call(this,l),this.dispatchEvent(l)}),$n(this,vv,a=>{yn(this,nu,a)}),$n(this,Sv,()=>{yn(this,Sl,void 0),Ut(this,Br)===this.CONNECTING&&Ts(this,Ui,pv).call(this)});try{if(e instanceof URL)yn(this,Qa,e);else if(typeof e=="string")yn(this,Qa,new URL(e,nB()));else throw new Error("Invalid URL")}catch{throw tB("An invalid or illegal string was specified")}yn(this,gl,AA({onEvent:Ut(this,_v),onRetry:Ut(this,vv)})),yn(this,Br,this.CONNECTING),yn(this,nu,3e3),yn(this,Gh,(r=n?.fetch)!=null?r:globalThis.fetch),yn(this,Sh,(i=n?.withCredentials)!=null?i:!1),Ts(this,Ui,pv).call(this)}get readyState(){return Ut(this,Br)}get url(){return Ut(this,Qa).href}get withCredentials(){return Ut(this,Sh)}get onerror(){return Ut(this,Tl)}set onerror(e){yn(this,Tl,e)}get onmessage(){return Ut(this,_l)}set onmessage(e){yn(this,_l,e)}get onopen(){return Ut(this,qc)}set onopen(e){yn(this,qc,e)}addEventListener(e,n,r){const i=n;super.addEventListener(e,i,r)}removeEventListener(e,n,r){const i=n;super.removeEventListener(e,i,r)}close(){Ut(this,Sl)&&clearTimeout(Ut(this,Sl)),Ut(this,Br)!==this.CLOSED&&(Ut(this,fa)&&Ut(this,fa).abort(),yn(this,Br,this.CLOSED),yn(this,fa,void 0))}}Br=new WeakMap,Qa=new WeakMap,ml=new WeakMap,Sh=new WeakMap,Gh=new WeakMap,nu=new WeakMap,Sl=new WeakMap,ru=new WeakMap,fa=new WeakMap,gl=new WeakMap,Tl=new WeakMap,_l=new WeakMap,qc=new WeakMap,Ui=new WeakSet,pv=function(){yn(this,Br,this.CONNECTING),yn(this,fa,new AbortController),Ut(this,Gh)(Ut(this,Qa),Ts(this,Ui,ab).call(this)).then(Ut(this,mv)).catch(Ut(this,gv))},mv=new WeakMap,gv=new WeakMap,ab=function(){var t;const e={mode:"cors",redirect:"follow",headers:{Accept:"text/event-stream",...Ut(this,ru)?{"Last-Event-ID":Ut(this,ru)}:void 0},cache:"no-store",signal:(t=Ut(this,fa))==null?void 0:t.signal};return"window"in globalThis&&(e.credentials=this.withCredentials?"include":"same-origin"),e},_v=new WeakMap,vv=new WeakMap,Zc=function(t,e){var n;Ut(this,Br)!==this.CLOSED&&yn(this,Br,this.CLOSED);const r=new ib("error",{code:e,message:t});(n=Ut(this,Tl))==null||n.call(this,r),this.dispatchEvent(r)},yv=function(t,e){var n;if(Ut(this,Br)===this.CLOSED)return;yn(this,Br,this.CONNECTING);const r=new ib("error",{code:e,message:t});(n=Ut(this,Tl))==null||n.call(this,r),this.dispatchEvent(r),yn(this,Sl,setTimeout(Ut(this,Sv),Ut(this,nu)))},Sv=new WeakMap,wh.CONNECTING=0,wh.OPEN=1,wh.CLOSED=2;function nB(){const t="document"in globalThis?globalThis.document:void 0;return t&&typeof t=="object"&&"baseURI"in t&&typeof t.baseURI=="string"?t.baseURI:void 0}function Wh(t){return t?t instanceof Headers?Object.fromEntries(t.entries()):Array.isArray(t)?Object.fromEntries(t):{...t}:{}}function IA(t=fetch,e){return e?async(n,r)=>{const i={...e,...r,headers:r?.headers?{...Wh(e.headers),...Wh(r.headers)}:e.headers};return t(n,i)}:t}let Uy;Uy=globalThis.crypto;async function rB(t){return(await Uy).getRandomValues(new Uint8Array(t))}async function iB(t){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~",n=Math.pow(2,8)-Math.pow(2,8)%e.length;let r="";for(;r.length<t;){const i=await rB(t-r.length);for(const a of i)a<n&&(r+=e[a%e.length])}return r}async function sB(t){return await iB(t)}async function aB(t){const e=await(await Uy).subtle.digest("SHA-256",new TextEncoder().encode(t));return btoa(String.fromCharCode(...new Uint8Array(e))).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")}async function oB(t){if(t||(t=43),t<43||t>128)throw`Expected a length between 43 and 128. Received ${t}.`;const e=await sB(t),n=await aB(e);return{code_verifier:e,code_challenge:n}}const nr=nD().superRefine((t,e)=>{if(!URL.canParse(t))return e.addIssue({code:qD.custom,message:"URL must be parseable",fatal:!0}),lL}).refine(t=>{const e=new URL(t);return e.protocol!=="javascript:"&&e.protocol!=="data:"&&e.protocol!=="vbscript:"},{message:"URL cannot use javascript:, data:, or vbscript: scheme"}),lB=Kn({resource:ee().url(),authorization_servers:Fe(nr).optional(),jwks_uri:ee().url().optional(),scopes_supported:Fe(ee()).optional(),bearer_methods_supported:Fe(ee()).optional(),resource_signing_alg_values_supported:Fe(ee()).optional(),resource_name:ee().optional(),resource_documentation:ee().optional(),resource_policy_uri:ee().url().optional(),resource_tos_uri:ee().url().optional(),tls_client_certificate_bound_access_tokens:dn().optional(),authorization_details_types_supported:Fe(ee()).optional(),dpop_signing_alg_values_supported:Fe(ee()).optional(),dpop_bound_access_tokens_required:dn().optional()}),NA=Kn({issuer:ee(),authorization_endpoint:nr,token_endpoint:nr,registration_endpoint:nr.optional(),scopes_supported:Fe(ee()).optional(),response_types_supported:Fe(ee()),response_modes_supported:Fe(ee()).optional(),grant_types_supported:Fe(ee()).optional(),token_endpoint_auth_methods_supported:Fe(ee()).optional(),token_endpoint_auth_signing_alg_values_supported:Fe(ee()).optional(),service_documentation:nr.optional(),revocation_endpoint:nr.optional(),revocation_endpoint_auth_methods_supported:Fe(ee()).optional(),revocation_endpoint_auth_signing_alg_values_supported:Fe(ee()).optional(),introspection_endpoint:ee().optional(),introspection_endpoint_auth_methods_supported:Fe(ee()).optional(),introspection_endpoint_auth_signing_alg_values_supported:Fe(ee()).optional(),code_challenge_methods_supported:Fe(ee()).optional(),client_id_metadata_document_supported:dn().optional()}),cB=Kn({issuer:ee(),authorization_endpoint:nr,token_endpoint:nr,userinfo_endpoint:nr.optional(),jwks_uri:nr,registration_endpoint:nr.optional(),scopes_supported:Fe(ee()).optional(),response_types_supported:Fe(ee()),response_modes_supported:Fe(ee()).optional(),grant_types_supported:Fe(ee()).optional(),acr_values_supported:Fe(ee()).optional(),subject_types_supported:Fe(ee()),id_token_signing_alg_values_supported:Fe(ee()),id_token_encryption_alg_values_supported:Fe(ee()).optional(),id_token_encryption_enc_values_supported:Fe(ee()).optional(),userinfo_signing_alg_values_supported:Fe(ee()).optional(),userinfo_encryption_alg_values_supported:Fe(ee()).optional(),userinfo_encryption_enc_values_supported:Fe(ee()).optional(),request_object_signing_alg_values_supported:Fe(ee()).optional(),request_object_encryption_alg_values_supported:Fe(ee()).optional(),request_object_encryption_enc_values_supported:Fe(ee()).optional(),token_endpoint_auth_methods_supported:Fe(ee()).optional(),token_endpoint_auth_signing_alg_values_supported:Fe(ee()).optional(),display_values_supported:Fe(ee()).optional(),claim_types_supported:Fe(ee()).optional(),claims_supported:Fe(ee()).optional(),service_documentation:ee().optional(),claims_locales_supported:Fe(ee()).optional(),ui_locales_supported:Fe(ee()).optional(),claims_parameter_supported:dn().optional(),request_parameter_supported:dn().optional(),request_uri_parameter_supported:dn().optional(),require_request_uri_registration:dn().optional(),op_policy_uri:nr.optional(),op_tos_uri:nr.optional(),client_id_metadata_document_supported:dn().optional()}),uB=je({...cB.shape,...NA.pick({code_challenge_methods_supported:!0}).shape}),dB=je({access_token:ee(),id_token:ee().optional(),token_type:ee(),expires_in:ZD().optional(),scope:ee().optional(),refresh_token:ee().optional()}).strip(),fB=je({error:ee(),error_description:ee().optional(),error_uri:ee().optional()}),ob=nr.optional().or(Ge("").transform(()=>{})),hB=je({redirect_uris:Fe(nr),token_endpoint_auth_method:ee().optional(),grant_types:Fe(ee()).optional(),response_types:Fe(ee()).optional(),client_name:ee().optional(),client_uri:nr.optional(),logo_uri:ob,scope:ee().optional(),contacts:Fe(ee()).optional(),tos_uri:ob,policy_uri:ee().optional(),jwks_uri:nr.optional(),jwks:xD().optional(),software_id:ee().optional(),software_version:ee().optional(),software_statement:ee().optional()}).strip(),pB=je({client_id:ee(),client_secret:ee().optional(),client_id_issued_at:Kt().optional(),client_secret_expires_at:Kt().optional()}).strip(),mB=hB.merge(pB);je({error:ee(),error_description:ee().optional()}).strip();je({token:ee(),token_type_hint:ee().optional()}).strip();function gB(t){const e=typeof t=="string"?new URL(t):new URL(t.href);return e.hash="",e}function _B({requestedResource:t,configuredResource:e}){const n=typeof t=="string"?new URL(t):new URL(t.href),r=typeof e=="string"?new URL(e):new URL(e.href);if(n.origin!==r.origin||n.pathname.length<r.pathname.length)return!1;const i=n.pathname.endsWith("/")?n.pathname:n.pathname+"/",a=r.pathname.endsWith("/")?r.pathname:r.pathname+"/";return i.startsWith(a)}class Jn extends Error{constructor(e,n){super(e),this.errorUri=n,this.name=this.constructor.name}toResponseObject(){const e={error:this.errorCode,error_description:this.message};return this.errorUri&&(e.error_uri=this.errorUri),e}get errorCode(){return this.constructor.errorCode}}class wv extends Jn{}wv.errorCode="invalid_request";class qh extends Jn{}qh.errorCode="invalid_client";class Zh extends Jn{}Zh.errorCode="invalid_grant";class Xh extends Jn{}Xh.errorCode="unauthorized_client";class xv extends Jn{}xv.errorCode="unsupported_grant_type";class Ev extends Jn{}Ev.errorCode="invalid_scope";class bv extends Jn{}bv.errorCode="access_denied";class Ll extends Jn{}Ll.errorCode="server_error";class Tv extends Jn{}Tv.errorCode="temporarily_unavailable";class Mv extends Jn{}Mv.errorCode="unsupported_response_type";class Rv extends Jn{}Rv.errorCode="unsupported_token_type";class Cv extends Jn{}Cv.errorCode="invalid_token";class Av extends Jn{}Av.errorCode="method_not_allowed";class Pv extends Jn{}Pv.errorCode="too_many_requests";class Kh extends Jn{}Kh.errorCode="invalid_client_metadata";class Iv extends Jn{}Iv.errorCode="insufficient_scope";class Nv extends Jn{}Nv.errorCode="invalid_target";const vB={[wv.errorCode]:wv,[qh.errorCode]:qh,[Zh.errorCode]:Zh,[Xh.errorCode]:Xh,[xv.errorCode]:xv,[Ev.errorCode]:Ev,[bv.errorCode]:bv,[Ll.errorCode]:Ll,[Tv.errorCode]:Tv,[Mv.errorCode]:Mv,[Rv.errorCode]:Rv,[Cv.errorCode]:Cv,[Av.errorCode]:Av,[Pv.errorCode]:Pv,[Kh.errorCode]:Kh,[Iv.errorCode]:Iv,[Nv.errorCode]:Nv};class Fi extends Error{constructor(e){super(e??"Unauthorized")}}function yB(t){return["client_secret_basic","client_secret_post","none"].includes(t)}const Wg="code",qg="S256";function SB(t,e){const n=t.client_secret!==void 0;return e.length===0?n?"client_secret_post":"none":"token_endpoint_auth_method"in t&&t.token_endpoint_auth_method&&yB(t.token_endpoint_auth_method)&&e.includes(t.token_endpoint_auth_method)?t.token_endpoint_auth_method:n&&e.includes("client_secret_basic")?"client_secret_basic":n&&e.includes("client_secret_post")?"client_secret_post":e.includes("none")?"none":n?"client_secret_post":"none"}function wB(t,e,n,r){const{client_id:i,client_secret:a}=e;switch(t){case"client_secret_basic":xB(i,a,n);return;case"client_secret_post":EB(i,a,r);return;case"none":bB(i,r);return;default:throw new Error(`Unsupported client authentication method: ${t}`)}}function xB(t,e,n){if(!e)throw new Error("client_secret_basic authentication requires a client_secret");const r=btoa(`${t}:${e}`);n.set("Authorization",`Basic ${r}`)}function EB(t,e,n){n.set("client_id",t),e&&n.set("client_secret",e)}function bB(t,e){e.set("client_id",t)}async function kA(t){const e=t instanceof Response?t.status:void 0,n=t instanceof Response?await t.text():t;try{const r=fB.parse(JSON.parse(n)),{error:i,error_description:a,error_uri:l}=r,c=vB[i]||Ll;return new c(a||"",l)}catch(r){const i=`${e?`HTTP ${e}: `:""}Invalid OAuth error response: ${r}. Raw body: ${n}`;return new Ll(i)}}async function io(t,e){try{return await Zg(t,e)}catch(n){if(n instanceof qh||n instanceof Xh)return await t.invalidateCredentials?.("all"),await Zg(t,e);if(n instanceof Zh)return await t.invalidateCredentials?.("tokens"),await Zg(t,e);throw n}}async function Zg(t,{serverUrl:e,authorizationCode:n,scope:r,resourceMetadataUrl:i,fetchFn:a}){let l,c;try{l=await RB(e,{resourceMetadataUrl:i},a),l.authorization_servers&&l.authorization_servers.length>0&&(c=l.authorization_servers[0])}catch{}c||(c=new URL("/",e));const u=await MB(e,t,l),f=await NB(c,{fetchFn:a});let h=await Promise.resolve(t.clientInformation());if(!h){if(n!==void 0)throw new Error("Existing OAuth client information is required when exchanging an authorization code");const g=f?.client_id_metadata_document_supported===!0,v=t.clientMetadataUrl;if(v&&!TB(v))throw new Kh(`clientMetadataUrl must be a valid HTTPS URL with a non-root pathname, got: ${v}`);if(g&&v)h={client_id:v},await t.saveClientInformation?.(h);else{if(!t.saveClientInformation)throw new Error("OAuth client information must be saveable for dynamic registration");const w=await UB(c,{metadata:f,clientMetadata:t.clientMetadata,fetchFn:a});await t.saveClientInformation(w),h=w}}const p=!t.redirectUrl;if(n!==void 0||p){const g=await DB(t,c,{metadata:f,resource:u,authorizationCode:n,fetchFn:a});return await t.saveTokens(g),"AUTHORIZED"}const m=await t.tokens();if(m?.refresh_token)try{const g=await OB(c,{metadata:f,clientInformation:h,refreshToken:m.refresh_token,resource:u,addClientAuthentication:t.addClientAuthentication,fetchFn:a});return await t.saveTokens(g),"AUTHORIZED"}catch(g){if(!(!(g instanceof Jn)||g instanceof Ll))throw g}const y=t.state?await t.state():void 0,{authorizationUrl:S,codeVerifier:E}=await kB(c,{metadata:f,clientInformation:h,state:y,redirectUrl:t.redirectUrl,scope:r||l?.scopes_supported?.join(" ")||t.clientMetadata.scope,resource:u});return await t.saveCodeVerifier(E),await t.redirectToAuthorization(S),"REDIRECT"}function TB(t){if(!t)return!1;try{const e=new URL(t);return e.protocol==="https:"&&e.pathname!=="/"}catch{return!1}}async function MB(t,e,n){const r=gB(t);if(e.validateResourceURL)return await e.validateResourceURL(r,n?.resource);if(n){if(!_B({requestedResource:r,configuredResource:n.resource}))throw new Error(`Protected resource ${n.resource} does not match expected ${r} (or origin)`);return new URL(n.resource)}}function Yh(t){const e=t.headers.get("WWW-Authenticate");if(!e)return{};const[n,r]=e.split(" ");if(n.toLowerCase()!=="bearer"||!r)return{};const i=Xg(t,"resource_metadata")||void 0;let a;if(i)try{a=new URL(i)}catch{}const l=Xg(t,"scope")||void 0,c=Xg(t,"error")||void 0;return{resourceMetadataUrl:a,scope:l,error:c}}function Xg(t,e){const n=t.headers.get("WWW-Authenticate");if(!n)return null;const r=new RegExp(`${e}=(?:"([^"]+)"|([^\\s,]+))`),i=n.match(r);return i?i[1]||i[2]:null}async function RB(t,e,n=fetch){const r=await PB(t,"oauth-protected-resource",n,{protocolVersion:e?.protocolVersion,metadataUrl:e?.resourceMetadataUrl});if(!r||r.status===404)throw await r?.body?.cancel(),new Error("Resource server does not implement OAuth 2.0 Protected Resource Metadata.");if(!r.ok)throw await r.body?.cancel(),new Error(`HTTP ${r.status} trying to load well-known OAuth protected resource metadata.`);return lB.parse(await r.json())}async function Fy(t,e,n=fetch){try{return await n(t,{headers:e})}catch(r){if(r instanceof TypeError)return e?Fy(t,void 0,n):void 0;throw r}}function CB(t,e="",n={}){return e.endsWith("/")&&(e=e.slice(0,-1)),n.prependPathname?`${e}/.well-known/${t}`:`/.well-known/${t}${e}`}async function lb(t,e,n=fetch){return await Fy(t,{"MCP-Protocol-Version":e},n)}function AB(t,e){return!t||t.status>=400&&t.status<500&&e!=="/"}async function PB(t,e,n,r){const i=new URL(t),a=r?.protocolVersion??bp;let l;if(r?.metadataUrl)l=new URL(r.metadataUrl);else{const u=CB(e,i.pathname);l=new URL(u,r?.metadataServerUrl??i),l.search=i.search}let c=await lb(l,a,n);if(!r?.metadataUrl&&AB(c,i.pathname)){const u=new URL(`/.well-known/${e}`,i);c=await lb(u,a,n)}return c}function IB(t){const e=typeof t=="string"?new URL(t):t,n=e.pathname!=="/",r=[];if(!n)return r.push({url:new URL("/.well-known/oauth-authorization-server",e.origin),type:"oauth"}),r.push({url:new URL("/.well-known/openid-configuration",e.origin),type:"oidc"}),r;let i=e.pathname;return i.endsWith("/")&&(i=i.slice(0,-1)),r.push({url:new URL(`/.well-known/oauth-authorization-server${i}`,e.origin),type:"oauth"}),r.push({url:new URL(`/.well-known/openid-configuration${i}`,e.origin),type:"oidc"}),r.push({url:new URL(`${i}/.well-known/openid-configuration`,e.origin),type:"oidc"}),r}async function NB(t,{fetchFn:e=fetch,protocolVersion:n=bp}={}){const r={"MCP-Protocol-Version":n,Accept:"application/json"},i=IB(t);for(const{url:a,type:l}of i){const c=await Fy(a,r,e);if(c){if(!c.ok){if(await c.body?.cancel(),c.status>=400&&c.status<500)continue;throw new Error(`HTTP ${c.status} trying to load ${l==="oauth"?"OAuth":"OpenID provider"} metadata from ${a}`)}return l==="oauth"?NA.parse(await c.json()):uB.parse(await c.json())}}}async function kB(t,{metadata:e,clientInformation:n,redirectUrl:r,scope:i,state:a,resource:l}){let c;if(e){if(c=new URL(e.authorization_endpoint),!e.response_types_supported.includes(Wg))throw new Error(`Incompatible auth server: does not support response type ${Wg}`);if(e.code_challenge_methods_supported&&!e.code_challenge_methods_supported.includes(qg))throw new Error(`Incompatible auth server: does not support code challenge method ${qg}`)}else c=new URL("/authorize",t);const u=await oB(),f=u.code_verifier,h=u.code_challenge;return c.searchParams.set("response_type",Wg),c.searchParams.set("client_id",n.client_id),c.searchParams.set("code_challenge",h),c.searchParams.set("code_challenge_method",qg),c.searchParams.set("redirect_uri",String(r)),a&&c.searchParams.set("state",a),i&&c.searchParams.set("scope",i),i?.includes("offline_access")&&c.searchParams.append("prompt","consent"),l&&c.searchParams.set("resource",l.href),{authorizationUrl:c,codeVerifier:f}}function LB(t,e,n){return new URLSearchParams({grant_type:"authorization_code",code:t,code_verifier:e,redirect_uri:String(n)})}async function LA(t,{metadata:e,tokenRequestParams:n,clientInformation:r,addClientAuthentication:i,resource:a,fetchFn:l}){const c=e?.token_endpoint?new URL(e.token_endpoint):new URL("/token",t),u=new Headers({"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"});if(a&&n.set("resource",a.href),i)await i(u,n,c,e);else if(r){const h=e?.token_endpoint_auth_methods_supported??[],p=SB(r,h);wB(p,r,u,n)}const f=await(l??fetch)(c,{method:"POST",headers:u,body:n});if(!f.ok)throw await kA(f);return dB.parse(await f.json())}async function OB(t,{metadata:e,clientInformation:n,refreshToken:r,resource:i,addClientAuthentication:a,fetchFn:l}){const c=new URLSearchParams({grant_type:"refresh_token",refresh_token:r}),u=await LA(t,{metadata:e,tokenRequestParams:c,clientInformation:n,addClientAuthentication:a,resource:i,fetchFn:l});return{refresh_token:r,...u}}async function DB(t,e,{metadata:n,resource:r,authorizationCode:i,fetchFn:a}={}){const l=t.clientMetadata.scope;let c;if(t.prepareTokenRequest&&(c=await t.prepareTokenRequest(l)),!c){if(!i)throw new Error("Either provider.prepareTokenRequest() or authorizationCode is required");if(!t.redirectUrl)throw new Error("redirectUrl is required for authorization_code flow");const f=await t.codeVerifier();c=LB(i,f,t.redirectUrl)}const u=await t.clientInformation();return LA(e,{metadata:n,tokenRequestParams:c,clientInformation:u??void 0,addClientAuthentication:t.addClientAuthentication,resource:r,fetchFn:a})}async function UB(t,{metadata:e,clientMetadata:n,fetchFn:r}){let i;if(e){if(!e.registration_endpoint)throw new Error("Incompatible auth server: does not support dynamic client registration");i=new URL(e.registration_endpoint)}else i=new URL("/register",t);const a=await(r??fetch)(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!a.ok)throw await kA(a);return mB.parse(await a.json())}class FB extends Error{constructor(e,n,r){super(`SSE error: ${n}`),this.code=e,this.event=r}}class zB{constructor(e,n){this._url=e,this._resourceMetadataUrl=void 0,this._scope=void 0,this._eventSourceInit=n?.eventSourceInit,this._requestInit=n?.requestInit,this._authProvider=n?.authProvider,this._fetch=n?.fetch,this._fetchWithInit=IA(n?.fetch,n?.requestInit)}async _authThenStart(){if(!this._authProvider)throw new Fi("No auth provider");let e;try{e=await io(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})}catch(n){throw this.onerror?.(n),n}if(e!=="AUTHORIZED")throw new Fi;return await this._startOrAuth()}async _commonHeaders(){const e={};if(this._authProvider){const r=await this._authProvider.tokens();r&&(e.Authorization=`Bearer ${r.access_token}`)}this._protocolVersion&&(e["mcp-protocol-version"]=this._protocolVersion);const n=Wh(this._requestInit?.headers);return new Headers({...e,...n})}_startOrAuth(){const e=this?._eventSourceInit?.fetch??this._fetch??fetch;return new Promise((n,r)=>{this._eventSource=new wh(this._url.href,{...this._eventSourceInit,fetch:async(i,a)=>{const l=await this._commonHeaders();l.set("Accept","text/event-stream");const c=await e(i,{...a,headers:l});if(c.status===401&&c.headers.has("www-authenticate")){const{resourceMetadataUrl:u,scope:f}=Yh(c);this._resourceMetadataUrl=u,this._scope=f}return c}}),this._abortController=new AbortController,this._eventSource.onerror=i=>{if(i.code===401&&this._authProvider){this._authThenStart().then(n,r);return}const a=new FB(i.code,i.message,i);r(a),this.onerror?.(a)},this._eventSource.onopen=()=>{},this._eventSource.addEventListener("endpoint",i=>{const a=i;try{if(this._endpoint=new URL(a.data,this._url),this._endpoint.origin!==this._url.origin)throw new Error(`Endpoint origin does not match connection origin: ${this._endpoint.origin}`)}catch(l){r(l),this.onerror?.(l),this.close();return}n()}),this._eventSource.onmessage=i=>{const a=i;let l;try{l=vh.parse(JSON.parse(a.data))}catch(c){this.onerror?.(c);return}this.onmessage?.(l)}})}async start(){if(this._eventSource)throw new Error("SSEClientTransport already started! If using Client class, note that connect() calls start() automatically.");return await this._startOrAuth()}async finishAuth(e){if(!this._authProvider)throw new Fi("No auth provider");if(await io(this._authProvider,{serverUrl:this._url,authorizationCode:e,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})!=="AUTHORIZED")throw new Fi("Failed to authorize")}async close(){this._abortController?.abort(),this._eventSource?.close(),this.onclose?.()}async send(e){if(!this._endpoint)throw new Error("Not connected");try{const n=await this._commonHeaders();n.set("content-type","application/json");const r={...this._requestInit,method:"POST",headers:n,body:JSON.stringify(e),signal:this._abortController?.signal},i=await(this._fetch??fetch)(this._endpoint,r);if(!i.ok){const a=await i.text().catch(()=>null);if(i.status===401&&this._authProvider){const{resourceMetadataUrl:l,scope:c}=Yh(i);if(this._resourceMetadataUrl=l,this._scope=c,await io(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})!=="AUTHORIZED")throw new Fi;return this.send(e)}throw new Error(`Error POSTing to endpoint (HTTP ${i.status}): ${a}`)}await i.body?.cancel()}catch(n){throw this.onerror?.(n),n}}setProtocolVersion(e){this._protocolVersion=e}}class $B extends TransformStream{constructor({onError:e,onRetry:n,onComment:r}={}){let i;super({start(a){i=AA({onEvent:l=>{a.enqueue(l)},onError(l){e==="terminate"?a.error(l):typeof e=="function"&&e(l)},onRetry:n,onComment:r})},transform(a){i.feed(a)}})}}const BB={initialReconnectionDelay:1e3,maxReconnectionDelay:3e4,reconnectionDelayGrowFactor:1.5,maxRetries:2};class qo extends Error{constructor(e,n){super(`Streamable HTTP error: ${n}`),this.code=e}}class VB{constructor(e,n){this._hasCompletedAuthFlow=!1,this._url=e,this._resourceMetadataUrl=void 0,this._scope=void 0,this._requestInit=n?.requestInit,this._authProvider=n?.authProvider,this._fetch=n?.fetch,this._fetchWithInit=IA(n?.fetch,n?.requestInit),this._sessionId=n?.sessionId,this._reconnectionOptions=n?.reconnectionOptions??BB}async _authThenStart(){if(!this._authProvider)throw new Fi("No auth provider");let e;try{e=await io(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})}catch(n){throw this.onerror?.(n),n}if(e!=="AUTHORIZED")throw new Fi;return await this._startOrAuthSse({resumptionToken:void 0})}async _commonHeaders(){const e={};if(this._authProvider){const r=await this._authProvider.tokens();r&&(e.Authorization=`Bearer ${r.access_token}`)}this._sessionId&&(e["mcp-session-id"]=this._sessionId),this._protocolVersion&&(e["mcp-protocol-version"]=this._protocolVersion);const n=Wh(this._requestInit?.headers);return new Headers({...e,...n})}async _startOrAuthSse(e){const{resumptionToken:n}=e;try{const r=await this._commonHeaders();r.set("Accept","text/event-stream"),n&&r.set("last-event-id",n);const i=await(this._fetch??fetch)(this._url,{method:"GET",headers:r,signal:this._abortController?.signal});if(!i.ok){if(await i.body?.cancel(),i.status===401&&this._authProvider)return await this._authThenStart();if(i.status===405)return;throw new qo(i.status,`Failed to open SSE stream: ${i.statusText}`)}this._handleSseStream(i.body,e,!0)}catch(r){throw this.onerror?.(r),r}}_getNextReconnectionDelay(e){if(this._serverRetryMs!==void 0)return this._serverRetryMs;const n=this._reconnectionOptions.initialReconnectionDelay,r=this._reconnectionOptions.reconnectionDelayGrowFactor,i=this._reconnectionOptions.maxReconnectionDelay;return Math.min(n*Math.pow(r,e),i)}_scheduleReconnection(e,n=0){const r=this._reconnectionOptions.maxRetries;if(n>=r){this.onerror?.(new Error(`Maximum reconnection attempts (${r}) exceeded.`));return}const i=this._getNextReconnectionDelay(n);this._reconnectionTimeout=setTimeout(()=>{this._startOrAuthSse(e).catch(a=>{this.onerror?.(new Error(`Failed to reconnect SSE stream: ${a instanceof Error?a.message:String(a)}`)),this._scheduleReconnection(e,n+1)})},i)}_handleSseStream(e,n,r){if(!e)return;const{onresumptiontoken:i,replayMessageId:a}=n;let l,c=!1,u=!1;(async()=>{try{const h=e.pipeThrough(new TextDecoderStream).pipeThrough(new $B({onRetry:y=>{this._serverRetryMs=y}})).getReader();for(;;){const{value:y,done:S}=await h.read();if(S)break;if(y.id&&(l=y.id,c=!0,i?.(y.id)),!!y.data&&(!y.event||y.event==="message"))try{const E=vh.parse(JSON.parse(y.data));Wc(E)&&(u=!0,a!==void 0&&(E.id=a)),this.onmessage?.(E)}catch(E){this.onerror?.(E)}}(r||c)&&!u&&this._abortController&&!this._abortController.signal.aborted&&this._scheduleReconnection({resumptionToken:l,onresumptiontoken:i,replayMessageId:a},0)}catch(h){if(this.onerror?.(new Error(`SSE stream disconnected: ${h}`)),(r||c)&&!u&&this._abortController&&!this._abortController.signal.aborted)try{this._scheduleReconnection({resumptionToken:l,onresumptiontoken:i,replayMessageId:a},0)}catch(y){this.onerror?.(new Error(`Failed to reconnect: ${y instanceof Error?y.message:String(y)}`))}}})()}async start(){if(this._abortController)throw new Error("StreamableHTTPClientTransport already started! If using Client class, note that connect() calls start() automatically.");this._abortController=new AbortController}async finishAuth(e){if(!this._authProvider)throw new Fi("No auth provider");if(await io(this._authProvider,{serverUrl:this._url,authorizationCode:e,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})!=="AUTHORIZED")throw new Fi("Failed to authorize")}async close(){this._reconnectionTimeout&&(clearTimeout(this._reconnectionTimeout),this._reconnectionTimeout=void 0),this._abortController?.abort(),this.onclose?.()}async send(e,n){try{const{resumptionToken:r,onresumptiontoken:i}=n||{};if(r){this._startOrAuthSse({resumptionToken:r,replayMessageId:fv(e)?e.id:void 0}).catch(m=>this.onerror?.(m));return}const a=await this._commonHeaders();a.set("content-type","application/json"),a.set("accept","application/json, text/event-stream");const l={...this._requestInit,method:"POST",headers:a,body:JSON.stringify(e),signal:this._abortController?.signal},c=await(this._fetch??fetch)(this._url,l),u=c.headers.get("mcp-session-id");if(u&&(this._sessionId=u),!c.ok){const m=await c.text().catch(()=>null);if(c.status===401&&this._authProvider){if(this._hasCompletedAuthFlow)throw new qo(401,"Server returned 401 after successful authentication");const{resourceMetadataUrl:y,scope:S}=Yh(c);if(this._resourceMetadataUrl=y,this._scope=S,await io(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})!=="AUTHORIZED")throw new Fi;return this._hasCompletedAuthFlow=!0,this.send(e)}if(c.status===403&&this._authProvider){const{resourceMetadataUrl:y,scope:S,error:E}=Yh(c);if(E==="insufficient_scope"){const g=c.headers.get("WWW-Authenticate");if(this._lastUpscopingHeader===g)throw new qo(403,"Server returned 403 after trying upscoping");if(S&&(this._scope=S),y&&(this._resourceMetadataUrl=y),this._lastUpscopingHeader=g??void 0,await io(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetch})!=="AUTHORIZED")throw new Fi;return this.send(e)}}throw new qo(c.status,`Error POSTing to endpoint: ${m}`)}if(this._hasCompletedAuthFlow=!1,this._lastUpscopingHeader=void 0,c.status===202){await c.body?.cancel(),_z(e)&&this._startOrAuthSse({resumptionToken:void 0}).catch(m=>this.onerror?.(m));return}const h=(Array.isArray(e)?e:[e]).filter(m=>"method"in m&&"id"in m&&m.id!==void 0).length>0,p=c.headers.get("content-type");if(h)if(p?.includes("text/event-stream"))this._handleSseStream(c.body,{onresumptiontoken:i},!1);else if(p?.includes("application/json")){const m=await c.json(),y=Array.isArray(m)?m.map(S=>vh.parse(S)):[vh.parse(m)];for(const S of y)this.onmessage?.(S)}else throw await c.body?.cancel(),new qo(-1,`Unexpected content type: ${p}`);else await c.body?.cancel()}catch(r){throw this.onerror?.(r),r}}get sessionId(){return this._sessionId}async terminateSession(){if(this._sessionId)try{const e=await this._commonHeaders(),n={...this._requestInit,method:"DELETE",headers:e,signal:this._abortController?.signal},r=await(this._fetch??fetch)(this._url,n);if(await r.body?.cancel(),!r.ok&&r.status!==405)throw new qo(r.status,`Failed to terminate session: ${r.statusText}`);this._sessionId=void 0}catch(e){throw this.onerror?.(e),e}}setProtocolVersion(e){this._protocolVersion=e}get protocolVersion(){return this._protocolVersion}async resumeStream(e,n){await this._startOrAuthSse({resumptionToken:e,onresumptiontoken:n?.onresumptiontoken})}}class zy{client;transport;transportType;sessionId;endpoint;headers;authProvider;handlers;constructor(e,n,r,i,a,l={}){this.endpoint=e,this.headers=r??{},this.authProvider=i,this.transportType=n,this.handlers=l,this.transport=this.initializeTransport(a),this.client=this.initializeClient()}static async create(e,n=Sa.HTTP,r,i,a,l={}){const c=new zy(e,n,r,i,a,l);return await c.client.connect(c.transport),"sessionId"in c.transport&&(c.sessionId=c.transport.sessionId),c}initializeTransport(e){return this.transportType===Sa.SSE?new zB(new URL(this.endpoint),{authProvider:this.authProvider,requestInit:{headers:this.headers}}):new VB(new URL(this.endpoint),{authProvider:this.authProvider,requestInit:{headers:this.headers},sessionId:e})}initializeClient(){const e=this.handlers.elicitation?{elicitation:{}}:{},n=this.handlers.sampling?{sampling:{}}:{},r=new Q4({name:"tambo-mcp-client",version:"1.0.0"},{capabilities:{...e,...n}});return this.handlers.elicitation&&r.setRequestHandler(tu,this.handlers.elicitation),this.handlers.sampling&&r.setRequestHandler(eu,this.handlers.sampling),r}async listTools(){const e=[];let n=!0,r;for(;n;){const i=await this.client.listTools({cursor:r},{});e.push(...i.tools.map(a=>{if(a.inputSchema.type!=="object")throw new Error(`Input schema for tool ${a.name} is not an object`);return{name:a.name,description:a.description,inputSchema:a.inputSchema}})),i.nextCursor?r=i.nextCursor:n=!1}return e}getServerCapabilities(){return this.client.getServerCapabilities()}getServerVersion(){return this.client.getServerVersion()}getInstructions(){return this.client.getInstructions()}async callTool(e,n,r){return await this.client.callTool({name:e,arguments:n,_meta:r})}updateElicitationHandler(e){if(e!==this.handlers.elicitation){if(e&&!this.handlers.elicitation)throw new Error("Elicitation handler must be set on create");if(this.handlers={...this.handlers,elicitation:e},!e){const n=tu.shape.method.value;this.client.removeRequestHandler(n);return}this.client.setRequestHandler(tu,e)}}updateSamplingHandler(e){if(e!==this.handlers.sampling){if(e&&!this.handlers.sampling)throw new Error("Sampling handler must be set on create");if(this.handlers={...this.handlers,sampling:e},!e){const n=eu.shape.method.value;this.client.removeRequestHandler(n);return}this.client.setRequestHandler(eu,e)}}async close(){await this.transport.close(),await this.client.close()}}function jB(t){if(t==null)return"Unknown error occurred";if(Array.isArray(t)){const e=t.filter(n=>n?.type==="text"&&typeof n.text=="string").map(n=>n.text);return e.length>0?e.join(" "):"Error occurred but no details provided"}return typeof t=="object"?JSON.stringify(t):`${t}`}const OA=V.createContext({servers:[],elicitation:null,resolveElicitation:null}),HB="__tambo_internal_mcp_server__";function GB(t){let e=0;for(let n=0;n<t.length;n++)e=Math.imul(31,e)+t.charCodeAt(n)|0;return(e>>>0).toString(36)}function DA(t){if(t?.client?.close)try{const e=t.client.close();e&&typeof e.catch=="function"&&e.catch(n=>{const r=t.url??"(unknown url)";console.error(`Error closing MCP client for ${r}:`,n)})}catch(e){const n=t.url??"(unknown url)";console.error(`Error closing MCP client for ${n}:`,e)}}function WB(t,e,n){const r={};return t.handlers?.elicitation?r.elicitation=t.handlers.elicitation:e&&(r.elicitation=async(i,a)=>await e(i,a,t)),t.handlers?.sampling?r.sampling=t.handlers.sampling:n&&(r.sampling=async(i,a)=>await n(i,a,t)),r}function qB(t,e,n){return V.useMemo(()=>{const r=new Map;if(t.forEach(i=>{const a=cb(i,Qc.BROWSER_SIDE);r.set(a.key,a)}),e&&n){const i=new URL(n);i.pathname=`${i.pathname.replace(/\/+$/,"")}/mcp`;const a=i.toString(),l=GB(e),c={name:HB,url:a,transport:Sa.HTTP,serverKey:`tambo-${l}`,customHeaders:{Authorization:`Bearer ${e}`}},u=cb(c,Qc.TAMBO_INTERNAL);r.set(u.key,u)}return r},[t,e,n])}async function ZB(t,e,n,r,i,a,l){const{toolOwnerRef:c,keyToToolsRef:u}=a;try{(await t.listTools()).forEach(h=>{const p=r?`${e.serverKey}__${h.name}`:h.name,m=c.current.get(p);m&&m!==n||(m||(c.current.set(p,n),u.current.has(n)||u.current.set(n,new Set),u.current.get(n).add(p)),l({description:h.description??"",name:p,tool:async(y={})=>{const S=i.get(n);if(!S?.client)throw new Error(`MCP server for tool ${h.name} is not connected`);const E=await S.client.callTool(h.name,y);if(E.isError){const g=jB(E.content);throw new Error(g)}return E.content},inputSchema:h.inputSchema??{},outputSchema:{},transformToContent:y=>FF(y)?y:[{type:"text",text:dv(y)}],..."maxCalls"in h&&h.maxCalls!==void 0?{maxCalls:h.maxCalls}:{}}))})}catch(f){console.error(`Failed to register tools from MCP server ${e.url}:`,f)}}function XB(t,e){const{toolOwnerRef:n,keyToToolsRef:r}=e,i=r.current.get(t);if(i){for(const a of i)n.current.delete(a);r.current.delete(t)}}const KB=({handlers:t,contextKey:e,children:n})=>{const{registerTool:r}=Tu(),{mcpAccessToken:i,tamboBaseUrl:a}=YF(e),l=t3(),c=t?.sampling,{elicitation:u,resolveElicitation:f,defaultElicitationHandler:h}=QF(),p=t?.elicitation??h,m=V.useRef(new Map),y=V.useRef(new Map),S=V.useRef(new Map),E={toolOwnerRef:y,keyToToolsRef:S},[g,v]=V.useState([]),x=qB(l,i,a);YB(x,m,E,p,c,r,v),JB(x,m,p,c),QB(m,E);const w=V.useMemo(()=>({servers:g,elicitation:u,resolveElicitation:f}),[g,u,f]);return qt.createElement(OA.Provider,{value:w},n)};function YB(t,e,n,r,i,a,l){V.useEffect(()=>{const c=e.current,u=new Set(t.keys()),f=new Set(c.keys()),h=Array.from(f).filter(y=>!u.has(y));h.forEach(y=>{const S=c.get(y);S&&DA(S),XB(y,n),c.delete(y)});const p=Array.from(u).filter(y=>!f.has(y));async function m(y){await Promise.allSettled(y.map(async S=>{const E=t.get(S);try{const g=WB(E,r,i),v=await zy.create(E.url,E.transport,E.customHeaders,void 0,void 0,g),x={...E,client:v};c.set(S,x),l(Array.from(c.values()));const w=t.size>1;await ZB(v,E,S,w,c,n,a)}catch(g){const v={...E,connectionError:g};c.set(S,v),l(Array.from(c.values())),console.error(`Failed to connect to MCP server ${E.url}:`,g)}}))}p.length>0&&m(p).catch(y=>{console.error("Unexpected error in addClients:",y)}),h.length>0&&l(Array.from(c.values()))},[t,r,i,a])}function JB(t,e,n,r){V.useEffect(()=>{e.current.forEach((a,l)=>{if(!a.client)return;const c=t.get(l);if(!c)return;const u=c.handlers?.elicitation??(n?async(h,p)=>await n(h,p,c):void 0),f=c.handlers?.sampling??(r?async(h,p)=>await r(h,p,c):void 0);a.client.updateElicitationHandler?.(u),a.client.updateSamplingHandler?.(f)})},[t,n,r])}function QB(t,e){V.useEffect(()=>{const n=t.current,{toolOwnerRef:r,keyToToolsRef:i}=e;return()=>{n.forEach(a=>{DA(a)}),n.clear(),r.current.clear(),i.current.clear()}},[])}const eV=()=>V.useContext(OA).servers;function cb(t,e){const n=XR(t),r=t.handlers;return{...t,handlers:r,key:n,serverType:e}}const UA=V.createContext({registerComponent:()=>{},registerTool:()=>{},registerTools:()=>{},addToolAssociation:()=>{}}),tV=({children:t})=>{const e=jC(),{registerComponent:n,addToolAssociation:r,registerTool:i,registerTools:a}=Tu(),l={client:e,registerComponent:n,registerTool:i,registerTools:a,addToolAssociation:r};return qt.createElement(UA.Provider,{value:l},t)},nV=()=>V.useContext(UA),FA=V.createContext(null),ub="contextAttachments";function rV({children:t}){const{addContextHelper:e,removeContextHelper:n}=gp(),[r,i]=V.useState([]);V.useEffect(()=>(e(ub,()=>r.length===0?null:r.map(f=>({id:f.id,displayName:f.displayName,context:f.context,type:f.type}))),()=>{n(ub)}),[r,e,n]);const a=V.useCallback(f=>{const p={id:crypto.randomUUID(),displayName:f.displayName,context:f.context,type:f.type};return i(m=>[...m,p]),p},[]),l=V.useCallback(f=>{i(h=>h.filter(p=>p.id!==f))},[]),c=V.useCallback(()=>{i([])},[]),u=V.useMemo(()=>({attachments:r,addContextAttachment:a,removeContextAttachment:l,clearContextAttachments:c}),[r,a,l,c]);return qt.createElement(FA.Provider,{value:u},t)}function iV(){const t=V.useContext(FA);if(!t)throw new Error("useTamboContextAttachment must be used within a TamboContextAttachmentProvider");return t}function sV(t){const e=HC();return IF(t,e)}class Zo extends ni{}const aV=/@([a-zA-Z0-9-]+):(\S+)/g;function oV(t,e,n){const r=[],i=Array.from(t.matchAll(aV));let a=0;for(const l of i){const[c,u,f]=l,h=`${u}:${f}`;if(l.index!==void 0&&l.index>a){const S=t.slice(a,l.index);S.length>0&&r.push({type:"text",text:S})}const p={uri:f},m=e[h];m&&(p.name=m);const y=n?.get(h);if(y?.contents?.[0]){const S=y.contents[0];"text"in S&&S.text?p.text=S.text:"blob"in S&&S.blob&&(p.blob=S.blob),"mimeType"in S&&S.mimeType&&(p.mimeType=S.mimeType)}r.push({type:"resource",resource:p}),l.index!==void 0&&(a=l.index+c.length)}if(a<t.length){const l=t.slice(a);l.length>0&&r.push({type:"text",text:l})}return r.length===0&&t.trim()&&r.push({type:"text",text:t}),r}function lV(t,e,n={},r){const i=[];if(t.trim().length>0){const l=oV(t,n,r);i.push(...l)}for(const l of e)i.push({type:"image_url",image_url:{url:l.dataUrl}});if(i.length===0)throw new Error("Message must contain text or images");return i}function cV(t){return"client"in t&&t.client!=null}async function uV(t,e,n){const r=new Map,i=t.map(async a=>{const l=a.indexOf(":");if(l===-1)return;const c=a.slice(0,l),u=a.slice(l+1);try{if(c===DF){if(!n){console.warn(`No resource source available to resolve registry resource: ${a}`);return}const h=await n.getResource(u);h&&r.set(a,h);return}const f=e.find(h=>h.serverKey===c);if(!f){console.warn(`No server found for resource: ${a}`);return}switch(f.serverType){case Qc.TAMBO_INTERNAL:return;case Qc.TAMBO_REGISTRY:return;case Qc.BROWSER_SIDE:{if(!cV(f)){console.warn(`MCP server not connected for resource: ${a}`);return}const h=await f.client.client.readResource({uri:u});h&&r.set(a,h);return}}}catch(f){console.warn(`Failed to fetch resource content for ${a}:`,f)}});return await Promise.all(i),r}function dV(t){const e=/@([a-zA-Z0-9-]+):(\S+)/g;return Array.from(t.matchAll(e)).map(([,r,i])=>`${r}:${i}`)}const db={EMPTY:"Message cannot be empty",VALIDATION:"Invalid message format"},fV=V.createContext(void 0),hV=({children:t})=>{const{thread:e,sendThreadMessage:n,contextKey:r}=WC(),[i,a]=V.useState(""),l=l3(),c=eV(),{resourceSource:u}=Tu(),{clearInteractableSelections:f}=JR(),h=V.useCallback(async({streamResponse:E,forceToolChoice:g,additionalContext:v,resourceNames:x={}}={})=>{if(i?.trim()){const M=c3(i);if(!M.isValid)throw new Zo(`Cannot submit message: ${M.error??db.VALIDATION}`,{cause:M.error})}if(!i.trim()&&l.images.length===0)throw new Zo(db.EMPTY,{cause:"No text or images to send"});const w=dV(i),C=await uV(w,c,u??void 0),T=lV(i,l.images,x,C);try{await n(i||"Image message",{threadId:e.id,contextKey:r,streamResponse:E,forceToolChoice:g,additionalContext:v,content:T}),f()}catch(M){if(l.images.length>0){const A=M instanceof Error?M.message.toLowerCase():"";if(A.includes("unknown content part type: image"))throw new Zo("Image attachments are not yet supported by the backend. This feature is coming soon.",{cause:M});if(A.includes("does not support image message content types")||A.includes("invalid model")&&A.includes("image_url is only supported by certain models"))throw new Zo("This model doesn't support images. Please use GPT-4o, GPT-4 Turbo, or other vision-capable models.",{cause:M});if(A.includes("does not support image")||A.includes("vision not supported"))throw new Zo("This Claude model doesn't support images. Please use Claude 3.5 Sonnet, Claude 3 Opus, or other vision-capable models.",{cause:M});if(A.includes("image")||A.includes("vision"))throw new Zo("This model doesn't support image attachments. Please use a vision-capable model.",{cause:M})}throw M}a("")},[i,n,e.id,r,l,c,u,f]),{mutateAsync:p,mutate:m,...y}=sV({mutationKey:["thread-input",e.id],mutationFn:h}),S={...y,value:i,setValue:a,submit:p,images:l.images,addImage:l.addImage,addImages:l.addImages,removeImage:l.removeImage,clearImages:l.clearImages};return qt.createElement(fV.Provider,{value:S},t)},pV=({children:t,tamboUrl:e,apiKey:n,userToken:r,components:i,environment:a,tools:l,mcpServers:c,streaming:u,autoGenerateThreadName:f,autoGenerateNameThreshold:h,contextHelpers:p,contextKey:m,initialMessages:y,onCallUnregisteredTool:S,getResource:E,listResources:g,resources:v})=>qt.createElement(OF,{tamboUrl:e,apiKey:n,environment:a,userToken:r},qt.createElement(e3,{components:i,tools:l,mcpServers:c,onCallUnregisteredTool:S,getResource:E,listResources:g,resources:v},qt.createElement(r3,{contextHelpers:p},qt.createElement(ZF,{contextKey:m,streaming:u,autoGenerateThreadName:f,autoGenerateNameThreshold:h,initialMessages:y},qt.createElement(KF,null,qt.createElement(KB,{contextKey:m},qt.createElement(rV,null,qt.createElement(tV,null,qt.createElement(i3,null,qt.createElement(hV,null,qt.createElement(gV,null,t))))))))))),mV=V.createContext({}),gV=({children:t})=>{const e=WC(),n=V.useContext(Hl);if(!n)throw new Error("TamboCompositeProvider must be used within a TamboClientProvider");const{client:r,queryClient:i,isUpdatingToken:a}=n,l=nV(),c=JR(),u=gp(),f=iV();return qt.createElement(mV.Provider,{value:{client:r,queryClient:i,isUpdatingToken:a,...l,...e,...c,...u,...f}},t)},_V=Pt({title:it().describe("Main headline - product value proposition"),description:it().describe("Clear explanation of what TrendPulse does"),subtleHint:it().describe('Progression cue text (e.g. "Scroll to explore")'),introState:rs(["idle","ready"]).describe("Controls progression cue visibility - ready shows cue, idle hides it")});function vV({title:t,description:e,subtleHint:n,introState:r}){return q.jsxs("section",{className:"intro-section",children:[q.jsxs("div",{className:"intro-content",children:[q.jsx("h1",{className:"intro-title",children:t}),q.jsx("p",{className:"intro-description",children:e}),q.jsxs("div",{className:"progression-cue","data-state":r,children:[q.jsx("span",{className:"progression-text",children:n}),q.jsx("div",{className:"progression-arrow",children:q.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:q.jsx("path",{d:"M12 5V19M12 19L5 12M12 19L19 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),q.jsx("div",{className:"intro-boundary"})]})}const yV=Pt({features:ji(Pt({icon:it().describe("Emoji or icon for the feature"),title:it().describe("Feature title"),description:it().describe("Brief description")})).describe("List of features to highlight")});function SV({features:t}){return q.jsx("section",{className:"feature-highlights",children:q.jsxs("div",{className:"features-container",children:[q.jsx("h2",{className:"features-heading",children:"What you can do"}),q.jsx("div",{className:"features-grid",children:t.map((e,n)=>q.jsxs("div",{className:"feature-card",children:[q.jsx("div",{className:"feature-icon",children:e.icon}),q.jsx("h3",{className:"feature-title",children:e.title}),q.jsx("p",{className:"feature-description",children:e.description})]},n))})]})})}Pt({headline:it().describe("CTA headline"),buttonText:it().describe("Button text"),onNavigate:du().args().returns(uu()).optional().describe("Navigation handler")});function wV({headline:t,buttonText:e,onNavigate:n}){const r=()=>{n&&n()};return q.jsx("section",{className:"research-cta",children:q.jsxs("div",{className:"research-cta-content",children:[q.jsx("h2",{className:"research-cta-headline",children:t}),q.jsxs("button",{className:"research-cta-button",onClick:r,children:[e,q.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"research-cta-arrow",children:q.jsx("path",{d:"M5 12H19M19 12L12 5M19 12L12 19",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})]})})}const $y="160",xV=0,fb=1,EV=2,zA=1,bV=2,Ms=3,wa=0,ar=1,Cs=2,ga=0,Ml=1,hb=2,pb=3,mb=4,TV=5,eo=100,MV=101,RV=102,gb=103,_b=104,CV=200,AV=201,PV=202,IV=203,kv=204,Lv=205,NV=206,kV=207,LV=208,OV=209,DV=210,UV=211,FV=212,zV=213,$V=214,BV=0,VV=1,jV=2,Jh=3,HV=4,GV=5,WV=6,qV=7,$A=0,ZV=1,XV=2,_a=0,KV=1,YV=2,JV=3,QV=4,ej=5,tj=6,BA=300,Ol=301,Dl=302,Ov=303,Dv=304,Np=306,Uv=1e3,Bi=1001,Fv=1002,Cr=1003,vb=1004,Kg=1005,mi=1006,nj=1007,vu=1008,va=1009,rj=1010,ij=1011,By=1012,VA=1013,ha=1014,pa=1015,yu=1016,jA=1017,HA=1018,ao=1020,sj=1021,Vi=1023,aj=1024,oj=1025,oo=1026,Ul=1027,lj=1028,GA=1029,cj=1030,WA=1031,qA=1033,Yg=33776,Jg=33777,Qg=33778,e_=33779,yb=35840,Sb=35841,wb=35842,xb=35843,ZA=36196,Eb=37492,bb=37496,Tb=37808,Mb=37809,Rb=37810,Cb=37811,Ab=37812,Pb=37813,Ib=37814,Nb=37815,kb=37816,Lb=37817,Ob=37818,Db=37819,Ub=37820,Fb=37821,t_=36492,zb=36494,$b=36495,uj=36283,Bb=36284,Vb=36285,jb=36286,XA=3e3,lo=3001,dj=3200,fj=3201,KA=0,hj=1,_i="",rr="srgb",Os="srgb-linear",Vy="display-p3",kp="display-p3-linear",Qh="linear",mn="srgb",ep="rec709",tp="p3",Xo=7680,Hb=519,pj=512,mj=513,gj=514,YA=515,_j=516,vj=517,yj=518,Sj=519,Gb=35044,Wb="300 es",zv=1035,As=2e3,np=2001;class Wl{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(n)===-1&&r[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const a=i.indexOf(n);a!==-1&&i.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let a=0,l=i.length;a<l;a++)i[a].call(this,e);e.target=null}}}const pr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],n_=Math.PI/180,$v=180/Math.PI;function Nu(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(pr[t&255]+pr[t>>8&255]+pr[t>>16&255]+pr[t>>24&255]+"-"+pr[e&255]+pr[e>>8&255]+"-"+pr[e>>16&15|64]+pr[e>>24&255]+"-"+pr[n&63|128]+pr[n>>8&255]+"-"+pr[n>>16&255]+pr[n>>24&255]+pr[r&255]+pr[r>>8&255]+pr[r>>16&255]+pr[r>>24&255]).toLowerCase()}function Vr(t,e,n){return Math.max(e,Math.min(n,t))}function wj(t,e){return(t%e+e)%e}function r_(t,e,n){return(1-n)*t+n*e}function qb(t){return(t&t-1)===0&&t!==0}function Bv(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Oc(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function $r(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}class sn{constructor(e=0,n=0){sn.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,r=this.y,i=e.elements;return this.x=i[0]*n+i[3]*r+i[6],this.y=i[1]*n+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(Vr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y;return n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const r=Math.cos(n),i=Math.sin(n),a=this.x-e.x,l=this.y-e.y;return this.x=a*r-l*i+e.x,this.y=a*i+l*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Dt{constructor(e,n,r,i,a,l,c,u,f){Dt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,r,i,a,l,c,u,f)}set(e,n,r,i,a,l,c,u,f){const h=this.elements;return h[0]=e,h[1]=i,h[2]=c,h[3]=n,h[4]=a,h[5]=u,h[6]=r,h[7]=l,h[8]=f,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this}extractBasis(e,n,r){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,i=n.elements,a=this.elements,l=r[0],c=r[3],u=r[6],f=r[1],h=r[4],p=r[7],m=r[2],y=r[5],S=r[8],E=i[0],g=i[3],v=i[6],x=i[1],w=i[4],C=i[7],T=i[2],M=i[5],A=i[8];return a[0]=l*E+c*x+u*T,a[3]=l*g+c*w+u*M,a[6]=l*v+c*C+u*A,a[1]=f*E+h*x+p*T,a[4]=f*g+h*w+p*M,a[7]=f*v+h*C+p*A,a[2]=m*E+y*x+S*T,a[5]=m*g+y*w+S*M,a[8]=m*v+y*C+S*A,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[1],i=e[2],a=e[3],l=e[4],c=e[5],u=e[6],f=e[7],h=e[8];return n*l*h-n*c*f-r*a*h+r*c*u+i*a*f-i*l*u}invert(){const e=this.elements,n=e[0],r=e[1],i=e[2],a=e[3],l=e[4],c=e[5],u=e[6],f=e[7],h=e[8],p=h*l-c*f,m=c*u-h*a,y=f*a-l*u,S=n*p+r*m+i*y;if(S===0)return this.set(0,0,0,0,0,0,0,0,0);const E=1/S;return e[0]=p*E,e[1]=(i*f-h*r)*E,e[2]=(c*r-i*l)*E,e[3]=m*E,e[4]=(h*n-i*u)*E,e[5]=(i*a-c*n)*E,e[6]=y*E,e[7]=(r*u-f*n)*E,e[8]=(l*n-r*a)*E,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,r,i,a,l,c){const u=Math.cos(a),f=Math.sin(a);return this.set(r*u,r*f,-r*(u*l+f*c)+l+e,-i*f,i*u,-i*(-f*l+u*c)+c+n,0,0,1),this}scale(e,n){return this.premultiply(i_.makeScale(e,n)),this}rotate(e){return this.premultiply(i_.makeRotation(-e)),this}translate(e,n){return this.premultiply(i_.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,r,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,r=e.elements;for(let i=0;i<9;i++)if(n[i]!==r[i])return!1;return!0}fromArray(e,n=0){for(let r=0;r<9;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const i_=new Dt;function JA(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function rp(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function xj(){const t=rp("canvas");return t.style.display="block",t}const Zb={};function iu(t){t in Zb||(Zb[t]=!0,console.warn(t))}const Xb=new Dt().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Kb=new Dt().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Bf={[Os]:{transfer:Qh,primaries:ep,toReference:t=>t,fromReference:t=>t},[rr]:{transfer:mn,primaries:ep,toReference:t=>t.convertSRGBToLinear(),fromReference:t=>t.convertLinearToSRGB()},[kp]:{transfer:Qh,primaries:tp,toReference:t=>t.applyMatrix3(Kb),fromReference:t=>t.applyMatrix3(Xb)},[Vy]:{transfer:mn,primaries:tp,toReference:t=>t.convertSRGBToLinear().applyMatrix3(Kb),fromReference:t=>t.applyMatrix3(Xb).convertLinearToSRGB()}},Ej=new Set([Os,kp]),on={enabled:!0,_workingColorSpace:Os,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(t){if(!Ej.has(t))throw new Error(`Unsupported working color space, "${t}".`);this._workingColorSpace=t},convert:function(t,e,n){if(this.enabled===!1||e===n||!e||!n)return t;const r=Bf[e].toReference,i=Bf[n].fromReference;return i(r(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this._workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this._workingColorSpace)},getPrimaries:function(t){return Bf[t].primaries},getTransfer:function(t){return t===_i?Qh:Bf[t].transfer}};function Rl(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function s_(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let Ko;class QA{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{Ko===void 0&&(Ko=rp("canvas")),Ko.width=e.width,Ko.height=e.height;const r=Ko.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=Ko}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=rp("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),a=i.data;for(let l=0;l<a.length;l++)a[l]=Rl(a[l]/255)*255;return r.putImageData(i,0,0),n}else if(e.data){const n=e.data.slice(0);for(let r=0;r<n.length;r++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[r]=Math.floor(Rl(n[r]/255)*255):n[r]=Rl(n[r]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let bj=0;class e1{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:bj++}),this.uuid=Nu(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let a;if(Array.isArray(i)){a=[];for(let l=0,c=i.length;l<c;l++)i[l].isDataTexture?a.push(a_(i[l].image)):a.push(a_(i[l]))}else a=a_(i);r.url=a}return n||(e.images[this.uuid]=r),r}}function a_(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?QA.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Tj=0;class ti extends Wl{constructor(e=ti.DEFAULT_IMAGE,n=ti.DEFAULT_MAPPING,r=Bi,i=Bi,a=mi,l=vu,c=Vi,u=va,f=ti.DEFAULT_ANISOTROPY,h=_i){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Tj++}),this.uuid=Nu(),this.name="",this.source=new e1(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=a,this.minFilter=l,this.anisotropy=f,this.format=c,this.internalFormat=null,this.type=u,this.offset=new sn(0,0),this.repeat=new sn(1,1),this.center=new sn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Dt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof h=="string"?this.colorSpace=h:(iu("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=h===lo?rr:_i),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==BA)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Uv:e.x=e.x-Math.floor(e.x);break;case Bi:e.x=e.x<0?0:1;break;case Fv:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Uv:e.y=e.y-Math.floor(e.y);break;case Bi:e.y=e.y<0?0:1;break;case Fv:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return iu("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===rr?lo:XA}set encoding(e){iu("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===lo?rr:_i}}ti.DEFAULT_IMAGE=null;ti.DEFAULT_MAPPING=BA;ti.DEFAULT_ANISOTROPY=1;class sr{constructor(e=0,n=0,r=0,i=1){sr.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,r,i){return this.x=e,this.y=n,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,r=this.y,i=this.z,a=this.w,l=e.elements;return this.x=l[0]*n+l[4]*r+l[8]*i+l[12]*a,this.y=l[1]*n+l[5]*r+l[9]*i+l[13]*a,this.z=l[2]*n+l[6]*r+l[10]*i+l[14]*a,this.w=l[3]*n+l[7]*r+l[11]*i+l[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,r,i,a;const u=e.elements,f=u[0],h=u[4],p=u[8],m=u[1],y=u[5],S=u[9],E=u[2],g=u[6],v=u[10];if(Math.abs(h-m)<.01&&Math.abs(p-E)<.01&&Math.abs(S-g)<.01){if(Math.abs(h+m)<.1&&Math.abs(p+E)<.1&&Math.abs(S+g)<.1&&Math.abs(f+y+v-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const w=(f+1)/2,C=(y+1)/2,T=(v+1)/2,M=(h+m)/4,A=(p+E)/4,F=(S+g)/4;return w>C&&w>T?w<.01?(r=0,i=.707106781,a=.707106781):(r=Math.sqrt(w),i=M/r,a=A/r):C>T?C<.01?(r=.707106781,i=0,a=.707106781):(i=Math.sqrt(C),r=M/i,a=F/i):T<.01?(r=.707106781,i=.707106781,a=0):(a=Math.sqrt(T),r=A/a,i=F/a),this.set(r,i,a,n),this}let x=Math.sqrt((g-S)*(g-S)+(p-E)*(p-E)+(m-h)*(m-h));return Math.abs(x)<.001&&(x=1),this.x=(g-S)/x,this.y=(p-E)/x,this.z=(m-h)/x,this.w=Math.acos((f+y+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this.w=e.w+(n.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Mj extends Wl{constructor(e=1,n=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new sr(0,0,e,n),this.scissorTest=!1,this.viewport=new sr(0,0,e,n);const i={width:e,height:n,depth:1};r.encoding!==void 0&&(iu("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===lo?rr:_i),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:mi,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},r),this.texture=new ti(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps,this.texture.internalFormat=r.internalFormat,this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}setSize(e,n,r=1){(this.width!==e||this.height!==n||this.depth!==r)&&(this.width=e,this.height=n,this.depth=r,this.texture.image.width=e,this.texture.image.height=n,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const n=Object.assign({},e.texture.image);return this.texture.source=new e1(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class po extends Mj{constructor(e=1,n=1,r={}){super(e,n,r),this.isWebGLRenderTarget=!0}}class t1 extends ti{constructor(e=null,n=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:r,depth:i},this.magFilter=Cr,this.minFilter=Cr,this.wrapR=Bi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Rj extends ti{constructor(e=null,n=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:r,depth:i},this.magFilter=Cr,this.minFilter=Cr,this.wrapR=Bi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ku{constructor(e=0,n=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=i}static slerpFlat(e,n,r,i,a,l,c){let u=r[i+0],f=r[i+1],h=r[i+2],p=r[i+3];const m=a[l+0],y=a[l+1],S=a[l+2],E=a[l+3];if(c===0){e[n+0]=u,e[n+1]=f,e[n+2]=h,e[n+3]=p;return}if(c===1){e[n+0]=m,e[n+1]=y,e[n+2]=S,e[n+3]=E;return}if(p!==E||u!==m||f!==y||h!==S){let g=1-c;const v=u*m+f*y+h*S+p*E,x=v>=0?1:-1,w=1-v*v;if(w>Number.EPSILON){const T=Math.sqrt(w),M=Math.atan2(T,v*x);g=Math.sin(g*M)/T,c=Math.sin(c*M)/T}const C=c*x;if(u=u*g+m*C,f=f*g+y*C,h=h*g+S*C,p=p*g+E*C,g===1-c){const T=1/Math.sqrt(u*u+f*f+h*h+p*p);u*=T,f*=T,h*=T,p*=T}}e[n]=u,e[n+1]=f,e[n+2]=h,e[n+3]=p}static multiplyQuaternionsFlat(e,n,r,i,a,l){const c=r[i],u=r[i+1],f=r[i+2],h=r[i+3],p=a[l],m=a[l+1],y=a[l+2],S=a[l+3];return e[n]=c*S+h*p+u*y-f*m,e[n+1]=u*S+h*m+f*p-c*y,e[n+2]=f*S+h*y+c*m-u*p,e[n+3]=h*S-c*p-u*m-f*y,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,r,i){return this._x=e,this._y=n,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const r=e._x,i=e._y,a=e._z,l=e._order,c=Math.cos,u=Math.sin,f=c(r/2),h=c(i/2),p=c(a/2),m=u(r/2),y=u(i/2),S=u(a/2);switch(l){case"XYZ":this._x=m*h*p+f*y*S,this._y=f*y*p-m*h*S,this._z=f*h*S+m*y*p,this._w=f*h*p-m*y*S;break;case"YXZ":this._x=m*h*p+f*y*S,this._y=f*y*p-m*h*S,this._z=f*h*S-m*y*p,this._w=f*h*p+m*y*S;break;case"ZXY":this._x=m*h*p-f*y*S,this._y=f*y*p+m*h*S,this._z=f*h*S+m*y*p,this._w=f*h*p-m*y*S;break;case"ZYX":this._x=m*h*p-f*y*S,this._y=f*y*p+m*h*S,this._z=f*h*S-m*y*p,this._w=f*h*p+m*y*S;break;case"YZX":this._x=m*h*p+f*y*S,this._y=f*y*p+m*h*S,this._z=f*h*S-m*y*p,this._w=f*h*p-m*y*S;break;case"XZY":this._x=m*h*p-f*y*S,this._y=f*y*p-m*h*S,this._z=f*h*S+m*y*p,this._w=f*h*p+m*y*S;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+l)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const r=n/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,r=n[0],i=n[4],a=n[8],l=n[1],c=n[5],u=n[9],f=n[2],h=n[6],p=n[10],m=r+c+p;if(m>0){const y=.5/Math.sqrt(m+1);this._w=.25/y,this._x=(h-u)*y,this._y=(a-f)*y,this._z=(l-i)*y}else if(r>c&&r>p){const y=2*Math.sqrt(1+r-c-p);this._w=(h-u)/y,this._x=.25*y,this._y=(i+l)/y,this._z=(a+f)/y}else if(c>p){const y=2*Math.sqrt(1+c-r-p);this._w=(a-f)/y,this._x=(i+l)/y,this._y=.25*y,this._z=(u+h)/y}else{const y=2*Math.sqrt(1+p-r-c);this._w=(l-i)/y,this._x=(a+f)/y,this._y=(u+h)/y,this._z=.25*y}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let r=e.dot(n)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Vr(this.dot(e),-1,1)))}rotateTowards(e,n){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,n/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const r=e._x,i=e._y,a=e._z,l=e._w,c=n._x,u=n._y,f=n._z,h=n._w;return this._x=r*h+l*c+i*f-a*u,this._y=i*h+l*u+a*c-r*f,this._z=a*h+l*f+r*u-i*c,this._w=l*h-r*c-i*u-a*f,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const r=this._x,i=this._y,a=this._z,l=this._w;let c=l*e._w+r*e._x+i*e._y+a*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=l,this._x=r,this._y=i,this._z=a,this;const u=1-c*c;if(u<=Number.EPSILON){const y=1-n;return this._w=y*l+n*this._w,this._x=y*r+n*this._x,this._y=y*i+n*this._y,this._z=y*a+n*this._z,this.normalize(),this}const f=Math.sqrt(u),h=Math.atan2(f,c),p=Math.sin((1-n)*h)/f,m=Math.sin(n*h)/f;return this._w=l*p+this._w*m,this._x=r*p+this._x*m,this._y=i*p+this._y*m,this._z=a*p+this._z*m,this._onChangeCallback(),this}slerpQuaternions(e,n,r){return this.copy(e).slerp(n,r)}random(){const e=Math.random(),n=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(n*Math.cos(i),r*Math.sin(a),r*Math.cos(a),n*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Se{constructor(e=0,n=0,r=0){Se.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}set(e,n,r){return r===void 0&&(r=this.z),this.x=e,this.y=n,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(Yb.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(Yb.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,r=this.y,i=this.z,a=e.elements;return this.x=a[0]*n+a[3]*r+a[6]*i,this.y=a[1]*n+a[4]*r+a[7]*i,this.z=a[2]*n+a[5]*r+a[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,r=this.y,i=this.z,a=e.elements,l=1/(a[3]*n+a[7]*r+a[11]*i+a[15]);return this.x=(a[0]*n+a[4]*r+a[8]*i+a[12])*l,this.y=(a[1]*n+a[5]*r+a[9]*i+a[13])*l,this.z=(a[2]*n+a[6]*r+a[10]*i+a[14])*l,this}applyQuaternion(e){const n=this.x,r=this.y,i=this.z,a=e.x,l=e.y,c=e.z,u=e.w,f=2*(l*i-c*r),h=2*(c*n-a*i),p=2*(a*r-l*n);return this.x=n+u*f+l*p-c*h,this.y=r+u*h+c*f-a*p,this.z=i+u*p+a*h-l*f,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,r=this.y,i=this.z,a=e.elements;return this.x=a[0]*n+a[4]*r+a[8]*i,this.y=a[1]*n+a[5]*r+a[9]*i,this.z=a[2]*n+a[6]*r+a[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const r=e.x,i=e.y,a=e.z,l=n.x,c=n.y,u=n.z;return this.x=i*u-a*c,this.y=a*l-r*u,this.z=r*c-i*l,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const r=e.dot(this)/n;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return o_.copy(this).projectOnVector(e),this.sub(o_)}reflect(e){return this.sub(o_.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(Vr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return n*n+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,r){const i=Math.sin(n)*e;return this.x=i*Math.sin(r),this.y=Math.cos(n)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,r){return this.x=e*Math.sin(n),this.y=r,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=r,this.z=i,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(n),this.y=r*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const o_=new Se,Yb=new ku;class Lu{constructor(e=new Se(1/0,1/0,1/0),n=new Se(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n+=3)this.expandByPoint(ki.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,r=e.count;n<r;n++)this.expandByPoint(ki.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const r=ki.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const a=r.getAttribute("position");if(n===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let l=0,c=a.count;l<c;l++)e.isMesh===!0?e.getVertexPosition(l,ki):ki.fromBufferAttribute(a,l),ki.applyMatrix4(e.matrixWorld),this.expandByPoint(ki);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Vf.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),Vf.copy(r.boundingBox)),Vf.applyMatrix4(e.matrixWorld),this.union(Vf)}const i=e.children;for(let a=0,l=i.length;a<l;a++)this.expandByObject(i[a],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ki),ki.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,r;return e.normal.x>0?(n=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),n<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Dc),jf.subVectors(this.max,Dc),Yo.subVectors(e.a,Dc),Jo.subVectors(e.b,Dc),Qo.subVectors(e.c,Dc),sa.subVectors(Jo,Yo),aa.subVectors(Qo,Jo),Ga.subVectors(Yo,Qo);let n=[0,-sa.z,sa.y,0,-aa.z,aa.y,0,-Ga.z,Ga.y,sa.z,0,-sa.x,aa.z,0,-aa.x,Ga.z,0,-Ga.x,-sa.y,sa.x,0,-aa.y,aa.x,0,-Ga.y,Ga.x,0];return!l_(n,Yo,Jo,Qo,jf)||(n=[1,0,0,0,1,0,0,0,1],!l_(n,Yo,Jo,Qo,jf))?!1:(Hf.crossVectors(sa,aa),n=[Hf.x,Hf.y,Hf.z],l_(n,Yo,Jo,Qo,jf))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ki).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ki).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(ys[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ys[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ys[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ys[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ys[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ys[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ys[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ys[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ys),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const ys=[new Se,new Se,new Se,new Se,new Se,new Se,new Se,new Se],ki=new Se,Vf=new Lu,Yo=new Se,Jo=new Se,Qo=new Se,sa=new Se,aa=new Se,Ga=new Se,Dc=new Se,jf=new Se,Hf=new Se,Wa=new Se;function l_(t,e,n,r,i){for(let a=0,l=t.length-3;a<=l;a+=3){Wa.fromArray(t,a);const c=i.x*Math.abs(Wa.x)+i.y*Math.abs(Wa.y)+i.z*Math.abs(Wa.z),u=e.dot(Wa),f=n.dot(Wa),h=r.dot(Wa);if(Math.max(-Math.max(u,f,h),Math.min(u,f,h))>c)return!1}return!0}const Cj=new Lu,Uc=new Se,c_=new Se;class Lp{constructor(e=new Se,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const r=this.center;n!==void 0?r.copy(n):Cj.setFromPoints(e).getCenter(r);let i=0;for(let a=0,l=e.length;a<l;a++)i=Math.max(i,r.distanceToSquared(e[a]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const r=this.center.distanceToSquared(e);return n.copy(e),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Uc.subVectors(e,this.center);const n=Uc.lengthSq();if(n>this.radius*this.radius){const r=Math.sqrt(n),i=(r-this.radius)*.5;this.center.addScaledVector(Uc,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(c_.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Uc.copy(e.center).add(c_)),this.expandByPoint(Uc.copy(e.center).sub(c_))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Ss=new Se,u_=new Se,Gf=new Se,oa=new Se,d_=new Se,Wf=new Se,f_=new Se;class n1{constructor(e=new Se,n=new Se(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ss)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=Ss.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Ss.copy(this.origin).addScaledVector(this.direction,n),Ss.distanceToSquared(e))}distanceSqToSegment(e,n,r,i){u_.copy(e).add(n).multiplyScalar(.5),Gf.copy(n).sub(e).normalize(),oa.copy(this.origin).sub(u_);const a=e.distanceTo(n)*.5,l=-this.direction.dot(Gf),c=oa.dot(this.direction),u=-oa.dot(Gf),f=oa.lengthSq(),h=Math.abs(1-l*l);let p,m,y,S;if(h>0)if(p=l*u-c,m=l*c-u,S=a*h,p>=0)if(m>=-S)if(m<=S){const E=1/h;p*=E,m*=E,y=p*(p+l*m+2*c)+m*(l*p+m+2*u)+f}else m=a,p=Math.max(0,-(l*m+c)),y=-p*p+m*(m+2*u)+f;else m=-a,p=Math.max(0,-(l*m+c)),y=-p*p+m*(m+2*u)+f;else m<=-S?(p=Math.max(0,-(-l*a+c)),m=p>0?-a:Math.min(Math.max(-a,-u),a),y=-p*p+m*(m+2*u)+f):m<=S?(p=0,m=Math.min(Math.max(-a,-u),a),y=m*(m+2*u)+f):(p=Math.max(0,-(l*a+c)),m=p>0?a:Math.min(Math.max(-a,-u),a),y=-p*p+m*(m+2*u)+f);else m=l>0?-a:a,p=Math.max(0,-(l*m+c)),y=-p*p+m*(m+2*u)+f;return r&&r.copy(this.origin).addScaledVector(this.direction,p),i&&i.copy(u_).addScaledVector(Gf,m),y}intersectSphere(e,n){Ss.subVectors(e.center,this.origin);const r=Ss.dot(this.direction),i=Ss.dot(Ss)-r*r,a=e.radius*e.radius;if(i>a)return null;const l=Math.sqrt(a-i),c=r-l,u=r+l;return u<0?null:c<0?this.at(u,n):this.at(c,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/n;return r>=0?r:null}intersectPlane(e,n){const r=this.distanceToPlane(e);return r===null?null:this.at(r,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let r,i,a,l,c,u;const f=1/this.direction.x,h=1/this.direction.y,p=1/this.direction.z,m=this.origin;return f>=0?(r=(e.min.x-m.x)*f,i=(e.max.x-m.x)*f):(r=(e.max.x-m.x)*f,i=(e.min.x-m.x)*f),h>=0?(a=(e.min.y-m.y)*h,l=(e.max.y-m.y)*h):(a=(e.max.y-m.y)*h,l=(e.min.y-m.y)*h),r>l||a>i||((a>r||isNaN(r))&&(r=a),(l<i||isNaN(i))&&(i=l),p>=0?(c=(e.min.z-m.z)*p,u=(e.max.z-m.z)*p):(c=(e.max.z-m.z)*p,u=(e.min.z-m.z)*p),r>u||c>i)||((c>r||r!==r)&&(r=c),(u<i||i!==i)&&(i=u),i<0)?null:this.at(r>=0?r:i,n)}intersectsBox(e){return this.intersectBox(e,Ss)!==null}intersectTriangle(e,n,r,i,a){d_.subVectors(n,e),Wf.subVectors(r,e),f_.crossVectors(d_,Wf);let l=this.direction.dot(f_),c;if(l>0){if(i)return null;c=1}else if(l<0)c=-1,l=-l;else return null;oa.subVectors(this.origin,e);const u=c*this.direction.dot(Wf.crossVectors(oa,Wf));if(u<0)return null;const f=c*this.direction.dot(d_.cross(oa));if(f<0||u+f>l)return null;const h=-c*oa.dot(f_);return h<0?null:this.at(h/l,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Yn{constructor(e,n,r,i,a,l,c,u,f,h,p,m,y,S,E,g){Yn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,r,i,a,l,c,u,f,h,p,m,y,S,E,g)}set(e,n,r,i,a,l,c,u,f,h,p,m,y,S,E,g){const v=this.elements;return v[0]=e,v[4]=n,v[8]=r,v[12]=i,v[1]=a,v[5]=l,v[9]=c,v[13]=u,v[2]=f,v[6]=h,v[10]=p,v[14]=m,v[3]=y,v[7]=S,v[11]=E,v[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Yn().fromArray(this.elements)}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this}copyPosition(e){const n=this.elements,r=e.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,r){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,n,r){return this.set(e.x,n.x,r.x,0,e.y,n.y,r.y,0,e.z,n.z,r.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,r=e.elements,i=1/el.setFromMatrixColumn(e,0).length(),a=1/el.setFromMatrixColumn(e,1).length(),l=1/el.setFromMatrixColumn(e,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*a,n[5]=r[5]*a,n[6]=r[6]*a,n[7]=0,n[8]=r[8]*l,n[9]=r[9]*l,n[10]=r[10]*l,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,r=e.x,i=e.y,a=e.z,l=Math.cos(r),c=Math.sin(r),u=Math.cos(i),f=Math.sin(i),h=Math.cos(a),p=Math.sin(a);if(e.order==="XYZ"){const m=l*h,y=l*p,S=c*h,E=c*p;n[0]=u*h,n[4]=-u*p,n[8]=f,n[1]=y+S*f,n[5]=m-E*f,n[9]=-c*u,n[2]=E-m*f,n[6]=S+y*f,n[10]=l*u}else if(e.order==="YXZ"){const m=u*h,y=u*p,S=f*h,E=f*p;n[0]=m+E*c,n[4]=S*c-y,n[8]=l*f,n[1]=l*p,n[5]=l*h,n[9]=-c,n[2]=y*c-S,n[6]=E+m*c,n[10]=l*u}else if(e.order==="ZXY"){const m=u*h,y=u*p,S=f*h,E=f*p;n[0]=m-E*c,n[4]=-l*p,n[8]=S+y*c,n[1]=y+S*c,n[5]=l*h,n[9]=E-m*c,n[2]=-l*f,n[6]=c,n[10]=l*u}else if(e.order==="ZYX"){const m=l*h,y=l*p,S=c*h,E=c*p;n[0]=u*h,n[4]=S*f-y,n[8]=m*f+E,n[1]=u*p,n[5]=E*f+m,n[9]=y*f-S,n[2]=-f,n[6]=c*u,n[10]=l*u}else if(e.order==="YZX"){const m=l*u,y=l*f,S=c*u,E=c*f;n[0]=u*h,n[4]=E-m*p,n[8]=S*p+y,n[1]=p,n[5]=l*h,n[9]=-c*h,n[2]=-f*h,n[6]=y*p+S,n[10]=m-E*p}else if(e.order==="XZY"){const m=l*u,y=l*f,S=c*u,E=c*f;n[0]=u*h,n[4]=-p,n[8]=f*h,n[1]=m*p+E,n[5]=l*h,n[9]=y*p-S,n[2]=S*p-y,n[6]=c*h,n[10]=E*p+m}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Aj,e,Pj)}lookAt(e,n,r){const i=this.elements;return Kr.subVectors(e,n),Kr.lengthSq()===0&&(Kr.z=1),Kr.normalize(),la.crossVectors(r,Kr),la.lengthSq()===0&&(Math.abs(r.z)===1?Kr.x+=1e-4:Kr.z+=1e-4,Kr.normalize(),la.crossVectors(r,Kr)),la.normalize(),qf.crossVectors(Kr,la),i[0]=la.x,i[4]=qf.x,i[8]=Kr.x,i[1]=la.y,i[5]=qf.y,i[9]=Kr.y,i[2]=la.z,i[6]=qf.z,i[10]=Kr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,i=n.elements,a=this.elements,l=r[0],c=r[4],u=r[8],f=r[12],h=r[1],p=r[5],m=r[9],y=r[13],S=r[2],E=r[6],g=r[10],v=r[14],x=r[3],w=r[7],C=r[11],T=r[15],M=i[0],A=i[4],F=i[8],I=i[12],O=i[1],W=i[5],J=i[9],ae=i[13],Z=i[2],ie=i[6],de=i[10],pe=i[14],K=i[3],ne=i[7],j=i[11],N=i[15];return a[0]=l*M+c*O+u*Z+f*K,a[4]=l*A+c*W+u*ie+f*ne,a[8]=l*F+c*J+u*de+f*j,a[12]=l*I+c*ae+u*pe+f*N,a[1]=h*M+p*O+m*Z+y*K,a[5]=h*A+p*W+m*ie+y*ne,a[9]=h*F+p*J+m*de+y*j,a[13]=h*I+p*ae+m*pe+y*N,a[2]=S*M+E*O+g*Z+v*K,a[6]=S*A+E*W+g*ie+v*ne,a[10]=S*F+E*J+g*de+v*j,a[14]=S*I+E*ae+g*pe+v*N,a[3]=x*M+w*O+C*Z+T*K,a[7]=x*A+w*W+C*ie+T*ne,a[11]=x*F+w*J+C*de+T*j,a[15]=x*I+w*ae+C*pe+T*N,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[4],i=e[8],a=e[12],l=e[1],c=e[5],u=e[9],f=e[13],h=e[2],p=e[6],m=e[10],y=e[14],S=e[3],E=e[7],g=e[11],v=e[15];return S*(+a*u*p-i*f*p-a*c*m+r*f*m+i*c*y-r*u*y)+E*(+n*u*y-n*f*m+a*l*m-i*l*y+i*f*h-a*u*h)+g*(+n*f*p-n*c*y-a*l*p+r*l*y+a*c*h-r*f*h)+v*(-i*c*h-n*u*p+n*c*m+i*l*p-r*l*m+r*u*h)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=n,i[14]=r),this}invert(){const e=this.elements,n=e[0],r=e[1],i=e[2],a=e[3],l=e[4],c=e[5],u=e[6],f=e[7],h=e[8],p=e[9],m=e[10],y=e[11],S=e[12],E=e[13],g=e[14],v=e[15],x=p*g*f-E*m*f+E*u*y-c*g*y-p*u*v+c*m*v,w=S*m*f-h*g*f-S*u*y+l*g*y+h*u*v-l*m*v,C=h*E*f-S*p*f+S*c*y-l*E*y-h*c*v+l*p*v,T=S*p*u-h*E*u-S*c*m+l*E*m+h*c*g-l*p*g,M=n*x+r*w+i*C+a*T;if(M===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const A=1/M;return e[0]=x*A,e[1]=(E*m*a-p*g*a-E*i*y+r*g*y+p*i*v-r*m*v)*A,e[2]=(c*g*a-E*u*a+E*i*f-r*g*f-c*i*v+r*u*v)*A,e[3]=(p*u*a-c*m*a-p*i*f+r*m*f+c*i*y-r*u*y)*A,e[4]=w*A,e[5]=(h*g*a-S*m*a+S*i*y-n*g*y-h*i*v+n*m*v)*A,e[6]=(S*u*a-l*g*a-S*i*f+n*g*f+l*i*v-n*u*v)*A,e[7]=(l*m*a-h*u*a+h*i*f-n*m*f-l*i*y+n*u*y)*A,e[8]=C*A,e[9]=(S*p*a-h*E*a-S*r*y+n*E*y+h*r*v-n*p*v)*A,e[10]=(l*E*a-S*c*a+S*r*f-n*E*f-l*r*v+n*c*v)*A,e[11]=(h*c*a-l*p*a-h*r*f+n*p*f+l*r*y-n*c*y)*A,e[12]=T*A,e[13]=(h*E*i-S*p*i+S*r*m-n*E*m-h*r*g+n*p*g)*A,e[14]=(S*c*i-l*E*i-S*r*u+n*E*u+l*r*g-n*c*g)*A,e[15]=(l*p*i-h*c*i+h*r*u-n*p*u-l*r*m+n*c*m)*A,this}scale(e){const n=this.elements,r=e.x,i=e.y,a=e.z;return n[0]*=r,n[4]*=i,n[8]*=a,n[1]*=r,n[5]*=i,n[9]*=a,n[2]*=r,n[6]*=i,n[10]*=a,n[3]*=r,n[7]*=i,n[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,r,i))}makeTranslation(e,n,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,r,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const r=Math.cos(n),i=Math.sin(n),a=1-r,l=e.x,c=e.y,u=e.z,f=a*l,h=a*c;return this.set(f*l+r,f*c-i*u,f*u+i*c,0,f*c+i*u,h*c+r,h*u-i*l,0,f*u-i*c,h*u+i*l,a*u*u+r,0,0,0,0,1),this}makeScale(e,n,r){return this.set(e,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,n,r,i,a,l){return this.set(1,r,a,0,e,1,l,0,n,i,1,0,0,0,0,1),this}compose(e,n,r){const i=this.elements,a=n._x,l=n._y,c=n._z,u=n._w,f=a+a,h=l+l,p=c+c,m=a*f,y=a*h,S=a*p,E=l*h,g=l*p,v=c*p,x=u*f,w=u*h,C=u*p,T=r.x,M=r.y,A=r.z;return i[0]=(1-(E+v))*T,i[1]=(y+C)*T,i[2]=(S-w)*T,i[3]=0,i[4]=(y-C)*M,i[5]=(1-(m+v))*M,i[6]=(g+x)*M,i[7]=0,i[8]=(S+w)*A,i[9]=(g-x)*A,i[10]=(1-(m+E))*A,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,n,r){const i=this.elements;let a=el.set(i[0],i[1],i[2]).length();const l=el.set(i[4],i[5],i[6]).length(),c=el.set(i[8],i[9],i[10]).length();this.determinant()<0&&(a=-a),e.x=i[12],e.y=i[13],e.z=i[14],Li.copy(this);const f=1/a,h=1/l,p=1/c;return Li.elements[0]*=f,Li.elements[1]*=f,Li.elements[2]*=f,Li.elements[4]*=h,Li.elements[5]*=h,Li.elements[6]*=h,Li.elements[8]*=p,Li.elements[9]*=p,Li.elements[10]*=p,n.setFromRotationMatrix(Li),r.x=a,r.y=l,r.z=c,this}makePerspective(e,n,r,i,a,l,c=As){const u=this.elements,f=2*a/(n-e),h=2*a/(r-i),p=(n+e)/(n-e),m=(r+i)/(r-i);let y,S;if(c===As)y=-(l+a)/(l-a),S=-2*l*a/(l-a);else if(c===np)y=-l/(l-a),S=-l*a/(l-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return u[0]=f,u[4]=0,u[8]=p,u[12]=0,u[1]=0,u[5]=h,u[9]=m,u[13]=0,u[2]=0,u[6]=0,u[10]=y,u[14]=S,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,n,r,i,a,l,c=As){const u=this.elements,f=1/(n-e),h=1/(r-i),p=1/(l-a),m=(n+e)*f,y=(r+i)*h;let S,E;if(c===As)S=(l+a)*p,E=-2*p;else if(c===np)S=a*p,E=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return u[0]=2*f,u[4]=0,u[8]=0,u[12]=-m,u[1]=0,u[5]=2*h,u[9]=0,u[13]=-y,u[2]=0,u[6]=0,u[10]=E,u[14]=-S,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){const n=this.elements,r=e.elements;for(let i=0;i<16;i++)if(n[i]!==r[i])return!1;return!0}fromArray(e,n=0){for(let r=0;r<16;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e[n+9]=r[9],e[n+10]=r[10],e[n+11]=r[11],e[n+12]=r[12],e[n+13]=r[13],e[n+14]=r[14],e[n+15]=r[15],e}}const el=new Se,Li=new Yn,Aj=new Se(0,0,0),Pj=new Se(1,1,1),la=new Se,qf=new Se,Kr=new Se,Jb=new Yn,Qb=new ku;class Op{constructor(e=0,n=0,r=0,i=Op.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,r,i=this._order){return this._x=e,this._y=n,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,r=!0){const i=e.elements,a=i[0],l=i[4],c=i[8],u=i[1],f=i[5],h=i[9],p=i[2],m=i[6],y=i[10];switch(n){case"XYZ":this._y=Math.asin(Vr(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,y),this._z=Math.atan2(-l,a)):(this._x=Math.atan2(m,f),this._z=0);break;case"YXZ":this._x=Math.asin(-Vr(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(c,y),this._z=Math.atan2(u,f)):(this._y=Math.atan2(-p,a),this._z=0);break;case"ZXY":this._x=Math.asin(Vr(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-p,y),this._z=Math.atan2(-l,f)):(this._y=0,this._z=Math.atan2(u,a));break;case"ZYX":this._y=Math.asin(-Vr(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(m,y),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-l,f));break;case"YZX":this._z=Math.asin(Vr(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-h,f),this._y=Math.atan2(-p,a)):(this._x=0,this._y=Math.atan2(c,y));break;case"XZY":this._z=Math.asin(-Vr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(m,f),this._y=Math.atan2(c,a)):(this._x=Math.atan2(-h,y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,r){return Jb.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Jb,n,r)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return Qb.setFromEuler(this),this.setFromQuaternion(Qb,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Op.DEFAULT_ORDER="XYZ";class r1{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Ij=0;const eT=new Se,tl=new ku,ws=new Yn,Zf=new Se,Fc=new Se,Nj=new Se,kj=new ku,tT=new Se(1,0,0),nT=new Se(0,1,0),rT=new Se(0,0,1),Lj={type:"added"},Oj={type:"removed"};class Ar extends Wl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Ij++}),this.uuid=Nu(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ar.DEFAULT_UP.clone();const e=new Se,n=new Op,r=new ku,i=new Se(1,1,1);function a(){r.setFromEuler(n,!1)}function l(){n.setFromQuaternion(r,void 0,!1)}n._onChange(a),r._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Yn},normalMatrix:{value:new Dt}}),this.matrix=new Yn,this.matrixWorld=new Yn,this.matrixAutoUpdate=Ar.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ar.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new r1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return tl.setFromAxisAngle(e,n),this.quaternion.multiply(tl),this}rotateOnWorldAxis(e,n){return tl.setFromAxisAngle(e,n),this.quaternion.premultiply(tl),this}rotateX(e){return this.rotateOnAxis(tT,e)}rotateY(e){return this.rotateOnAxis(nT,e)}rotateZ(e){return this.rotateOnAxis(rT,e)}translateOnAxis(e,n){return eT.copy(e).applyQuaternion(this.quaternion),this.position.add(eT.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(tT,e)}translateY(e){return this.translateOnAxis(nT,e)}translateZ(e){return this.translateOnAxis(rT,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ws.copy(this.matrixWorld).invert())}lookAt(e,n,r){e.isVector3?Zf.copy(e):Zf.set(e,n,r);const i=this.parent;this.updateWorldMatrix(!0,!1),Fc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ws.lookAt(Fc,Zf,this.up):ws.lookAt(Zf,Fc,this.up),this.quaternion.setFromRotationMatrix(ws),i&&(ws.extractRotation(i.matrixWorld),tl.setFromRotationMatrix(ws),this.quaternion.premultiply(tl.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Lj)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Oj)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ws.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ws.multiply(e.parent.matrixWorld)),e.applyMatrix4(ws),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let r=0,i=this.children.length;r<i;r++){const l=this.children[r].getObjectByProperty(e,n);if(l!==void 0)return l}}getObjectsByProperty(e,n,r=[]){this[e]===n&&r.push(this);const i=this.children;for(let a=0,l=i.length;a<l;a++)i[a].getObjectsByProperty(e,n,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Fc,e,Nj),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Fc,kj,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let r=0,i=n.length;r<i;r++){const a=n[r];(a.matrixWorldAutoUpdate===!0||e===!0)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const i=this.children;for(let a=0,l=i.length;a<l;a++){const c=i[a];c.matrixWorldAutoUpdate===!0&&c.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",r={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(c=>({boxInitialized:c.boxInitialized,boxMin:c.box.min.toArray(),boxMax:c.box.max.toArray(),sphereInitialized:c.sphereInitialized,sphereRadius:c.sphere.radius,sphereCenter:c.sphere.center.toArray()})),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function a(c,u){return c[u.uuid]===void 0&&(c[u.uuid]=u.toJSON(e)),u.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=a(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const u=c.shapes;if(Array.isArray(u))for(let f=0,h=u.length;f<h;f++){const p=u[f];a(e.shapes,p)}else a(e.shapes,u)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let u=0,f=this.material.length;u<f;u++)c.push(a(e.materials,this.material[u]));i.material=c}else i.material=a(e.materials,this.material);if(this.children.length>0){i.children=[];for(let c=0;c<this.children.length;c++)i.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let c=0;c<this.animations.length;c++){const u=this.animations[c];i.animations.push(a(e.animations,u))}}if(n){const c=l(e.geometries),u=l(e.materials),f=l(e.textures),h=l(e.images),p=l(e.shapes),m=l(e.skeletons),y=l(e.animations),S=l(e.nodes);c.length>0&&(r.geometries=c),u.length>0&&(r.materials=u),f.length>0&&(r.textures=f),h.length>0&&(r.images=h),p.length>0&&(r.shapes=p),m.length>0&&(r.skeletons=m),y.length>0&&(r.animations=y),S.length>0&&(r.nodes=S)}return r.object=i,r;function l(c){const u=[];for(const f in c){const h=c[f];delete h.metadata,u.push(h)}return u}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}Ar.DEFAULT_UP=new Se(0,1,0);Ar.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ar.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Oi=new Se,xs=new Se,h_=new Se,Es=new Se,nl=new Se,rl=new Se,iT=new Se,p_=new Se,m_=new Se,g_=new Se;let Xf=!1;class zi{constructor(e=new Se,n=new Se,r=new Se){this.a=e,this.b=n,this.c=r}static getNormal(e,n,r,i){i.subVectors(r,n),Oi.subVectors(e,n),i.cross(Oi);const a=i.lengthSq();return a>0?i.multiplyScalar(1/Math.sqrt(a)):i.set(0,0,0)}static getBarycoord(e,n,r,i,a){Oi.subVectors(i,n),xs.subVectors(r,n),h_.subVectors(e,n);const l=Oi.dot(Oi),c=Oi.dot(xs),u=Oi.dot(h_),f=xs.dot(xs),h=xs.dot(h_),p=l*f-c*c;if(p===0)return a.set(0,0,0),null;const m=1/p,y=(f*u-c*h)*m,S=(l*h-c*u)*m;return a.set(1-y-S,S,y)}static containsPoint(e,n,r,i){return this.getBarycoord(e,n,r,i,Es)===null?!1:Es.x>=0&&Es.y>=0&&Es.x+Es.y<=1}static getUV(e,n,r,i,a,l,c,u){return Xf===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Xf=!0),this.getInterpolation(e,n,r,i,a,l,c,u)}static getInterpolation(e,n,r,i,a,l,c,u){return this.getBarycoord(e,n,r,i,Es)===null?(u.x=0,u.y=0,"z"in u&&(u.z=0),"w"in u&&(u.w=0),null):(u.setScalar(0),u.addScaledVector(a,Es.x),u.addScaledVector(l,Es.y),u.addScaledVector(c,Es.z),u)}static isFrontFacing(e,n,r,i){return Oi.subVectors(r,n),xs.subVectors(e,n),Oi.cross(xs).dot(i)<0}set(e,n,r){return this.a.copy(e),this.b.copy(n),this.c.copy(r),this}setFromPointsAndIndices(e,n,r,i){return this.a.copy(e[n]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,n,r,i){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Oi.subVectors(this.c,this.b),xs.subVectors(this.a,this.b),Oi.cross(xs).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return zi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return zi.getBarycoord(e,this.a,this.b,this.c,n)}getUV(e,n,r,i,a){return Xf===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Xf=!0),zi.getInterpolation(e,this.a,this.b,this.c,n,r,i,a)}getInterpolation(e,n,r,i,a){return zi.getInterpolation(e,this.a,this.b,this.c,n,r,i,a)}containsPoint(e){return zi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return zi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const r=this.a,i=this.b,a=this.c;let l,c;nl.subVectors(i,r),rl.subVectors(a,r),p_.subVectors(e,r);const u=nl.dot(p_),f=rl.dot(p_);if(u<=0&&f<=0)return n.copy(r);m_.subVectors(e,i);const h=nl.dot(m_),p=rl.dot(m_);if(h>=0&&p<=h)return n.copy(i);const m=u*p-h*f;if(m<=0&&u>=0&&h<=0)return l=u/(u-h),n.copy(r).addScaledVector(nl,l);g_.subVectors(e,a);const y=nl.dot(g_),S=rl.dot(g_);if(S>=0&&y<=S)return n.copy(a);const E=y*f-u*S;if(E<=0&&f>=0&&S<=0)return c=f/(f-S),n.copy(r).addScaledVector(rl,c);const g=h*S-y*p;if(g<=0&&p-h>=0&&y-S>=0)return iT.subVectors(a,i),c=(p-h)/(p-h+(y-S)),n.copy(i).addScaledVector(iT,c);const v=1/(g+E+m);return l=E*v,c=m*v,n.copy(r).addScaledVector(nl,l).addScaledVector(rl,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const i1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ca={h:0,s:0,l:0},Kf={h:0,s:0,l:0};function __(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class It{constructor(e,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,r)}set(e,n,r){if(n===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,n,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=rr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,on.toWorkingColorSpace(this,n),this}setRGB(e,n,r,i=on.workingColorSpace){return this.r=e,this.g=n,this.b=r,on.toWorkingColorSpace(this,i),this}setHSL(e,n,r,i=on.workingColorSpace){if(e=wj(e,1),n=Vr(n,0,1),r=Vr(r,0,1),n===0)this.r=this.g=this.b=r;else{const a=r<=.5?r*(1+n):r+n-r*n,l=2*r-a;this.r=__(l,a,e+1/3),this.g=__(l,a,e),this.b=__(l,a,e-1/3)}return on.toWorkingColorSpace(this,i),this}setStyle(e,n=rr){function r(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const l=i[1],c=i[2];switch(l){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return r(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,n);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return r(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,n);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return r(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=i[1],l=a.length;if(l===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,n);if(l===6)return this.setHex(parseInt(a,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=rr){const r=i1[e.toLowerCase()];return r!==void 0?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Rl(e.r),this.g=Rl(e.g),this.b=Rl(e.b),this}copyLinearToSRGB(e){return this.r=s_(e.r),this.g=s_(e.g),this.b=s_(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=rr){return on.fromWorkingColorSpace(mr.copy(this),e),Math.round(Vr(mr.r*255,0,255))*65536+Math.round(Vr(mr.g*255,0,255))*256+Math.round(Vr(mr.b*255,0,255))}getHexString(e=rr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=on.workingColorSpace){on.fromWorkingColorSpace(mr.copy(this),n);const r=mr.r,i=mr.g,a=mr.b,l=Math.max(r,i,a),c=Math.min(r,i,a);let u,f;const h=(c+l)/2;if(c===l)u=0,f=0;else{const p=l-c;switch(f=h<=.5?p/(l+c):p/(2-l-c),l){case r:u=(i-a)/p+(i<a?6:0);break;case i:u=(a-r)/p+2;break;case a:u=(r-i)/p+4;break}u/=6}return e.h=u,e.s=f,e.l=h,e}getRGB(e,n=on.workingColorSpace){return on.fromWorkingColorSpace(mr.copy(this),n),e.r=mr.r,e.g=mr.g,e.b=mr.b,e}getStyle(e=rr){on.fromWorkingColorSpace(mr.copy(this),e);const n=mr.r,r=mr.g,i=mr.b;return e!==rr?`color(${e} ${n.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,n,r){return this.getHSL(ca),this.setHSL(ca.h+e,ca.s+n,ca.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,r){return this.r=e.r+(n.r-e.r)*r,this.g=e.g+(n.g-e.g)*r,this.b=e.b+(n.b-e.b)*r,this}lerpHSL(e,n){this.getHSL(ca),e.getHSL(Kf);const r=r_(ca.h,Kf.h,n),i=r_(ca.s,Kf.s,n),a=r_(ca.l,Kf.l,n);return this.setHSL(r,i,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,r=this.g,i=this.b,a=e.elements;return this.r=a[0]*n+a[3]*r+a[6]*i,this.g=a[1]*n+a[4]*r+a[7]*i,this.b=a[2]*n+a[5]*r+a[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const mr=new It;It.NAMES=i1;let Dj=0;class ql extends Wl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Dj++}),this.uuid=Nu(),this.name="",this.type="Material",this.blending=Ml,this.side=wa,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=kv,this.blendDst=Lv,this.blendEquation=eo,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new It(0,0,0),this.blendAlpha=0,this.depthFunc=Jh,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Hb,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Xo,this.stencilZFail=Xo,this.stencilZPass=Xo,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const r=e[n];if(r===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const i=this[n];if(i===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[n]=r}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Ml&&(r.blending=this.blending),this.side!==wa&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==kv&&(r.blendSrc=this.blendSrc),this.blendDst!==Lv&&(r.blendDst=this.blendDst),this.blendEquation!==eo&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==Jh&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Hb&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Xo&&(r.stencilFail=this.stencilFail),this.stencilZFail!==Xo&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==Xo&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}if(n){const a=i(e.textures),l=i(e.images);a.length>0&&(r.textures=a),l.length>0&&(r.images=l)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let r=null;if(n!==null){const i=n.length;r=new Array(i);for(let a=0;a!==i;++a)r[a]=n[a].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class to extends ql{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new It(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=$A,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const On=new Se,Yf=new sn;class Si{constructor(e,n,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=r,this.usage=Gb,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=pa,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,r){e*=this.itemSize,r*=n.itemSize;for(let i=0,a=this.itemSize;i<a;i++)this.array[e+i]=n.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,r=this.count;n<r;n++)Yf.fromBufferAttribute(this,n),Yf.applyMatrix3(e),this.setXY(n,Yf.x,Yf.y);else if(this.itemSize===3)for(let n=0,r=this.count;n<r;n++)On.fromBufferAttribute(this,n),On.applyMatrix3(e),this.setXYZ(n,On.x,On.y,On.z);return this}applyMatrix4(e){for(let n=0,r=this.count;n<r;n++)On.fromBufferAttribute(this,n),On.applyMatrix4(e),this.setXYZ(n,On.x,On.y,On.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)On.fromBufferAttribute(this,n),On.applyNormalMatrix(e),this.setXYZ(n,On.x,On.y,On.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)On.fromBufferAttribute(this,n),On.transformDirection(e),this.setXYZ(n,On.x,On.y,On.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let r=this.array[e*this.itemSize+n];return this.normalized&&(r=Oc(r,this.array)),r}setComponent(e,n,r){return this.normalized&&(r=$r(r,this.array)),this.array[e*this.itemSize+n]=r,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Oc(n,this.array)),n}setX(e,n){return this.normalized&&(n=$r(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Oc(n,this.array)),n}setY(e,n){return this.normalized&&(n=$r(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Oc(n,this.array)),n}setZ(e,n){return this.normalized&&(n=$r(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Oc(n,this.array)),n}setW(e,n){return this.normalized&&(n=$r(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=$r(n,this.array),r=$r(r,this.array)),this.array[e+0]=n,this.array[e+1]=r,this}setXYZ(e,n,r,i){return e*=this.itemSize,this.normalized&&(n=$r(n,this.array),r=$r(r,this.array),i=$r(i,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,n,r,i,a){return e*=this.itemSize,this.normalized&&(n=$r(n,this.array),r=$r(r,this.array),i=$r(i,this.array),a=$r(a,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Gb&&(e.usage=this.usage),e}}class s1 extends Si{constructor(e,n,r){super(new Uint16Array(e),n,r)}}class a1 extends Si{constructor(e,n,r){super(new Uint32Array(e),n,r)}}class Qi extends Si{constructor(e,n,r){super(new Float32Array(e),n,r)}}let Uj=0;const fi=new Yn,v_=new Ar,il=new Se,Yr=new Lu,zc=new Lu,Xn=new Se;class is extends Wl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Uj++}),this.uuid=Nu(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(JA(e)?a1:s1)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,r=0){this.groups.push({start:e,count:n,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const a=new Dt().getNormalMatrix(e);r.applyNormalMatrix(a),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return fi.makeRotationFromQuaternion(e),this.applyMatrix4(fi),this}rotateX(e){return fi.makeRotationX(e),this.applyMatrix4(fi),this}rotateY(e){return fi.makeRotationY(e),this.applyMatrix4(fi),this}rotateZ(e){return fi.makeRotationZ(e),this.applyMatrix4(fi),this}translate(e,n,r){return fi.makeTranslation(e,n,r),this.applyMatrix4(fi),this}scale(e,n,r){return fi.makeScale(e,n,r),this.applyMatrix4(fi),this}lookAt(e){return v_.lookAt(e),v_.updateMatrix(),this.applyMatrix4(v_.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(il).negate(),this.translate(il.x,il.y,il.z),this}setFromPoints(e){const n=[];for(let r=0,i=e.length;r<i;r++){const a=e[r];n.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new Qi(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Lu);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Se(-1/0,-1/0,-1/0),new Se(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let r=0,i=n.length;r<i;r++){const a=n[r];Yr.setFromBufferAttribute(a),this.morphTargetsRelative?(Xn.addVectors(this.boundingBox.min,Yr.min),this.boundingBox.expandByPoint(Xn),Xn.addVectors(this.boundingBox.max,Yr.max),this.boundingBox.expandByPoint(Xn)):(this.boundingBox.expandByPoint(Yr.min),this.boundingBox.expandByPoint(Yr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Lp);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Se,1/0);return}if(e){const r=this.boundingSphere.center;if(Yr.setFromBufferAttribute(e),n)for(let a=0,l=n.length;a<l;a++){const c=n[a];zc.setFromBufferAttribute(c),this.morphTargetsRelative?(Xn.addVectors(Yr.min,zc.min),Yr.expandByPoint(Xn),Xn.addVectors(Yr.max,zc.max),Yr.expandByPoint(Xn)):(Yr.expandByPoint(zc.min),Yr.expandByPoint(zc.max))}Yr.getCenter(r);let i=0;for(let a=0,l=e.count;a<l;a++)Xn.fromBufferAttribute(e,a),i=Math.max(i,r.distanceToSquared(Xn));if(n)for(let a=0,l=n.length;a<l;a++){const c=n[a],u=this.morphTargetsRelative;for(let f=0,h=c.count;f<h;f++)Xn.fromBufferAttribute(c,f),u&&(il.fromBufferAttribute(e,f),Xn.add(il)),i=Math.max(i,r.distanceToSquared(Xn))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,i=n.position.array,a=n.normal.array,l=n.uv.array,c=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Si(new Float32Array(4*c),4));const u=this.getAttribute("tangent").array,f=[],h=[];for(let O=0;O<c;O++)f[O]=new Se,h[O]=new Se;const p=new Se,m=new Se,y=new Se,S=new sn,E=new sn,g=new sn,v=new Se,x=new Se;function w(O,W,J){p.fromArray(i,O*3),m.fromArray(i,W*3),y.fromArray(i,J*3),S.fromArray(l,O*2),E.fromArray(l,W*2),g.fromArray(l,J*2),m.sub(p),y.sub(p),E.sub(S),g.sub(S);const ae=1/(E.x*g.y-g.x*E.y);isFinite(ae)&&(v.copy(m).multiplyScalar(g.y).addScaledVector(y,-E.y).multiplyScalar(ae),x.copy(y).multiplyScalar(E.x).addScaledVector(m,-g.x).multiplyScalar(ae),f[O].add(v),f[W].add(v),f[J].add(v),h[O].add(x),h[W].add(x),h[J].add(x))}let C=this.groups;C.length===0&&(C=[{start:0,count:r.length}]);for(let O=0,W=C.length;O<W;++O){const J=C[O],ae=J.start,Z=J.count;for(let ie=ae,de=ae+Z;ie<de;ie+=3)w(r[ie+0],r[ie+1],r[ie+2])}const T=new Se,M=new Se,A=new Se,F=new Se;function I(O){A.fromArray(a,O*3),F.copy(A);const W=f[O];T.copy(W),T.sub(A.multiplyScalar(A.dot(W))).normalize(),M.crossVectors(F,W);const ae=M.dot(h[O])<0?-1:1;u[O*4]=T.x,u[O*4+1]=T.y,u[O*4+2]=T.z,u[O*4+3]=ae}for(let O=0,W=C.length;O<W;++O){const J=C[O],ae=J.start,Z=J.count;for(let ie=ae,de=ae+Z;ie<de;ie+=3)I(r[ie+0]),I(r[ie+1]),I(r[ie+2])}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Si(new Float32Array(n.count*3),3),this.setAttribute("normal",r);else for(let m=0,y=r.count;m<y;m++)r.setXYZ(m,0,0,0);const i=new Se,a=new Se,l=new Se,c=new Se,u=new Se,f=new Se,h=new Se,p=new Se;if(e)for(let m=0,y=e.count;m<y;m+=3){const S=e.getX(m+0),E=e.getX(m+1),g=e.getX(m+2);i.fromBufferAttribute(n,S),a.fromBufferAttribute(n,E),l.fromBufferAttribute(n,g),h.subVectors(l,a),p.subVectors(i,a),h.cross(p),c.fromBufferAttribute(r,S),u.fromBufferAttribute(r,E),f.fromBufferAttribute(r,g),c.add(h),u.add(h),f.add(h),r.setXYZ(S,c.x,c.y,c.z),r.setXYZ(E,u.x,u.y,u.z),r.setXYZ(g,f.x,f.y,f.z)}else for(let m=0,y=n.count;m<y;m+=3)i.fromBufferAttribute(n,m+0),a.fromBufferAttribute(n,m+1),l.fromBufferAttribute(n,m+2),h.subVectors(l,a),p.subVectors(i,a),h.cross(p),r.setXYZ(m+0,h.x,h.y,h.z),r.setXYZ(m+1,h.x,h.y,h.z),r.setXYZ(m+2,h.x,h.y,h.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,r=e.count;n<r;n++)Xn.fromBufferAttribute(e,n),Xn.normalize(),e.setXYZ(n,Xn.x,Xn.y,Xn.z)}toNonIndexed(){function e(c,u){const f=c.array,h=c.itemSize,p=c.normalized,m=new f.constructor(u.length*h);let y=0,S=0;for(let E=0,g=u.length;E<g;E++){c.isInterleavedBufferAttribute?y=u[E]*c.data.stride+c.offset:y=u[E]*h;for(let v=0;v<h;v++)m[S++]=f[y++]}return new Si(m,h,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new is,r=this.index.array,i=this.attributes;for(const c in i){const u=i[c],f=e(u,r);n.setAttribute(c,f)}const a=this.morphAttributes;for(const c in a){const u=[],f=a[c];for(let h=0,p=f.length;h<p;h++){const m=f[h],y=e(m,r);u.push(y)}n.morphAttributes[c]=u}n.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let c=0,u=l.length;c<u;c++){const f=l[c];n.addGroup(f.start,f.count,f.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const f in u)u[f]!==void 0&&(e[f]=u[f]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const r=this.attributes;for(const u in r){const f=r[u];e.data.attributes[u]=f.toJSON(e.data)}const i={};let a=!1;for(const u in this.morphAttributes){const f=this.morphAttributes[u],h=[];for(let p=0,m=f.length;p<m;p++){const y=f[p];h.push(y.toJSON(e.data))}h.length>0&&(i[u]=h,a=!0)}a&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(e.data.groups=JSON.parse(JSON.stringify(l)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(n));const i=e.attributes;for(const f in i){const h=i[f];this.setAttribute(f,h.clone(n))}const a=e.morphAttributes;for(const f in a){const h=[],p=a[f];for(let m=0,y=p.length;m<y;m++)h.push(p[m].clone(n));this.morphAttributes[f]=h}this.morphTargetsRelative=e.morphTargetsRelative;const l=e.groups;for(let f=0,h=l.length;f<h;f++){const p=l[f];this.addGroup(p.start,p.count,p.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const sT=new Yn,qa=new n1,Jf=new Lp,aT=new Se,sl=new Se,al=new Se,ol=new Se,y_=new Se,Qf=new Se,eh=new sn,th=new sn,nh=new sn,oT=new Se,lT=new Se,cT=new Se,rh=new Se,ih=new Se;class _r extends Ar{constructor(e=new is,n=new to){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,l=i.length;a<l;a++){const c=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=a}}}}getVertexPosition(e,n){const r=this.geometry,i=r.attributes.position,a=r.morphAttributes.position,l=r.morphTargetsRelative;n.fromBufferAttribute(i,e);const c=this.morphTargetInfluences;if(a&&c){Qf.set(0,0,0);for(let u=0,f=a.length;u<f;u++){const h=c[u],p=a[u];h!==0&&(y_.fromBufferAttribute(p,e),l?Qf.addScaledVector(y_,h):Qf.addScaledVector(y_.sub(n),h))}n.add(Qf)}return n}raycast(e,n){const r=this.geometry,i=this.material,a=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),Jf.copy(r.boundingSphere),Jf.applyMatrix4(a),qa.copy(e.ray).recast(e.near),!(Jf.containsPoint(qa.origin)===!1&&(qa.intersectSphere(Jf,aT)===null||qa.origin.distanceToSquared(aT)>(e.far-e.near)**2))&&(sT.copy(a).invert(),qa.copy(e.ray).applyMatrix4(sT),!(r.boundingBox!==null&&qa.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,n,qa)))}_computeIntersections(e,n,r){let i;const a=this.geometry,l=this.material,c=a.index,u=a.attributes.position,f=a.attributes.uv,h=a.attributes.uv1,p=a.attributes.normal,m=a.groups,y=a.drawRange;if(c!==null)if(Array.isArray(l))for(let S=0,E=m.length;S<E;S++){const g=m[S],v=l[g.materialIndex],x=Math.max(g.start,y.start),w=Math.min(c.count,Math.min(g.start+g.count,y.start+y.count));for(let C=x,T=w;C<T;C+=3){const M=c.getX(C),A=c.getX(C+1),F=c.getX(C+2);i=sh(this,v,e,r,f,h,p,M,A,F),i&&(i.faceIndex=Math.floor(C/3),i.face.materialIndex=g.materialIndex,n.push(i))}}else{const S=Math.max(0,y.start),E=Math.min(c.count,y.start+y.count);for(let g=S,v=E;g<v;g+=3){const x=c.getX(g),w=c.getX(g+1),C=c.getX(g+2);i=sh(this,l,e,r,f,h,p,x,w,C),i&&(i.faceIndex=Math.floor(g/3),n.push(i))}}else if(u!==void 0)if(Array.isArray(l))for(let S=0,E=m.length;S<E;S++){const g=m[S],v=l[g.materialIndex],x=Math.max(g.start,y.start),w=Math.min(u.count,Math.min(g.start+g.count,y.start+y.count));for(let C=x,T=w;C<T;C+=3){const M=C,A=C+1,F=C+2;i=sh(this,v,e,r,f,h,p,M,A,F),i&&(i.faceIndex=Math.floor(C/3),i.face.materialIndex=g.materialIndex,n.push(i))}}else{const S=Math.max(0,y.start),E=Math.min(u.count,y.start+y.count);for(let g=S,v=E;g<v;g+=3){const x=g,w=g+1,C=g+2;i=sh(this,l,e,r,f,h,p,x,w,C),i&&(i.faceIndex=Math.floor(g/3),n.push(i))}}}}function Fj(t,e,n,r,i,a,l,c){let u;if(e.side===ar?u=r.intersectTriangle(l,a,i,!0,c):u=r.intersectTriangle(i,a,l,e.side===wa,c),u===null)return null;ih.copy(c),ih.applyMatrix4(t.matrixWorld);const f=n.ray.origin.distanceTo(ih);return f<n.near||f>n.far?null:{distance:f,point:ih.clone(),object:t}}function sh(t,e,n,r,i,a,l,c,u,f){t.getVertexPosition(c,sl),t.getVertexPosition(u,al),t.getVertexPosition(f,ol);const h=Fj(t,e,n,r,sl,al,ol,rh);if(h){i&&(eh.fromBufferAttribute(i,c),th.fromBufferAttribute(i,u),nh.fromBufferAttribute(i,f),h.uv=zi.getInterpolation(rh,sl,al,ol,eh,th,nh,new sn)),a&&(eh.fromBufferAttribute(a,c),th.fromBufferAttribute(a,u),nh.fromBufferAttribute(a,f),h.uv1=zi.getInterpolation(rh,sl,al,ol,eh,th,nh,new sn),h.uv2=h.uv1),l&&(oT.fromBufferAttribute(l,c),lT.fromBufferAttribute(l,u),cT.fromBufferAttribute(l,f),h.normal=zi.getInterpolation(rh,sl,al,ol,oT,lT,cT,new Se),h.normal.dot(r.direction)>0&&h.normal.multiplyScalar(-1));const p={a:c,b:u,c:f,normal:new Se,materialIndex:0};zi.getNormal(sl,al,ol,p.normal),h.face=p}return h}class Ou extends is{constructor(e=1,n=1,r=1,i=1,a=1,l=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:r,widthSegments:i,heightSegments:a,depthSegments:l};const c=this;i=Math.floor(i),a=Math.floor(a),l=Math.floor(l);const u=[],f=[],h=[],p=[];let m=0,y=0;S("z","y","x",-1,-1,r,n,e,l,a,0),S("z","y","x",1,-1,r,n,-e,l,a,1),S("x","z","y",1,1,e,r,n,i,l,2),S("x","z","y",1,-1,e,r,-n,i,l,3),S("x","y","z",1,-1,e,n,r,i,a,4),S("x","y","z",-1,-1,e,n,-r,i,a,5),this.setIndex(u),this.setAttribute("position",new Qi(f,3)),this.setAttribute("normal",new Qi(h,3)),this.setAttribute("uv",new Qi(p,2));function S(E,g,v,x,w,C,T,M,A,F,I){const O=C/A,W=T/F,J=C/2,ae=T/2,Z=M/2,ie=A+1,de=F+1;let pe=0,K=0;const ne=new Se;for(let j=0;j<de;j++){const N=j*W-ae;for(let H=0;H<ie;H++){const U=H*O-J;ne[E]=U*x,ne[g]=N*w,ne[v]=Z,f.push(ne.x,ne.y,ne.z),ne[E]=0,ne[g]=0,ne[v]=M>0?1:-1,h.push(ne.x,ne.y,ne.z),p.push(H/A),p.push(1-j/F),pe+=1}}for(let j=0;j<F;j++)for(let N=0;N<A;N++){const H=m+N+ie*j,U=m+N+ie*(j+1),P=m+(N+1)+ie*(j+1),L=m+(N+1)+ie*j;u.push(H,U,L),u.push(U,P,L),K+=6}c.addGroup(y,K,I),y+=K,m+=pe}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ou(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Fl(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][r]=null):e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}function Tr(t){const e={};for(let n=0;n<t.length;n++){const r=Fl(t[n]);for(const i in r)e[i]=r[i]}return e}function zj(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function o1(t){return t.getRenderTarget()===null?t.outputColorSpace:on.workingColorSpace}const $j={clone:Fl,merge:Tr};var Bj=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Vj=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class mo extends ql{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Bj,this.fragmentShader=Vj,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Fl(e.uniforms),this.uniformsGroups=zj(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const i in this.uniforms){const l=this.uniforms[i].value;l&&l.isTexture?n.uniforms[i]={type:"t",value:l.toJSON(e).uuid}:l&&l.isColor?n.uniforms[i]={type:"c",value:l.getHex()}:l&&l.isVector2?n.uniforms[i]={type:"v2",value:l.toArray()}:l&&l.isVector3?n.uniforms[i]={type:"v3",value:l.toArray()}:l&&l.isVector4?n.uniforms[i]={type:"v4",value:l.toArray()}:l&&l.isMatrix3?n.uniforms[i]={type:"m3",value:l.toArray()}:l&&l.isMatrix4?n.uniforms[i]={type:"m4",value:l.toArray()}:n.uniforms[i]={value:l}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(n.extensions=r),n}}class l1 extends Ar{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Yn,this.projectionMatrix=new Yn,this.projectionMatrixInverse=new Yn,this.coordinateSystem=As}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class gi extends l1{constructor(e=50,n=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=$v*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(n_*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return $v*2*Math.atan(Math.tan(n_*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,n,r,i,a,l){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(n_*.5*this.fov)/this.zoom,r=2*n,i=this.aspect*r,a=-.5*i;const l=this.view;if(this.view!==null&&this.view.enabled){const u=l.fullWidth,f=l.fullHeight;a+=l.offsetX*i/u,n-=l.offsetY*r/f,i*=l.width/u,r*=l.height/f}const c=this.filmOffset;c!==0&&(a+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+i,n,n-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const ll=-90,cl=1;class jj extends Ar{constructor(e,n,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new gi(ll,cl,e,n);i.layers=this.layers,this.add(i);const a=new gi(ll,cl,e,n);a.layers=this.layers,this.add(a);const l=new gi(ll,cl,e,n);l.layers=this.layers,this.add(l);const c=new gi(ll,cl,e,n);c.layers=this.layers,this.add(c);const u=new gi(ll,cl,e,n);u.layers=this.layers,this.add(u);const f=new gi(ll,cl,e,n);f.layers=this.layers,this.add(f)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[r,i,a,l,c,u]=n;for(const f of n)this.remove(f);if(e===As)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),l.up.set(0,0,1),l.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),u.up.set(0,1,0),u.lookAt(0,0,-1);else if(e===np)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),l.up.set(0,0,-1),l.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),u.up.set(0,-1,0),u.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const f of n)this.add(f),f.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[a,l,c,u,f,h]=this.children,p=e.getRenderTarget(),m=e.getActiveCubeFace(),y=e.getActiveMipmapLevel(),S=e.xr.enabled;e.xr.enabled=!1;const E=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(n,a),e.setRenderTarget(r,1,i),e.render(n,l),e.setRenderTarget(r,2,i),e.render(n,c),e.setRenderTarget(r,3,i),e.render(n,u),e.setRenderTarget(r,4,i),e.render(n,f),r.texture.generateMipmaps=E,e.setRenderTarget(r,5,i),e.render(n,h),e.setRenderTarget(p,m,y),e.xr.enabled=S,r.texture.needsPMREMUpdate=!0}}class c1 extends ti{constructor(e,n,r,i,a,l,c,u,f,h){e=e!==void 0?e:[],n=n!==void 0?n:Ol,super(e,n,r,i,a,l,c,u,f,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Hj extends po{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];n.encoding!==void 0&&(iu("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===lo?rr:_i),this.texture=new c1(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:mi}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Ou(5,5,5),a=new mo({name:"CubemapFromEquirect",uniforms:Fl(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:ar,blending:ga});a.uniforms.tEquirect.value=n;const l=new _r(i,a),c=n.minFilter;return n.minFilter===vu&&(n.minFilter=mi),new jj(1,10,this).update(e,l),n.minFilter=c,l.geometry.dispose(),l.material.dispose(),this}clear(e,n,r,i){const a=e.getRenderTarget();for(let l=0;l<6;l++)e.setRenderTarget(this,l),e.clear(n,r,i);e.setRenderTarget(a)}}const S_=new Se,Gj=new Se,Wj=new Dt;class Ya{constructor(e=new Se(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,r,i){return this.normal.set(e,n,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,r){const i=S_.subVectors(r,n).cross(Gj.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const r=e.delta(S_),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/i;return a<0||a>1?null:n.copy(e.start).addScaledVector(r,a)}intersectsLine(e){const n=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return n<0&&r>0||r<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const r=n||Wj.getNormalMatrix(e),i=this.coplanarPoint(S_).applyMatrix4(e),a=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Za=new Lp,ah=new Se;class u1{constructor(e=new Ya,n=new Ya,r=new Ya,i=new Ya,a=new Ya,l=new Ya){this.planes=[e,n,r,i,a,l]}set(e,n,r,i,a,l){const c=this.planes;return c[0].copy(e),c[1].copy(n),c[2].copy(r),c[3].copy(i),c[4].copy(a),c[5].copy(l),this}copy(e){const n=this.planes;for(let r=0;r<6;r++)n[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,n=As){const r=this.planes,i=e.elements,a=i[0],l=i[1],c=i[2],u=i[3],f=i[4],h=i[5],p=i[6],m=i[7],y=i[8],S=i[9],E=i[10],g=i[11],v=i[12],x=i[13],w=i[14],C=i[15];if(r[0].setComponents(u-a,m-f,g-y,C-v).normalize(),r[1].setComponents(u+a,m+f,g+y,C+v).normalize(),r[2].setComponents(u+l,m+h,g+S,C+x).normalize(),r[3].setComponents(u-l,m-h,g-S,C-x).normalize(),r[4].setComponents(u-c,m-p,g-E,C-w).normalize(),n===As)r[5].setComponents(u+c,m+p,g+E,C+w).normalize();else if(n===np)r[5].setComponents(c,p,E,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Za.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),Za.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Za)}intersectsSprite(e){return Za.center.set(0,0,0),Za.radius=.7071067811865476,Za.applyMatrix4(e.matrixWorld),this.intersectsSphere(Za)}intersectsSphere(e){const n=this.planes,r=e.center,i=-e.radius;for(let a=0;a<6;a++)if(n[a].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const n=this.planes;for(let r=0;r<6;r++){const i=n[r];if(ah.x=i.normal.x>0?e.max.x:e.min.x,ah.y=i.normal.y>0?e.max.y:e.min.y,ah.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(ah)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let r=0;r<6;r++)if(n[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function d1(){let t=null,e=!1,n=null,r=null;function i(a,l){n(a,l),r=t.requestAnimationFrame(i)}return{start:function(){e!==!0&&n!==null&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(a){n=a},setContext:function(a){t=a}}}function qj(t,e){const n=e.isWebGL2,r=new WeakMap;function i(f,h){const p=f.array,m=f.usage,y=p.byteLength,S=t.createBuffer();t.bindBuffer(h,S),t.bufferData(h,p,m),f.onUploadCallback();let E;if(p instanceof Float32Array)E=t.FLOAT;else if(p instanceof Uint16Array)if(f.isFloat16BufferAttribute)if(n)E=t.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else E=t.UNSIGNED_SHORT;else if(p instanceof Int16Array)E=t.SHORT;else if(p instanceof Uint32Array)E=t.UNSIGNED_INT;else if(p instanceof Int32Array)E=t.INT;else if(p instanceof Int8Array)E=t.BYTE;else if(p instanceof Uint8Array)E=t.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)E=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:S,type:E,bytesPerElement:p.BYTES_PER_ELEMENT,version:f.version,size:y}}function a(f,h,p){const m=h.array,y=h._updateRange,S=h.updateRanges;if(t.bindBuffer(p,f),y.count===-1&&S.length===0&&t.bufferSubData(p,0,m),S.length!==0){for(let E=0,g=S.length;E<g;E++){const v=S[E];n?t.bufferSubData(p,v.start*m.BYTES_PER_ELEMENT,m,v.start,v.count):t.bufferSubData(p,v.start*m.BYTES_PER_ELEMENT,m.subarray(v.start,v.start+v.count))}h.clearUpdateRanges()}y.count!==-1&&(n?t.bufferSubData(p,y.offset*m.BYTES_PER_ELEMENT,m,y.offset,y.count):t.bufferSubData(p,y.offset*m.BYTES_PER_ELEMENT,m.subarray(y.offset,y.offset+y.count)),y.count=-1),h.onUploadCallback()}function l(f){return f.isInterleavedBufferAttribute&&(f=f.data),r.get(f)}function c(f){f.isInterleavedBufferAttribute&&(f=f.data);const h=r.get(f);h&&(t.deleteBuffer(h.buffer),r.delete(f))}function u(f,h){if(f.isGLBufferAttribute){const m=r.get(f);(!m||m.version<f.version)&&r.set(f,{buffer:f.buffer,type:f.type,bytesPerElement:f.elementSize,version:f.version});return}f.isInterleavedBufferAttribute&&(f=f.data);const p=r.get(f);if(p===void 0)r.set(f,i(f,h));else if(p.version<f.version){if(p.size!==f.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");a(p.buffer,f,h),p.version=f.version}}return{get:l,remove:c,update:u}}class jy extends is{constructor(e=1,n=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:r,heightSegments:i};const a=e/2,l=n/2,c=Math.floor(r),u=Math.floor(i),f=c+1,h=u+1,p=e/c,m=n/u,y=[],S=[],E=[],g=[];for(let v=0;v<h;v++){const x=v*m-l;for(let w=0;w<f;w++){const C=w*p-a;S.push(C,-x,0),E.push(0,0,1),g.push(w/c),g.push(1-v/u)}}for(let v=0;v<u;v++)for(let x=0;x<c;x++){const w=x+f*v,C=x+f*(v+1),T=x+1+f*(v+1),M=x+1+f*v;y.push(w,C,M),y.push(C,T,M)}this.setIndex(y),this.setAttribute("position",new Qi(S,3)),this.setAttribute("normal",new Qi(E,3)),this.setAttribute("uv",new Qi(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jy(e.width,e.height,e.widthSegments,e.heightSegments)}}var Zj=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Xj=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Kj=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Yj=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Jj=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Qj=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,eH=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,tH=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,nH=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,rH=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,iH=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,sH=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,aH=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,oH=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,lH=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,cH=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,uH=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,dH=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,fH=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,hH=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,pH=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,mH=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,gH=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,_H=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,vH=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,yH=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,SH=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,wH=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,xH=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,EH=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,bH="gl_FragColor = linearToOutputTexel( gl_FragColor );",TH=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,MH=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,RH=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,CH=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,AH=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,PH=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,IH=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,NH=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,kH=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,LH=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,OH=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,DH=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,UH=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,FH=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,zH=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,$H=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,BH=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,VH=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,jH=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,HH=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,GH=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,WH=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,qH=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,ZH=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,XH=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,KH=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,YH=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,JH=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,QH=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,eG=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,tG=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,nG=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,rG=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,iG=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,sG=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,aG=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,oG=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,lG=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,cG=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,uG=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,dG=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,fG=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,hG=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,pG=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,mG=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,gG=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,_G=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,vG=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,yG=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,SG=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,wG=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,xG=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,EG=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,bG=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,TG=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,MG=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,RG=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,CG=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,AG=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,PG=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,IG=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,NG=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,kG=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,LG=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,OG=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,DG=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,UG=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,FG=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,zG=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,$G=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color *= toneMappingExposure;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,BG=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,VG=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,jG=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,HG=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,GG=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,WG=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const qG=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,ZG=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,XG=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,KG=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,YG=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,JG=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,QG=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,e5=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,t5=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,n5=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,r5=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,i5=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,s5=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,a5=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,o5=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,l5=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,c5=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,u5=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,d5=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,f5=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,h5=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,p5=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,m5=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,g5=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,v5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,y5=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,S5=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,w5=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,x5=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,E5=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,b5=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,T5=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,M5=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,At={alphahash_fragment:Zj,alphahash_pars_fragment:Xj,alphamap_fragment:Kj,alphamap_pars_fragment:Yj,alphatest_fragment:Jj,alphatest_pars_fragment:Qj,aomap_fragment:eH,aomap_pars_fragment:tH,batching_pars_vertex:nH,batching_vertex:rH,begin_vertex:iH,beginnormal_vertex:sH,bsdfs:aH,iridescence_fragment:oH,bumpmap_pars_fragment:lH,clipping_planes_fragment:cH,clipping_planes_pars_fragment:uH,clipping_planes_pars_vertex:dH,clipping_planes_vertex:fH,color_fragment:hH,color_pars_fragment:pH,color_pars_vertex:mH,color_vertex:gH,common:_H,cube_uv_reflection_fragment:vH,defaultnormal_vertex:yH,displacementmap_pars_vertex:SH,displacementmap_vertex:wH,emissivemap_fragment:xH,emissivemap_pars_fragment:EH,colorspace_fragment:bH,colorspace_pars_fragment:TH,envmap_fragment:MH,envmap_common_pars_fragment:RH,envmap_pars_fragment:CH,envmap_pars_vertex:AH,envmap_physical_pars_fragment:BH,envmap_vertex:PH,fog_vertex:IH,fog_pars_vertex:NH,fog_fragment:kH,fog_pars_fragment:LH,gradientmap_pars_fragment:OH,lightmap_fragment:DH,lightmap_pars_fragment:UH,lights_lambert_fragment:FH,lights_lambert_pars_fragment:zH,lights_pars_begin:$H,lights_toon_fragment:VH,lights_toon_pars_fragment:jH,lights_phong_fragment:HH,lights_phong_pars_fragment:GH,lights_physical_fragment:WH,lights_physical_pars_fragment:qH,lights_fragment_begin:ZH,lights_fragment_maps:XH,lights_fragment_end:KH,logdepthbuf_fragment:YH,logdepthbuf_pars_fragment:JH,logdepthbuf_pars_vertex:QH,logdepthbuf_vertex:eG,map_fragment:tG,map_pars_fragment:nG,map_particle_fragment:rG,map_particle_pars_fragment:iG,metalnessmap_fragment:sG,metalnessmap_pars_fragment:aG,morphcolor_vertex:oG,morphnormal_vertex:lG,morphtarget_pars_vertex:cG,morphtarget_vertex:uG,normal_fragment_begin:dG,normal_fragment_maps:fG,normal_pars_fragment:hG,normal_pars_vertex:pG,normal_vertex:mG,normalmap_pars_fragment:gG,clearcoat_normal_fragment_begin:_G,clearcoat_normal_fragment_maps:vG,clearcoat_pars_fragment:yG,iridescence_pars_fragment:SG,opaque_fragment:wG,packing:xG,premultiplied_alpha_fragment:EG,project_vertex:bG,dithering_fragment:TG,dithering_pars_fragment:MG,roughnessmap_fragment:RG,roughnessmap_pars_fragment:CG,shadowmap_pars_fragment:AG,shadowmap_pars_vertex:PG,shadowmap_vertex:IG,shadowmask_pars_fragment:NG,skinbase_vertex:kG,skinning_pars_vertex:LG,skinning_vertex:OG,skinnormal_vertex:DG,specularmap_fragment:UG,specularmap_pars_fragment:FG,tonemapping_fragment:zG,tonemapping_pars_fragment:$G,transmission_fragment:BG,transmission_pars_fragment:VG,uv_pars_fragment:jG,uv_pars_vertex:HG,uv_vertex:GG,worldpos_vertex:WG,background_vert:qG,background_frag:ZG,backgroundCube_vert:XG,backgroundCube_frag:KG,cube_vert:YG,cube_frag:JG,depth_vert:QG,depth_frag:e5,distanceRGBA_vert:t5,distanceRGBA_frag:n5,equirect_vert:r5,equirect_frag:i5,linedashed_vert:s5,linedashed_frag:a5,meshbasic_vert:o5,meshbasic_frag:l5,meshlambert_vert:c5,meshlambert_frag:u5,meshmatcap_vert:d5,meshmatcap_frag:f5,meshnormal_vert:h5,meshnormal_frag:p5,meshphong_vert:m5,meshphong_frag:g5,meshphysical_vert:_5,meshphysical_frag:v5,meshtoon_vert:y5,meshtoon_frag:S5,points_vert:w5,points_frag:x5,shadow_vert:E5,shadow_frag:b5,sprite_vert:T5,sprite_frag:M5},Be={common:{diffuse:{value:new It(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Dt},alphaMap:{value:null},alphaMapTransform:{value:new Dt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Dt}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Dt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Dt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Dt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Dt},normalScale:{value:new sn(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Dt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Dt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Dt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Dt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new It(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new It(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Dt},alphaTest:{value:0},uvTransform:{value:new Dt}},sprite:{diffuse:{value:new It(16777215)},opacity:{value:1},center:{value:new sn(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Dt},alphaMap:{value:null},alphaMapTransform:{value:new Dt},alphaTest:{value:0}}},Yi={basic:{uniforms:Tr([Be.common,Be.specularmap,Be.envmap,Be.aomap,Be.lightmap,Be.fog]),vertexShader:At.meshbasic_vert,fragmentShader:At.meshbasic_frag},lambert:{uniforms:Tr([Be.common,Be.specularmap,Be.envmap,Be.aomap,Be.lightmap,Be.emissivemap,Be.bumpmap,Be.normalmap,Be.displacementmap,Be.fog,Be.lights,{emissive:{value:new It(0)}}]),vertexShader:At.meshlambert_vert,fragmentShader:At.meshlambert_frag},phong:{uniforms:Tr([Be.common,Be.specularmap,Be.envmap,Be.aomap,Be.lightmap,Be.emissivemap,Be.bumpmap,Be.normalmap,Be.displacementmap,Be.fog,Be.lights,{emissive:{value:new It(0)},specular:{value:new It(1118481)},shininess:{value:30}}]),vertexShader:At.meshphong_vert,fragmentShader:At.meshphong_frag},standard:{uniforms:Tr([Be.common,Be.envmap,Be.aomap,Be.lightmap,Be.emissivemap,Be.bumpmap,Be.normalmap,Be.displacementmap,Be.roughnessmap,Be.metalnessmap,Be.fog,Be.lights,{emissive:{value:new It(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:At.meshphysical_vert,fragmentShader:At.meshphysical_frag},toon:{uniforms:Tr([Be.common,Be.aomap,Be.lightmap,Be.emissivemap,Be.bumpmap,Be.normalmap,Be.displacementmap,Be.gradientmap,Be.fog,Be.lights,{emissive:{value:new It(0)}}]),vertexShader:At.meshtoon_vert,fragmentShader:At.meshtoon_frag},matcap:{uniforms:Tr([Be.common,Be.bumpmap,Be.normalmap,Be.displacementmap,Be.fog,{matcap:{value:null}}]),vertexShader:At.meshmatcap_vert,fragmentShader:At.meshmatcap_frag},points:{uniforms:Tr([Be.points,Be.fog]),vertexShader:At.points_vert,fragmentShader:At.points_frag},dashed:{uniforms:Tr([Be.common,Be.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:At.linedashed_vert,fragmentShader:At.linedashed_frag},depth:{uniforms:Tr([Be.common,Be.displacementmap]),vertexShader:At.depth_vert,fragmentShader:At.depth_frag},normal:{uniforms:Tr([Be.common,Be.bumpmap,Be.normalmap,Be.displacementmap,{opacity:{value:1}}]),vertexShader:At.meshnormal_vert,fragmentShader:At.meshnormal_frag},sprite:{uniforms:Tr([Be.sprite,Be.fog]),vertexShader:At.sprite_vert,fragmentShader:At.sprite_frag},background:{uniforms:{uvTransform:{value:new Dt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:At.background_vert,fragmentShader:At.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:At.backgroundCube_vert,fragmentShader:At.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:At.cube_vert,fragmentShader:At.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:At.equirect_vert,fragmentShader:At.equirect_frag},distanceRGBA:{uniforms:Tr([Be.common,Be.displacementmap,{referencePosition:{value:new Se},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:At.distanceRGBA_vert,fragmentShader:At.distanceRGBA_frag},shadow:{uniforms:Tr([Be.lights,Be.fog,{color:{value:new It(0)},opacity:{value:1}}]),vertexShader:At.shadow_vert,fragmentShader:At.shadow_frag}};Yi.physical={uniforms:Tr([Yi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Dt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Dt},clearcoatNormalScale:{value:new sn(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Dt},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Dt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Dt},sheen:{value:0},sheenColor:{value:new It(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Dt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Dt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Dt},transmissionSamplerSize:{value:new sn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Dt},attenuationDistance:{value:0},attenuationColor:{value:new It(0)},specularColor:{value:new It(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Dt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Dt},anisotropyVector:{value:new sn},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Dt}}]),vertexShader:At.meshphysical_vert,fragmentShader:At.meshphysical_frag};const oh={r:0,b:0,g:0};function R5(t,e,n,r,i,a,l){const c=new It(0);let u=a===!0?0:1,f,h,p=null,m=0,y=null;function S(g,v){let x=!1,w=v.isScene===!0?v.background:null;w&&w.isTexture&&(w=(v.backgroundBlurriness>0?n:e).get(w)),w===null?E(c,u):w&&w.isColor&&(E(w,1),x=!0);const C=t.xr.getEnvironmentBlendMode();C==="additive"?r.buffers.color.setClear(0,0,0,1,l):C==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,l),(t.autoClear||x)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),w&&(w.isCubeTexture||w.mapping===Np)?(h===void 0&&(h=new _r(new Ou(1,1,1),new mo({name:"BackgroundCubeMaterial",uniforms:Fl(Yi.backgroundCube.uniforms),vertexShader:Yi.backgroundCube.vertexShader,fragmentShader:Yi.backgroundCube.fragmentShader,side:ar,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(T,M,A){this.matrixWorld.copyPosition(A.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(h)),h.material.uniforms.envMap.value=w,h.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,h.material.toneMapped=on.getTransfer(w.colorSpace)!==mn,(p!==w||m!==w.version||y!==t.toneMapping)&&(h.material.needsUpdate=!0,p=w,m=w.version,y=t.toneMapping),h.layers.enableAll(),g.unshift(h,h.geometry,h.material,0,0,null)):w&&w.isTexture&&(f===void 0&&(f=new _r(new jy(2,2),new mo({name:"BackgroundMaterial",uniforms:Fl(Yi.background.uniforms),vertexShader:Yi.background.vertexShader,fragmentShader:Yi.background.fragmentShader,side:wa,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),Object.defineProperty(f.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(f)),f.material.uniforms.t2D.value=w,f.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,f.material.toneMapped=on.getTransfer(w.colorSpace)!==mn,w.matrixAutoUpdate===!0&&w.updateMatrix(),f.material.uniforms.uvTransform.value.copy(w.matrix),(p!==w||m!==w.version||y!==t.toneMapping)&&(f.material.needsUpdate=!0,p=w,m=w.version,y=t.toneMapping),f.layers.enableAll(),g.unshift(f,f.geometry,f.material,0,0,null))}function E(g,v){g.getRGB(oh,o1(t)),r.buffers.color.setClear(oh.r,oh.g,oh.b,v,l)}return{getClearColor:function(){return c},setClearColor:function(g,v=1){c.set(g),u=v,E(c,u)},getClearAlpha:function(){return u},setClearAlpha:function(g){u=g,E(c,u)},render:S}}function C5(t,e,n,r){const i=t.getParameter(t.MAX_VERTEX_ATTRIBS),a=r.isWebGL2?null:e.get("OES_vertex_array_object"),l=r.isWebGL2||a!==null,c={},u=g(null);let f=u,h=!1;function p(Z,ie,de,pe,K){let ne=!1;if(l){const j=E(pe,de,ie);f!==j&&(f=j,y(f.object)),ne=v(Z,pe,de,K),ne&&x(Z,pe,de,K)}else{const j=ie.wireframe===!0;(f.geometry!==pe.id||f.program!==de.id||f.wireframe!==j)&&(f.geometry=pe.id,f.program=de.id,f.wireframe=j,ne=!0)}K!==null&&n.update(K,t.ELEMENT_ARRAY_BUFFER),(ne||h)&&(h=!1,F(Z,ie,de,pe),K!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.get(K).buffer))}function m(){return r.isWebGL2?t.createVertexArray():a.createVertexArrayOES()}function y(Z){return r.isWebGL2?t.bindVertexArray(Z):a.bindVertexArrayOES(Z)}function S(Z){return r.isWebGL2?t.deleteVertexArray(Z):a.deleteVertexArrayOES(Z)}function E(Z,ie,de){const pe=de.wireframe===!0;let K=c[Z.id];K===void 0&&(K={},c[Z.id]=K);let ne=K[ie.id];ne===void 0&&(ne={},K[ie.id]=ne);let j=ne[pe];return j===void 0&&(j=g(m()),ne[pe]=j),j}function g(Z){const ie=[],de=[],pe=[];for(let K=0;K<i;K++)ie[K]=0,de[K]=0,pe[K]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ie,enabledAttributes:de,attributeDivisors:pe,object:Z,attributes:{},index:null}}function v(Z,ie,de,pe){const K=f.attributes,ne=ie.attributes;let j=0;const N=de.getAttributes();for(const H in N)if(N[H].location>=0){const P=K[H];let L=ne[H];if(L===void 0&&(H==="instanceMatrix"&&Z.instanceMatrix&&(L=Z.instanceMatrix),H==="instanceColor"&&Z.instanceColor&&(L=Z.instanceColor)),P===void 0||P.attribute!==L||L&&P.data!==L.data)return!0;j++}return f.attributesNum!==j||f.index!==pe}function x(Z,ie,de,pe){const K={},ne=ie.attributes;let j=0;const N=de.getAttributes();for(const H in N)if(N[H].location>=0){let P=ne[H];P===void 0&&(H==="instanceMatrix"&&Z.instanceMatrix&&(P=Z.instanceMatrix),H==="instanceColor"&&Z.instanceColor&&(P=Z.instanceColor));const L={};L.attribute=P,P&&P.data&&(L.data=P.data),K[H]=L,j++}f.attributes=K,f.attributesNum=j,f.index=pe}function w(){const Z=f.newAttributes;for(let ie=0,de=Z.length;ie<de;ie++)Z[ie]=0}function C(Z){T(Z,0)}function T(Z,ie){const de=f.newAttributes,pe=f.enabledAttributes,K=f.attributeDivisors;de[Z]=1,pe[Z]===0&&(t.enableVertexAttribArray(Z),pe[Z]=1),K[Z]!==ie&&((r.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Z,ie),K[Z]=ie)}function M(){const Z=f.newAttributes,ie=f.enabledAttributes;for(let de=0,pe=ie.length;de<pe;de++)ie[de]!==Z[de]&&(t.disableVertexAttribArray(de),ie[de]=0)}function A(Z,ie,de,pe,K,ne,j){j===!0?t.vertexAttribIPointer(Z,ie,de,K,ne):t.vertexAttribPointer(Z,ie,de,pe,K,ne)}function F(Z,ie,de,pe){if(r.isWebGL2===!1&&(Z.isInstancedMesh||pe.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;w();const K=pe.attributes,ne=de.getAttributes(),j=ie.defaultAttributeValues;for(const N in ne){const H=ne[N];if(H.location>=0){let U=K[N];if(U===void 0&&(N==="instanceMatrix"&&Z.instanceMatrix&&(U=Z.instanceMatrix),N==="instanceColor"&&Z.instanceColor&&(U=Z.instanceColor)),U!==void 0){const P=U.normalized,L=U.itemSize,G=n.get(U);if(G===void 0)continue;const Q=G.buffer,le=G.type,xe=G.bytesPerElement,Te=r.isWebGL2===!0&&(le===t.INT||le===t.UNSIGNED_INT||U.gpuType===VA);if(U.isInterleavedBufferAttribute){const X=U.data,z=X.stride,ve=U.offset;if(X.isInstancedInterleavedBuffer){for(let he=0;he<H.locationSize;he++)T(H.location+he,X.meshPerAttribute);Z.isInstancedMesh!==!0&&pe._maxInstanceCount===void 0&&(pe._maxInstanceCount=X.meshPerAttribute*X.count)}else for(let he=0;he<H.locationSize;he++)C(H.location+he);t.bindBuffer(t.ARRAY_BUFFER,Q);for(let he=0;he<H.locationSize;he++)A(H.location+he,L/H.locationSize,le,P,z*xe,(ve+L/H.locationSize*he)*xe,Te)}else{if(U.isInstancedBufferAttribute){for(let X=0;X<H.locationSize;X++)T(H.location+X,U.meshPerAttribute);Z.isInstancedMesh!==!0&&pe._maxInstanceCount===void 0&&(pe._maxInstanceCount=U.meshPerAttribute*U.count)}else for(let X=0;X<H.locationSize;X++)C(H.location+X);t.bindBuffer(t.ARRAY_BUFFER,Q);for(let X=0;X<H.locationSize;X++)A(H.location+X,L/H.locationSize,le,P,L*xe,L/H.locationSize*X*xe,Te)}}else if(j!==void 0){const P=j[N];if(P!==void 0)switch(P.length){case 2:t.vertexAttrib2fv(H.location,P);break;case 3:t.vertexAttrib3fv(H.location,P);break;case 4:t.vertexAttrib4fv(H.location,P);break;default:t.vertexAttrib1fv(H.location,P)}}}}M()}function I(){J();for(const Z in c){const ie=c[Z];for(const de in ie){const pe=ie[de];for(const K in pe)S(pe[K].object),delete pe[K];delete ie[de]}delete c[Z]}}function O(Z){if(c[Z.id]===void 0)return;const ie=c[Z.id];for(const de in ie){const pe=ie[de];for(const K in pe)S(pe[K].object),delete pe[K];delete ie[de]}delete c[Z.id]}function W(Z){for(const ie in c){const de=c[ie];if(de[Z.id]===void 0)continue;const pe=de[Z.id];for(const K in pe)S(pe[K].object),delete pe[K];delete de[Z.id]}}function J(){ae(),h=!0,f!==u&&(f=u,y(f.object))}function ae(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:p,reset:J,resetDefaultState:ae,dispose:I,releaseStatesOfGeometry:O,releaseStatesOfProgram:W,initAttributes:w,enableAttribute:C,disableUnusedAttributes:M}}function A5(t,e,n,r){const i=r.isWebGL2;let a;function l(h){a=h}function c(h,p){t.drawArrays(a,h,p),n.update(p,a,1)}function u(h,p,m){if(m===0)return;let y,S;if(i)y=t,S="drawArraysInstanced";else if(y=e.get("ANGLE_instanced_arrays"),S="drawArraysInstancedANGLE",y===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}y[S](a,h,p,m),n.update(p,a,m)}function f(h,p,m){if(m===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let S=0;S<m;S++)this.render(h[S],p[S]);else{y.multiDrawArraysWEBGL(a,h,0,p,0,m);let S=0;for(let E=0;E<m;E++)S+=p[E];n.update(S,a,1)}}this.setMode=l,this.render=c,this.renderInstances=u,this.renderMultiDraw=f}function P5(t,e,n){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const A=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(A){if(A==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";A="mediump"}return A==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const l=typeof WebGL2RenderingContext<"u"&&t.constructor.name==="WebGL2RenderingContext";let c=n.precision!==void 0?n.precision:"highp";const u=a(c);u!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",u,"instead."),c=u);const f=l||e.has("WEBGL_draw_buffers"),h=n.logarithmicDepthBuffer===!0,p=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),m=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),y=t.getParameter(t.MAX_TEXTURE_SIZE),S=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),E=t.getParameter(t.MAX_VERTEX_ATTRIBS),g=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),v=t.getParameter(t.MAX_VARYING_VECTORS),x=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),w=m>0,C=l||e.has("OES_texture_float"),T=w&&C,M=l?t.getParameter(t.MAX_SAMPLES):0;return{isWebGL2:l,drawBuffers:f,getMaxAnisotropy:i,getMaxPrecision:a,precision:c,logarithmicDepthBuffer:h,maxTextures:p,maxVertexTextures:m,maxTextureSize:y,maxCubemapSize:S,maxAttributes:E,maxVertexUniforms:g,maxVaryings:v,maxFragmentUniforms:x,vertexTextures:w,floatFragmentTextures:C,floatVertexTextures:T,maxSamples:M}}function I5(t){const e=this;let n=null,r=0,i=!1,a=!1;const l=new Ya,c=new Dt,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(p,m){const y=p.length!==0||m||r!==0||i;return i=m,r=p.length,y},this.beginShadows=function(){a=!0,h(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(p,m){n=h(p,m,0)},this.setState=function(p,m,y){const S=p.clippingPlanes,E=p.clipIntersection,g=p.clipShadows,v=t.get(p);if(!i||S===null||S.length===0||a&&!g)a?h(null):f();else{const x=a?0:r,w=x*4;let C=v.clippingState||null;u.value=C,C=h(S,m,w,y);for(let T=0;T!==w;++T)C[T]=n[T];v.clippingState=C,this.numIntersection=E?this.numPlanes:0,this.numPlanes+=x}};function f(){u.value!==n&&(u.value=n,u.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function h(p,m,y,S){const E=p!==null?p.length:0;let g=null;if(E!==0){if(g=u.value,S!==!0||g===null){const v=y+E*4,x=m.matrixWorldInverse;c.getNormalMatrix(x),(g===null||g.length<v)&&(g=new Float32Array(v));for(let w=0,C=y;w!==E;++w,C+=4)l.copy(p[w]).applyMatrix4(x,c),l.normal.toArray(g,C),g[C+3]=l.constant}u.value=g,u.needsUpdate=!0}return e.numPlanes=E,e.numIntersection=0,g}}function N5(t){let e=new WeakMap;function n(l,c){return c===Ov?l.mapping=Ol:c===Dv&&(l.mapping=Dl),l}function r(l){if(l&&l.isTexture){const c=l.mapping;if(c===Ov||c===Dv)if(e.has(l)){const u=e.get(l).texture;return n(u,l.mapping)}else{const u=l.image;if(u&&u.height>0){const f=new Hj(u.height/2);return f.fromEquirectangularTexture(t,l),e.set(l,f),l.addEventListener("dispose",i),n(f.texture,l.mapping)}else return null}}return l}function i(l){const c=l.target;c.removeEventListener("dispose",i);const u=e.get(c);u!==void 0&&(e.delete(c),u.dispose())}function a(){e=new WeakMap}return{get:r,dispose:a}}class k5 extends l1{constructor(e=-1,n=1,r=1,i=-1,a=.1,l=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=r,this.bottom=i,this.near=a,this.far=l,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,r,i,a,l){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let a=r-e,l=r+e,c=i+n,u=i-n;if(this.view!==null&&this.view.enabled){const f=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=f*this.view.offsetX,l=a+f*this.view.width,c-=h*this.view.offsetY,u=c-h*this.view.height}this.projectionMatrix.makeOrthographic(a,l,c,u,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}const wl=4,uT=[.125,.215,.35,.446,.526,.582],no=20,w_=new k5,dT=new It;let x_=null,E_=0,b_=0;const Ja=(1+Math.sqrt(5))/2,ul=1/Ja,fT=[new Se(1,1,1),new Se(-1,1,1),new Se(1,1,-1),new Se(-1,1,-1),new Se(0,Ja,ul),new Se(0,Ja,-ul),new Se(ul,0,Ja),new Se(-ul,0,Ja),new Se(Ja,ul,0),new Se(-Ja,ul,0)];class hT{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,r=.1,i=100){x_=this._renderer.getRenderTarget(),E_=this._renderer.getActiveCubeFace(),b_=this._renderer.getActiveMipmapLevel(),this._setSize(256);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,r,i,a),n>0&&this._blur(a,0,0,n),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=gT(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=mT(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(x_,E_,b_),e.scissorTest=!1,lh(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===Ol||e.mapping===Dl?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),x_=this._renderer.getRenderTarget(),E_=this._renderer.getActiveCubeFace(),b_=this._renderer.getActiveMipmapLevel();const r=n||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,r={magFilter:mi,minFilter:mi,generateMipmaps:!1,type:yu,format:Vi,colorSpace:Os,depthBuffer:!1},i=pT(e,n,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=pT(e,n,r);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=L5(a)),this._blurMaterial=O5(a,e,n)}return i}_compileMaterial(e){const n=new _r(this._lodPlanes[0],e);this._renderer.compile(n,w_)}_sceneToCubeUV(e,n,r,i){const c=new gi(90,1,n,r),u=[1,-1,1,1,1,1],f=[1,1,1,-1,-1,-1],h=this._renderer,p=h.autoClear,m=h.toneMapping;h.getClearColor(dT),h.toneMapping=_a,h.autoClear=!1;const y=new to({name:"PMREM.Background",side:ar,depthWrite:!1,depthTest:!1}),S=new _r(new Ou,y);let E=!1;const g=e.background;g?g.isColor&&(y.color.copy(g),e.background=null,E=!0):(y.color.copy(dT),E=!0);for(let v=0;v<6;v++){const x=v%3;x===0?(c.up.set(0,u[v],0),c.lookAt(f[v],0,0)):x===1?(c.up.set(0,0,u[v]),c.lookAt(0,f[v],0)):(c.up.set(0,u[v],0),c.lookAt(0,0,f[v]));const w=this._cubeSize;lh(i,x*w,v>2?w:0,w,w),h.setRenderTarget(i),E&&h.render(S,c),h.render(e,c)}S.geometry.dispose(),S.material.dispose(),h.toneMapping=m,h.autoClear=p,e.background=g}_textureToCubeUV(e,n){const r=this._renderer,i=e.mapping===Ol||e.mapping===Dl;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=gT()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=mT());const a=i?this._cubemapMaterial:this._equirectMaterial,l=new _r(this._lodPlanes[0],a),c=a.uniforms;c.envMap.value=e;const u=this._cubeSize;lh(n,0,0,3*u,2*u),r.setRenderTarget(n),r.render(l,w_)}_applyPMREM(e){const n=this._renderer,r=n.autoClear;n.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const a=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),l=fT[(i-1)%fT.length];this._blur(e,i-1,i,a,l)}n.autoClear=r}_blur(e,n,r,i,a){const l=this._pingPongRenderTarget;this._halfBlur(e,l,n,r,i,"latitudinal",a),this._halfBlur(l,e,r,r,i,"longitudinal",a)}_halfBlur(e,n,r,i,a,l,c){const u=this._renderer,f=this._blurMaterial;l!=="latitudinal"&&l!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,p=new _r(this._lodPlanes[i],f),m=f.uniforms,y=this._sizeLods[r]-1,S=isFinite(a)?Math.PI/(2*y):2*Math.PI/(2*no-1),E=a/S,g=isFinite(a)?1+Math.floor(h*E):no;g>no&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${no}`);const v=[];let x=0;for(let A=0;A<no;++A){const F=A/E,I=Math.exp(-F*F/2);v.push(I),A===0?x+=I:A<g&&(x+=2*I)}for(let A=0;A<v.length;A++)v[A]=v[A]/x;m.envMap.value=e.texture,m.samples.value=g,m.weights.value=v,m.latitudinal.value=l==="latitudinal",c&&(m.poleAxis.value=c);const{_lodMax:w}=this;m.dTheta.value=S,m.mipInt.value=w-r;const C=this._sizeLods[i],T=3*C*(i>w-wl?i-w+wl:0),M=4*(this._cubeSize-C);lh(n,T,M,3*C,2*C),u.setRenderTarget(n),u.render(p,w_)}}function L5(t){const e=[],n=[],r=[];let i=t;const a=t-wl+1+uT.length;for(let l=0;l<a;l++){const c=Math.pow(2,i);n.push(c);let u=1/c;l>t-wl?u=uT[l-t+wl-1]:l===0&&(u=0),r.push(u);const f=1/(c-2),h=-f,p=1+f,m=[h,h,p,h,p,p,h,h,p,p,h,p],y=6,S=6,E=3,g=2,v=1,x=new Float32Array(E*S*y),w=new Float32Array(g*S*y),C=new Float32Array(v*S*y);for(let M=0;M<y;M++){const A=M%3*2/3-1,F=M>2?0:-1,I=[A,F,0,A+2/3,F,0,A+2/3,F+1,0,A,F,0,A+2/3,F+1,0,A,F+1,0];x.set(I,E*S*M),w.set(m,g*S*M);const O=[M,M,M,M,M,M];C.set(O,v*S*M)}const T=new is;T.setAttribute("position",new Si(x,E)),T.setAttribute("uv",new Si(w,g)),T.setAttribute("faceIndex",new Si(C,v)),e.push(T),i>wl&&i--}return{lodPlanes:e,sizeLods:n,sigmas:r}}function pT(t,e,n){const r=new po(t,e,n);return r.texture.mapping=Np,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function lh(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function O5(t,e,n){const r=new Float32Array(no),i=new Se(0,1,0);return new mo({name:"SphericalGaussianBlur",defines:{n:no,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:Hy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ga,depthTest:!1,depthWrite:!1})}function mT(){return new mo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Hy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:ga,depthTest:!1,depthWrite:!1})}function gT(){return new mo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Hy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ga,depthTest:!1,depthWrite:!1})}function Hy(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function D5(t){let e=new WeakMap,n=null;function r(c){if(c&&c.isTexture){const u=c.mapping,f=u===Ov||u===Dv,h=u===Ol||u===Dl;if(f||h)if(c.isRenderTargetTexture&&c.needsPMREMUpdate===!0){c.needsPMREMUpdate=!1;let p=e.get(c);return n===null&&(n=new hT(t)),p=f?n.fromEquirectangular(c,p):n.fromCubemap(c,p),e.set(c,p),p.texture}else{if(e.has(c))return e.get(c).texture;{const p=c.image;if(f&&p&&p.height>0||h&&p&&i(p)){n===null&&(n=new hT(t));const m=f?n.fromEquirectangular(c):n.fromCubemap(c);return e.set(c,m),c.addEventListener("dispose",a),m.texture}else return null}}}return c}function i(c){let u=0;const f=6;for(let h=0;h<f;h++)c[h]!==void 0&&u++;return u===f}function a(c){const u=c.target;u.removeEventListener("dispose",a);const f=e.get(u);f!==void 0&&(e.delete(u),f.dispose())}function l(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:r,dispose:l}}function U5(t){const e={};function n(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(r)}return e[r]=i,i}return{has:function(r){return n(r)!==null},init:function(r){r.isWebGL2?(n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance")):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(r){const i=n(r);return i===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function F5(t,e,n,r){const i={},a=new WeakMap;function l(p){const m=p.target;m.index!==null&&e.remove(m.index);for(const S in m.attributes)e.remove(m.attributes[S]);for(const S in m.morphAttributes){const E=m.morphAttributes[S];for(let g=0,v=E.length;g<v;g++)e.remove(E[g])}m.removeEventListener("dispose",l),delete i[m.id];const y=a.get(m);y&&(e.remove(y),a.delete(m)),r.releaseStatesOfGeometry(m),m.isInstancedBufferGeometry===!0&&delete m._maxInstanceCount,n.memory.geometries--}function c(p,m){return i[m.id]===!0||(m.addEventListener("dispose",l),i[m.id]=!0,n.memory.geometries++),m}function u(p){const m=p.attributes;for(const S in m)e.update(m[S],t.ARRAY_BUFFER);const y=p.morphAttributes;for(const S in y){const E=y[S];for(let g=0,v=E.length;g<v;g++)e.update(E[g],t.ARRAY_BUFFER)}}function f(p){const m=[],y=p.index,S=p.attributes.position;let E=0;if(y!==null){const x=y.array;E=y.version;for(let w=0,C=x.length;w<C;w+=3){const T=x[w+0],M=x[w+1],A=x[w+2];m.push(T,M,M,A,A,T)}}else if(S!==void 0){const x=S.array;E=S.version;for(let w=0,C=x.length/3-1;w<C;w+=3){const T=w+0,M=w+1,A=w+2;m.push(T,M,M,A,A,T)}}else return;const g=new(JA(m)?a1:s1)(m,1);g.version=E;const v=a.get(p);v&&e.remove(v),a.set(p,g)}function h(p){const m=a.get(p);if(m){const y=p.index;y!==null&&m.version<y.version&&f(p)}else f(p);return a.get(p)}return{get:c,update:u,getWireframeAttribute:h}}function z5(t,e,n,r){const i=r.isWebGL2;let a;function l(y){a=y}let c,u;function f(y){c=y.type,u=y.bytesPerElement}function h(y,S){t.drawElements(a,S,c,y*u),n.update(S,a,1)}function p(y,S,E){if(E===0)return;let g,v;if(i)g=t,v="drawElementsInstanced";else if(g=e.get("ANGLE_instanced_arrays"),v="drawElementsInstancedANGLE",g===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[v](a,S,c,y*u,E),n.update(S,a,E)}function m(y,S,E){if(E===0)return;const g=e.get("WEBGL_multi_draw");if(g===null)for(let v=0;v<E;v++)this.render(y[v]/u,S[v]);else{g.multiDrawElementsWEBGL(a,S,0,c,y,0,E);let v=0;for(let x=0;x<E;x++)v+=S[x];n.update(v,a,1)}}this.setMode=l,this.setIndex=f,this.render=h,this.renderInstances=p,this.renderMultiDraw=m}function $5(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(a,l,c){switch(n.calls++,l){case t.TRIANGLES:n.triangles+=c*(a/3);break;case t.LINES:n.lines+=c*(a/2);break;case t.LINE_STRIP:n.lines+=c*(a-1);break;case t.LINE_LOOP:n.lines+=c*a;break;case t.POINTS:n.points+=c*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",l);break}}function i(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:i,update:r}}function B5(t,e){return t[0]-e[0]}function V5(t,e){return Math.abs(e[1])-Math.abs(t[1])}function j5(t,e,n){const r={},i=new Float32Array(8),a=new WeakMap,l=new sr,c=[];for(let f=0;f<8;f++)c[f]=[f,0];function u(f,h,p){const m=f.morphTargetInfluences;if(e.isWebGL2===!0){const y=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,S=y!==void 0?y.length:0;let E=a.get(h);if(E===void 0||E.count!==S){let Z=function(){J.dispose(),a.delete(h),h.removeEventListener("dispose",Z)};E!==void 0&&E.texture.dispose();const x=h.morphAttributes.position!==void 0,w=h.morphAttributes.normal!==void 0,C=h.morphAttributes.color!==void 0,T=h.morphAttributes.position||[],M=h.morphAttributes.normal||[],A=h.morphAttributes.color||[];let F=0;x===!0&&(F=1),w===!0&&(F=2),C===!0&&(F=3);let I=h.attributes.position.count*F,O=1;I>e.maxTextureSize&&(O=Math.ceil(I/e.maxTextureSize),I=e.maxTextureSize);const W=new Float32Array(I*O*4*S),J=new t1(W,I,O,S);J.type=pa,J.needsUpdate=!0;const ae=F*4;for(let ie=0;ie<S;ie++){const de=T[ie],pe=M[ie],K=A[ie],ne=I*O*4*ie;for(let j=0;j<de.count;j++){const N=j*ae;x===!0&&(l.fromBufferAttribute(de,j),W[ne+N+0]=l.x,W[ne+N+1]=l.y,W[ne+N+2]=l.z,W[ne+N+3]=0),w===!0&&(l.fromBufferAttribute(pe,j),W[ne+N+4]=l.x,W[ne+N+5]=l.y,W[ne+N+6]=l.z,W[ne+N+7]=0),C===!0&&(l.fromBufferAttribute(K,j),W[ne+N+8]=l.x,W[ne+N+9]=l.y,W[ne+N+10]=l.z,W[ne+N+11]=K.itemSize===4?l.w:1)}}E={count:S,texture:J,size:new sn(I,O)},a.set(h,E),h.addEventListener("dispose",Z)}let g=0;for(let x=0;x<m.length;x++)g+=m[x];const v=h.morphTargetsRelative?1:1-g;p.getUniforms().setValue(t,"morphTargetBaseInfluence",v),p.getUniforms().setValue(t,"morphTargetInfluences",m),p.getUniforms().setValue(t,"morphTargetsTexture",E.texture,n),p.getUniforms().setValue(t,"morphTargetsTextureSize",E.size)}else{const y=m===void 0?0:m.length;let S=r[h.id];if(S===void 0||S.length!==y){S=[];for(let w=0;w<y;w++)S[w]=[w,0];r[h.id]=S}for(let w=0;w<y;w++){const C=S[w];C[0]=w,C[1]=m[w]}S.sort(V5);for(let w=0;w<8;w++)w<y&&S[w][1]?(c[w][0]=S[w][0],c[w][1]=S[w][1]):(c[w][0]=Number.MAX_SAFE_INTEGER,c[w][1]=0);c.sort(B5);const E=h.morphAttributes.position,g=h.morphAttributes.normal;let v=0;for(let w=0;w<8;w++){const C=c[w],T=C[0],M=C[1];T!==Number.MAX_SAFE_INTEGER&&M?(E&&h.getAttribute("morphTarget"+w)!==E[T]&&h.setAttribute("morphTarget"+w,E[T]),g&&h.getAttribute("morphNormal"+w)!==g[T]&&h.setAttribute("morphNormal"+w,g[T]),i[w]=M,v+=M):(E&&h.hasAttribute("morphTarget"+w)===!0&&h.deleteAttribute("morphTarget"+w),g&&h.hasAttribute("morphNormal"+w)===!0&&h.deleteAttribute("morphNormal"+w),i[w]=0)}const x=h.morphTargetsRelative?1:1-v;p.getUniforms().setValue(t,"morphTargetBaseInfluence",x),p.getUniforms().setValue(t,"morphTargetInfluences",i)}}return{update:u}}function H5(t,e,n,r){let i=new WeakMap;function a(u){const f=r.render.frame,h=u.geometry,p=e.get(u,h);if(i.get(p)!==f&&(e.update(p),i.set(p,f)),u.isInstancedMesh&&(u.hasEventListener("dispose",c)===!1&&u.addEventListener("dispose",c),i.get(u)!==f&&(n.update(u.instanceMatrix,t.ARRAY_BUFFER),u.instanceColor!==null&&n.update(u.instanceColor,t.ARRAY_BUFFER),i.set(u,f))),u.isSkinnedMesh){const m=u.skeleton;i.get(m)!==f&&(m.update(),i.set(m,f))}return p}function l(){i=new WeakMap}function c(u){const f=u.target;f.removeEventListener("dispose",c),n.remove(f.instanceMatrix),f.instanceColor!==null&&n.remove(f.instanceColor)}return{update:a,dispose:l}}class f1 extends ti{constructor(e,n,r,i,a,l,c,u,f,h){if(h=h!==void 0?h:oo,h!==oo&&h!==Ul)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&h===oo&&(r=ha),r===void 0&&h===Ul&&(r=ao),super(null,i,a,l,c,u,h,r,f),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=c!==void 0?c:Cr,this.minFilter=u!==void 0?u:Cr,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}const h1=new ti,p1=new f1(1,1);p1.compareFunction=YA;const m1=new t1,g1=new Rj,_1=new c1,_T=[],vT=[],yT=new Float32Array(16),ST=new Float32Array(9),wT=new Float32Array(4);function Zl(t,e,n){const r=t[0];if(r<=0||r>0)return t;const i=e*n;let a=_T[i];if(a===void 0&&(a=new Float32Array(i),_T[i]=a),e!==0){r.toArray(a,0);for(let l=1,c=0;l!==e;++l)c+=n,t[l].toArray(a,c)}return a}function jn(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Hn(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function Dp(t,e){let n=vT[e];n===void 0&&(n=new Int32Array(e),vT[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function G5(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function W5(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(jn(n,e))return;t.uniform2fv(this.addr,e),Hn(n,e)}}function q5(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(jn(n,e))return;t.uniform3fv(this.addr,e),Hn(n,e)}}function Z5(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(jn(n,e))return;t.uniform4fv(this.addr,e),Hn(n,e)}}function X5(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(jn(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Hn(n,e)}else{if(jn(n,r))return;wT.set(r),t.uniformMatrix2fv(this.addr,!1,wT),Hn(n,r)}}function K5(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(jn(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Hn(n,e)}else{if(jn(n,r))return;ST.set(r),t.uniformMatrix3fv(this.addr,!1,ST),Hn(n,r)}}function Y5(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(jn(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Hn(n,e)}else{if(jn(n,r))return;yT.set(r),t.uniformMatrix4fv(this.addr,!1,yT),Hn(n,r)}}function J5(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Q5(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(jn(n,e))return;t.uniform2iv(this.addr,e),Hn(n,e)}}function e9(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(jn(n,e))return;t.uniform3iv(this.addr,e),Hn(n,e)}}function t9(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(jn(n,e))return;t.uniform4iv(this.addr,e),Hn(n,e)}}function n9(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function r9(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(jn(n,e))return;t.uniform2uiv(this.addr,e),Hn(n,e)}}function i9(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(jn(n,e))return;t.uniform3uiv(this.addr,e),Hn(n,e)}}function s9(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(jn(n,e))return;t.uniform4uiv(this.addr,e),Hn(n,e)}}function a9(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i);const a=this.type===t.SAMPLER_2D_SHADOW?p1:h1;n.setTexture2D(e||a,i)}function o9(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||g1,i)}function l9(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(e||_1,i)}function c9(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||m1,i)}function u9(t){switch(t){case 5126:return G5;case 35664:return W5;case 35665:return q5;case 35666:return Z5;case 35674:return X5;case 35675:return K5;case 35676:return Y5;case 5124:case 35670:return J5;case 35667:case 35671:return Q5;case 35668:case 35672:return e9;case 35669:case 35673:return t9;case 5125:return n9;case 36294:return r9;case 36295:return i9;case 36296:return s9;case 35678:case 36198:case 36298:case 36306:case 35682:return a9;case 35679:case 36299:case 36307:return o9;case 35680:case 36300:case 36308:case 36293:return l9;case 36289:case 36303:case 36311:case 36292:return c9}}function d9(t,e){t.uniform1fv(this.addr,e)}function f9(t,e){const n=Zl(e,this.size,2);t.uniform2fv(this.addr,n)}function h9(t,e){const n=Zl(e,this.size,3);t.uniform3fv(this.addr,n)}function p9(t,e){const n=Zl(e,this.size,4);t.uniform4fv(this.addr,n)}function m9(t,e){const n=Zl(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function g9(t,e){const n=Zl(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function _9(t,e){const n=Zl(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function v9(t,e){t.uniform1iv(this.addr,e)}function y9(t,e){t.uniform2iv(this.addr,e)}function S9(t,e){t.uniform3iv(this.addr,e)}function w9(t,e){t.uniform4iv(this.addr,e)}function x9(t,e){t.uniform1uiv(this.addr,e)}function E9(t,e){t.uniform2uiv(this.addr,e)}function b9(t,e){t.uniform3uiv(this.addr,e)}function T9(t,e){t.uniform4uiv(this.addr,e)}function M9(t,e,n){const r=this.cache,i=e.length,a=Dp(n,i);jn(r,a)||(t.uniform1iv(this.addr,a),Hn(r,a));for(let l=0;l!==i;++l)n.setTexture2D(e[l]||h1,a[l])}function R9(t,e,n){const r=this.cache,i=e.length,a=Dp(n,i);jn(r,a)||(t.uniform1iv(this.addr,a),Hn(r,a));for(let l=0;l!==i;++l)n.setTexture3D(e[l]||g1,a[l])}function C9(t,e,n){const r=this.cache,i=e.length,a=Dp(n,i);jn(r,a)||(t.uniform1iv(this.addr,a),Hn(r,a));for(let l=0;l!==i;++l)n.setTextureCube(e[l]||_1,a[l])}function A9(t,e,n){const r=this.cache,i=e.length,a=Dp(n,i);jn(r,a)||(t.uniform1iv(this.addr,a),Hn(r,a));for(let l=0;l!==i;++l)n.setTexture2DArray(e[l]||m1,a[l])}function P9(t){switch(t){case 5126:return d9;case 35664:return f9;case 35665:return h9;case 35666:return p9;case 35674:return m9;case 35675:return g9;case 35676:return _9;case 5124:case 35670:return v9;case 35667:case 35671:return y9;case 35668:case 35672:return S9;case 35669:case 35673:return w9;case 5125:return x9;case 36294:return E9;case 36295:return b9;case 36296:return T9;case 35678:case 36198:case 36298:case 36306:case 35682:return M9;case 35679:case 36299:case 36307:return R9;case 35680:case 36300:case 36308:case 36293:return C9;case 36289:case 36303:case 36311:case 36292:return A9}}class I9{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.setValue=u9(n.type)}}class N9{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=P9(n.type)}}class k9{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,r){const i=this.seq;for(let a=0,l=i.length;a!==l;++a){const c=i[a];c.setValue(e,n[c.id],r)}}}const T_=/(\w+)(\])?(\[|\.)?/g;function xT(t,e){t.seq.push(e),t.map[e.id]=e}function L9(t,e,n){const r=t.name,i=r.length;for(T_.lastIndex=0;;){const a=T_.exec(r),l=T_.lastIndex;let c=a[1];const u=a[2]==="]",f=a[3];if(u&&(c=c|0),f===void 0||f==="["&&l+2===i){xT(n,f===void 0?new I9(c,t,e):new N9(c,t,e));break}else{let p=n.map[c];p===void 0&&(p=new k9(c),xT(n,p)),n=p}}}class xh{constructor(e,n){this.seq=[],this.map={};const r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const a=e.getActiveUniform(n,i),l=e.getUniformLocation(n,a.name);L9(a,l,this)}}setValue(e,n,r,i){const a=this.map[n];a!==void 0&&a.setValue(e,r,i)}setOptional(e,n,r){const i=n[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,n,r,i){for(let a=0,l=n.length;a!==l;++a){const c=n[a],u=r[c.id];u.needsUpdate!==!1&&c.setValue(e,u.value,i)}}static seqWithValue(e,n){const r=[];for(let i=0,a=e.length;i!==a;++i){const l=e[i];l.id in n&&r.push(l)}return r}}function ET(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}const O9=37297;let D9=0;function U9(t,e){const n=t.split(`
`),r=[],i=Math.max(e-6,0),a=Math.min(e+6,n.length);for(let l=i;l<a;l++){const c=l+1;r.push(`${c===e?">":" "} ${c}: ${n[l]}`)}return r.join(`
`)}function F9(t){const e=on.getPrimaries(on.workingColorSpace),n=on.getPrimaries(t);let r;switch(e===n?r="":e===tp&&n===ep?r="LinearDisplayP3ToLinearSRGB":e===ep&&n===tp&&(r="LinearSRGBToLinearDisplayP3"),t){case Os:case kp:return[r,"LinearTransferOETF"];case rr:case Vy:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",t),[r,"LinearTransferOETF"]}}function bT(t,e,n){const r=t.getShaderParameter(e,t.COMPILE_STATUS),i=t.getShaderInfoLog(e).trim();if(r&&i==="")return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const l=parseInt(a[1]);return n.toUpperCase()+`

`+i+`

`+U9(t.getShaderSource(e),l)}else return i}function z9(t,e){const n=F9(e);return`vec4 ${t}( vec4 value ) { return ${n[0]}( ${n[1]}( value ) ); }`}function $9(t,e){let n;switch(e){case KV:n="Linear";break;case YV:n="Reinhard";break;case JV:n="OptimizedCineon";break;case QV:n="ACESFilmic";break;case tj:n="AgX";break;case ej:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function B9(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.normalMapTangentSpace||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(xl).join(`
`)}function V9(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(xl).join(`
`)}function j9(t){const e=[];for(const n in t){const r=t[n];r!==!1&&e.push("#define "+n+" "+r)}return e.join(`
`)}function H9(t,e){const n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const a=t.getActiveAttrib(e,i),l=a.name;let c=1;a.type===t.FLOAT_MAT2&&(c=2),a.type===t.FLOAT_MAT3&&(c=3),a.type===t.FLOAT_MAT4&&(c=4),n[l]={type:a.type,location:t.getAttribLocation(e,l),locationSize:c}}return n}function xl(t){return t!==""}function TT(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function MT(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const G9=/^[ \t]*#include +<([\w\d./]+)>/gm;function Vv(t){return t.replace(G9,q9)}const W9=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function q9(t,e){let n=At[e];if(n===void 0){const r=W9.get(e);if(r!==void 0)n=At[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return Vv(n)}const Z9=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function RT(t){return t.replace(Z9,X9)}function X9(t,e,n,r){let i="";for(let a=parseInt(e);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function CT(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function K9(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===zA?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===bV?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Ms&&(e="SHADOWMAP_TYPE_VSM"),e}function Y9(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Ol:case Dl:e="ENVMAP_TYPE_CUBE";break;case Np:e="ENVMAP_TYPE_CUBE_UV";break}return e}function J9(t){let e="ENVMAP_MODE_REFLECTION";return t.envMap&&t.envMapMode===Dl&&(e="ENVMAP_MODE_REFRACTION"),e}function Q9(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case $A:e="ENVMAP_BLENDING_MULTIPLY";break;case ZV:e="ENVMAP_BLENDING_MIX";break;case XV:e="ENVMAP_BLENDING_ADD";break}return e}function eW(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}function tW(t,e,n,r){const i=t.getContext(),a=n.defines;let l=n.vertexShader,c=n.fragmentShader;const u=K9(n),f=Y9(n),h=J9(n),p=Q9(n),m=eW(n),y=n.isWebGL2?"":B9(n),S=V9(n),E=j9(a),g=i.createProgram();let v,x,w=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,E].filter(xl).join(`
`),v.length>0&&(v+=`
`),x=[y,"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,E].filter(xl).join(`
`),x.length>0&&(x+=`
`)):(v=[CT(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,E,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(xl).join(`
`),x=[y,CT(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,E,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.envMap?"#define "+h:"",n.envMap?"#define "+p:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==_a?"#define TONE_MAPPING":"",n.toneMapping!==_a?At.tonemapping_pars_fragment:"",n.toneMapping!==_a?$9("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",At.colorspace_pars_fragment,z9("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(xl).join(`
`)),l=Vv(l),l=TT(l,n),l=MT(l,n),c=Vv(c),c=TT(c,n),c=MT(c,n),l=RT(l),c=RT(c),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,v=[S,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,x=["precision mediump sampler2DArray;","#define varying in",n.glslVersion===Wb?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Wb?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+x);const C=w+v+l,T=w+x+c,M=ET(i,i.VERTEX_SHADER,C),A=ET(i,i.FRAGMENT_SHADER,T);i.attachShader(g,M),i.attachShader(g,A),n.index0AttributeName!==void 0?i.bindAttribLocation(g,0,n.index0AttributeName):n.morphTargets===!0&&i.bindAttribLocation(g,0,"position"),i.linkProgram(g);function F(J){if(t.debug.checkShaderErrors){const ae=i.getProgramInfoLog(g).trim(),Z=i.getShaderInfoLog(M).trim(),ie=i.getShaderInfoLog(A).trim();let de=!0,pe=!0;if(i.getProgramParameter(g,i.LINK_STATUS)===!1)if(de=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(i,g,M,A);else{const K=bT(i,M,"vertex"),ne=bT(i,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(g,i.VALIDATE_STATUS)+`

Program Info Log: `+ae+`
`+K+`
`+ne)}else ae!==""?console.warn("THREE.WebGLProgram: Program Info Log:",ae):(Z===""||ie==="")&&(pe=!1);pe&&(J.diagnostics={runnable:de,programLog:ae,vertexShader:{log:Z,prefix:v},fragmentShader:{log:ie,prefix:x}})}i.deleteShader(M),i.deleteShader(A),I=new xh(i,g),O=H9(i,g)}let I;this.getUniforms=function(){return I===void 0&&F(this),I};let O;this.getAttributes=function(){return O===void 0&&F(this),O};let W=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return W===!1&&(W=i.getProgramParameter(g,O9)),W},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(g),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=D9++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=M,this.fragmentShader=A,this}let nW=0;class rW{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(n),a=this._getShaderStage(r),l=this._getShaderCacheForMaterial(e);return l.has(i)===!1&&(l.add(i),i.usedTimes++),l.has(a)===!1&&(l.add(a),a.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const r of n)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let r=n.get(e);return r===void 0&&(r=new Set,n.set(e,r)),r}_getShaderStage(e){const n=this.shaderCache;let r=n.get(e);return r===void 0&&(r=new iW(e),n.set(e,r)),r}}class iW{constructor(e){this.id=nW++,this.code=e,this.usedTimes=0}}function sW(t,e,n,r,i,a,l){const c=new r1,u=new rW,f=[],h=i.isWebGL2,p=i.logarithmicDepthBuffer,m=i.vertexTextures;let y=i.precision;const S={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function E(I){return I===0?"uv":`uv${I}`}function g(I,O,W,J,ae){const Z=J.fog,ie=ae.geometry,de=I.isMeshStandardMaterial?J.environment:null,pe=(I.isMeshStandardMaterial?n:e).get(I.envMap||de),K=pe&&pe.mapping===Np?pe.image.height:null,ne=S[I.type];I.precision!==null&&(y=i.getMaxPrecision(I.precision),y!==I.precision&&console.warn("THREE.WebGLProgram.getParameters:",I.precision,"not supported, using",y,"instead."));const j=ie.morphAttributes.position||ie.morphAttributes.normal||ie.morphAttributes.color,N=j!==void 0?j.length:0;let H=0;ie.morphAttributes.position!==void 0&&(H=1),ie.morphAttributes.normal!==void 0&&(H=2),ie.morphAttributes.color!==void 0&&(H=3);let U,P,L,G;if(ne){const Gn=Yi[ne];U=Gn.vertexShader,P=Gn.fragmentShader}else U=I.vertexShader,P=I.fragmentShader,u.update(I),L=u.getVertexShaderID(I),G=u.getFragmentShaderID(I);const Q=t.getRenderTarget(),le=ae.isInstancedMesh===!0,xe=ae.isBatchedMesh===!0,Te=!!I.map,X=!!I.matcap,z=!!pe,ve=!!I.aoMap,he=!!I.lightMap,be=!!I.bumpMap,Re=!!I.normalMap,gt=!!I.displacementMap,at=!!I.emissiveMap,$=!!I.metalnessMap,D=!!I.roughnessMap,oe=I.anisotropy>0,Me=I.clearcoat>0,Ee=I.iridescence>0,Ie=I.sheen>0,et=I.transmission>0,ze=oe&&!!I.anisotropyMap,Ze=Me&&!!I.clearcoatMap,ot=Me&&!!I.clearcoatNormalMap,St=Me&&!!I.clearcoatRoughnessMap,Ae=Ee&&!!I.iridescenceMap,zt=Ee&&!!I.iridescenceThicknessMap,Nt=Ie&&!!I.sheenColorMap,vt=Ie&&!!I.sheenRoughnessMap,lt=!!I.specularMap,Qe=!!I.specularColorMap,wt=!!I.specularIntensityMap,Bt=et&&!!I.transmissionMap,ln=et&&!!I.thicknessMap,bt=!!I.gradientMap,Ue=!!I.alphaMap,re=I.alphaTest>0,$e=!!I.alphaHash,Ve=!!I.extensions,pt=!!ie.attributes.uv1,ct=!!ie.attributes.uv2,Yt=!!ie.attributes.uv3;let Jt=_a;return I.toneMapped&&(Q===null||Q.isXRRenderTarget===!0)&&(Jt=t.toneMapping),{isWebGL2:h,shaderID:ne,shaderType:I.type,shaderName:I.name,vertexShader:U,fragmentShader:P,defines:I.defines,customVertexShaderID:L,customFragmentShaderID:G,isRawShaderMaterial:I.isRawShaderMaterial===!0,glslVersion:I.glslVersion,precision:y,batching:xe,instancing:le,instancingColor:le&&ae.instanceColor!==null,supportsVertexTextures:m,outputColorSpace:Q===null?t.outputColorSpace:Q.isXRRenderTarget===!0?Q.texture.colorSpace:Os,map:Te,matcap:X,envMap:z,envMapMode:z&&pe.mapping,envMapCubeUVHeight:K,aoMap:ve,lightMap:he,bumpMap:be,normalMap:Re,displacementMap:m&&gt,emissiveMap:at,normalMapObjectSpace:Re&&I.normalMapType===hj,normalMapTangentSpace:Re&&I.normalMapType===KA,metalnessMap:$,roughnessMap:D,anisotropy:oe,anisotropyMap:ze,clearcoat:Me,clearcoatMap:Ze,clearcoatNormalMap:ot,clearcoatRoughnessMap:St,iridescence:Ee,iridescenceMap:Ae,iridescenceThicknessMap:zt,sheen:Ie,sheenColorMap:Nt,sheenRoughnessMap:vt,specularMap:lt,specularColorMap:Qe,specularIntensityMap:wt,transmission:et,transmissionMap:Bt,thicknessMap:ln,gradientMap:bt,opaque:I.transparent===!1&&I.blending===Ml,alphaMap:Ue,alphaTest:re,alphaHash:$e,combine:I.combine,mapUv:Te&&E(I.map.channel),aoMapUv:ve&&E(I.aoMap.channel),lightMapUv:he&&E(I.lightMap.channel),bumpMapUv:be&&E(I.bumpMap.channel),normalMapUv:Re&&E(I.normalMap.channel),displacementMapUv:gt&&E(I.displacementMap.channel),emissiveMapUv:at&&E(I.emissiveMap.channel),metalnessMapUv:$&&E(I.metalnessMap.channel),roughnessMapUv:D&&E(I.roughnessMap.channel),anisotropyMapUv:ze&&E(I.anisotropyMap.channel),clearcoatMapUv:Ze&&E(I.clearcoatMap.channel),clearcoatNormalMapUv:ot&&E(I.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:St&&E(I.clearcoatRoughnessMap.channel),iridescenceMapUv:Ae&&E(I.iridescenceMap.channel),iridescenceThicknessMapUv:zt&&E(I.iridescenceThicknessMap.channel),sheenColorMapUv:Nt&&E(I.sheenColorMap.channel),sheenRoughnessMapUv:vt&&E(I.sheenRoughnessMap.channel),specularMapUv:lt&&E(I.specularMap.channel),specularColorMapUv:Qe&&E(I.specularColorMap.channel),specularIntensityMapUv:wt&&E(I.specularIntensityMap.channel),transmissionMapUv:Bt&&E(I.transmissionMap.channel),thicknessMapUv:ln&&E(I.thicknessMap.channel),alphaMapUv:Ue&&E(I.alphaMap.channel),vertexTangents:!!ie.attributes.tangent&&(Re||oe),vertexColors:I.vertexColors,vertexAlphas:I.vertexColors===!0&&!!ie.attributes.color&&ie.attributes.color.itemSize===4,vertexUv1s:pt,vertexUv2s:ct,vertexUv3s:Yt,pointsUvs:ae.isPoints===!0&&!!ie.attributes.uv&&(Te||Ue),fog:!!Z,useFog:I.fog===!0,fogExp2:Z&&Z.isFogExp2,flatShading:I.flatShading===!0,sizeAttenuation:I.sizeAttenuation===!0,logarithmicDepthBuffer:p,skinning:ae.isSkinnedMesh===!0,morphTargets:ie.morphAttributes.position!==void 0,morphNormals:ie.morphAttributes.normal!==void 0,morphColors:ie.morphAttributes.color!==void 0,morphTargetsCount:N,morphTextureStride:H,numDirLights:O.directional.length,numPointLights:O.point.length,numSpotLights:O.spot.length,numSpotLightMaps:O.spotLightMap.length,numRectAreaLights:O.rectArea.length,numHemiLights:O.hemi.length,numDirLightShadows:O.directionalShadowMap.length,numPointLightShadows:O.pointShadowMap.length,numSpotLightShadows:O.spotShadowMap.length,numSpotLightShadowsWithMaps:O.numSpotLightShadowsWithMaps,numLightProbes:O.numLightProbes,numClippingPlanes:l.numPlanes,numClipIntersection:l.numIntersection,dithering:I.dithering,shadowMapEnabled:t.shadowMap.enabled&&W.length>0,shadowMapType:t.shadowMap.type,toneMapping:Jt,useLegacyLights:t._useLegacyLights,decodeVideoTexture:Te&&I.map.isVideoTexture===!0&&on.getTransfer(I.map.colorSpace)===mn,premultipliedAlpha:I.premultipliedAlpha,doubleSided:I.side===Cs,flipSided:I.side===ar,useDepthPacking:I.depthPacking>=0,depthPacking:I.depthPacking||0,index0AttributeName:I.index0AttributeName,extensionDerivatives:Ve&&I.extensions.derivatives===!0,extensionFragDepth:Ve&&I.extensions.fragDepth===!0,extensionDrawBuffers:Ve&&I.extensions.drawBuffers===!0,extensionShaderTextureLOD:Ve&&I.extensions.shaderTextureLOD===!0,extensionClipCullDistance:Ve&&I.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:h||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||r.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:I.customProgramCacheKey()}}function v(I){const O=[];if(I.shaderID?O.push(I.shaderID):(O.push(I.customVertexShaderID),O.push(I.customFragmentShaderID)),I.defines!==void 0)for(const W in I.defines)O.push(W),O.push(I.defines[W]);return I.isRawShaderMaterial===!1&&(x(O,I),w(O,I),O.push(t.outputColorSpace)),O.push(I.customProgramCacheKey),O.join()}function x(I,O){I.push(O.precision),I.push(O.outputColorSpace),I.push(O.envMapMode),I.push(O.envMapCubeUVHeight),I.push(O.mapUv),I.push(O.alphaMapUv),I.push(O.lightMapUv),I.push(O.aoMapUv),I.push(O.bumpMapUv),I.push(O.normalMapUv),I.push(O.displacementMapUv),I.push(O.emissiveMapUv),I.push(O.metalnessMapUv),I.push(O.roughnessMapUv),I.push(O.anisotropyMapUv),I.push(O.clearcoatMapUv),I.push(O.clearcoatNormalMapUv),I.push(O.clearcoatRoughnessMapUv),I.push(O.iridescenceMapUv),I.push(O.iridescenceThicknessMapUv),I.push(O.sheenColorMapUv),I.push(O.sheenRoughnessMapUv),I.push(O.specularMapUv),I.push(O.specularColorMapUv),I.push(O.specularIntensityMapUv),I.push(O.transmissionMapUv),I.push(O.thicknessMapUv),I.push(O.combine),I.push(O.fogExp2),I.push(O.sizeAttenuation),I.push(O.morphTargetsCount),I.push(O.morphAttributeCount),I.push(O.numDirLights),I.push(O.numPointLights),I.push(O.numSpotLights),I.push(O.numSpotLightMaps),I.push(O.numHemiLights),I.push(O.numRectAreaLights),I.push(O.numDirLightShadows),I.push(O.numPointLightShadows),I.push(O.numSpotLightShadows),I.push(O.numSpotLightShadowsWithMaps),I.push(O.numLightProbes),I.push(O.shadowMapType),I.push(O.toneMapping),I.push(O.numClippingPlanes),I.push(O.numClipIntersection),I.push(O.depthPacking)}function w(I,O){c.disableAll(),O.isWebGL2&&c.enable(0),O.supportsVertexTextures&&c.enable(1),O.instancing&&c.enable(2),O.instancingColor&&c.enable(3),O.matcap&&c.enable(4),O.envMap&&c.enable(5),O.normalMapObjectSpace&&c.enable(6),O.normalMapTangentSpace&&c.enable(7),O.clearcoat&&c.enable(8),O.iridescence&&c.enable(9),O.alphaTest&&c.enable(10),O.vertexColors&&c.enable(11),O.vertexAlphas&&c.enable(12),O.vertexUv1s&&c.enable(13),O.vertexUv2s&&c.enable(14),O.vertexUv3s&&c.enable(15),O.vertexTangents&&c.enable(16),O.anisotropy&&c.enable(17),O.alphaHash&&c.enable(18),O.batching&&c.enable(19),I.push(c.mask),c.disableAll(),O.fog&&c.enable(0),O.useFog&&c.enable(1),O.flatShading&&c.enable(2),O.logarithmicDepthBuffer&&c.enable(3),O.skinning&&c.enable(4),O.morphTargets&&c.enable(5),O.morphNormals&&c.enable(6),O.morphColors&&c.enable(7),O.premultipliedAlpha&&c.enable(8),O.shadowMapEnabled&&c.enable(9),O.useLegacyLights&&c.enable(10),O.doubleSided&&c.enable(11),O.flipSided&&c.enable(12),O.useDepthPacking&&c.enable(13),O.dithering&&c.enable(14),O.transmission&&c.enable(15),O.sheen&&c.enable(16),O.opaque&&c.enable(17),O.pointsUvs&&c.enable(18),O.decodeVideoTexture&&c.enable(19),I.push(c.mask)}function C(I){const O=S[I.type];let W;if(O){const J=Yi[O];W=$j.clone(J.uniforms)}else W=I.uniforms;return W}function T(I,O){let W;for(let J=0,ae=f.length;J<ae;J++){const Z=f[J];if(Z.cacheKey===O){W=Z,++W.usedTimes;break}}return W===void 0&&(W=new tW(t,O,I,a),f.push(W)),W}function M(I){if(--I.usedTimes===0){const O=f.indexOf(I);f[O]=f[f.length-1],f.pop(),I.destroy()}}function A(I){u.remove(I)}function F(){u.dispose()}return{getParameters:g,getProgramCacheKey:v,getUniforms:C,acquireProgram:T,releaseProgram:M,releaseShaderCache:A,programs:f,dispose:F}}function aW(){let t=new WeakMap;function e(a){let l=t.get(a);return l===void 0&&(l={},t.set(a,l)),l}function n(a){t.delete(a)}function r(a,l,c){t.get(a)[l]=c}function i(){t=new WeakMap}return{get:e,remove:n,update:r,dispose:i}}function oW(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function AT(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function PT(){const t=[];let e=0;const n=[],r=[],i=[];function a(){e=0,n.length=0,r.length=0,i.length=0}function l(p,m,y,S,E,g){let v=t[e];return v===void 0?(v={id:p.id,object:p,geometry:m,material:y,groupOrder:S,renderOrder:p.renderOrder,z:E,group:g},t[e]=v):(v.id=p.id,v.object=p,v.geometry=m,v.material=y,v.groupOrder=S,v.renderOrder=p.renderOrder,v.z=E,v.group=g),e++,v}function c(p,m,y,S,E,g){const v=l(p,m,y,S,E,g);y.transmission>0?r.push(v):y.transparent===!0?i.push(v):n.push(v)}function u(p,m,y,S,E,g){const v=l(p,m,y,S,E,g);y.transmission>0?r.unshift(v):y.transparent===!0?i.unshift(v):n.unshift(v)}function f(p,m){n.length>1&&n.sort(p||oW),r.length>1&&r.sort(m||AT),i.length>1&&i.sort(m||AT)}function h(){for(let p=e,m=t.length;p<m;p++){const y=t[p];if(y.id===null)break;y.id=null,y.object=null,y.geometry=null,y.material=null,y.group=null}}return{opaque:n,transmissive:r,transparent:i,init:a,push:c,unshift:u,finish:h,sort:f}}function lW(){let t=new WeakMap;function e(r,i){const a=t.get(r);let l;return a===void 0?(l=new PT,t.set(r,[l])):i>=a.length?(l=new PT,a.push(l)):l=a[i],l}function n(){t=new WeakMap}return{get:e,dispose:n}}function cW(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Se,color:new It};break;case"SpotLight":n={position:new Se,direction:new Se,color:new It,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Se,color:new It,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Se,skyColor:new It,groundColor:new It};break;case"RectAreaLight":n={color:new It,position:new Se,halfWidth:new Se,halfHeight:new Se};break}return t[e.id]=n,n}}}function uW(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new sn};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new sn};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new sn,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let dW=0;function fW(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function hW(t,e){const n=new cW,r=uW(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let h=0;h<9;h++)i.probe.push(new Se);const a=new Se,l=new Yn,c=new Yn;function u(h,p){let m=0,y=0,S=0;for(let J=0;J<9;J++)i.probe[J].set(0,0,0);let E=0,g=0,v=0,x=0,w=0,C=0,T=0,M=0,A=0,F=0,I=0;h.sort(fW);const O=p===!0?Math.PI:1;for(let J=0,ae=h.length;J<ae;J++){const Z=h[J],ie=Z.color,de=Z.intensity,pe=Z.distance,K=Z.shadow&&Z.shadow.map?Z.shadow.map.texture:null;if(Z.isAmbientLight)m+=ie.r*de*O,y+=ie.g*de*O,S+=ie.b*de*O;else if(Z.isLightProbe){for(let ne=0;ne<9;ne++)i.probe[ne].addScaledVector(Z.sh.coefficients[ne],de);I++}else if(Z.isDirectionalLight){const ne=n.get(Z);if(ne.color.copy(Z.color).multiplyScalar(Z.intensity*O),Z.castShadow){const j=Z.shadow,N=r.get(Z);N.shadowBias=j.bias,N.shadowNormalBias=j.normalBias,N.shadowRadius=j.radius,N.shadowMapSize=j.mapSize,i.directionalShadow[E]=N,i.directionalShadowMap[E]=K,i.directionalShadowMatrix[E]=Z.shadow.matrix,C++}i.directional[E]=ne,E++}else if(Z.isSpotLight){const ne=n.get(Z);ne.position.setFromMatrixPosition(Z.matrixWorld),ne.color.copy(ie).multiplyScalar(de*O),ne.distance=pe,ne.coneCos=Math.cos(Z.angle),ne.penumbraCos=Math.cos(Z.angle*(1-Z.penumbra)),ne.decay=Z.decay,i.spot[v]=ne;const j=Z.shadow;if(Z.map&&(i.spotLightMap[A]=Z.map,A++,j.updateMatrices(Z),Z.castShadow&&F++),i.spotLightMatrix[v]=j.matrix,Z.castShadow){const N=r.get(Z);N.shadowBias=j.bias,N.shadowNormalBias=j.normalBias,N.shadowRadius=j.radius,N.shadowMapSize=j.mapSize,i.spotShadow[v]=N,i.spotShadowMap[v]=K,M++}v++}else if(Z.isRectAreaLight){const ne=n.get(Z);ne.color.copy(ie).multiplyScalar(de),ne.halfWidth.set(Z.width*.5,0,0),ne.halfHeight.set(0,Z.height*.5,0),i.rectArea[x]=ne,x++}else if(Z.isPointLight){const ne=n.get(Z);if(ne.color.copy(Z.color).multiplyScalar(Z.intensity*O),ne.distance=Z.distance,ne.decay=Z.decay,Z.castShadow){const j=Z.shadow,N=r.get(Z);N.shadowBias=j.bias,N.shadowNormalBias=j.normalBias,N.shadowRadius=j.radius,N.shadowMapSize=j.mapSize,N.shadowCameraNear=j.camera.near,N.shadowCameraFar=j.camera.far,i.pointShadow[g]=N,i.pointShadowMap[g]=K,i.pointShadowMatrix[g]=Z.shadow.matrix,T++}i.point[g]=ne,g++}else if(Z.isHemisphereLight){const ne=n.get(Z);ne.skyColor.copy(Z.color).multiplyScalar(de*O),ne.groundColor.copy(Z.groundColor).multiplyScalar(de*O),i.hemi[w]=ne,w++}}x>0&&(e.isWebGL2?t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Be.LTC_FLOAT_1,i.rectAreaLTC2=Be.LTC_FLOAT_2):(i.rectAreaLTC1=Be.LTC_HALF_1,i.rectAreaLTC2=Be.LTC_HALF_2):t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Be.LTC_FLOAT_1,i.rectAreaLTC2=Be.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=Be.LTC_HALF_1,i.rectAreaLTC2=Be.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=m,i.ambient[1]=y,i.ambient[2]=S;const W=i.hash;(W.directionalLength!==E||W.pointLength!==g||W.spotLength!==v||W.rectAreaLength!==x||W.hemiLength!==w||W.numDirectionalShadows!==C||W.numPointShadows!==T||W.numSpotShadows!==M||W.numSpotMaps!==A||W.numLightProbes!==I)&&(i.directional.length=E,i.spot.length=v,i.rectArea.length=x,i.point.length=g,i.hemi.length=w,i.directionalShadow.length=C,i.directionalShadowMap.length=C,i.pointShadow.length=T,i.pointShadowMap.length=T,i.spotShadow.length=M,i.spotShadowMap.length=M,i.directionalShadowMatrix.length=C,i.pointShadowMatrix.length=T,i.spotLightMatrix.length=M+A-F,i.spotLightMap.length=A,i.numSpotLightShadowsWithMaps=F,i.numLightProbes=I,W.directionalLength=E,W.pointLength=g,W.spotLength=v,W.rectAreaLength=x,W.hemiLength=w,W.numDirectionalShadows=C,W.numPointShadows=T,W.numSpotShadows=M,W.numSpotMaps=A,W.numLightProbes=I,i.version=dW++)}function f(h,p){let m=0,y=0,S=0,E=0,g=0;const v=p.matrixWorldInverse;for(let x=0,w=h.length;x<w;x++){const C=h[x];if(C.isDirectionalLight){const T=i.directional[m];T.direction.setFromMatrixPosition(C.matrixWorld),a.setFromMatrixPosition(C.target.matrixWorld),T.direction.sub(a),T.direction.transformDirection(v),m++}else if(C.isSpotLight){const T=i.spot[S];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(v),T.direction.setFromMatrixPosition(C.matrixWorld),a.setFromMatrixPosition(C.target.matrixWorld),T.direction.sub(a),T.direction.transformDirection(v),S++}else if(C.isRectAreaLight){const T=i.rectArea[E];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(v),c.identity(),l.copy(C.matrixWorld),l.premultiply(v),c.extractRotation(l),T.halfWidth.set(C.width*.5,0,0),T.halfHeight.set(0,C.height*.5,0),T.halfWidth.applyMatrix4(c),T.halfHeight.applyMatrix4(c),E++}else if(C.isPointLight){const T=i.point[y];T.position.setFromMatrixPosition(C.matrixWorld),T.position.applyMatrix4(v),y++}else if(C.isHemisphereLight){const T=i.hemi[g];T.direction.setFromMatrixPosition(C.matrixWorld),T.direction.transformDirection(v),g++}}}return{setup:u,setupView:f,state:i}}function IT(t,e){const n=new hW(t,e),r=[],i=[];function a(){r.length=0,i.length=0}function l(p){r.push(p)}function c(p){i.push(p)}function u(p){n.setup(r,p)}function f(p){n.setupView(r,p)}return{init:a,state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:u,setupLightsView:f,pushLight:l,pushShadow:c}}function pW(t,e){let n=new WeakMap;function r(a,l=0){const c=n.get(a);let u;return c===void 0?(u=new IT(t,e),n.set(a,[u])):l>=c.length?(u=new IT(t,e),c.push(u)):u=c[l],u}function i(){n=new WeakMap}return{get:r,dispose:i}}class mW extends ql{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=dj,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class gW extends ql{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const _W=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,vW=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function yW(t,e,n){let r=new u1;const i=new sn,a=new sn,l=new sr,c=new mW({depthPacking:fj}),u=new gW,f={},h=n.maxTextureSize,p={[wa]:ar,[ar]:wa,[Cs]:Cs},m=new mo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new sn},radius:{value:4}},vertexShader:_W,fragmentShader:vW}),y=m.clone();y.defines.HORIZONTAL_PASS=1;const S=new is;S.setAttribute("position",new Si(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const E=new _r(S,m),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=zA;let v=this.type;this.render=function(M,A,F){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||M.length===0)return;const I=t.getRenderTarget(),O=t.getActiveCubeFace(),W=t.getActiveMipmapLevel(),J=t.state;J.setBlending(ga),J.buffers.color.setClear(1,1,1,1),J.buffers.depth.setTest(!0),J.setScissorTest(!1);const ae=v!==Ms&&this.type===Ms,Z=v===Ms&&this.type!==Ms;for(let ie=0,de=M.length;ie<de;ie++){const pe=M[ie],K=pe.shadow;if(K===void 0){console.warn("THREE.WebGLShadowMap:",pe,"has no shadow.");continue}if(K.autoUpdate===!1&&K.needsUpdate===!1)continue;i.copy(K.mapSize);const ne=K.getFrameExtents();if(i.multiply(ne),a.copy(K.mapSize),(i.x>h||i.y>h)&&(i.x>h&&(a.x=Math.floor(h/ne.x),i.x=a.x*ne.x,K.mapSize.x=a.x),i.y>h&&(a.y=Math.floor(h/ne.y),i.y=a.y*ne.y,K.mapSize.y=a.y)),K.map===null||ae===!0||Z===!0){const N=this.type!==Ms?{minFilter:Cr,magFilter:Cr}:{};K.map!==null&&K.map.dispose(),K.map=new po(i.x,i.y,N),K.map.texture.name=pe.name+".shadowMap",K.camera.updateProjectionMatrix()}t.setRenderTarget(K.map),t.clear();const j=K.getViewportCount();for(let N=0;N<j;N++){const H=K.getViewport(N);l.set(a.x*H.x,a.y*H.y,a.x*H.z,a.y*H.w),J.viewport(l),K.updateMatrices(pe,N),r=K.getFrustum(),C(A,F,K.camera,pe,this.type)}K.isPointLightShadow!==!0&&this.type===Ms&&x(K,F),K.needsUpdate=!1}v=this.type,g.needsUpdate=!1,t.setRenderTarget(I,O,W)};function x(M,A){const F=e.update(E);m.defines.VSM_SAMPLES!==M.blurSamples&&(m.defines.VSM_SAMPLES=M.blurSamples,y.defines.VSM_SAMPLES=M.blurSamples,m.needsUpdate=!0,y.needsUpdate=!0),M.mapPass===null&&(M.mapPass=new po(i.x,i.y)),m.uniforms.shadow_pass.value=M.map.texture,m.uniforms.resolution.value=M.mapSize,m.uniforms.radius.value=M.radius,t.setRenderTarget(M.mapPass),t.clear(),t.renderBufferDirect(A,null,F,m,E,null),y.uniforms.shadow_pass.value=M.mapPass.texture,y.uniforms.resolution.value=M.mapSize,y.uniforms.radius.value=M.radius,t.setRenderTarget(M.map),t.clear(),t.renderBufferDirect(A,null,F,y,E,null)}function w(M,A,F,I){let O=null;const W=F.isPointLight===!0?M.customDistanceMaterial:M.customDepthMaterial;if(W!==void 0)O=W;else if(O=F.isPointLight===!0?u:c,t.localClippingEnabled&&A.clipShadows===!0&&Array.isArray(A.clippingPlanes)&&A.clippingPlanes.length!==0||A.displacementMap&&A.displacementScale!==0||A.alphaMap&&A.alphaTest>0||A.map&&A.alphaTest>0){const J=O.uuid,ae=A.uuid;let Z=f[J];Z===void 0&&(Z={},f[J]=Z);let ie=Z[ae];ie===void 0&&(ie=O.clone(),Z[ae]=ie,A.addEventListener("dispose",T)),O=ie}if(O.visible=A.visible,O.wireframe=A.wireframe,I===Ms?O.side=A.shadowSide!==null?A.shadowSide:A.side:O.side=A.shadowSide!==null?A.shadowSide:p[A.side],O.alphaMap=A.alphaMap,O.alphaTest=A.alphaTest,O.map=A.map,O.clipShadows=A.clipShadows,O.clippingPlanes=A.clippingPlanes,O.clipIntersection=A.clipIntersection,O.displacementMap=A.displacementMap,O.displacementScale=A.displacementScale,O.displacementBias=A.displacementBias,O.wireframeLinewidth=A.wireframeLinewidth,O.linewidth=A.linewidth,F.isPointLight===!0&&O.isMeshDistanceMaterial===!0){const J=t.properties.get(O);J.light=F}return O}function C(M,A,F,I,O){if(M.visible===!1)return;if(M.layers.test(A.layers)&&(M.isMesh||M.isLine||M.isPoints)&&(M.castShadow||M.receiveShadow&&O===Ms)&&(!M.frustumCulled||r.intersectsObject(M))){M.modelViewMatrix.multiplyMatrices(F.matrixWorldInverse,M.matrixWorld);const ae=e.update(M),Z=M.material;if(Array.isArray(Z)){const ie=ae.groups;for(let de=0,pe=ie.length;de<pe;de++){const K=ie[de],ne=Z[K.materialIndex];if(ne&&ne.visible){const j=w(M,ne,I,O);M.onBeforeShadow(t,M,A,F,ae,j,K),t.renderBufferDirect(F,null,ae,j,M,K),M.onAfterShadow(t,M,A,F,ae,j,K)}}}else if(Z.visible){const ie=w(M,Z,I,O);M.onBeforeShadow(t,M,A,F,ae,ie,null),t.renderBufferDirect(F,null,ae,ie,M,null),M.onAfterShadow(t,M,A,F,ae,ie,null)}}const J=M.children;for(let ae=0,Z=J.length;ae<Z;ae++)C(J[ae],A,F,I,O)}function T(M){M.target.removeEventListener("dispose",T);for(const F in f){const I=f[F],O=M.target.uuid;O in I&&(I[O].dispose(),delete I[O])}}}function SW(t,e,n){const r=n.isWebGL2;function i(){let re=!1;const $e=new sr;let Ve=null;const pt=new sr(0,0,0,0);return{setMask:function(ct){Ve!==ct&&!re&&(t.colorMask(ct,ct,ct,ct),Ve=ct)},setLocked:function(ct){re=ct},setClear:function(ct,Yt,Jt,Mn,Gn){Gn===!0&&(ct*=Mn,Yt*=Mn,Jt*=Mn),$e.set(ct,Yt,Jt,Mn),pt.equals($e)===!1&&(t.clearColor(ct,Yt,Jt,Mn),pt.copy($e))},reset:function(){re=!1,Ve=null,pt.set(-1,0,0,0)}}}function a(){let re=!1,$e=null,Ve=null,pt=null;return{setTest:function(ct){ct?xe(t.DEPTH_TEST):Te(t.DEPTH_TEST)},setMask:function(ct){$e!==ct&&!re&&(t.depthMask(ct),$e=ct)},setFunc:function(ct){if(Ve!==ct){switch(ct){case BV:t.depthFunc(t.NEVER);break;case VV:t.depthFunc(t.ALWAYS);break;case jV:t.depthFunc(t.LESS);break;case Jh:t.depthFunc(t.LEQUAL);break;case HV:t.depthFunc(t.EQUAL);break;case GV:t.depthFunc(t.GEQUAL);break;case WV:t.depthFunc(t.GREATER);break;case qV:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}Ve=ct}},setLocked:function(ct){re=ct},setClear:function(ct){pt!==ct&&(t.clearDepth(ct),pt=ct)},reset:function(){re=!1,$e=null,Ve=null,pt=null}}}function l(){let re=!1,$e=null,Ve=null,pt=null,ct=null,Yt=null,Jt=null,Mn=null,Gn=null;return{setTest:function(Ht){re||(Ht?xe(t.STENCIL_TEST):Te(t.STENCIL_TEST))},setMask:function(Ht){$e!==Ht&&!re&&(t.stencilMask(Ht),$e=Ht)},setFunc:function(Ht,Un,cr){(Ve!==Ht||pt!==Un||ct!==cr)&&(t.stencilFunc(Ht,Un,cr),Ve=Ht,pt=Un,ct=cr)},setOp:function(Ht,Un,cr){(Yt!==Ht||Jt!==Un||Mn!==cr)&&(t.stencilOp(Ht,Un,cr),Yt=Ht,Jt=Un,Mn=cr)},setLocked:function(Ht){re=Ht},setClear:function(Ht){Gn!==Ht&&(t.clearStencil(Ht),Gn=Ht)},reset:function(){re=!1,$e=null,Ve=null,pt=null,ct=null,Yt=null,Jt=null,Mn=null,Gn=null}}}const c=new i,u=new a,f=new l,h=new WeakMap,p=new WeakMap;let m={},y={},S=new WeakMap,E=[],g=null,v=!1,x=null,w=null,C=null,T=null,M=null,A=null,F=null,I=new It(0,0,0),O=0,W=!1,J=null,ae=null,Z=null,ie=null,de=null;const pe=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let K=!1,ne=0;const j=t.getParameter(t.VERSION);j.indexOf("WebGL")!==-1?(ne=parseFloat(/^WebGL (\d)/.exec(j)[1]),K=ne>=1):j.indexOf("OpenGL ES")!==-1&&(ne=parseFloat(/^OpenGL ES (\d)/.exec(j)[1]),K=ne>=2);let N=null,H={};const U=t.getParameter(t.SCISSOR_BOX),P=t.getParameter(t.VIEWPORT),L=new sr().fromArray(U),G=new sr().fromArray(P);function Q(re,$e,Ve,pt){const ct=new Uint8Array(4),Yt=t.createTexture();t.bindTexture(re,Yt),t.texParameteri(re,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(re,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let Jt=0;Jt<Ve;Jt++)r&&(re===t.TEXTURE_3D||re===t.TEXTURE_2D_ARRAY)?t.texImage3D($e,0,t.RGBA,1,1,pt,0,t.RGBA,t.UNSIGNED_BYTE,ct):t.texImage2D($e+Jt,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,ct);return Yt}const le={};le[t.TEXTURE_2D]=Q(t.TEXTURE_2D,t.TEXTURE_2D,1),le[t.TEXTURE_CUBE_MAP]=Q(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(le[t.TEXTURE_2D_ARRAY]=Q(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),le[t.TEXTURE_3D]=Q(t.TEXTURE_3D,t.TEXTURE_3D,1,1)),c.setClear(0,0,0,1),u.setClear(1),f.setClear(0),xe(t.DEPTH_TEST),u.setFunc(Jh),at(!1),$(fb),xe(t.CULL_FACE),Re(ga);function xe(re){m[re]!==!0&&(t.enable(re),m[re]=!0)}function Te(re){m[re]!==!1&&(t.disable(re),m[re]=!1)}function X(re,$e){return y[re]!==$e?(t.bindFramebuffer(re,$e),y[re]=$e,r&&(re===t.DRAW_FRAMEBUFFER&&(y[t.FRAMEBUFFER]=$e),re===t.FRAMEBUFFER&&(y[t.DRAW_FRAMEBUFFER]=$e)),!0):!1}function z(re,$e){let Ve=E,pt=!1;if(re)if(Ve=S.get($e),Ve===void 0&&(Ve=[],S.set($e,Ve)),re.isWebGLMultipleRenderTargets){const ct=re.texture;if(Ve.length!==ct.length||Ve[0]!==t.COLOR_ATTACHMENT0){for(let Yt=0,Jt=ct.length;Yt<Jt;Yt++)Ve[Yt]=t.COLOR_ATTACHMENT0+Yt;Ve.length=ct.length,pt=!0}}else Ve[0]!==t.COLOR_ATTACHMENT0&&(Ve[0]=t.COLOR_ATTACHMENT0,pt=!0);else Ve[0]!==t.BACK&&(Ve[0]=t.BACK,pt=!0);pt&&(n.isWebGL2?t.drawBuffers(Ve):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ve))}function ve(re){return g!==re?(t.useProgram(re),g=re,!0):!1}const he={[eo]:t.FUNC_ADD,[MV]:t.FUNC_SUBTRACT,[RV]:t.FUNC_REVERSE_SUBTRACT};if(r)he[gb]=t.MIN,he[_b]=t.MAX;else{const re=e.get("EXT_blend_minmax");re!==null&&(he[gb]=re.MIN_EXT,he[_b]=re.MAX_EXT)}const be={[CV]:t.ZERO,[AV]:t.ONE,[PV]:t.SRC_COLOR,[kv]:t.SRC_ALPHA,[DV]:t.SRC_ALPHA_SATURATE,[LV]:t.DST_COLOR,[NV]:t.DST_ALPHA,[IV]:t.ONE_MINUS_SRC_COLOR,[Lv]:t.ONE_MINUS_SRC_ALPHA,[OV]:t.ONE_MINUS_DST_COLOR,[kV]:t.ONE_MINUS_DST_ALPHA,[UV]:t.CONSTANT_COLOR,[FV]:t.ONE_MINUS_CONSTANT_COLOR,[zV]:t.CONSTANT_ALPHA,[$V]:t.ONE_MINUS_CONSTANT_ALPHA};function Re(re,$e,Ve,pt,ct,Yt,Jt,Mn,Gn,Ht){if(re===ga){v===!0&&(Te(t.BLEND),v=!1);return}if(v===!1&&(xe(t.BLEND),v=!0),re!==TV){if(re!==x||Ht!==W){if((w!==eo||M!==eo)&&(t.blendEquation(t.FUNC_ADD),w=eo,M=eo),Ht)switch(re){case Ml:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case hb:t.blendFunc(t.ONE,t.ONE);break;case pb:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case mb:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",re);break}else switch(re){case Ml:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case hb:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case pb:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case mb:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",re);break}C=null,T=null,A=null,F=null,I.set(0,0,0),O=0,x=re,W=Ht}return}ct=ct||$e,Yt=Yt||Ve,Jt=Jt||pt,($e!==w||ct!==M)&&(t.blendEquationSeparate(he[$e],he[ct]),w=$e,M=ct),(Ve!==C||pt!==T||Yt!==A||Jt!==F)&&(t.blendFuncSeparate(be[Ve],be[pt],be[Yt],be[Jt]),C=Ve,T=pt,A=Yt,F=Jt),(Mn.equals(I)===!1||Gn!==O)&&(t.blendColor(Mn.r,Mn.g,Mn.b,Gn),I.copy(Mn),O=Gn),x=re,W=!1}function gt(re,$e){re.side===Cs?Te(t.CULL_FACE):xe(t.CULL_FACE);let Ve=re.side===ar;$e&&(Ve=!Ve),at(Ve),re.blending===Ml&&re.transparent===!1?Re(ga):Re(re.blending,re.blendEquation,re.blendSrc,re.blendDst,re.blendEquationAlpha,re.blendSrcAlpha,re.blendDstAlpha,re.blendColor,re.blendAlpha,re.premultipliedAlpha),u.setFunc(re.depthFunc),u.setTest(re.depthTest),u.setMask(re.depthWrite),c.setMask(re.colorWrite);const pt=re.stencilWrite;f.setTest(pt),pt&&(f.setMask(re.stencilWriteMask),f.setFunc(re.stencilFunc,re.stencilRef,re.stencilFuncMask),f.setOp(re.stencilFail,re.stencilZFail,re.stencilZPass)),oe(re.polygonOffset,re.polygonOffsetFactor,re.polygonOffsetUnits),re.alphaToCoverage===!0?xe(t.SAMPLE_ALPHA_TO_COVERAGE):Te(t.SAMPLE_ALPHA_TO_COVERAGE)}function at(re){J!==re&&(re?t.frontFace(t.CW):t.frontFace(t.CCW),J=re)}function $(re){re!==xV?(xe(t.CULL_FACE),re!==ae&&(re===fb?t.cullFace(t.BACK):re===EV?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):Te(t.CULL_FACE),ae=re}function D(re){re!==Z&&(K&&t.lineWidth(re),Z=re)}function oe(re,$e,Ve){re?(xe(t.POLYGON_OFFSET_FILL),(ie!==$e||de!==Ve)&&(t.polygonOffset($e,Ve),ie=$e,de=Ve)):Te(t.POLYGON_OFFSET_FILL)}function Me(re){re?xe(t.SCISSOR_TEST):Te(t.SCISSOR_TEST)}function Ee(re){re===void 0&&(re=t.TEXTURE0+pe-1),N!==re&&(t.activeTexture(re),N=re)}function Ie(re,$e,Ve){Ve===void 0&&(N===null?Ve=t.TEXTURE0+pe-1:Ve=N);let pt=H[Ve];pt===void 0&&(pt={type:void 0,texture:void 0},H[Ve]=pt),(pt.type!==re||pt.texture!==$e)&&(N!==Ve&&(t.activeTexture(Ve),N=Ve),t.bindTexture(re,$e||le[re]),pt.type=re,pt.texture=$e)}function et(){const re=H[N];re!==void 0&&re.type!==void 0&&(t.bindTexture(re.type,null),re.type=void 0,re.texture=void 0)}function ze(){try{t.compressedTexImage2D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Ze(){try{t.compressedTexImage3D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function ot(){try{t.texSubImage2D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function St(){try{t.texSubImage3D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Ae(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function zt(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Nt(){try{t.texStorage2D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function vt(){try{t.texStorage3D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function lt(){try{t.texImage2D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Qe(){try{t.texImage3D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function wt(re){L.equals(re)===!1&&(t.scissor(re.x,re.y,re.z,re.w),L.copy(re))}function Bt(re){G.equals(re)===!1&&(t.viewport(re.x,re.y,re.z,re.w),G.copy(re))}function ln(re,$e){let Ve=p.get($e);Ve===void 0&&(Ve=new WeakMap,p.set($e,Ve));let pt=Ve.get(re);pt===void 0&&(pt=t.getUniformBlockIndex($e,re.name),Ve.set(re,pt))}function bt(re,$e){const pt=p.get($e).get(re);h.get($e)!==pt&&(t.uniformBlockBinding($e,pt,re.__bindingPointIndex),h.set($e,pt))}function Ue(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),r===!0&&(t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),m={},N=null,H={},y={},S=new WeakMap,E=[],g=null,v=!1,x=null,w=null,C=null,T=null,M=null,A=null,F=null,I=new It(0,0,0),O=0,W=!1,J=null,ae=null,Z=null,ie=null,de=null,L.set(0,0,t.canvas.width,t.canvas.height),G.set(0,0,t.canvas.width,t.canvas.height),c.reset(),u.reset(),f.reset()}return{buffers:{color:c,depth:u,stencil:f},enable:xe,disable:Te,bindFramebuffer:X,drawBuffers:z,useProgram:ve,setBlending:Re,setMaterial:gt,setFlipSided:at,setCullFace:$,setLineWidth:D,setPolygonOffset:oe,setScissorTest:Me,activeTexture:Ee,bindTexture:Ie,unbindTexture:et,compressedTexImage2D:ze,compressedTexImage3D:Ze,texImage2D:lt,texImage3D:Qe,updateUBOMapping:ln,uniformBlockBinding:bt,texStorage2D:Nt,texStorage3D:vt,texSubImage2D:ot,texSubImage3D:St,compressedTexSubImage2D:Ae,compressedTexSubImage3D:zt,scissor:wt,viewport:Bt,reset:Ue}}function wW(t,e,n,r,i,a,l){const c=i.isWebGL2,u=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),h=new WeakMap;let p;const m=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function S($,D){return y?new OffscreenCanvas($,D):rp("canvas")}function E($,D,oe,Me){let Ee=1;if(($.width>Me||$.height>Me)&&(Ee=Me/Math.max($.width,$.height)),Ee<1||D===!0)if(typeof HTMLImageElement<"u"&&$ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&$ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&$ instanceof ImageBitmap){const Ie=D?Bv:Math.floor,et=Ie(Ee*$.width),ze=Ie(Ee*$.height);p===void 0&&(p=S(et,ze));const Ze=oe?S(et,ze):p;return Ze.width=et,Ze.height=ze,Ze.getContext("2d").drawImage($,0,0,et,ze),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+$.width+"x"+$.height+") to ("+et+"x"+ze+")."),Ze}else return"data"in $&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+$.width+"x"+$.height+")."),$;return $}function g($){return qb($.width)&&qb($.height)}function v($){return c?!1:$.wrapS!==Bi||$.wrapT!==Bi||$.minFilter!==Cr&&$.minFilter!==mi}function x($,D){return $.generateMipmaps&&D&&$.minFilter!==Cr&&$.minFilter!==mi}function w($){t.generateMipmap($)}function C($,D,oe,Me,Ee=!1){if(c===!1)return D;if($!==null){if(t[$]!==void 0)return t[$];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+$+"'")}let Ie=D;if(D===t.RED&&(oe===t.FLOAT&&(Ie=t.R32F),oe===t.HALF_FLOAT&&(Ie=t.R16F),oe===t.UNSIGNED_BYTE&&(Ie=t.R8)),D===t.RED_INTEGER&&(oe===t.UNSIGNED_BYTE&&(Ie=t.R8UI),oe===t.UNSIGNED_SHORT&&(Ie=t.R16UI),oe===t.UNSIGNED_INT&&(Ie=t.R32UI),oe===t.BYTE&&(Ie=t.R8I),oe===t.SHORT&&(Ie=t.R16I),oe===t.INT&&(Ie=t.R32I)),D===t.RG&&(oe===t.FLOAT&&(Ie=t.RG32F),oe===t.HALF_FLOAT&&(Ie=t.RG16F),oe===t.UNSIGNED_BYTE&&(Ie=t.RG8)),D===t.RGBA){const et=Ee?Qh:on.getTransfer(Me);oe===t.FLOAT&&(Ie=t.RGBA32F),oe===t.HALF_FLOAT&&(Ie=t.RGBA16F),oe===t.UNSIGNED_BYTE&&(Ie=et===mn?t.SRGB8_ALPHA8:t.RGBA8),oe===t.UNSIGNED_SHORT_4_4_4_4&&(Ie=t.RGBA4),oe===t.UNSIGNED_SHORT_5_5_5_1&&(Ie=t.RGB5_A1)}return(Ie===t.R16F||Ie===t.R32F||Ie===t.RG16F||Ie===t.RG32F||Ie===t.RGBA16F||Ie===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Ie}function T($,D,oe){return x($,oe)===!0||$.isFramebufferTexture&&$.minFilter!==Cr&&$.minFilter!==mi?Math.log2(Math.max(D.width,D.height))+1:$.mipmaps!==void 0&&$.mipmaps.length>0?$.mipmaps.length:$.isCompressedTexture&&Array.isArray($.image)?D.mipmaps.length:1}function M($){return $===Cr||$===vb||$===Kg?t.NEAREST:t.LINEAR}function A($){const D=$.target;D.removeEventListener("dispose",A),I(D),D.isVideoTexture&&h.delete(D)}function F($){const D=$.target;D.removeEventListener("dispose",F),W(D)}function I($){const D=r.get($);if(D.__webglInit===void 0)return;const oe=$.source,Me=m.get(oe);if(Me){const Ee=Me[D.__cacheKey];Ee.usedTimes--,Ee.usedTimes===0&&O($),Object.keys(Me).length===0&&m.delete(oe)}r.remove($)}function O($){const D=r.get($);t.deleteTexture(D.__webglTexture);const oe=$.source,Me=m.get(oe);delete Me[D.__cacheKey],l.memory.textures--}function W($){const D=$.texture,oe=r.get($),Me=r.get(D);if(Me.__webglTexture!==void 0&&(t.deleteTexture(Me.__webglTexture),l.memory.textures--),$.depthTexture&&$.depthTexture.dispose(),$.isWebGLCubeRenderTarget)for(let Ee=0;Ee<6;Ee++){if(Array.isArray(oe.__webglFramebuffer[Ee]))for(let Ie=0;Ie<oe.__webglFramebuffer[Ee].length;Ie++)t.deleteFramebuffer(oe.__webglFramebuffer[Ee][Ie]);else t.deleteFramebuffer(oe.__webglFramebuffer[Ee]);oe.__webglDepthbuffer&&t.deleteRenderbuffer(oe.__webglDepthbuffer[Ee])}else{if(Array.isArray(oe.__webglFramebuffer))for(let Ee=0;Ee<oe.__webglFramebuffer.length;Ee++)t.deleteFramebuffer(oe.__webglFramebuffer[Ee]);else t.deleteFramebuffer(oe.__webglFramebuffer);if(oe.__webglDepthbuffer&&t.deleteRenderbuffer(oe.__webglDepthbuffer),oe.__webglMultisampledFramebuffer&&t.deleteFramebuffer(oe.__webglMultisampledFramebuffer),oe.__webglColorRenderbuffer)for(let Ee=0;Ee<oe.__webglColorRenderbuffer.length;Ee++)oe.__webglColorRenderbuffer[Ee]&&t.deleteRenderbuffer(oe.__webglColorRenderbuffer[Ee]);oe.__webglDepthRenderbuffer&&t.deleteRenderbuffer(oe.__webglDepthRenderbuffer)}if($.isWebGLMultipleRenderTargets)for(let Ee=0,Ie=D.length;Ee<Ie;Ee++){const et=r.get(D[Ee]);et.__webglTexture&&(t.deleteTexture(et.__webglTexture),l.memory.textures--),r.remove(D[Ee])}r.remove(D),r.remove($)}let J=0;function ae(){J=0}function Z(){const $=J;return $>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+$+" texture units while this GPU supports only "+i.maxTextures),J+=1,$}function ie($){const D=[];return D.push($.wrapS),D.push($.wrapT),D.push($.wrapR||0),D.push($.magFilter),D.push($.minFilter),D.push($.anisotropy),D.push($.internalFormat),D.push($.format),D.push($.type),D.push($.generateMipmaps),D.push($.premultiplyAlpha),D.push($.flipY),D.push($.unpackAlignment),D.push($.colorSpace),D.join()}function de($,D){const oe=r.get($);if($.isVideoTexture&&gt($),$.isRenderTargetTexture===!1&&$.version>0&&oe.__version!==$.version){const Me=$.image;if(Me===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Me.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{L(oe,$,D);return}}n.bindTexture(t.TEXTURE_2D,oe.__webglTexture,t.TEXTURE0+D)}function pe($,D){const oe=r.get($);if($.version>0&&oe.__version!==$.version){L(oe,$,D);return}n.bindTexture(t.TEXTURE_2D_ARRAY,oe.__webglTexture,t.TEXTURE0+D)}function K($,D){const oe=r.get($);if($.version>0&&oe.__version!==$.version){L(oe,$,D);return}n.bindTexture(t.TEXTURE_3D,oe.__webglTexture,t.TEXTURE0+D)}function ne($,D){const oe=r.get($);if($.version>0&&oe.__version!==$.version){G(oe,$,D);return}n.bindTexture(t.TEXTURE_CUBE_MAP,oe.__webglTexture,t.TEXTURE0+D)}const j={[Uv]:t.REPEAT,[Bi]:t.CLAMP_TO_EDGE,[Fv]:t.MIRRORED_REPEAT},N={[Cr]:t.NEAREST,[vb]:t.NEAREST_MIPMAP_NEAREST,[Kg]:t.NEAREST_MIPMAP_LINEAR,[mi]:t.LINEAR,[nj]:t.LINEAR_MIPMAP_NEAREST,[vu]:t.LINEAR_MIPMAP_LINEAR},H={[pj]:t.NEVER,[Sj]:t.ALWAYS,[mj]:t.LESS,[YA]:t.LEQUAL,[gj]:t.EQUAL,[yj]:t.GEQUAL,[_j]:t.GREATER,[vj]:t.NOTEQUAL};function U($,D,oe){if(oe?(t.texParameteri($,t.TEXTURE_WRAP_S,j[D.wrapS]),t.texParameteri($,t.TEXTURE_WRAP_T,j[D.wrapT]),($===t.TEXTURE_3D||$===t.TEXTURE_2D_ARRAY)&&t.texParameteri($,t.TEXTURE_WRAP_R,j[D.wrapR]),t.texParameteri($,t.TEXTURE_MAG_FILTER,N[D.magFilter]),t.texParameteri($,t.TEXTURE_MIN_FILTER,N[D.minFilter])):(t.texParameteri($,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri($,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),($===t.TEXTURE_3D||$===t.TEXTURE_2D_ARRAY)&&t.texParameteri($,t.TEXTURE_WRAP_R,t.CLAMP_TO_EDGE),(D.wrapS!==Bi||D.wrapT!==Bi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri($,t.TEXTURE_MAG_FILTER,M(D.magFilter)),t.texParameteri($,t.TEXTURE_MIN_FILTER,M(D.minFilter)),D.minFilter!==Cr&&D.minFilter!==mi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),D.compareFunction&&(t.texParameteri($,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri($,t.TEXTURE_COMPARE_FUNC,H[D.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const Me=e.get("EXT_texture_filter_anisotropic");if(D.magFilter===Cr||D.minFilter!==Kg&&D.minFilter!==vu||D.type===pa&&e.has("OES_texture_float_linear")===!1||c===!1&&D.type===yu&&e.has("OES_texture_half_float_linear")===!1)return;(D.anisotropy>1||r.get(D).__currentAnisotropy)&&(t.texParameterf($,Me.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(D.anisotropy,i.getMaxAnisotropy())),r.get(D).__currentAnisotropy=D.anisotropy)}}function P($,D){let oe=!1;$.__webglInit===void 0&&($.__webglInit=!0,D.addEventListener("dispose",A));const Me=D.source;let Ee=m.get(Me);Ee===void 0&&(Ee={},m.set(Me,Ee));const Ie=ie(D);if(Ie!==$.__cacheKey){Ee[Ie]===void 0&&(Ee[Ie]={texture:t.createTexture(),usedTimes:0},l.memory.textures++,oe=!0),Ee[Ie].usedTimes++;const et=Ee[$.__cacheKey];et!==void 0&&(Ee[$.__cacheKey].usedTimes--,et.usedTimes===0&&O(D)),$.__cacheKey=Ie,$.__webglTexture=Ee[Ie].texture}return oe}function L($,D,oe){let Me=t.TEXTURE_2D;(D.isDataArrayTexture||D.isCompressedArrayTexture)&&(Me=t.TEXTURE_2D_ARRAY),D.isData3DTexture&&(Me=t.TEXTURE_3D);const Ee=P($,D),Ie=D.source;n.bindTexture(Me,$.__webglTexture,t.TEXTURE0+oe);const et=r.get(Ie);if(Ie.version!==et.__version||Ee===!0){n.activeTexture(t.TEXTURE0+oe);const ze=on.getPrimaries(on.workingColorSpace),Ze=D.colorSpace===_i?null:on.getPrimaries(D.colorSpace),ot=D.colorSpace===_i||ze===Ze?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,D.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,D.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,D.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,ot);const St=v(D)&&g(D.image)===!1;let Ae=E(D.image,St,!1,i.maxTextureSize);Ae=at(D,Ae);const zt=g(Ae)||c,Nt=a.convert(D.format,D.colorSpace);let vt=a.convert(D.type),lt=C(D.internalFormat,Nt,vt,D.colorSpace,D.isVideoTexture);U(Me,D,zt);let Qe;const wt=D.mipmaps,Bt=c&&D.isVideoTexture!==!0&&lt!==ZA,ln=et.__version===void 0||Ee===!0,bt=T(D,Ae,zt);if(D.isDepthTexture)lt=t.DEPTH_COMPONENT,c?D.type===pa?lt=t.DEPTH_COMPONENT32F:D.type===ha?lt=t.DEPTH_COMPONENT24:D.type===ao?lt=t.DEPTH24_STENCIL8:lt=t.DEPTH_COMPONENT16:D.type===pa&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),D.format===oo&&lt===t.DEPTH_COMPONENT&&D.type!==By&&D.type!==ha&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),D.type=ha,vt=a.convert(D.type)),D.format===Ul&&lt===t.DEPTH_COMPONENT&&(lt=t.DEPTH_STENCIL,D.type!==ao&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),D.type=ao,vt=a.convert(D.type))),ln&&(Bt?n.texStorage2D(t.TEXTURE_2D,1,lt,Ae.width,Ae.height):n.texImage2D(t.TEXTURE_2D,0,lt,Ae.width,Ae.height,0,Nt,vt,null));else if(D.isDataTexture)if(wt.length>0&&zt){Bt&&ln&&n.texStorage2D(t.TEXTURE_2D,bt,lt,wt[0].width,wt[0].height);for(let Ue=0,re=wt.length;Ue<re;Ue++)Qe=wt[Ue],Bt?n.texSubImage2D(t.TEXTURE_2D,Ue,0,0,Qe.width,Qe.height,Nt,vt,Qe.data):n.texImage2D(t.TEXTURE_2D,Ue,lt,Qe.width,Qe.height,0,Nt,vt,Qe.data);D.generateMipmaps=!1}else Bt?(ln&&n.texStorage2D(t.TEXTURE_2D,bt,lt,Ae.width,Ae.height),n.texSubImage2D(t.TEXTURE_2D,0,0,0,Ae.width,Ae.height,Nt,vt,Ae.data)):n.texImage2D(t.TEXTURE_2D,0,lt,Ae.width,Ae.height,0,Nt,vt,Ae.data);else if(D.isCompressedTexture)if(D.isCompressedArrayTexture){Bt&&ln&&n.texStorage3D(t.TEXTURE_2D_ARRAY,bt,lt,wt[0].width,wt[0].height,Ae.depth);for(let Ue=0,re=wt.length;Ue<re;Ue++)Qe=wt[Ue],D.format!==Vi?Nt!==null?Bt?n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Ue,0,0,0,Qe.width,Qe.height,Ae.depth,Nt,Qe.data,0,0):n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,Ue,lt,Qe.width,Qe.height,Ae.depth,0,Qe.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Bt?n.texSubImage3D(t.TEXTURE_2D_ARRAY,Ue,0,0,0,Qe.width,Qe.height,Ae.depth,Nt,vt,Qe.data):n.texImage3D(t.TEXTURE_2D_ARRAY,Ue,lt,Qe.width,Qe.height,Ae.depth,0,Nt,vt,Qe.data)}else{Bt&&ln&&n.texStorage2D(t.TEXTURE_2D,bt,lt,wt[0].width,wt[0].height);for(let Ue=0,re=wt.length;Ue<re;Ue++)Qe=wt[Ue],D.format!==Vi?Nt!==null?Bt?n.compressedTexSubImage2D(t.TEXTURE_2D,Ue,0,0,Qe.width,Qe.height,Nt,Qe.data):n.compressedTexImage2D(t.TEXTURE_2D,Ue,lt,Qe.width,Qe.height,0,Qe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Bt?n.texSubImage2D(t.TEXTURE_2D,Ue,0,0,Qe.width,Qe.height,Nt,vt,Qe.data):n.texImage2D(t.TEXTURE_2D,Ue,lt,Qe.width,Qe.height,0,Nt,vt,Qe.data)}else if(D.isDataArrayTexture)Bt?(ln&&n.texStorage3D(t.TEXTURE_2D_ARRAY,bt,lt,Ae.width,Ae.height,Ae.depth),n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,Ae.width,Ae.height,Ae.depth,Nt,vt,Ae.data)):n.texImage3D(t.TEXTURE_2D_ARRAY,0,lt,Ae.width,Ae.height,Ae.depth,0,Nt,vt,Ae.data);else if(D.isData3DTexture)Bt?(ln&&n.texStorage3D(t.TEXTURE_3D,bt,lt,Ae.width,Ae.height,Ae.depth),n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,Ae.width,Ae.height,Ae.depth,Nt,vt,Ae.data)):n.texImage3D(t.TEXTURE_3D,0,lt,Ae.width,Ae.height,Ae.depth,0,Nt,vt,Ae.data);else if(D.isFramebufferTexture){if(ln)if(Bt)n.texStorage2D(t.TEXTURE_2D,bt,lt,Ae.width,Ae.height);else{let Ue=Ae.width,re=Ae.height;for(let $e=0;$e<bt;$e++)n.texImage2D(t.TEXTURE_2D,$e,lt,Ue,re,0,Nt,vt,null),Ue>>=1,re>>=1}}else if(wt.length>0&&zt){Bt&&ln&&n.texStorage2D(t.TEXTURE_2D,bt,lt,wt[0].width,wt[0].height);for(let Ue=0,re=wt.length;Ue<re;Ue++)Qe=wt[Ue],Bt?n.texSubImage2D(t.TEXTURE_2D,Ue,0,0,Nt,vt,Qe):n.texImage2D(t.TEXTURE_2D,Ue,lt,Nt,vt,Qe);D.generateMipmaps=!1}else Bt?(ln&&n.texStorage2D(t.TEXTURE_2D,bt,lt,Ae.width,Ae.height),n.texSubImage2D(t.TEXTURE_2D,0,0,0,Nt,vt,Ae)):n.texImage2D(t.TEXTURE_2D,0,lt,Nt,vt,Ae);x(D,zt)&&w(Me),et.__version=Ie.version,D.onUpdate&&D.onUpdate(D)}$.__version=D.version}function G($,D,oe){if(D.image.length!==6)return;const Me=P($,D),Ee=D.source;n.bindTexture(t.TEXTURE_CUBE_MAP,$.__webglTexture,t.TEXTURE0+oe);const Ie=r.get(Ee);if(Ee.version!==Ie.__version||Me===!0){n.activeTexture(t.TEXTURE0+oe);const et=on.getPrimaries(on.workingColorSpace),ze=D.colorSpace===_i?null:on.getPrimaries(D.colorSpace),Ze=D.colorSpace===_i||et===ze?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,D.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,D.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,D.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ze);const ot=D.isCompressedTexture||D.image[0].isCompressedTexture,St=D.image[0]&&D.image[0].isDataTexture,Ae=[];for(let Ue=0;Ue<6;Ue++)!ot&&!St?Ae[Ue]=E(D.image[Ue],!1,!0,i.maxCubemapSize):Ae[Ue]=St?D.image[Ue].image:D.image[Ue],Ae[Ue]=at(D,Ae[Ue]);const zt=Ae[0],Nt=g(zt)||c,vt=a.convert(D.format,D.colorSpace),lt=a.convert(D.type),Qe=C(D.internalFormat,vt,lt,D.colorSpace),wt=c&&D.isVideoTexture!==!0,Bt=Ie.__version===void 0||Me===!0;let ln=T(D,zt,Nt);U(t.TEXTURE_CUBE_MAP,D,Nt);let bt;if(ot){wt&&Bt&&n.texStorage2D(t.TEXTURE_CUBE_MAP,ln,Qe,zt.width,zt.height);for(let Ue=0;Ue<6;Ue++){bt=Ae[Ue].mipmaps;for(let re=0;re<bt.length;re++){const $e=bt[re];D.format!==Vi?vt!==null?wt?n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,re,0,0,$e.width,$e.height,vt,$e.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,re,Qe,$e.width,$e.height,0,$e.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):wt?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,re,0,0,$e.width,$e.height,vt,lt,$e.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,re,Qe,$e.width,$e.height,0,vt,lt,$e.data)}}}else{bt=D.mipmaps,wt&&Bt&&(bt.length>0&&ln++,n.texStorage2D(t.TEXTURE_CUBE_MAP,ln,Qe,Ae[0].width,Ae[0].height));for(let Ue=0;Ue<6;Ue++)if(St){wt?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,0,0,Ae[Ue].width,Ae[Ue].height,vt,lt,Ae[Ue].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,Qe,Ae[Ue].width,Ae[Ue].height,0,vt,lt,Ae[Ue].data);for(let re=0;re<bt.length;re++){const Ve=bt[re].image[Ue].image;wt?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,re+1,0,0,Ve.width,Ve.height,vt,lt,Ve.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,re+1,Qe,Ve.width,Ve.height,0,vt,lt,Ve.data)}}else{wt?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,0,0,vt,lt,Ae[Ue]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,Qe,vt,lt,Ae[Ue]);for(let re=0;re<bt.length;re++){const $e=bt[re];wt?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,re+1,0,0,vt,lt,$e.image[Ue]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,re+1,Qe,vt,lt,$e.image[Ue])}}}x(D,Nt)&&w(t.TEXTURE_CUBE_MAP),Ie.__version=Ee.version,D.onUpdate&&D.onUpdate(D)}$.__version=D.version}function Q($,D,oe,Me,Ee,Ie){const et=a.convert(oe.format,oe.colorSpace),ze=a.convert(oe.type),Ze=C(oe.internalFormat,et,ze,oe.colorSpace);if(!r.get(D).__hasExternalTextures){const St=Math.max(1,D.width>>Ie),Ae=Math.max(1,D.height>>Ie);Ee===t.TEXTURE_3D||Ee===t.TEXTURE_2D_ARRAY?n.texImage3D(Ee,Ie,Ze,St,Ae,D.depth,0,et,ze,null):n.texImage2D(Ee,Ie,Ze,St,Ae,0,et,ze,null)}n.bindFramebuffer(t.FRAMEBUFFER,$),Re(D)?u.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Me,Ee,r.get(oe).__webglTexture,0,be(D)):(Ee===t.TEXTURE_2D||Ee>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Ee<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,Me,Ee,r.get(oe).__webglTexture,Ie),n.bindFramebuffer(t.FRAMEBUFFER,null)}function le($,D,oe){if(t.bindRenderbuffer(t.RENDERBUFFER,$),D.depthBuffer&&!D.stencilBuffer){let Me=c===!0?t.DEPTH_COMPONENT24:t.DEPTH_COMPONENT16;if(oe||Re(D)){const Ee=D.depthTexture;Ee&&Ee.isDepthTexture&&(Ee.type===pa?Me=t.DEPTH_COMPONENT32F:Ee.type===ha&&(Me=t.DEPTH_COMPONENT24));const Ie=be(D);Re(D)?u.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Ie,Me,D.width,D.height):t.renderbufferStorageMultisample(t.RENDERBUFFER,Ie,Me,D.width,D.height)}else t.renderbufferStorage(t.RENDERBUFFER,Me,D.width,D.height);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,$)}else if(D.depthBuffer&&D.stencilBuffer){const Me=be(D);oe&&Re(D)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Me,t.DEPTH24_STENCIL8,D.width,D.height):Re(D)?u.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Me,t.DEPTH24_STENCIL8,D.width,D.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,D.width,D.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,$)}else{const Me=D.isWebGLMultipleRenderTargets===!0?D.texture:[D.texture];for(let Ee=0;Ee<Me.length;Ee++){const Ie=Me[Ee],et=a.convert(Ie.format,Ie.colorSpace),ze=a.convert(Ie.type),Ze=C(Ie.internalFormat,et,ze,Ie.colorSpace),ot=be(D);oe&&Re(D)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,ot,Ze,D.width,D.height):Re(D)?u.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,ot,Ze,D.width,D.height):t.renderbufferStorage(t.RENDERBUFFER,Ze,D.width,D.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function xe($,D){if(D&&D.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,$),!(D.depthTexture&&D.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(D.depthTexture).__webglTexture||D.depthTexture.image.width!==D.width||D.depthTexture.image.height!==D.height)&&(D.depthTexture.image.width=D.width,D.depthTexture.image.height=D.height,D.depthTexture.needsUpdate=!0),de(D.depthTexture,0);const Me=r.get(D.depthTexture).__webglTexture,Ee=be(D);if(D.depthTexture.format===oo)Re(D)?u.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Me,0,Ee):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Me,0);else if(D.depthTexture.format===Ul)Re(D)?u.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Me,0,Ee):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Me,0);else throw new Error("Unknown depthTexture format")}function Te($){const D=r.get($),oe=$.isWebGLCubeRenderTarget===!0;if($.depthTexture&&!D.__autoAllocateDepthBuffer){if(oe)throw new Error("target.depthTexture not supported in Cube render targets");xe(D.__webglFramebuffer,$)}else if(oe){D.__webglDepthbuffer=[];for(let Me=0;Me<6;Me++)n.bindFramebuffer(t.FRAMEBUFFER,D.__webglFramebuffer[Me]),D.__webglDepthbuffer[Me]=t.createRenderbuffer(),le(D.__webglDepthbuffer[Me],$,!1)}else n.bindFramebuffer(t.FRAMEBUFFER,D.__webglFramebuffer),D.__webglDepthbuffer=t.createRenderbuffer(),le(D.__webglDepthbuffer,$,!1);n.bindFramebuffer(t.FRAMEBUFFER,null)}function X($,D,oe){const Me=r.get($);D!==void 0&&Q(Me.__webglFramebuffer,$,$.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),oe!==void 0&&Te($)}function z($){const D=$.texture,oe=r.get($),Me=r.get(D);$.addEventListener("dispose",F),$.isWebGLMultipleRenderTargets!==!0&&(Me.__webglTexture===void 0&&(Me.__webglTexture=t.createTexture()),Me.__version=D.version,l.memory.textures++);const Ee=$.isWebGLCubeRenderTarget===!0,Ie=$.isWebGLMultipleRenderTargets===!0,et=g($)||c;if(Ee){oe.__webglFramebuffer=[];for(let ze=0;ze<6;ze++)if(c&&D.mipmaps&&D.mipmaps.length>0){oe.__webglFramebuffer[ze]=[];for(let Ze=0;Ze<D.mipmaps.length;Ze++)oe.__webglFramebuffer[ze][Ze]=t.createFramebuffer()}else oe.__webglFramebuffer[ze]=t.createFramebuffer()}else{if(c&&D.mipmaps&&D.mipmaps.length>0){oe.__webglFramebuffer=[];for(let ze=0;ze<D.mipmaps.length;ze++)oe.__webglFramebuffer[ze]=t.createFramebuffer()}else oe.__webglFramebuffer=t.createFramebuffer();if(Ie)if(i.drawBuffers){const ze=$.texture;for(let Ze=0,ot=ze.length;Ze<ot;Ze++){const St=r.get(ze[Ze]);St.__webglTexture===void 0&&(St.__webglTexture=t.createTexture(),l.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(c&&$.samples>0&&Re($)===!1){const ze=Ie?D:[D];oe.__webglMultisampledFramebuffer=t.createFramebuffer(),oe.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,oe.__webglMultisampledFramebuffer);for(let Ze=0;Ze<ze.length;Ze++){const ot=ze[Ze];oe.__webglColorRenderbuffer[Ze]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,oe.__webglColorRenderbuffer[Ze]);const St=a.convert(ot.format,ot.colorSpace),Ae=a.convert(ot.type),zt=C(ot.internalFormat,St,Ae,ot.colorSpace,$.isXRRenderTarget===!0),Nt=be($);t.renderbufferStorageMultisample(t.RENDERBUFFER,Nt,zt,$.width,$.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ze,t.RENDERBUFFER,oe.__webglColorRenderbuffer[Ze])}t.bindRenderbuffer(t.RENDERBUFFER,null),$.depthBuffer&&(oe.__webglDepthRenderbuffer=t.createRenderbuffer(),le(oe.__webglDepthRenderbuffer,$,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Ee){n.bindTexture(t.TEXTURE_CUBE_MAP,Me.__webglTexture),U(t.TEXTURE_CUBE_MAP,D,et);for(let ze=0;ze<6;ze++)if(c&&D.mipmaps&&D.mipmaps.length>0)for(let Ze=0;Ze<D.mipmaps.length;Ze++)Q(oe.__webglFramebuffer[ze][Ze],$,D,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,Ze);else Q(oe.__webglFramebuffer[ze],$,D,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+ze,0);x(D,et)&&w(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(Ie){const ze=$.texture;for(let Ze=0,ot=ze.length;Ze<ot;Ze++){const St=ze[Ze],Ae=r.get(St);n.bindTexture(t.TEXTURE_2D,Ae.__webglTexture),U(t.TEXTURE_2D,St,et),Q(oe.__webglFramebuffer,$,St,t.COLOR_ATTACHMENT0+Ze,t.TEXTURE_2D,0),x(St,et)&&w(t.TEXTURE_2D)}n.unbindTexture()}else{let ze=t.TEXTURE_2D;if(($.isWebGL3DRenderTarget||$.isWebGLArrayRenderTarget)&&(c?ze=$.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(ze,Me.__webglTexture),U(ze,D,et),c&&D.mipmaps&&D.mipmaps.length>0)for(let Ze=0;Ze<D.mipmaps.length;Ze++)Q(oe.__webglFramebuffer[Ze],$,D,t.COLOR_ATTACHMENT0,ze,Ze);else Q(oe.__webglFramebuffer,$,D,t.COLOR_ATTACHMENT0,ze,0);x(D,et)&&w(ze),n.unbindTexture()}$.depthBuffer&&Te($)}function ve($){const D=g($)||c,oe=$.isWebGLMultipleRenderTargets===!0?$.texture:[$.texture];for(let Me=0,Ee=oe.length;Me<Ee;Me++){const Ie=oe[Me];if(x(Ie,D)){const et=$.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,ze=r.get(Ie).__webglTexture;n.bindTexture(et,ze),w(et),n.unbindTexture()}}}function he($){if(c&&$.samples>0&&Re($)===!1){const D=$.isWebGLMultipleRenderTargets?$.texture:[$.texture],oe=$.width,Me=$.height;let Ee=t.COLOR_BUFFER_BIT;const Ie=[],et=$.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ze=r.get($),Ze=$.isWebGLMultipleRenderTargets===!0;if(Ze)for(let ot=0;ot<D.length;ot++)n.bindFramebuffer(t.FRAMEBUFFER,ze.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ot,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,ze.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+ot,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,ze.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,ze.__webglFramebuffer);for(let ot=0;ot<D.length;ot++){Ie.push(t.COLOR_ATTACHMENT0+ot),$.depthBuffer&&Ie.push(et);const St=ze.__ignoreDepthValues!==void 0?ze.__ignoreDepthValues:!1;if(St===!1&&($.depthBuffer&&(Ee|=t.DEPTH_BUFFER_BIT),$.stencilBuffer&&(Ee|=t.STENCIL_BUFFER_BIT)),Ze&&t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,ze.__webglColorRenderbuffer[ot]),St===!0&&(t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[et]),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[et])),Ze){const Ae=r.get(D[ot]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,Ae,0)}t.blitFramebuffer(0,0,oe,Me,0,0,oe,Me,Ee,t.NEAREST),f&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,Ie)}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),Ze)for(let ot=0;ot<D.length;ot++){n.bindFramebuffer(t.FRAMEBUFFER,ze.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ot,t.RENDERBUFFER,ze.__webglColorRenderbuffer[ot]);const St=r.get(D[ot]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,ze.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+ot,t.TEXTURE_2D,St,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,ze.__webglMultisampledFramebuffer)}}function be($){return Math.min(i.maxSamples,$.samples)}function Re($){const D=r.get($);return c&&$.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&D.__useRenderToTexture!==!1}function gt($){const D=l.render.frame;h.get($)!==D&&(h.set($,D),$.update())}function at($,D){const oe=$.colorSpace,Me=$.format,Ee=$.type;return $.isCompressedTexture===!0||$.isVideoTexture===!0||$.format===zv||oe!==Os&&oe!==_i&&(on.getTransfer(oe)===mn?c===!1?e.has("EXT_sRGB")===!0&&Me===Vi?($.format=zv,$.minFilter=mi,$.generateMipmaps=!1):D=QA.sRGBToLinear(D):(Me!==Vi||Ee!==va)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",oe)),D}this.allocateTextureUnit=Z,this.resetTextureUnits=ae,this.setTexture2D=de,this.setTexture2DArray=pe,this.setTexture3D=K,this.setTextureCube=ne,this.rebindTextures=X,this.setupRenderTarget=z,this.updateRenderTargetMipmap=ve,this.updateMultisampleRenderTarget=he,this.setupDepthRenderbuffer=Te,this.setupFrameBufferTexture=Q,this.useMultisampledRTT=Re}function xW(t,e,n){const r=n.isWebGL2;function i(a,l=_i){let c;const u=on.getTransfer(l);if(a===va)return t.UNSIGNED_BYTE;if(a===jA)return t.UNSIGNED_SHORT_4_4_4_4;if(a===HA)return t.UNSIGNED_SHORT_5_5_5_1;if(a===rj)return t.BYTE;if(a===ij)return t.SHORT;if(a===By)return t.UNSIGNED_SHORT;if(a===VA)return t.INT;if(a===ha)return t.UNSIGNED_INT;if(a===pa)return t.FLOAT;if(a===yu)return r?t.HALF_FLOAT:(c=e.get("OES_texture_half_float"),c!==null?c.HALF_FLOAT_OES:null);if(a===sj)return t.ALPHA;if(a===Vi)return t.RGBA;if(a===aj)return t.LUMINANCE;if(a===oj)return t.LUMINANCE_ALPHA;if(a===oo)return t.DEPTH_COMPONENT;if(a===Ul)return t.DEPTH_STENCIL;if(a===zv)return c=e.get("EXT_sRGB"),c!==null?c.SRGB_ALPHA_EXT:null;if(a===lj)return t.RED;if(a===GA)return t.RED_INTEGER;if(a===cj)return t.RG;if(a===WA)return t.RG_INTEGER;if(a===qA)return t.RGBA_INTEGER;if(a===Yg||a===Jg||a===Qg||a===e_)if(u===mn)if(c=e.get("WEBGL_compressed_texture_s3tc_srgb"),c!==null){if(a===Yg)return c.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(a===Jg)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(a===Qg)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(a===e_)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(c=e.get("WEBGL_compressed_texture_s3tc"),c!==null){if(a===Yg)return c.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===Jg)return c.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===Qg)return c.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===e_)return c.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===yb||a===Sb||a===wb||a===xb)if(c=e.get("WEBGL_compressed_texture_pvrtc"),c!==null){if(a===yb)return c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===Sb)return c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===wb)return c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===xb)return c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===ZA)return c=e.get("WEBGL_compressed_texture_etc1"),c!==null?c.COMPRESSED_RGB_ETC1_WEBGL:null;if(a===Eb||a===bb)if(c=e.get("WEBGL_compressed_texture_etc"),c!==null){if(a===Eb)return u===mn?c.COMPRESSED_SRGB8_ETC2:c.COMPRESSED_RGB8_ETC2;if(a===bb)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:c.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(a===Tb||a===Mb||a===Rb||a===Cb||a===Ab||a===Pb||a===Ib||a===Nb||a===kb||a===Lb||a===Ob||a===Db||a===Ub||a===Fb)if(c=e.get("WEBGL_compressed_texture_astc"),c!==null){if(a===Tb)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:c.COMPRESSED_RGBA_ASTC_4x4_KHR;if(a===Mb)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:c.COMPRESSED_RGBA_ASTC_5x4_KHR;if(a===Rb)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:c.COMPRESSED_RGBA_ASTC_5x5_KHR;if(a===Cb)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:c.COMPRESSED_RGBA_ASTC_6x5_KHR;if(a===Ab)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:c.COMPRESSED_RGBA_ASTC_6x6_KHR;if(a===Pb)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:c.COMPRESSED_RGBA_ASTC_8x5_KHR;if(a===Ib)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:c.COMPRESSED_RGBA_ASTC_8x6_KHR;if(a===Nb)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:c.COMPRESSED_RGBA_ASTC_8x8_KHR;if(a===kb)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:c.COMPRESSED_RGBA_ASTC_10x5_KHR;if(a===Lb)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:c.COMPRESSED_RGBA_ASTC_10x6_KHR;if(a===Ob)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:c.COMPRESSED_RGBA_ASTC_10x8_KHR;if(a===Db)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:c.COMPRESSED_RGBA_ASTC_10x10_KHR;if(a===Ub)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:c.COMPRESSED_RGBA_ASTC_12x10_KHR;if(a===Fb)return u===mn?c.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:c.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(a===t_||a===zb||a===$b)if(c=e.get("EXT_texture_compression_bptc"),c!==null){if(a===t_)return u===mn?c.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:c.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(a===zb)return c.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(a===$b)return c.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(a===uj||a===Bb||a===Vb||a===jb)if(c=e.get("EXT_texture_compression_rgtc"),c!==null){if(a===t_)return c.COMPRESSED_RED_RGTC1_EXT;if(a===Bb)return c.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(a===Vb)return c.COMPRESSED_RED_GREEN_RGTC2_EXT;if(a===jb)return c.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return a===ao?r?t.UNSIGNED_INT_24_8:(c=e.get("WEBGL_depth_texture"),c!==null?c.UNSIGNED_INT_24_8_WEBGL:null):t[a]!==void 0?t[a]:null}return{convert:i}}class EW extends gi{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Xc extends Ar{constructor(){super(),this.isGroup=!0,this.type="Group"}}const bW={type:"move"};class M_{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Xc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Xc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Se,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Se),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Xc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Se,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Se),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const r of e.hand.values())this._getHandJoint(n,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,r){let i=null,a=null,l=null;const c=this._targetRay,u=this._grip,f=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(f&&e.hand){l=!0;for(const E of e.hand.values()){const g=n.getJointPose(E,r),v=this._getHandJoint(f,E);g!==null&&(v.matrix.fromArray(g.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=g.radius),v.visible=g!==null}const h=f.joints["index-finger-tip"],p=f.joints["thumb-tip"],m=h.position.distanceTo(p.position),y=.02,S=.005;f.inputState.pinching&&m>y+S?(f.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!f.inputState.pinching&&m<=y-S&&(f.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(a=n.getPose(e.gripSpace,r),a!==null&&(u.matrix.fromArray(a.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,a.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(a.linearVelocity)):u.hasLinearVelocity=!1,a.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(a.angularVelocity)):u.hasAngularVelocity=!1));c!==null&&(i=n.getPose(e.targetRaySpace,r),i===null&&a!==null&&(i=a),i!==null&&(c.matrix.fromArray(i.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,i.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(i.linearVelocity)):c.hasLinearVelocity=!1,i.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(i.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(bW)))}return c!==null&&(c.visible=i!==null),u!==null&&(u.visible=a!==null),f!==null&&(f.visible=l!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const r=new Xc;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[n.jointName]=r,e.add(r)}return e.joints[n.jointName]}}class TW extends Wl{constructor(e,n){super();const r=this;let i=null,a=1,l=null,c="local-floor",u=1,f=null,h=null,p=null,m=null,y=null,S=null;const E=n.getContextAttributes();let g=null,v=null;const x=[],w=[],C=new sn;let T=null;const M=new gi;M.layers.enable(1),M.viewport=new sr;const A=new gi;A.layers.enable(2),A.viewport=new sr;const F=[M,A],I=new EW;I.layers.enable(1),I.layers.enable(2);let O=null,W=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(U){let P=x[U];return P===void 0&&(P=new M_,x[U]=P),P.getTargetRaySpace()},this.getControllerGrip=function(U){let P=x[U];return P===void 0&&(P=new M_,x[U]=P),P.getGripSpace()},this.getHand=function(U){let P=x[U];return P===void 0&&(P=new M_,x[U]=P),P.getHandSpace()};function J(U){const P=w.indexOf(U.inputSource);if(P===-1)return;const L=x[P];L!==void 0&&(L.update(U.inputSource,U.frame,f||l),L.dispatchEvent({type:U.type,data:U.inputSource}))}function ae(){i.removeEventListener("select",J),i.removeEventListener("selectstart",J),i.removeEventListener("selectend",J),i.removeEventListener("squeeze",J),i.removeEventListener("squeezestart",J),i.removeEventListener("squeezeend",J),i.removeEventListener("end",ae),i.removeEventListener("inputsourceschange",Z);for(let U=0;U<x.length;U++){const P=w[U];P!==null&&(w[U]=null,x[U].disconnect(P))}O=null,W=null,e.setRenderTarget(g),y=null,m=null,p=null,i=null,v=null,H.stop(),r.isPresenting=!1,e.setPixelRatio(T),e.setSize(C.width,C.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(U){a=U,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(U){c=U,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return f||l},this.setReferenceSpace=function(U){f=U},this.getBaseLayer=function(){return m!==null?m:y},this.getBinding=function(){return p},this.getFrame=function(){return S},this.getSession=function(){return i},this.setSession=async function(U){if(i=U,i!==null){if(g=e.getRenderTarget(),i.addEventListener("select",J),i.addEventListener("selectstart",J),i.addEventListener("selectend",J),i.addEventListener("squeeze",J),i.addEventListener("squeezestart",J),i.addEventListener("squeezeend",J),i.addEventListener("end",ae),i.addEventListener("inputsourceschange",Z),E.xrCompatible!==!0&&await n.makeXRCompatible(),T=e.getPixelRatio(),e.getSize(C),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const P={antialias:i.renderState.layers===void 0?E.antialias:!0,alpha:!0,depth:E.depth,stencil:E.stencil,framebufferScaleFactor:a};y=new XRWebGLLayer(i,n,P),i.updateRenderState({baseLayer:y}),e.setPixelRatio(1),e.setSize(y.framebufferWidth,y.framebufferHeight,!1),v=new po(y.framebufferWidth,y.framebufferHeight,{format:Vi,type:va,colorSpace:e.outputColorSpace,stencilBuffer:E.stencil})}else{let P=null,L=null,G=null;E.depth&&(G=E.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,P=E.stencil?Ul:oo,L=E.stencil?ao:ha);const Q={colorFormat:n.RGBA8,depthFormat:G,scaleFactor:a};p=new XRWebGLBinding(i,n),m=p.createProjectionLayer(Q),i.updateRenderState({layers:[m]}),e.setPixelRatio(1),e.setSize(m.textureWidth,m.textureHeight,!1),v=new po(m.textureWidth,m.textureHeight,{format:Vi,type:va,depthTexture:new f1(m.textureWidth,m.textureHeight,L,void 0,void 0,void 0,void 0,void 0,void 0,P),stencilBuffer:E.stencil,colorSpace:e.outputColorSpace,samples:E.antialias?4:0});const le=e.properties.get(v);le.__ignoreDepthValues=m.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(u),f=null,l=await i.requestReferenceSpace(c),H.setContext(i),H.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode};function Z(U){for(let P=0;P<U.removed.length;P++){const L=U.removed[P],G=w.indexOf(L);G>=0&&(w[G]=null,x[G].disconnect(L))}for(let P=0;P<U.added.length;P++){const L=U.added[P];let G=w.indexOf(L);if(G===-1){for(let le=0;le<x.length;le++)if(le>=w.length){w.push(L),G=le;break}else if(w[le]===null){w[le]=L,G=le;break}if(G===-1)break}const Q=x[G];Q&&Q.connect(L)}}const ie=new Se,de=new Se;function pe(U,P,L){ie.setFromMatrixPosition(P.matrixWorld),de.setFromMatrixPosition(L.matrixWorld);const G=ie.distanceTo(de),Q=P.projectionMatrix.elements,le=L.projectionMatrix.elements,xe=Q[14]/(Q[10]-1),Te=Q[14]/(Q[10]+1),X=(Q[9]+1)/Q[5],z=(Q[9]-1)/Q[5],ve=(Q[8]-1)/Q[0],he=(le[8]+1)/le[0],be=xe*ve,Re=xe*he,gt=G/(-ve+he),at=gt*-ve;P.matrixWorld.decompose(U.position,U.quaternion,U.scale),U.translateX(at),U.translateZ(gt),U.matrixWorld.compose(U.position,U.quaternion,U.scale),U.matrixWorldInverse.copy(U.matrixWorld).invert();const $=xe+gt,D=Te+gt,oe=be-at,Me=Re+(G-at),Ee=X*Te/D*$,Ie=z*Te/D*$;U.projectionMatrix.makePerspective(oe,Me,Ee,Ie,$,D),U.projectionMatrixInverse.copy(U.projectionMatrix).invert()}function K(U,P){P===null?U.matrixWorld.copy(U.matrix):U.matrixWorld.multiplyMatrices(P.matrixWorld,U.matrix),U.matrixWorldInverse.copy(U.matrixWorld).invert()}this.updateCamera=function(U){if(i===null)return;I.near=A.near=M.near=U.near,I.far=A.far=M.far=U.far,(O!==I.near||W!==I.far)&&(i.updateRenderState({depthNear:I.near,depthFar:I.far}),O=I.near,W=I.far);const P=U.parent,L=I.cameras;K(I,P);for(let G=0;G<L.length;G++)K(L[G],P);L.length===2?pe(I,M,A):I.projectionMatrix.copy(M.projectionMatrix),ne(U,I,P)};function ne(U,P,L){L===null?U.matrix.copy(P.matrixWorld):(U.matrix.copy(L.matrixWorld),U.matrix.invert(),U.matrix.multiply(P.matrixWorld)),U.matrix.decompose(U.position,U.quaternion,U.scale),U.updateMatrixWorld(!0),U.projectionMatrix.copy(P.projectionMatrix),U.projectionMatrixInverse.copy(P.projectionMatrixInverse),U.isPerspectiveCamera&&(U.fov=$v*2*Math.atan(1/U.projectionMatrix.elements[5]),U.zoom=1)}this.getCamera=function(){return I},this.getFoveation=function(){if(!(m===null&&y===null))return u},this.setFoveation=function(U){u=U,m!==null&&(m.fixedFoveation=U),y!==null&&y.fixedFoveation!==void 0&&(y.fixedFoveation=U)};let j=null;function N(U,P){if(h=P.getViewerPose(f||l),S=P,h!==null){const L=h.views;y!==null&&(e.setRenderTargetFramebuffer(v,y.framebuffer),e.setRenderTarget(v));let G=!1;L.length!==I.cameras.length&&(I.cameras.length=0,G=!0);for(let Q=0;Q<L.length;Q++){const le=L[Q];let xe=null;if(y!==null)xe=y.getViewport(le);else{const X=p.getViewSubImage(m,le);xe=X.viewport,Q===0&&(e.setRenderTargetTextures(v,X.colorTexture,m.ignoreDepthValues?void 0:X.depthStencilTexture),e.setRenderTarget(v))}let Te=F[Q];Te===void 0&&(Te=new gi,Te.layers.enable(Q),Te.viewport=new sr,F[Q]=Te),Te.matrix.fromArray(le.transform.matrix),Te.matrix.decompose(Te.position,Te.quaternion,Te.scale),Te.projectionMatrix.fromArray(le.projectionMatrix),Te.projectionMatrixInverse.copy(Te.projectionMatrix).invert(),Te.viewport.set(xe.x,xe.y,xe.width,xe.height),Q===0&&(I.matrix.copy(Te.matrix),I.matrix.decompose(I.position,I.quaternion,I.scale)),G===!0&&I.cameras.push(Te)}}for(let L=0;L<x.length;L++){const G=w[L],Q=x[L];G!==null&&Q!==void 0&&Q.update(G,P,f||l)}j&&j(U,P),P.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:P}),S=null}const H=new d1;H.setAnimationLoop(N),this.setAnimationLoop=function(U){j=U},this.dispose=function(){}}}function MW(t,e){function n(g,v){g.matrixAutoUpdate===!0&&g.updateMatrix(),v.value.copy(g.matrix)}function r(g,v){v.color.getRGB(g.fogColor.value,o1(t)),v.isFog?(g.fogNear.value=v.near,g.fogFar.value=v.far):v.isFogExp2&&(g.fogDensity.value=v.density)}function i(g,v,x,w,C){v.isMeshBasicMaterial||v.isMeshLambertMaterial?a(g,v):v.isMeshToonMaterial?(a(g,v),p(g,v)):v.isMeshPhongMaterial?(a(g,v),h(g,v)):v.isMeshStandardMaterial?(a(g,v),m(g,v),v.isMeshPhysicalMaterial&&y(g,v,C)):v.isMeshMatcapMaterial?(a(g,v),S(g,v)):v.isMeshDepthMaterial?a(g,v):v.isMeshDistanceMaterial?(a(g,v),E(g,v)):v.isMeshNormalMaterial?a(g,v):v.isLineBasicMaterial?(l(g,v),v.isLineDashedMaterial&&c(g,v)):v.isPointsMaterial?u(g,v,x,w):v.isSpriteMaterial?f(g,v):v.isShadowMaterial?(g.color.value.copy(v.color),g.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function a(g,v){g.opacity.value=v.opacity,v.color&&g.diffuse.value.copy(v.color),v.emissive&&g.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(g.map.value=v.map,n(v.map,g.mapTransform)),v.alphaMap&&(g.alphaMap.value=v.alphaMap,n(v.alphaMap,g.alphaMapTransform)),v.bumpMap&&(g.bumpMap.value=v.bumpMap,n(v.bumpMap,g.bumpMapTransform),g.bumpScale.value=v.bumpScale,v.side===ar&&(g.bumpScale.value*=-1)),v.normalMap&&(g.normalMap.value=v.normalMap,n(v.normalMap,g.normalMapTransform),g.normalScale.value.copy(v.normalScale),v.side===ar&&g.normalScale.value.negate()),v.displacementMap&&(g.displacementMap.value=v.displacementMap,n(v.displacementMap,g.displacementMapTransform),g.displacementScale.value=v.displacementScale,g.displacementBias.value=v.displacementBias),v.emissiveMap&&(g.emissiveMap.value=v.emissiveMap,n(v.emissiveMap,g.emissiveMapTransform)),v.specularMap&&(g.specularMap.value=v.specularMap,n(v.specularMap,g.specularMapTransform)),v.alphaTest>0&&(g.alphaTest.value=v.alphaTest);const x=e.get(v).envMap;if(x&&(g.envMap.value=x,g.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=v.reflectivity,g.ior.value=v.ior,g.refractionRatio.value=v.refractionRatio),v.lightMap){g.lightMap.value=v.lightMap;const w=t._useLegacyLights===!0?Math.PI:1;g.lightMapIntensity.value=v.lightMapIntensity*w,n(v.lightMap,g.lightMapTransform)}v.aoMap&&(g.aoMap.value=v.aoMap,g.aoMapIntensity.value=v.aoMapIntensity,n(v.aoMap,g.aoMapTransform))}function l(g,v){g.diffuse.value.copy(v.color),g.opacity.value=v.opacity,v.map&&(g.map.value=v.map,n(v.map,g.mapTransform))}function c(g,v){g.dashSize.value=v.dashSize,g.totalSize.value=v.dashSize+v.gapSize,g.scale.value=v.scale}function u(g,v,x,w){g.diffuse.value.copy(v.color),g.opacity.value=v.opacity,g.size.value=v.size*x,g.scale.value=w*.5,v.map&&(g.map.value=v.map,n(v.map,g.uvTransform)),v.alphaMap&&(g.alphaMap.value=v.alphaMap,n(v.alphaMap,g.alphaMapTransform)),v.alphaTest>0&&(g.alphaTest.value=v.alphaTest)}function f(g,v){g.diffuse.value.copy(v.color),g.opacity.value=v.opacity,g.rotation.value=v.rotation,v.map&&(g.map.value=v.map,n(v.map,g.mapTransform)),v.alphaMap&&(g.alphaMap.value=v.alphaMap,n(v.alphaMap,g.alphaMapTransform)),v.alphaTest>0&&(g.alphaTest.value=v.alphaTest)}function h(g,v){g.specular.value.copy(v.specular),g.shininess.value=Math.max(v.shininess,1e-4)}function p(g,v){v.gradientMap&&(g.gradientMap.value=v.gradientMap)}function m(g,v){g.metalness.value=v.metalness,v.metalnessMap&&(g.metalnessMap.value=v.metalnessMap,n(v.metalnessMap,g.metalnessMapTransform)),g.roughness.value=v.roughness,v.roughnessMap&&(g.roughnessMap.value=v.roughnessMap,n(v.roughnessMap,g.roughnessMapTransform)),e.get(v).envMap&&(g.envMapIntensity.value=v.envMapIntensity)}function y(g,v,x){g.ior.value=v.ior,v.sheen>0&&(g.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),g.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(g.sheenColorMap.value=v.sheenColorMap,n(v.sheenColorMap,g.sheenColorMapTransform)),v.sheenRoughnessMap&&(g.sheenRoughnessMap.value=v.sheenRoughnessMap,n(v.sheenRoughnessMap,g.sheenRoughnessMapTransform))),v.clearcoat>0&&(g.clearcoat.value=v.clearcoat,g.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(g.clearcoatMap.value=v.clearcoatMap,n(v.clearcoatMap,g.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,n(v.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(g.clearcoatNormalMap.value=v.clearcoatNormalMap,n(v.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===ar&&g.clearcoatNormalScale.value.negate())),v.iridescence>0&&(g.iridescence.value=v.iridescence,g.iridescenceIOR.value=v.iridescenceIOR,g.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(g.iridescenceMap.value=v.iridescenceMap,n(v.iridescenceMap,g.iridescenceMapTransform)),v.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=v.iridescenceThicknessMap,n(v.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),v.transmission>0&&(g.transmission.value=v.transmission,g.transmissionSamplerMap.value=x.texture,g.transmissionSamplerSize.value.set(x.width,x.height),v.transmissionMap&&(g.transmissionMap.value=v.transmissionMap,n(v.transmissionMap,g.transmissionMapTransform)),g.thickness.value=v.thickness,v.thicknessMap&&(g.thicknessMap.value=v.thicknessMap,n(v.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=v.attenuationDistance,g.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(g.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(g.anisotropyMap.value=v.anisotropyMap,n(v.anisotropyMap,g.anisotropyMapTransform))),g.specularIntensity.value=v.specularIntensity,g.specularColor.value.copy(v.specularColor),v.specularColorMap&&(g.specularColorMap.value=v.specularColorMap,n(v.specularColorMap,g.specularColorMapTransform)),v.specularIntensityMap&&(g.specularIntensityMap.value=v.specularIntensityMap,n(v.specularIntensityMap,g.specularIntensityMapTransform))}function S(g,v){v.matcap&&(g.matcap.value=v.matcap)}function E(g,v){const x=e.get(v).light;g.referencePosition.value.setFromMatrixPosition(x.matrixWorld),g.nearDistance.value=x.shadow.camera.near,g.farDistance.value=x.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function RW(t,e,n,r){let i={},a={},l=[];const c=n.isWebGL2?t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS):0;function u(x,w){const C=w.program;r.uniformBlockBinding(x,C)}function f(x,w){let C=i[x.id];C===void 0&&(S(x),C=h(x),i[x.id]=C,x.addEventListener("dispose",g));const T=w.program;r.updateUBOMapping(x,T);const M=e.render.frame;a[x.id]!==M&&(m(x),a[x.id]=M)}function h(x){const w=p();x.__bindingPointIndex=w;const C=t.createBuffer(),T=x.__size,M=x.usage;return t.bindBuffer(t.UNIFORM_BUFFER,C),t.bufferData(t.UNIFORM_BUFFER,T,M),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,w,C),C}function p(){for(let x=0;x<c;x++)if(l.indexOf(x)===-1)return l.push(x),x;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function m(x){const w=i[x.id],C=x.uniforms,T=x.__cache;t.bindBuffer(t.UNIFORM_BUFFER,w);for(let M=0,A=C.length;M<A;M++){const F=Array.isArray(C[M])?C[M]:[C[M]];for(let I=0,O=F.length;I<O;I++){const W=F[I];if(y(W,M,I,T)===!0){const J=W.__offset,ae=Array.isArray(W.value)?W.value:[W.value];let Z=0;for(let ie=0;ie<ae.length;ie++){const de=ae[ie],pe=E(de);typeof de=="number"||typeof de=="boolean"?(W.__data[0]=de,t.bufferSubData(t.UNIFORM_BUFFER,J+Z,W.__data)):de.isMatrix3?(W.__data[0]=de.elements[0],W.__data[1]=de.elements[1],W.__data[2]=de.elements[2],W.__data[3]=0,W.__data[4]=de.elements[3],W.__data[5]=de.elements[4],W.__data[6]=de.elements[5],W.__data[7]=0,W.__data[8]=de.elements[6],W.__data[9]=de.elements[7],W.__data[10]=de.elements[8],W.__data[11]=0):(de.toArray(W.__data,Z),Z+=pe.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,J,W.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function y(x,w,C,T){const M=x.value,A=w+"_"+C;if(T[A]===void 0)return typeof M=="number"||typeof M=="boolean"?T[A]=M:T[A]=M.clone(),!0;{const F=T[A];if(typeof M=="number"||typeof M=="boolean"){if(F!==M)return T[A]=M,!0}else if(F.equals(M)===!1)return F.copy(M),!0}return!1}function S(x){const w=x.uniforms;let C=0;const T=16;for(let A=0,F=w.length;A<F;A++){const I=Array.isArray(w[A])?w[A]:[w[A]];for(let O=0,W=I.length;O<W;O++){const J=I[O],ae=Array.isArray(J.value)?J.value:[J.value];for(let Z=0,ie=ae.length;Z<ie;Z++){const de=ae[Z],pe=E(de),K=C%T;K!==0&&T-K<pe.boundary&&(C+=T-K),J.__data=new Float32Array(pe.storage/Float32Array.BYTES_PER_ELEMENT),J.__offset=C,C+=pe.storage}}}const M=C%T;return M>0&&(C+=T-M),x.__size=C,x.__cache={},this}function E(x){const w={boundary:0,storage:0};return typeof x=="number"||typeof x=="boolean"?(w.boundary=4,w.storage=4):x.isVector2?(w.boundary=8,w.storage=8):x.isVector3||x.isColor?(w.boundary=16,w.storage=12):x.isVector4?(w.boundary=16,w.storage=16):x.isMatrix3?(w.boundary=48,w.storage=48):x.isMatrix4?(w.boundary=64,w.storage=64):x.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",x),w}function g(x){const w=x.target;w.removeEventListener("dispose",g);const C=l.indexOf(w.__bindingPointIndex);l.splice(C,1),t.deleteBuffer(i[w.id]),delete i[w.id],delete a[w.id]}function v(){for(const x in i)t.deleteBuffer(i[x]);l=[],i={},a={}}return{bind:u,update:f,dispose:v}}class v1{constructor(e={}){const{canvas:n=xj(),context:r=null,depth:i=!0,stencil:a=!0,alpha:l=!1,antialias:c=!1,premultipliedAlpha:u=!0,preserveDrawingBuffer:f=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:p=!1}=e;this.isWebGLRenderer=!0;let m;r!==null?m=r.getContextAttributes().alpha:m=l;const y=new Uint32Array(4),S=new Int32Array(4);let E=null,g=null;const v=[],x=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=rr,this._useLegacyLights=!1,this.toneMapping=_a,this.toneMappingExposure=1;const w=this;let C=!1,T=0,M=0,A=null,F=-1,I=null;const O=new sr,W=new sr;let J=null;const ae=new It(0);let Z=0,ie=n.width,de=n.height,pe=1,K=null,ne=null;const j=new sr(0,0,ie,de),N=new sr(0,0,ie,de);let H=!1;const U=new u1;let P=!1,L=!1,G=null;const Q=new Yn,le=new sn,xe=new Se,Te={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function X(){return A===null?pe:1}let z=r;function ve(B,ue){for(let ye=0;ye<B.length;ye++){const we=B[ye],ge=n.getContext(we,ue);if(ge!==null)return ge}return null}try{const B={alpha:!0,depth:i,stencil:a,antialias:c,premultipliedAlpha:u,preserveDrawingBuffer:f,powerPreference:h,failIfMajorPerformanceCaveat:p};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${$y}`),n.addEventListener("webglcontextlost",Ue,!1),n.addEventListener("webglcontextrestored",re,!1),n.addEventListener("webglcontextcreationerror",$e,!1),z===null){const ue=["webgl2","webgl","experimental-webgl"];if(w.isWebGL1Renderer===!0&&ue.shift(),z=ve(ue,B),z===null)throw ve(ue)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&z instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),z.getShaderPrecisionFormat===void 0&&(z.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(B){throw console.error("THREE.WebGLRenderer: "+B.message),B}let he,be,Re,gt,at,$,D,oe,Me,Ee,Ie,et,ze,Ze,ot,St,Ae,zt,Nt,vt,lt,Qe,wt,Bt;function ln(){he=new U5(z),be=new P5(z,he,e),he.init(be),Qe=new xW(z,he,be),Re=new SW(z,he,be),gt=new $5(z),at=new aW,$=new wW(z,he,Re,at,be,Qe,gt),D=new N5(w),oe=new D5(w),Me=new qj(z,be),wt=new C5(z,he,Me,be),Ee=new F5(z,Me,gt,wt),Ie=new H5(z,Ee,Me,gt),Nt=new j5(z,be,$),St=new I5(at),et=new sW(w,D,oe,he,be,wt,St),ze=new MW(w,at),Ze=new lW,ot=new pW(he,be),zt=new R5(w,D,oe,Re,Ie,m,u),Ae=new yW(w,Ie,be),Bt=new RW(z,gt,be,Re),vt=new A5(z,he,gt,be),lt=new z5(z,he,gt,be),gt.programs=et.programs,w.capabilities=be,w.extensions=he,w.properties=at,w.renderLists=Ze,w.shadowMap=Ae,w.state=Re,w.info=gt}ln();const bt=new TW(w,z);this.xr=bt,this.getContext=function(){return z},this.getContextAttributes=function(){return z.getContextAttributes()},this.forceContextLoss=function(){const B=he.get("WEBGL_lose_context");B&&B.loseContext()},this.forceContextRestore=function(){const B=he.get("WEBGL_lose_context");B&&B.restoreContext()},this.getPixelRatio=function(){return pe},this.setPixelRatio=function(B){B!==void 0&&(pe=B,this.setSize(ie,de,!1))},this.getSize=function(B){return B.set(ie,de)},this.setSize=function(B,ue,ye=!0){if(bt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ie=B,de=ue,n.width=Math.floor(B*pe),n.height=Math.floor(ue*pe),ye===!0&&(n.style.width=B+"px",n.style.height=ue+"px"),this.setViewport(0,0,B,ue)},this.getDrawingBufferSize=function(B){return B.set(ie*pe,de*pe).floor()},this.setDrawingBufferSize=function(B,ue,ye){ie=B,de=ue,pe=ye,n.width=Math.floor(B*ye),n.height=Math.floor(ue*ye),this.setViewport(0,0,B,ue)},this.getCurrentViewport=function(B){return B.copy(O)},this.getViewport=function(B){return B.copy(j)},this.setViewport=function(B,ue,ye,we){B.isVector4?j.set(B.x,B.y,B.z,B.w):j.set(B,ue,ye,we),Re.viewport(O.copy(j).multiplyScalar(pe).floor())},this.getScissor=function(B){return B.copy(N)},this.setScissor=function(B,ue,ye,we){B.isVector4?N.set(B.x,B.y,B.z,B.w):N.set(B,ue,ye,we),Re.scissor(W.copy(N).multiplyScalar(pe).floor())},this.getScissorTest=function(){return H},this.setScissorTest=function(B){Re.setScissorTest(H=B)},this.setOpaqueSort=function(B){K=B},this.setTransparentSort=function(B){ne=B},this.getClearColor=function(B){return B.copy(zt.getClearColor())},this.setClearColor=function(){zt.setClearColor.apply(zt,arguments)},this.getClearAlpha=function(){return zt.getClearAlpha()},this.setClearAlpha=function(){zt.setClearAlpha.apply(zt,arguments)},this.clear=function(B=!0,ue=!0,ye=!0){let we=0;if(B){let ge=!1;if(A!==null){const We=A.texture.format;ge=We===qA||We===WA||We===GA}if(ge){const We=A.texture.type,st=We===va||We===ha||We===By||We===ao||We===jA||We===HA,ft=zt.getClearColor(),Ke=zt.getClearAlpha(),Rt=ft.r,yt=ft.g,xt=ft.b;st?(y[0]=Rt,y[1]=yt,y[2]=xt,y[3]=Ke,z.clearBufferuiv(z.COLOR,0,y)):(S[0]=Rt,S[1]=yt,S[2]=xt,S[3]=Ke,z.clearBufferiv(z.COLOR,0,S))}else we|=z.COLOR_BUFFER_BIT}ue&&(we|=z.DEPTH_BUFFER_BIT),ye&&(we|=z.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),z.clear(we)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",Ue,!1),n.removeEventListener("webglcontextrestored",re,!1),n.removeEventListener("webglcontextcreationerror",$e,!1),Ze.dispose(),ot.dispose(),at.dispose(),D.dispose(),oe.dispose(),Ie.dispose(),wt.dispose(),Bt.dispose(),et.dispose(),bt.dispose(),bt.removeEventListener("sessionstart",Gn),bt.removeEventListener("sessionend",Ht),G&&(G.dispose(),G=null),Un.stop()};function Ue(B){B.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),C=!0}function re(){console.log("THREE.WebGLRenderer: Context Restored."),C=!1;const B=gt.autoReset,ue=Ae.enabled,ye=Ae.autoUpdate,we=Ae.needsUpdate,ge=Ae.type;ln(),gt.autoReset=B,Ae.enabled=ue,Ae.autoUpdate=ye,Ae.needsUpdate=we,Ae.type=ge}function $e(B){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",B.statusMessage)}function Ve(B){const ue=B.target;ue.removeEventListener("dispose",Ve),pt(ue)}function pt(B){ct(B),at.remove(B)}function ct(B){const ue=at.get(B).programs;ue!==void 0&&(ue.forEach(function(ye){et.releaseProgram(ye)}),B.isShaderMaterial&&et.releaseShaderCache(B))}this.renderBufferDirect=function(B,ue,ye,we,ge,We){ue===null&&(ue=Te);const st=ge.isMesh&&ge.matrixWorld.determinant()<0,ft=Fp(B,ue,ye,we,ge);Re.setMaterial(we,st);let Ke=ye.index,Rt=1;if(we.wireframe===!0){if(Ke=Ee.getWireframeAttribute(ye),Ke===void 0)return;Rt=2}const yt=ye.drawRange,xt=ye.attributes.position;let cn=yt.start*Rt,yr=(yt.start+yt.count)*Rt;We!==null&&(cn=Math.max(cn,We.start*Rt),yr=Math.min(yr,(We.start+We.count)*Rt)),Ke!==null?(cn=Math.max(cn,0),yr=Math.min(yr,Ke.count)):xt!=null&&(cn=Math.max(cn,0),yr=Math.min(yr,xt.count));const Pn=yr-cn;if(Pn<0||Pn===1/0)return;wt.setup(ge,we,ft,ye,Ke);let Nr,$t=vt;if(Ke!==null&&(Nr=Me.get(Ke),$t=lt,$t.setIndex(Nr)),ge.isMesh)we.wireframe===!0?(Re.setLineWidth(we.wireframeLinewidth*X()),$t.setMode(z.LINES)):$t.setMode(z.TRIANGLES);else if(ge.isLine){let Ct=we.linewidth;Ct===void 0&&(Ct=1),Re.setLineWidth(Ct*X()),ge.isLineSegments?$t.setMode(z.LINES):ge.isLineLoop?$t.setMode(z.LINE_LOOP):$t.setMode(z.LINE_STRIP)}else ge.isPoints?$t.setMode(z.POINTS):ge.isSprite&&$t.setMode(z.TRIANGLES);if(ge.isBatchedMesh)$t.renderMultiDraw(ge._multiDrawStarts,ge._multiDrawCounts,ge._multiDrawCount);else if(ge.isInstancedMesh)$t.renderInstances(cn,Pn,ge.count);else if(ye.isInstancedBufferGeometry){const Ct=ye._maxInstanceCount!==void 0?ye._maxInstanceCount:1/0,Sr=Math.min(ye.instanceCount,Ct);$t.renderInstances(cn,Pn,Sr)}else $t.render(cn,Pn)};function Yt(B,ue,ye){B.transparent===!0&&B.side===Cs&&B.forceSinglePass===!1?(B.side=ar,B.needsUpdate=!0,Us(B,ue,ye),B.side=wa,B.needsUpdate=!0,Us(B,ue,ye),B.side=Cs):Us(B,ue,ye)}this.compile=function(B,ue,ye=null){ye===null&&(ye=B),g=ot.get(ye),g.init(),x.push(g),ye.traverseVisible(function(ge){ge.isLight&&ge.layers.test(ue.layers)&&(g.pushLight(ge),ge.castShadow&&g.pushShadow(ge))}),B!==ye&&B.traverseVisible(function(ge){ge.isLight&&ge.layers.test(ue.layers)&&(g.pushLight(ge),ge.castShadow&&g.pushShadow(ge))}),g.setupLights(w._useLegacyLights);const we=new Set;return B.traverse(function(ge){const We=ge.material;if(We)if(Array.isArray(We))for(let st=0;st<We.length;st++){const ft=We[st];Yt(ft,ye,ge),we.add(ft)}else Yt(We,ye,ge),we.add(We)}),x.pop(),g=null,we},this.compileAsync=function(B,ue,ye=null){const we=this.compile(B,ue,ye);return new Promise(ge=>{function We(){if(we.forEach(function(st){at.get(st).currentProgram.isReady()&&we.delete(st)}),we.size===0){ge(B);return}setTimeout(We,10)}he.get("KHR_parallel_shader_compile")!==null?We():setTimeout(We,10)})};let Jt=null;function Mn(B){Jt&&Jt(B)}function Gn(){Un.stop()}function Ht(){Un.start()}const Un=new d1;Un.setAnimationLoop(Mn),typeof self<"u"&&Un.setContext(self),this.setAnimationLoop=function(B){Jt=B,bt.setAnimationLoop(B),B===null?Un.stop():Un.start()},bt.addEventListener("sessionstart",Gn),bt.addEventListener("sessionend",Ht),this.render=function(B,ue){if(ue!==void 0&&ue.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(C===!0)return;B.matrixWorldAutoUpdate===!0&&B.updateMatrixWorld(),ue.parent===null&&ue.matrixWorldAutoUpdate===!0&&ue.updateMatrixWorld(),bt.enabled===!0&&bt.isPresenting===!0&&(bt.cameraAutoUpdate===!0&&bt.updateCamera(ue),ue=bt.getCamera()),B.isScene===!0&&B.onBeforeRender(w,B,ue,A),g=ot.get(B,x.length),g.init(),x.push(g),Q.multiplyMatrices(ue.projectionMatrix,ue.matrixWorldInverse),U.setFromProjectionMatrix(Q),L=this.localClippingEnabled,P=St.init(this.clippingPlanes,L),E=Ze.get(B,v.length),E.init(),v.push(E),cr(B,ue,0,w.sortObjects),E.finish(),w.sortObjects===!0&&E.sort(K,ne),this.info.render.frame++,P===!0&&St.beginShadows();const ye=g.state.shadowsArray;if(Ae.render(ye,B,ue),P===!0&&St.endShadows(),this.info.autoReset===!0&&this.info.reset(),zt.render(E,B),g.setupLights(w._useLegacyLights),ue.isArrayCamera){const we=ue.cameras;for(let ge=0,We=we.length;ge<We;ge++){const st=we[ge];Du(E,B,st,st.viewport)}}else Du(E,B,ue);A!==null&&($.updateMultisampleRenderTarget(A),$.updateRenderTargetMipmap(A)),B.isScene===!0&&B.onAfterRender(w,B,ue),wt.resetDefaultState(),F=-1,I=null,x.pop(),x.length>0?g=x[x.length-1]:g=null,v.pop(),v.length>0?E=v[v.length-1]:E=null};function cr(B,ue,ye,we){if(B.visible===!1)return;if(B.layers.test(ue.layers)){if(B.isGroup)ye=B.renderOrder;else if(B.isLOD)B.autoUpdate===!0&&B.update(ue);else if(B.isLight)g.pushLight(B),B.castShadow&&g.pushShadow(B);else if(B.isSprite){if(!B.frustumCulled||U.intersectsSprite(B)){we&&xe.setFromMatrixPosition(B.matrixWorld).applyMatrix4(Q);const st=Ie.update(B),ft=B.material;ft.visible&&E.push(B,st,ft,ye,xe.z,null)}}else if((B.isMesh||B.isLine||B.isPoints)&&(!B.frustumCulled||U.intersectsObject(B))){const st=Ie.update(B),ft=B.material;if(we&&(B.boundingSphere!==void 0?(B.boundingSphere===null&&B.computeBoundingSphere(),xe.copy(B.boundingSphere.center)):(st.boundingSphere===null&&st.computeBoundingSphere(),xe.copy(st.boundingSphere.center)),xe.applyMatrix4(B.matrixWorld).applyMatrix4(Q)),Array.isArray(ft)){const Ke=st.groups;for(let Rt=0,yt=Ke.length;Rt<yt;Rt++){const xt=Ke[Rt],cn=ft[xt.materialIndex];cn&&cn.visible&&E.push(B,st,cn,ye,xe.z,xt)}}else ft.visible&&E.push(B,st,ft,ye,xe.z,null)}}const We=B.children;for(let st=0,ft=We.length;st<ft;st++)cr(We[st],ue,ye,we)}function Du(B,ue,ye,we){const ge=B.opaque,We=B.transmissive,st=B.transparent;g.setupLightsView(ye),P===!0&&St.setGlobalState(w.clippingPlanes,ye),We.length>0&&Ta(ge,We,ue,ye),we&&Re.viewport(O.copy(we)),ge.length>0&&ss(ge,ue,ye),We.length>0&&ss(We,ue,ye),st.length>0&&ss(st,ue,ye),Re.buffers.depth.setTest(!0),Re.buffers.depth.setMask(!0),Re.buffers.color.setMask(!0),Re.setPolygonOffset(!1)}function Ta(B,ue,ye,we){if((ye.isScene===!0?ye.overrideMaterial:null)!==null)return;const We=be.isWebGL2;G===null&&(G=new po(1,1,{generateMipmaps:!0,type:he.has("EXT_color_buffer_half_float")?yu:va,minFilter:vu,samples:We?4:0})),w.getDrawingBufferSize(le),We?G.setSize(le.x,le.y):G.setSize(Bv(le.x),Bv(le.y));const st=w.getRenderTarget();w.setRenderTarget(G),w.getClearColor(ae),Z=w.getClearAlpha(),Z<1&&w.setClearColor(16777215,.5),w.clear();const ft=w.toneMapping;w.toneMapping=_a,ss(B,ye,we),$.updateMultisampleRenderTarget(G),$.updateRenderTargetMipmap(G);let Ke=!1;for(let Rt=0,yt=ue.length;Rt<yt;Rt++){const xt=ue[Rt],cn=xt.object,yr=xt.geometry,Pn=xt.material,Nr=xt.group;if(Pn.side===Cs&&cn.layers.test(we.layers)){const $t=Pn.side;Pn.side=ar,Pn.needsUpdate=!0,Ma(cn,ye,we,yr,Pn,Nr),Pn.side=$t,Pn.needsUpdate=!0,Ke=!0}}Ke===!0&&($.updateMultisampleRenderTarget(G),$.updateRenderTargetMipmap(G)),w.setRenderTarget(st),w.setClearColor(ae,Z),w.toneMapping=ft}function ss(B,ue,ye){const we=ue.isScene===!0?ue.overrideMaterial:null;for(let ge=0,We=B.length;ge<We;ge++){const st=B[ge],ft=st.object,Ke=st.geometry,Rt=we===null?st.material:we,yt=st.group;ft.layers.test(ye.layers)&&Ma(ft,ue,ye,Ke,Rt,yt)}}function Ma(B,ue,ye,we,ge,We){B.onBeforeRender(w,ue,ye,we,ge,We),B.modelViewMatrix.multiplyMatrices(ye.matrixWorldInverse,B.matrixWorld),B.normalMatrix.getNormalMatrix(B.modelViewMatrix),ge.onBeforeRender(w,ue,ye,we,B,We),ge.transparent===!0&&ge.side===Cs&&ge.forceSinglePass===!1?(ge.side=ar,ge.needsUpdate=!0,w.renderBufferDirect(ye,ue,we,ge,B,We),ge.side=wa,ge.needsUpdate=!0,w.renderBufferDirect(ye,ue,we,ge,B,We),ge.side=Cs):w.renderBufferDirect(ye,ue,we,ge,B,We),B.onAfterRender(w,ue,ye,we,ge,We)}function Us(B,ue,ye){ue.isScene!==!0&&(ue=Te);const we=at.get(B),ge=g.state.lights,We=g.state.shadowsArray,st=ge.state.version,ft=et.getParameters(B,ge.state,We,ue,ye),Ke=et.getProgramCacheKey(ft);let Rt=we.programs;we.environment=B.isMeshStandardMaterial?ue.environment:null,we.fog=ue.fog,we.envMap=(B.isMeshStandardMaterial?oe:D).get(B.envMap||we.environment),Rt===void 0&&(B.addEventListener("dispose",Ve),Rt=new Map,we.programs=Rt);let yt=Rt.get(Ke);if(yt!==void 0){if(we.currentProgram===yt&&we.lightsStateVersion===st)return Fu(B,ft),yt}else ft.uniforms=et.getUniforms(B),B.onBuild(ye,ft,w),B.onBeforeCompile(ft,w),yt=et.acquireProgram(ft,Ke),Rt.set(Ke,yt),we.uniforms=ft.uniforms;const xt=we.uniforms;return(!B.isShaderMaterial&&!B.isRawShaderMaterial||B.clipping===!0)&&(xt.clippingPlanes=St.uniform),Fu(B,ft),we.needsLights=zu(B),we.lightsStateVersion=st,we.needsLights&&(xt.ambientLightColor.value=ge.state.ambient,xt.lightProbe.value=ge.state.probe,xt.directionalLights.value=ge.state.directional,xt.directionalLightShadows.value=ge.state.directionalShadow,xt.spotLights.value=ge.state.spot,xt.spotLightShadows.value=ge.state.spotShadow,xt.rectAreaLights.value=ge.state.rectArea,xt.ltc_1.value=ge.state.rectAreaLTC1,xt.ltc_2.value=ge.state.rectAreaLTC2,xt.pointLights.value=ge.state.point,xt.pointLightShadows.value=ge.state.pointShadow,xt.hemisphereLights.value=ge.state.hemi,xt.directionalShadowMap.value=ge.state.directionalShadowMap,xt.directionalShadowMatrix.value=ge.state.directionalShadowMatrix,xt.spotShadowMap.value=ge.state.spotShadowMap,xt.spotLightMatrix.value=ge.state.spotLightMatrix,xt.spotLightMap.value=ge.state.spotLightMap,xt.pointShadowMap.value=ge.state.pointShadowMap,xt.pointShadowMatrix.value=ge.state.pointShadowMatrix),we.currentProgram=yt,we.uniformsList=null,yt}function Uu(B){if(B.uniformsList===null){const ue=B.currentProgram.getUniforms();B.uniformsList=xh.seqWithValue(ue.seq,B.uniforms)}return B.uniformsList}function Fu(B,ue){const ye=at.get(B);ye.outputColorSpace=ue.outputColorSpace,ye.batching=ue.batching,ye.instancing=ue.instancing,ye.instancingColor=ue.instancingColor,ye.skinning=ue.skinning,ye.morphTargets=ue.morphTargets,ye.morphNormals=ue.morphNormals,ye.morphColors=ue.morphColors,ye.morphTargetsCount=ue.morphTargetsCount,ye.numClippingPlanes=ue.numClippingPlanes,ye.numIntersection=ue.numClipIntersection,ye.vertexAlphas=ue.vertexAlphas,ye.vertexTangents=ue.vertexTangents,ye.toneMapping=ue.toneMapping}function Fp(B,ue,ye,we,ge){ue.isScene!==!0&&(ue=Te),$.resetTextureUnits();const We=ue.fog,st=we.isMeshStandardMaterial?ue.environment:null,ft=A===null?w.outputColorSpace:A.isXRRenderTarget===!0?A.texture.colorSpace:Os,Ke=(we.isMeshStandardMaterial?oe:D).get(we.envMap||st),Rt=we.vertexColors===!0&&!!ye.attributes.color&&ye.attributes.color.itemSize===4,yt=!!ye.attributes.tangent&&(!!we.normalMap||we.anisotropy>0),xt=!!ye.morphAttributes.position,cn=!!ye.morphAttributes.normal,yr=!!ye.morphAttributes.color;let Pn=_a;we.toneMapped&&(A===null||A.isXRRenderTarget===!0)&&(Pn=w.toneMapping);const Nr=ye.morphAttributes.position||ye.morphAttributes.normal||ye.morphAttributes.color,$t=Nr!==void 0?Nr.length:0,Ct=at.get(we),Sr=g.state.lights;if(P===!0&&(L===!0||B!==I)){const kr=B===I&&we.id===F;St.setState(we,B,kr)}let _n=!1;we.version===Ct.__version?(Ct.needsLights&&Ct.lightsStateVersion!==Sr.state.version||Ct.outputColorSpace!==ft||ge.isBatchedMesh&&Ct.batching===!1||!ge.isBatchedMesh&&Ct.batching===!0||ge.isInstancedMesh&&Ct.instancing===!1||!ge.isInstancedMesh&&Ct.instancing===!0||ge.isSkinnedMesh&&Ct.skinning===!1||!ge.isSkinnedMesh&&Ct.skinning===!0||ge.isInstancedMesh&&Ct.instancingColor===!0&&ge.instanceColor===null||ge.isInstancedMesh&&Ct.instancingColor===!1&&ge.instanceColor!==null||Ct.envMap!==Ke||we.fog===!0&&Ct.fog!==We||Ct.numClippingPlanes!==void 0&&(Ct.numClippingPlanes!==St.numPlanes||Ct.numIntersection!==St.numIntersection)||Ct.vertexAlphas!==Rt||Ct.vertexTangents!==yt||Ct.morphTargets!==xt||Ct.morphNormals!==cn||Ct.morphColors!==yr||Ct.toneMapping!==Pn||be.isWebGL2===!0&&Ct.morphTargetsCount!==$t)&&(_n=!0):(_n=!0,Ct.__version=we.version);let os=Ct.currentProgram;_n===!0&&(os=Us(we,ue,ge));let $u=!1,Wi=!1,Fs=!1;const Rn=os.getUniforms(),si=Ct.uniforms;if(Re.useProgram(os.program)&&($u=!0,Wi=!0,Fs=!0),we.id!==F&&(F=we.id,Wi=!0),$u||I!==B){Rn.setValue(z,"projectionMatrix",B.projectionMatrix),Rn.setValue(z,"viewMatrix",B.matrixWorldInverse);const kr=Rn.map.cameraPosition;kr!==void 0&&kr.setValue(z,xe.setFromMatrixPosition(B.matrixWorld)),be.logarithmicDepthBuffer&&Rn.setValue(z,"logDepthBufFC",2/(Math.log(B.far+1)/Math.LN2)),(we.isMeshPhongMaterial||we.isMeshToonMaterial||we.isMeshLambertMaterial||we.isMeshBasicMaterial||we.isMeshStandardMaterial||we.isShaderMaterial)&&Rn.setValue(z,"isOrthographic",B.isOrthographicCamera===!0),I!==B&&(I=B,Wi=!0,Fs=!0)}if(ge.isSkinnedMesh){Rn.setOptional(z,ge,"bindMatrix"),Rn.setOptional(z,ge,"bindMatrixInverse");const kr=ge.skeleton;kr&&(be.floatVertexTextures?(kr.boneTexture===null&&kr.computeBoneTexture(),Rn.setValue(z,"boneTexture",kr.boneTexture,$)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}ge.isBatchedMesh&&(Rn.setOptional(z,ge,"batchingTexture"),Rn.setValue(z,"batchingTexture",ge._matricesTexture,$));const Xl=ye.morphAttributes;if((Xl.position!==void 0||Xl.normal!==void 0||Xl.color!==void 0&&be.isWebGL2===!0)&&Nt.update(ge,ye,os),(Wi||Ct.receiveShadow!==ge.receiveShadow)&&(Ct.receiveShadow=ge.receiveShadow,Rn.setValue(z,"receiveShadow",ge.receiveShadow)),we.isMeshGouraudMaterial&&we.envMap!==null&&(si.envMap.value=Ke,si.flipEnvMap.value=Ke.isCubeTexture&&Ke.isRenderTargetTexture===!1?-1:1),Wi&&(Rn.setValue(z,"toneMappingExposure",w.toneMappingExposure),Ct.needsLights&&as(si,Fs),We&&we.fog===!0&&ze.refreshFogUniforms(si,We),ze.refreshMaterialUniforms(si,we,pe,de,G),xh.upload(z,Uu(Ct),si,$)),we.isShaderMaterial&&we.uniformsNeedUpdate===!0&&(xh.upload(z,Uu(Ct),si,$),we.uniformsNeedUpdate=!1),we.isSpriteMaterial&&Rn.setValue(z,"center",ge.center),Rn.setValue(z,"modelViewMatrix",ge.modelViewMatrix),Rn.setValue(z,"normalMatrix",ge.normalMatrix),Rn.setValue(z,"modelMatrix",ge.matrixWorld),we.isShaderMaterial||we.isRawShaderMaterial){const kr=we.uniformsGroups;for(let Ra=0,Bu=kr.length;Ra<Bu;Ra++)if(be.isWebGL2){const wo=kr[Ra];Bt.update(wo,os),Bt.bind(wo,os)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return os}function as(B,ue){B.ambientLightColor.needsUpdate=ue,B.lightProbe.needsUpdate=ue,B.directionalLights.needsUpdate=ue,B.directionalLightShadows.needsUpdate=ue,B.pointLights.needsUpdate=ue,B.pointLightShadows.needsUpdate=ue,B.spotLights.needsUpdate=ue,B.spotLightShadows.needsUpdate=ue,B.rectAreaLights.needsUpdate=ue,B.hemisphereLights.needsUpdate=ue}function zu(B){return B.isMeshLambertMaterial||B.isMeshToonMaterial||B.isMeshPhongMaterial||B.isMeshStandardMaterial||B.isShadowMaterial||B.isShaderMaterial&&B.lights===!0}this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return M},this.getRenderTarget=function(){return A},this.setRenderTargetTextures=function(B,ue,ye){at.get(B.texture).__webglTexture=ue,at.get(B.depthTexture).__webglTexture=ye;const we=at.get(B);we.__hasExternalTextures=!0,we.__hasExternalTextures&&(we.__autoAllocateDepthBuffer=ye===void 0,we.__autoAllocateDepthBuffer||he.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),we.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(B,ue){const ye=at.get(B);ye.__webglFramebuffer=ue,ye.__useDefaultFramebuffer=ue===void 0},this.setRenderTarget=function(B,ue=0,ye=0){A=B,T=ue,M=ye;let we=!0,ge=null,We=!1,st=!1;if(B){const Ke=at.get(B);Ke.__useDefaultFramebuffer!==void 0?(Re.bindFramebuffer(z.FRAMEBUFFER,null),we=!1):Ke.__webglFramebuffer===void 0?$.setupRenderTarget(B):Ke.__hasExternalTextures&&$.rebindTextures(B,at.get(B.texture).__webglTexture,at.get(B.depthTexture).__webglTexture);const Rt=B.texture;(Rt.isData3DTexture||Rt.isDataArrayTexture||Rt.isCompressedArrayTexture)&&(st=!0);const yt=at.get(B).__webglFramebuffer;B.isWebGLCubeRenderTarget?(Array.isArray(yt[ue])?ge=yt[ue][ye]:ge=yt[ue],We=!0):be.isWebGL2&&B.samples>0&&$.useMultisampledRTT(B)===!1?ge=at.get(B).__webglMultisampledFramebuffer:Array.isArray(yt)?ge=yt[ye]:ge=yt,O.copy(B.viewport),W.copy(B.scissor),J=B.scissorTest}else O.copy(j).multiplyScalar(pe).floor(),W.copy(N).multiplyScalar(pe).floor(),J=H;if(Re.bindFramebuffer(z.FRAMEBUFFER,ge)&&be.drawBuffers&&we&&Re.drawBuffers(B,ge),Re.viewport(O),Re.scissor(W),Re.setScissorTest(J),We){const Ke=at.get(B.texture);z.framebufferTexture2D(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,z.TEXTURE_CUBE_MAP_POSITIVE_X+ue,Ke.__webglTexture,ye)}else if(st){const Ke=at.get(B.texture),Rt=ue||0;z.framebufferTextureLayer(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,Ke.__webglTexture,ye||0,Rt)}F=-1},this.readRenderTargetPixels=function(B,ue,ye,we,ge,We,st){if(!(B&&B.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ft=at.get(B).__webglFramebuffer;if(B.isWebGLCubeRenderTarget&&st!==void 0&&(ft=ft[st]),ft){Re.bindFramebuffer(z.FRAMEBUFFER,ft);try{const Ke=B.texture,Rt=Ke.format,yt=Ke.type;if(Rt!==Vi&&Qe.convert(Rt)!==z.getParameter(z.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const xt=yt===yu&&(he.has("EXT_color_buffer_half_float")||be.isWebGL2&&he.has("EXT_color_buffer_float"));if(yt!==va&&Qe.convert(yt)!==z.getParameter(z.IMPLEMENTATION_COLOR_READ_TYPE)&&!(yt===pa&&(be.isWebGL2||he.has("OES_texture_float")||he.has("WEBGL_color_buffer_float")))&&!xt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ue>=0&&ue<=B.width-we&&ye>=0&&ye<=B.height-ge&&z.readPixels(ue,ye,we,ge,Qe.convert(Rt),Qe.convert(yt),We)}finally{const Ke=A!==null?at.get(A).__webglFramebuffer:null;Re.bindFramebuffer(z.FRAMEBUFFER,Ke)}}},this.copyFramebufferToTexture=function(B,ue,ye=0){const we=Math.pow(2,-ye),ge=Math.floor(ue.image.width*we),We=Math.floor(ue.image.height*we);$.setTexture2D(ue,0),z.copyTexSubImage2D(z.TEXTURE_2D,ye,0,0,B.x,B.y,ge,We),Re.unbindTexture()},this.copyTextureToTexture=function(B,ue,ye,we=0){const ge=ue.image.width,We=ue.image.height,st=Qe.convert(ye.format),ft=Qe.convert(ye.type);$.setTexture2D(ye,0),z.pixelStorei(z.UNPACK_FLIP_Y_WEBGL,ye.flipY),z.pixelStorei(z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ye.premultiplyAlpha),z.pixelStorei(z.UNPACK_ALIGNMENT,ye.unpackAlignment),ue.isDataTexture?z.texSubImage2D(z.TEXTURE_2D,we,B.x,B.y,ge,We,st,ft,ue.image.data):ue.isCompressedTexture?z.compressedTexSubImage2D(z.TEXTURE_2D,we,B.x,B.y,ue.mipmaps[0].width,ue.mipmaps[0].height,st,ue.mipmaps[0].data):z.texSubImage2D(z.TEXTURE_2D,we,B.x,B.y,st,ft,ue.image),we===0&&ye.generateMipmaps&&z.generateMipmap(z.TEXTURE_2D),Re.unbindTexture()},this.copyTextureToTexture3D=function(B,ue,ye,we,ge=0){if(w.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const We=B.max.x-B.min.x+1,st=B.max.y-B.min.y+1,ft=B.max.z-B.min.z+1,Ke=Qe.convert(we.format),Rt=Qe.convert(we.type);let yt;if(we.isData3DTexture)$.setTexture3D(we,0),yt=z.TEXTURE_3D;else if(we.isDataArrayTexture||we.isCompressedArrayTexture)$.setTexture2DArray(we,0),yt=z.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}z.pixelStorei(z.UNPACK_FLIP_Y_WEBGL,we.flipY),z.pixelStorei(z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,we.premultiplyAlpha),z.pixelStorei(z.UNPACK_ALIGNMENT,we.unpackAlignment);const xt=z.getParameter(z.UNPACK_ROW_LENGTH),cn=z.getParameter(z.UNPACK_IMAGE_HEIGHT),yr=z.getParameter(z.UNPACK_SKIP_PIXELS),Pn=z.getParameter(z.UNPACK_SKIP_ROWS),Nr=z.getParameter(z.UNPACK_SKIP_IMAGES),$t=ye.isCompressedTexture?ye.mipmaps[ge]:ye.image;z.pixelStorei(z.UNPACK_ROW_LENGTH,$t.width),z.pixelStorei(z.UNPACK_IMAGE_HEIGHT,$t.height),z.pixelStorei(z.UNPACK_SKIP_PIXELS,B.min.x),z.pixelStorei(z.UNPACK_SKIP_ROWS,B.min.y),z.pixelStorei(z.UNPACK_SKIP_IMAGES,B.min.z),ye.isDataTexture||ye.isData3DTexture?z.texSubImage3D(yt,ge,ue.x,ue.y,ue.z,We,st,ft,Ke,Rt,$t.data):ye.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),z.compressedTexSubImage3D(yt,ge,ue.x,ue.y,ue.z,We,st,ft,Ke,$t.data)):z.texSubImage3D(yt,ge,ue.x,ue.y,ue.z,We,st,ft,Ke,Rt,$t),z.pixelStorei(z.UNPACK_ROW_LENGTH,xt),z.pixelStorei(z.UNPACK_IMAGE_HEIGHT,cn),z.pixelStorei(z.UNPACK_SKIP_PIXELS,yr),z.pixelStorei(z.UNPACK_SKIP_ROWS,Pn),z.pixelStorei(z.UNPACK_SKIP_IMAGES,Nr),ge===0&&we.generateMipmaps&&z.generateMipmap(yt),Re.unbindTexture()},this.initTexture=function(B){B.isCubeTexture?$.setTextureCube(B,0):B.isData3DTexture?$.setTexture3D(B,0):B.isDataArrayTexture||B.isCompressedArrayTexture?$.setTexture2DArray(B,0):$.setTexture2D(B,0),Re.unbindTexture()},this.resetState=function(){T=0,M=0,A=null,Re.reset(),wt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return As}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=e===Vy?"display-p3":"srgb",n.unpackColorSpace=on.workingColorSpace===kp?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===rr?lo:XA}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===lo?rr:Os}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class CW extends v1{}CW.prototype.isWebGL1Renderer=!0;class AW extends Ar{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n}}class y1 extends ql{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new It(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const NT=new Yn,jv=new n1,ch=new Lp,uh=new Se;class PW extends Ar{constructor(e=new is,n=new y1){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,n){const r=this.geometry,i=this.matrixWorld,a=e.params.Points.threshold,l=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),ch.copy(r.boundingSphere),ch.applyMatrix4(i),ch.radius+=a,e.ray.intersectsSphere(ch)===!1)return;NT.copy(i).invert(),jv.copy(e.ray).applyMatrix4(NT);const c=a/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,f=r.index,p=r.attributes.position;if(f!==null){const m=Math.max(0,l.start),y=Math.min(f.count,l.start+l.count);for(let S=m,E=y;S<E;S++){const g=f.getX(S);uh.fromBufferAttribute(p,g),kT(uh,g,u,i,e,n,this)}}else{const m=Math.max(0,l.start),y=Math.min(p.count,l.start+l.count);for(let S=m,E=y;S<E;S++)uh.fromBufferAttribute(p,S),kT(uh,S,u,i,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,l=i.length;a<l;a++){const c=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=a}}}}}function kT(t,e,n,r,i,a,l){const c=jv.distanceSqToPoint(t);if(c<n){const u=new Se;jv.closestPointToPoint(t,u),u.applyMatrix4(r);const f=i.ray.origin.distanceTo(u);if(f<i.near||f>i.far)return;a.push({distance:f,distanceToRay:Math.sqrt(c),point:u,index:e,face:null,object:l})}}class Rs extends is{constructor(e=1,n=32,r=16,i=0,a=Math.PI*2,l=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:r,phiStart:i,phiLength:a,thetaStart:l,thetaLength:c},n=Math.max(3,Math.floor(n)),r=Math.max(2,Math.floor(r));const u=Math.min(l+c,Math.PI);let f=0;const h=[],p=new Se,m=new Se,y=[],S=[],E=[],g=[];for(let v=0;v<=r;v++){const x=[],w=v/r;let C=0;v===0&&l===0?C=.5/n:v===r&&u===Math.PI&&(C=-.5/n);for(let T=0;T<=n;T++){const M=T/n;p.x=-e*Math.cos(i+M*a)*Math.sin(l+w*c),p.y=e*Math.cos(l+w*c),p.z=e*Math.sin(i+M*a)*Math.sin(l+w*c),S.push(p.x,p.y,p.z),m.copy(p).normalize(),E.push(m.x,m.y,m.z),g.push(M+C,1-w),x.push(f++)}h.push(x)}for(let v=0;v<r;v++)for(let x=0;x<n;x++){const w=h[v][x+1],C=h[v][x],T=h[v+1][x],M=h[v+1][x+1];(v!==0||l>0)&&y.push(w,C,M),(v!==r-1||u<Math.PI)&&y.push(C,T,M)}this.setIndex(y),this.setAttribute("position",new Qi(S,3)),this.setAttribute("normal",new Qi(E,3)),this.setAttribute("uv",new Qi(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rs(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class R_ extends ql{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new It(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new It(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=KA,this.normalScale=new sn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class IW extends Ar{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new It(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}}class NW extends IW{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class kW{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=LT(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=LT();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function LT(){return(typeof performance>"u"?Date:performance).now()}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:$y}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=$y);const S1=rs(["tech","health","finance","news","entertainment"]).describe("Category of the trending topic"),w1=Pt({id:it().describe("Unique identifier for the hotspot"),lat:fn().min(-90).max(90).describe("Latitude coordinate (-90 to 90)"),lng:fn().min(-180).max(180).describe("Longitude coordinate (-180 to 180)"),intensity:fn().min(0).max(1).describe("Trend intensity (0 = weak, 1 = strongest)"),category:S1.describe("Category of the trending topic")}),LW={tech:"#00d9ff",health:"#00ff88",finance:"#b366ff",news:"#ffb347",entertainment:"#ff66cc"};function Kc(t){return LW[t]}function OW(t,e,n){const r=(90-t)*(Math.PI/180),i=(e+180)*(Math.PI/180),a=-(n*Math.sin(r)*Math.cos(i)),l=n*Math.cos(r),c=n*Math.sin(r)*Math.sin(i);return{x:a,y:l,z:c}}Pt({radius:fn().min(50).max(500).describe("Sphere radius in pixels"),color:it().describe("Globe color (hex format, e.g. #4a9eff)"),opacity:fn().min(0).max(1).describe("Globe opacity (0 = transparent, 1 = opaque)"),wireframe:so().describe("Render as wireframe or solid"),rotationSpeed:fn().min(0).max(.01).describe("Rotation speed in radians per frame"),rotationEnabled:so().describe("Enable/disable automatic rotation"),interactionEnabled:so().describe("Allow user to interact with globe"),resumeDelayMs:fn().min(0).max(1e4).describe("Delay before resuming auto-rotation"),hotspots:ji(w1).describe("Trend hotspots to display"),onInteractionStart:du().args().returns(uu()).optional(),onInteractionEnd:du().args().returns(uu()).optional(),hoveredCategory:it().optional().describe("Currently hovered category for highlighting")});function DW({radius:t,color:e,opacity:n,wireframe:r,rotationSpeed:i,rotationEnabled:a,interactionEnabled:l,hotspots:c,onInteractionStart:u,onInteractionEnd:f,hoveredCategory:h}){const p=V.useRef(null),m=V.useRef(null),y=V.useRef(null),S=V.useRef({isDragging:!1,previousMousePosition:{x:0,y:0},currentRotation:{x:0,y:0}});V.useEffect(()=>{if(!p.current)return;const w=p.current,C=w.clientWidth,T=w.clientHeight,M=new AW;M.background=new It(329744);const A=new gi(45,C/T,.1,2e3);A.position.z=t*3;const F=new v1({alpha:!1,antialias:!0,powerPreference:"high-performance"});F.setSize(C,T),F.setPixelRatio(Math.min(window.devicePixelRatio,2)),w.appendChild(F.domElement);const I=new NW(4210752,.3);M.add(I);const O=new is,W=2e3,J=new Float32Array(W*3),ae=new Float32Array(W*3);for(let L=0;L<W;L++){const G=Math.random()*Math.PI*2,Q=Math.random()*Math.PI,le=t*4+Math.random()*t*2;J[L*3]=le*Math.sin(Q)*Math.cos(G),J[L*3+1]=le*Math.sin(Q)*Math.sin(G),J[L*3+2]=le*Math.cos(Q);const xe=.8+Math.random()*.2;ae[L*3]=xe*.9,ae[L*3+1]=xe*.95,ae[L*3+2]=xe}O.setAttribute("position",new Si(J,3)),O.setAttribute("color",new Si(ae,3));const Z=new y1({size:1.5,vertexColors:!0,transparent:!0,opacity:.6,sizeAttenuation:!0}),ie=new PW(O,Z);M.add(ie);const de=new Rs(t,32,32),pe=new to({color:new It(e),transparent:!0,opacity:.25,wireframe:r}),K=new _r(de,pe);M.add(K);const ne=new Rs(t*1.01,32,32),j=new to({color:new It(e),transparent:!0,opacity:.1,wireframe:!0,side:ar}),N=new _r(ne,j);K.add(N);const H=new Xc;K.add(H);const U=new kW;m.current={scene:M,camera:A,renderer:F,sphere:K,hotspotsGroup:H,stars:ie,clock:U},F.render(M,A);const P=()=>{if(!p.current||!m.current)return;const L=p.current.clientWidth,G=p.current.clientHeight;m.current.camera.aspect=L/G,m.current.camera.updateProjectionMatrix(),m.current.renderer.setSize(L,G)};return window.addEventListener("resize",P),()=>{window.removeEventListener("resize",P),y.current!==null&&(cancelAnimationFrame(y.current),y.current=null),m.current&&(O.dispose(),Z.dispose(),de.dispose(),pe.dispose(),ne.dispose(),j.dispose(),m.current.renderer.dispose(),m.current.scene.clear(),w.contains(m.current.renderer.domElement)&&w.removeChild(m.current.renderer.domElement))}},[]),V.useEffect(()=>{if(!m.current)return;const{hotspotsGroup:w,renderer:C,scene:T,camera:M}=m.current;for(;w.children.length>0;){const A=w.children[0];w.remove(A),A instanceof _r&&(A.geometry.dispose(),Array.isArray(A.material)?A.material.forEach(F=>F.dispose()):A.material.dispose())}c.forEach(A=>{const F=OW(A.lat,A.lng,t),I=Kc(A.category),O=2,J=O+A.intensity*(8-O),ae=new Rs(J,16,16),Z=new R_({color:new It(I),emissive:new It(I),emissiveIntensity:A.intensity*.8,transparent:!0,opacity:.95}),ie=new _r(ae,Z);ie.position.set(F.x,F.y,F.z),ie.userData={hotspotId:A.id,category:A.category,intensity:A.intensity,baseSize:J,pulsePhase:Math.random()*Math.PI*2,floatPhase:Math.random()*Math.PI*2};const de=J*1.5,pe=new Rs(de,12,12),K=new to({color:new It(I),transparent:!0,opacity:.3*A.intensity,side:ar}),ne=new _r(pe,K);ne.position.copy(ie.position);const j=J*2,N=new Rs(j,12,12),H=new to({color:new It(I),transparent:!0,opacity:.15*A.intensity,side:ar}),U=new _r(N,H);U.position.copy(ie.position),w.add(U),w.add(ne),w.add(ie)}),(!a||i===0)&&C.render(T,M)},[c,t,a,i]),V.useEffect(()=>{if(!m.current)return;const{sphere:w,renderer:C,scene:T,camera:M,hotspotsGroup:A,stars:F,clock:I}=m.current;if(y.current!==null&&(cancelAnimationFrame(y.current),y.current=null),!a||i===0){C.render(T,M);return}const O=()=>{const W=I.getElapsedTime();S.current.isDragging||(w.rotation.y+=i),F&&(F.rotation.y=W*.01),A.children.forEach(J=>{if(J instanceof _r&&J.userData.hotspotId){const{intensity:ae,pulsePhase:Z,floatPhase:ie}=J.userData;if(ae>.6){const U=1+Math.sin(W*2+Z)*.15;if(J.scale.setScalar(U),J.material instanceof R_){const P=ae*.6+Math.sin(W*2+Z)*.2;J.material.emissiveIntensity=Math.max(.4,P)}}const K=Math.sin(W*1+ie)*.3,ne=J.position.clone().normalize(),j=J.position.clone().add(ne.multiplyScalar(K));J.position.copy(j)}}),C.render(T,M),y.current=requestAnimationFrame(O)};return O(),()=>{y.current!==null&&(cancelAnimationFrame(y.current),y.current=null)}},[i,a]),V.useEffect(()=>{if(!m.current)return;const{sphere:w,renderer:C,scene:T,camera:M}=m.current;w.geometry instanceof Rs&&w.geometry.parameters.radius!==t&&(w.geometry.dispose(),w.geometry=new Rs(t,32,32),M.position.z=t*3),w.material instanceof to&&(w.material.color=new It(e),w.material.opacity=Math.min(n,.3),w.material.transparent=!0,w.material.wireframe=r),(!a||i===0)&&C.render(T,M)},[t,e,n,r,a,i]),V.useEffect(()=>{if(!m.current)return;const{hotspotsGroup:w,renderer:C,scene:T,camera:M}=m.current;w.children.forEach(A=>{if(A instanceof _r&&A.userData.category){const F=h===A.userData.category,I=h&&h!==A.userData.category;A.material instanceof R_&&(F?(A.material.emissiveIntensity=A.userData.intensity*1.2,A.scale.setScalar(1.2)):I?(A.material.emissiveIntensity=A.userData.intensity*.3,A.material.opacity=.4):(A.material.emissiveIntensity=A.userData.intensity*.8,A.material.opacity=.95,A.scale.setScalar(1)))}}),(!a||i===0)&&C.render(T,M)},[h,a,i]);const E=V.useCallback(w=>{!l||!m.current||(S.current.isDragging=!0,S.current.previousMousePosition={x:w.clientX,y:w.clientY},u?.(),w.currentTarget.setPointerCapture(w.pointerId))},[l,u]),g=V.useCallback(w=>{if(!l||!m.current||!S.current.isDragging)return;const{sphere:C,renderer:T,scene:M,camera:A}=m.current,{previousMousePosition:F}=S.current,I=w.clientX-F.x,O=w.clientY-F.y,W=.005;C.rotation.y+=I*W,C.rotation.x+=O*W;const J=Math.PI/2;C.rotation.x=Math.max(-J,Math.min(J,C.rotation.x)),S.current.previousMousePosition={x:w.clientX,y:w.clientY},S.current.currentRotation={x:C.rotation.x,y:C.rotation.y},T.render(M,A)},[l]),v=V.useCallback(w=>{!l||!S.current.isDragging||(S.current.isDragging=!1,w.currentTarget.releasePointerCapture(w.pointerId),f?.())},[l,f]),x=V.useCallback(()=>{!l||!S.current.isDragging||(S.current.isDragging=!1,f?.())},[l,f]);return q.jsx("div",{ref:p,className:"globe-container",style:{width:"100%",height:"100%",minHeight:"600px",display:"flex",alignItems:"center",justifyContent:"center",cursor:l?S.current.isDragging?"grabbing":"grab":"default",touchAction:"none"},onPointerDown:E,onPointerMove:g,onPointerUp:v,onPointerLeave:x})}const x1=Pt({radius:fn().min(50).max(500).describe("Sphere radius in pixels"),color:it().describe("Globe color (hex format, e.g. #4a9eff)"),opacity:fn().min(0).max(1).describe("Globe opacity"),wireframe:so().describe("Render as wireframe or solid"),autoRotationSpeed:fn().min(0).max(.01).describe("Auto-rotation speed"),enableInteraction:so().describe("Allow user interaction"),resumeDelayMs:fn().min(0).max(1e4).describe("Delay before resuming auto-rotation"),hotspots:ji(w1).describe("Trend hotspots to display"),hoveredCategory:it().optional().describe("Currently hovered category")});function E1({radius:t,color:e,opacity:n,wireframe:r,autoRotationSpeed:i,enableInteraction:a,resumeDelayMs:l,hotspots:c,hoveredCategory:u}){const[f,h]=V.useState(!0),p=V.useRef(null);V.useEffect(()=>()=>{p.current!==null&&clearTimeout(p.current)},[]);const m=V.useCallback(()=>{p.current!==null&&(clearTimeout(p.current),p.current=null),h(!1)},[]),y=V.useCallback(()=>{p.current!==null&&clearTimeout(p.current),p.current=window.setTimeout(()=>{h(!0),p.current=null},l)},[l]);return q.jsx(DW,{radius:t,color:e,opacity:n,wireframe:r,rotationSpeed:i,rotationEnabled:f,interactionEnabled:a,resumeDelayMs:l,hotspots:c,onInteractionStart:m,onInteractionEnd:y,hoveredCategory:u})}const UW=Pt({id:it().describe("Unique identifier"),name:it().describe('Topic name (e.g., "AI Regulation", "Climate Summit")'),category:S1.describe("Category classification"),score:fn().min(0).max(100).describe("Trending score (0-100)"),velocity:rs(["rising","stable","falling"]).describe("Trend direction")}),FW=Pt({platform:rs(["youtube","x","reddit","news"]).describe("Platform identifier"),percentage:fn().min(0).max(100).describe("Percentage of total discussion volume"),count:fn().min(0).describe("Absolute discussion count")}),zW=Pt({platforms:ji(FW).describe("Distribution across platforms"),totalVolume:fn().min(0).describe("Total discussion volume across all platforms"),updatedAt:it().describe("Last update timestamp")}),$W=Pt({timestamp:it().describe("ISO timestamp"),value:fn().describe("Velocity value (-100 to +100, negative = falling, positive = rising)")}),BW=Pt({current:fn().min(-100).max(100).describe("Current velocity (-100 = sharp decline, 0 = stable, +100 = sharp rise)"),direction:rs(["rising","stable","falling"]).describe("Overall direction"),history:ji($W).describe("Historical velocity data for graph"),changePercent:fn().describe("Percent change from previous period")}),VW={youtube:"#FF0000",x:"#1DA1F2",reddit:"#FF4500",news:"#6B46C1"};function OT(t){return VW[t]||"#888888"}const jW={rising:"#00ff88",stable:"#4a9eff",falling:"#ff6b6b"};function dl(t){return jW[t]}const b1=Pt({topics:ji(UW).describe("List of trending topics from Tambo"),title:it().default("Trending Topics").describe("Panel title")});function T1({topics:t,title:e}){return q.jsxs("div",{className:"trend-panel trending-topics-panel",children:[q.jsxs("div",{className:"panel-header",children:[q.jsx("h3",{className:"panel-title",children:e}),q.jsx("span",{className:"panel-badge",children:t.length})]}),q.jsx("div",{className:"topics-list",children:t.length===0?q.jsxs("div",{className:"empty-state",children:[q.jsx("span",{className:"empty-icon",children:""}),q.jsx("p",{className:"empty-text",children:"No trending topics"})]}):t.map((n,r)=>q.jsxs("div",{className:"topic-item",children:[q.jsx("div",{className:"topic-rank",children:q.jsxs("span",{className:"rank-number",children:["#",r+1]})}),q.jsxs("div",{className:"topic-content",children:[q.jsxs("div",{className:"topic-header",children:[q.jsx("h4",{className:"topic-name",children:n.name}),q.jsx("div",{className:"topic-category",style:{backgroundColor:`${Kc(n.category)}20`,color:Kc(n.category),borderColor:Kc(n.category)},children:n.category})]}),q.jsxs("div",{className:"topic-metrics",children:[q.jsxs("div",{className:"metric",children:[q.jsx("span",{className:"metric-label",children:"Score"}),q.jsx("span",{className:"metric-value",children:n.score})]}),q.jsxs("div",{className:"metric",children:[q.jsx("span",{className:"metric-label",children:"Velocity"}),q.jsxs("div",{className:"velocity-indicator","data-direction":n.velocity,children:[n.velocity==="rising"&&" Rising",n.velocity==="stable"&&" Stable",n.velocity==="falling"&&" Falling"]})]})]})]}),q.jsx("div",{className:"topic-score-bar",children:q.jsx("div",{className:"score-fill",style:{width:`${n.score}%`,backgroundColor:Kc(n.category)}})})]},n.id))})]})}const M1=Pt({distribution:zW.describe("Platform distribution data from Tambo"),title:it().default("Platform Distribution").describe("Panel title")});function R1({distribution:t,title:e}){const{platforms:n,totalVolume:r}=t,i={youtube:"YouTube",x:"X (Twitter)",reddit:"Reddit",news:"News Sites"};return q.jsxs("div",{className:"trend-panel platform-distribution-panel",children:[q.jsxs("div",{className:"panel-header",children:[q.jsx("h3",{className:"panel-title",children:e}),q.jsxs("span",{className:"panel-subtitle",children:[r.toLocaleString()," total discussions"]})]}),q.jsxs("div",{className:"platform-chart",children:[q.jsx("div",{className:"distribution-bar",children:n.map(a=>q.jsx("div",{className:"bar-segment",style:{width:`${a.percentage}%`,backgroundColor:OT(a.platform)},title:`${i[a.platform]}: ${a.percentage}%`},a.platform))}),q.jsx("div",{className:"platform-legend",children:n.map(a=>q.jsxs("div",{className:"legend-item",children:[q.jsxs("div",{className:"legend-row",children:[q.jsxs("div",{className:"legend-label",children:[q.jsx("span",{className:"legend-dot",style:{backgroundColor:OT(a.platform)}}),q.jsx("span",{className:"legend-name",children:i[a.platform]})]}),q.jsxs("span",{className:"legend-percentage",children:[a.percentage,"%"]})]}),q.jsxs("div",{className:"legend-count",children:[a.count.toLocaleString()," discussions"]})]},a.platform))})]}),q.jsx("div",{className:"panel-footer",children:q.jsxs("span",{className:"update-time",children:["Last updated: ",new Date(t.updatedAt).toLocaleTimeString()]})})]})}const C1=Pt({velocity:BW.describe("Velocity data from Tambo"),title:it().default("Trend Velocity").describe("Panel title")});function A1({velocity:t,title:e}){const{current:n,direction:r,history:i,changePercent:a}=t,l=i.map(h=>h.value),c=Math.min(...l,-20),f=Math.max(...l,20)-c;return q.jsxs("div",{className:"trend-panel velocity-panel",children:[q.jsxs("div",{className:"panel-header",children:[q.jsx("h3",{className:"panel-title",children:e}),q.jsxs("div",{className:"velocity-badge",style:{backgroundColor:`${dl(r)}20`,color:dl(r),borderColor:dl(r)},children:[r==="rising"&&" Rising",r==="stable"&&" Stable",r==="falling"&&" Falling"]})]}),q.jsxs("div",{className:"velocity-current",children:[q.jsxs("div",{className:"velocity-value-container",children:[q.jsx("span",{className:"velocity-label",children:"Current Velocity"}),q.jsxs("span",{className:"velocity-value",style:{color:dl(r)},children:[n>0?"+":"",n]})]}),q.jsxs("div",{className:"velocity-change",children:[q.jsxs("span",{className:`change-value ${a>=0?"positive":"negative"}`,children:[a>=0?"":""," ",Math.abs(a).toFixed(1),"%"]}),q.jsx("span",{className:"change-label",children:"vs previous period"})]})]}),q.jsxs("div",{className:"velocity-graph",children:[q.jsxs("svg",{width:"100%",height:"120",className:"velocity-chart",children:[q.jsx("line",{x1:"0",y1:"60",x2:"100%",y2:"60",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:"1",strokeDasharray:"4 4"}),q.jsx("polyline",{fill:"none",stroke:dl(r),strokeWidth:"2",points:i.map((h,p)=>{const m=p/(i.length-1)*100,S=120-(h.value-c)/f*120;return`${m}%,${S}`}).join(" ")}),i.map((h,p)=>{const m=p/(i.length-1)*100,S=120-(h.value-c)/f*120;return q.jsx("circle",{cx:`${m}%`,cy:S,r:"3",fill:dl(r),opacity:p===i.length-1?1:.5},h.timestamp)})]}),q.jsxs("div",{className:"graph-labels",children:[q.jsx("span",{className:"label-left",children:i[0]?new Date(i[0].timestamp).toLocaleTimeString():""}),q.jsx("span",{className:"label-right",children:i[i.length-1]?new Date(i[i.length-1].timestamp).toLocaleTimeString():""})]})]}),q.jsxs("div",{className:"velocity-scale",children:[q.jsxs("div",{className:"scale-item",children:[q.jsx("span",{className:"scale-dot",style:{backgroundColor:"#ff6b6b"}}),q.jsx("span",{className:"scale-label",children:"Falling (< -20)"})]}),q.jsxs("div",{className:"scale-item",children:[q.jsx("span",{className:"scale-dot",style:{backgroundColor:"#4a9eff"}}),q.jsx("span",{className:"scale-label",children:"Stable (-20 to +20)"})]}),q.jsxs("div",{className:"scale-item",children:[q.jsx("span",{className:"scale-dot",style:{backgroundColor:"#00ff88"}}),q.jsx("span",{className:"scale-label",children:"Rising (> +20)"})]})]})]})}const HW=[{id:"tech",label:"Technology",color:"#00d9ff",icon:""},{id:"health",label:"Health & Wellness",color:"#00ff88",icon:""},{id:"finance",label:"Finance & Business",color:"#ffb347",icon:""},{id:"news",label:"News & Politics",color:"#b366ff",icon:""},{id:"entertainment",label:"Entertainment",color:"#ff66cc",icon:""}],GW=Pt({intro:_V.describe("Props for the intro section"),features:yV.shape.features.describe("Features to showcase"),globe:x1.describe("Props for the interactive 3D globe with trend hotspots"),trendPanels:Pt({topics:b1.shape.topics.describe("Trending topics data from Tambo"),distribution:M1.shape.distribution.describe("Platform distribution data from Tambo"),velocity:C1.shape.velocity.describe("Trend velocity data from Tambo")}).describe("Data for all trend panels - sourced from Tambo"),researchCTA:Pt({headline:it().describe("CTA headline"),buttonText:it().describe("Button text")}).describe("Research Now CTA props"),pageStatus:rs(["idle","loading","ready"]).describe("Overall page state")});function P1({intro:t,features:e,globe:n,trendPanels:r,researchCTA:i,pageStatus:a}){const[l,c]=V.useState(null);return q.jsxs("div",{className:"trendpulse-page",children:[q.jsx("div",{className:"page-status","data-status":a,children:a==="loading"&&q.jsx("div",{className:"status-pulse"})}),q.jsx(vV,{...t}),q.jsx(SV,{features:e}),q.jsxs("section",{className:"globe-section-improved",children:[q.jsx("div",{className:"section-marker",children:q.jsx("span",{className:"marker-label",children:"Trend Universe"})}),q.jsxs("div",{className:"globe-layout",children:[q.jsx("div",{className:"globe-main",children:q.jsx(E1,{...n,hoveredCategory:l||void 0})}),q.jsxs("aside",{className:"category-sidebar",children:[q.jsxs("div",{className:"category-header",children:[q.jsx("h3",{className:"category-title",children:"Categories"}),q.jsx("p",{className:"category-subtitle",children:"Hover to highlight"})]}),q.jsx("div",{className:"category-list",children:HW.map(u=>q.jsxs("button",{className:`category-item ${l===u.id?"active":""}`,onMouseEnter:()=>c(u.id),onMouseLeave:()=>c(null),style:{"--category-color":u.color},children:[q.jsx("span",{className:"category-icon",children:u.icon}),q.jsxs("div",{className:"category-content",children:[q.jsx("span",{className:"category-label",children:u.label}),q.jsx("div",{className:"category-indicator"})]})]},u.id))}),q.jsxs("div",{className:"category-hint",children:[q.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",className:"hint-icon",children:[q.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),q.jsx("path",{d:"M12 16v-4m0-4h.01",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),q.jsx("span",{className:"hint-text",children:"Node size indicates trend popularity"})]})]})]}),q.jsxs("div",{className:"globe-stats",children:[q.jsxs("div",{className:"stat-item",children:[q.jsx("span",{className:"stat-value",children:n.hotspots.length}),q.jsx("span",{className:"stat-label",children:"Active Trends"})]}),q.jsxs("div",{className:"stat-item",children:[q.jsx("span",{className:"stat-value",children:"Live"}),q.jsx("span",{className:"stat-label",children:"Real-time Data"})]}),q.jsxs("div",{className:"stat-item",children:[q.jsx("span",{className:"stat-value",children:"Global"}),q.jsx("span",{className:"stat-label",children:"Coverage"})]})]})]}),q.jsx("section",{className:"trend-panels-section",children:q.jsxs("div",{className:"trend-panels-container",children:[q.jsx("div",{className:"section-marker",children:q.jsx("span",{className:"marker-label",children:"Trend Analytics Dashboard"})}),q.jsxs("div",{className:"trend-panels-grid",children:[q.jsx(T1,{topics:r.topics,title:"Trending Topics"}),q.jsx(R1,{distribution:r.distribution,title:"Platform Distribution"}),q.jsx(A1,{velocity:r.velocity,title:"Trend Velocity"})]})]})}),q.jsx(wV,{...i})]})}const WW=[{name:"TrendPulsePage1",description:"Main TrendPulse landing page with refined intro section and interactive 3D globe displaying trend hotspots. The globe visualizes real-time trend data through color-coded markers positioned at geographic coordinates. Hotspot data is fully controlled by Tambo and updates reactively.",component:P1,propsSchema:GW},{name:"GlobeContainer",description:"Interactive 3D globe component with Tambo-orchestrated behavior and data visualization. Displays trend hotspots as glowing markers on the globe surface. Each hotspot has a category (tech/health/finance/news/entertainment) that determines its color, and an intensity (0-1) that controls size and opacity. Hotspots are positioned using lat/lng coordinates. The globe auto-rotates when idle (controlled by autoRotationSpeed). User can drag to manually rotate (if enableInteraction is true). Auto-rotation pauses during interaction and resumes after resumeDelayMs milliseconds. Hotspot data updates trigger immediate visual re-rendering without remounting.",component:E1,propsSchema:x1},{name:"TrendingTopicsList",description:"Persistent panel that displays a list of trending topics. Each topic shows: name, category (tech/health/finance/news/entertainment with color coding), score (0-100), and velocity (rising/stable/falling). Topics are ranked by their position in the list. The component NEVER sorts, filters, or fetches data - it only renders the topics array provided by Tambo. When Tambo updates the topics array, this panel re-renders immediately. Use this to prove that Tambo controls list content and ordering.",component:T1,propsSchema:b1},{name:"PlatformDistributionPanel",description:"Persistent panel that shows discussion volume distribution across platforms (YouTube, X/Twitter, Reddit, News Sites). Displays a horizontal stacked bar chart where each segment width represents the platform percentage. Shows percentage and absolute count for each platform, plus total discussion volume. The component NEVER calculates percentages or aggregates data - it only renders the distribution object provided by Tambo. When Tambo updates platform data, this chart updates immediately. Use this to prove multi-component orchestration alongside other trend panels.",component:R1,propsSchema:M1},{name:"TrendVelocityPanel",description:"Persistent panel that displays overall trend velocity (acceleration/deceleration). Shows current velocity value (-100 to +100), direction (rising/stable/falling), percent change from previous period, and a simple line graph of historical velocity over time. The component NEVER calculates velocity or derives trend direction - it only renders the velocity object provided by Tambo. When Tambo updates velocity data, the graph and indicators update immediately. Use this to demonstrate time-series data orchestration and prove multiple panels update together.",component:A1,propsSchema:C1}],qW=Pt({summaryText:it().nullable().describe("AI-generated topic summary - null when idle"),topicName:it().nullable().describe("Name of the researched topic - null when idle"),lastUpdated:it().nullable().describe("ISO timestamp of last update - null when idle")});function ZW({summaryText:t,topicName:e,lastUpdated:n}){const r=!t;return q.jsxs("div",{className:"insight-panel topic-summary-panel",children:[q.jsxs("div",{className:"panel-header",children:[q.jsxs("div",{className:"panel-title-row",children:[q.jsx("span",{className:"panel-icon",children:""}),q.jsx("h3",{className:"panel-title",children:"Topic Summary"})]}),n&&q.jsxs("span",{className:"panel-timestamp",children:["Updated ",new Date(n).toLocaleTimeString()]})]}),q.jsx("div",{className:"panel-content",children:r?q.jsxs("div",{className:"panel-placeholder",children:[q.jsx("div",{className:"placeholder-icon",children:""}),q.jsx("p",{className:"placeholder-text",children:"Topic summary will appear here once research begins."}),q.jsx("p",{className:"placeholder-hint",children:"Enter a research query to get started"})]}):q.jsxs("div",{className:"summary-content",children:[e&&q.jsxs("div",{className:"summary-topic",children:[q.jsx("span",{className:"topic-label",children:"Topic:"}),q.jsx("span",{className:"topic-name",children:e})]}),q.jsx("div",{className:"summary-text",children:t})]})})]})}const XW=Pt({text:it().describe("Keyword text"),relevance:fn().min(0).max(100).describe("Relevance score 0-100")}),KW=Pt({keywords:ji(XW).describe("List of extracted keywords - empty when idle"),maxKeywords:fn().default(8).describe("Maximum keywords to display")});function YW({keywords:t,maxKeywords:e}){const n=t.length===0,r=t.slice(0,e);return q.jsxs("div",{className:"insight-panel key-keywords-panel",children:[q.jsxs("div",{className:"panel-header",children:[q.jsxs("div",{className:"panel-title-row",children:[q.jsx("span",{className:"panel-icon",children:""}),q.jsx("h3",{className:"panel-title",children:"Key Keywords"})]}),!n&&q.jsx("span",{className:"panel-badge",children:t.length})]}),q.jsx("div",{className:"panel-content",children:n?q.jsxs("div",{className:"panel-placeholder",children:[q.jsx("div",{className:"placeholder-icon",children:""}),q.jsx("p",{className:"placeholder-text",children:"Important keywords will be extracted here"}),q.jsx("p",{className:"placeholder-hint",children:"These help identify core themes and topics"})]}):q.jsx("div",{className:"keywords-grid",children:r.map((i,a)=>q.jsxs("div",{className:"keyword-tag","data-relevance":i.relevance>=80?"high":i.relevance>=50?"medium":"low",children:[q.jsx("span",{className:"keyword-text",children:i.text}),q.jsxs("span",{className:"keyword-score",children:[i.relevance,"%"]})]},a))})})]})}const JW=Pt({title:it().describe("Suggested video title"),angle:it().describe("Content angle or hook"),estimatedViews:it().nullable().describe('Estimated view potential (e.g. "10K-50K")'),difficulty:rs(["easy","medium","hard"]).describe("Production difficulty")}),QW=Pt({angles:ji(JW).describe("List of suggested video angles - empty when idle"),maxAngles:fn().default(5).describe("Maximum angles to display")});function e6({angles:t,maxAngles:e}){const n=t.length===0,r=t.slice(0,e),i={easy:{label:"Easy",color:"#00ff88"},medium:{label:"Medium",color:"#ffb347"},hard:{label:"Hard",color:"#ff6b6b"}};return q.jsxs("div",{className:"insight-panel video-angles-panel",children:[q.jsxs("div",{className:"panel-header",children:[q.jsxs("div",{className:"panel-title-row",children:[q.jsx("span",{className:"panel-icon",children:""}),q.jsx("h3",{className:"panel-title",children:"Suggested Video Angles"})]}),!n&&q.jsx("span",{className:"panel-badge",children:t.length})]}),q.jsx("div",{className:"panel-content",children:n?q.jsxs("div",{className:"panel-placeholder",children:[q.jsx("div",{className:"placeholder-icon",children:""}),q.jsx("p",{className:"placeholder-text",children:"AI-generated video ideas will appear here"}),q.jsx("p",{className:"placeholder-hint",children:"Each suggestion includes title, angle, and difficulty"})]}):q.jsx("div",{className:"video-angles-list",children:r.map((a,l)=>q.jsxs("div",{className:"video-angle-card",children:[q.jsxs("div",{className:"angle-header",children:[q.jsxs("span",{className:"angle-number",children:["#",l+1]}),q.jsx("div",{className:"angle-difficulty",style:{backgroundColor:`${i[a.difficulty].color}20`,color:i[a.difficulty].color,borderColor:i[a.difficulty].color},children:i[a.difficulty].label})]}),q.jsx("h4",{className:"angle-title",children:a.title}),q.jsx("p",{className:"angle-description",children:a.angle}),a.estimatedViews&&q.jsxs("div",{className:"angle-footer",children:[q.jsx("span",{className:"angle-metric-label",children:"Est. Views:"}),q.jsx("span",{className:"angle-metric-value",children:a.estimatedViews})]})]},l))})})]})}const t6=rs(["idle","analyzing","complete","error"]).describe("Current research status"),n6=Pt({status:t6.describe("Current research status"),statusMessage:it().describe("Human-readable status message"),confidenceScore:fn().min(0).max(100).nullable().describe("Research confidence 0-100 - null when idle"),dataPoints:fn().nullable().describe("Number of data points analyzed - null when idle")});function r6({status:t,statusMessage:e,confidenceScore:n,dataPoints:r}){const a={idle:{label:"Idle",color:"#4a9eff",icon:""},analyzing:{label:"Analyzing",color:"#ffb347",icon:""},complete:{label:"Complete",color:"#00ff88",icon:""},error:{label:"Error",color:"#ff6b6b",icon:""}}[t];return q.jsxs("div",{className:"insight-panel research-status-panel",children:[q.jsx("div",{className:"panel-header",children:q.jsxs("div",{className:"panel-title-row",children:[q.jsx("span",{className:"panel-icon",children:""}),q.jsx("h3",{className:"panel-title",children:"Research Status"})]})}),q.jsxs("div",{className:"panel-content",children:[q.jsxs("div",{className:"status-indicator",children:[q.jsxs("div",{className:"status-badge",style:{backgroundColor:`${a.color}20`,color:a.color,borderColor:a.color},children:[q.jsx("span",{className:"status-icon",children:a.icon}),q.jsx("span",{className:"status-label",children:a.label})]}),q.jsx("p",{className:"status-message",children:e})]}),n!==null&&q.jsxs("div",{className:"confidence-section",children:[q.jsxs("div",{className:"confidence-header",children:[q.jsx("span",{className:"confidence-label",children:"Confidence Score"}),q.jsxs("span",{className:"confidence-value",children:[n,"%"]})]}),q.jsx("div",{className:"confidence-bar",children:q.jsx("div",{className:"confidence-fill",style:{width:`${n}%`,backgroundColor:n>=80?"#00ff88":n>=60?"#ffb347":"#ff6b6b"}})}),q.jsxs("p",{className:"confidence-interpretation",children:[n>=80&&"High confidence - results are reliable",n>=60&&n<80&&"Moderate confidence - results are useful",n<60&&"Low confidence - limited data available"]})]}),r!==null&&q.jsx("div",{className:"data-points-section",children:q.jsxs("div",{className:"data-points-row",children:[q.jsx("span",{className:"data-points-label",children:"Data Points Analyzed"}),q.jsx("span",{className:"data-points-value",children:r.toLocaleString()})]})}),t==="idle"&&q.jsx("div",{className:"idle-helper",children:q.jsx("p",{className:"helper-text",children:"Ready to analyze trends. Enter a research query to begin."})})]})]})}Pt({onSubmit:du().args(it()).returns(uu()).describe("Callback when user submits research query"),isProcessing:so().default(!1).describe("Whether research is currently processing"),placeholder:it().default("What trend would you like to research?").describe("Input placeholder text")});function i6({onSubmit:t,isProcessing:e,placeholder:n}){const[r,i]=qt.useState(""),a=l=>{l.preventDefault(),r.trim()&&!e&&(t(r.trim()),i(""))};return q.jsxs("div",{className:"research-input-panel",children:[q.jsxs("div",{className:"input-panel-header",children:[q.jsx("h2",{className:"input-panel-title",children:"Research a Trend"}),q.jsx("p",{className:"input-panel-description",children:"Ask questions about trends, topics, or content ideas. Get AI-powered insights to guide your creative strategy."})]}),q.jsxs("form",{onSubmit:a,className:"research-form",children:[q.jsx("textarea",{className:"research-textarea",value:r,onChange:l=>i(l.target.value),placeholder:n,disabled:e,rows:6}),q.jsxs("div",{className:"example-queries",children:[q.jsx("span",{className:"example-label",children:"Try asking:"}),q.jsxs("div",{className:"example-list",children:[q.jsx("button",{type:"button",className:"example-query",onClick:()=>i("What's trending in science this week?"),disabled:e,children:`"What's trending in science this week?"`}),q.jsx("button",{type:"button",className:"example-query",onClick:()=>i("What video should I make about AI?"),disabled:e,children:'"What video should I make about AI?"'}),q.jsx("button",{type:"button",className:"example-query",onClick:()=>i("Show me rising topics in gaming"),disabled:e,children:'"Show me rising topics in gaming"'})]})]}),q.jsx("button",{type:"submit",className:"research-submit-button",disabled:!r.trim()||e,children:e?q.jsxs(q.Fragment,{children:[q.jsx("span",{className:"button-spinner",children:""}),"Analyzing..."]}):q.jsxs(q.Fragment,{children:[q.jsx("span",{className:"button-icon",children:""}),"Research"]})})]}),q.jsx("div",{className:"input-panel-footer",children:q.jsxs("p",{className:"footer-hint",children:[q.jsx("span",{className:"hint-icon",children:""}),"Results will appear in the insight panels on the left"]})})]})}Pt({topicSummary:qW.describe("Topic summary panel data"),keywords:KW.describe("Keywords panel data"),videoAngles:QW.describe("Video angles panel data"),status:n6.describe("Research status panel data"),onResearchSubmit:du().args(it()).returns(aL(uu())).describe("Research submit handler from Tambo"),isProcessing:so().describe("Whether research is currently processing")});function s6({topicSummary:t,keywords:e,videoAngles:n,status:r,onResearchSubmit:i,isProcessing:a}){const l=Wv(),c=async u=>{console.log(" User query:",u),console.log(" Forwarding to Tambo orchestration..."),await i(u),console.log(" Tambo orchestration complete")};return q.jsxs("div",{className:"research-copilot-page",children:[q.jsx("header",{className:"page-header",children:q.jsxs("div",{className:"header-content",children:[q.jsxs("button",{onClick:()=>l("/"),className:"back-link",style:{background:"none",border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",padding:0},children:[q.jsx("span",{className:"back-arrow",children:""}),q.jsx("span",{className:"back-text",children:"Back to Trends"})]}),q.jsx("h1",{className:"page-heading",children:"Research Copilot"})]})}),q.jsxs("div",{className:"page-layout",children:[q.jsx("aside",{className:"insights-panel-container",children:q.jsxs("div",{className:"insights-panel-inner",children:[q.jsxs("div",{className:"section-label",children:[q.jsx("span",{className:"label-icon",children:""}),q.jsx("span",{className:"label-text",children:"Research Insights"})]}),q.jsxs("div",{className:"insights-stack",children:[q.jsx(ZW,{...t}),q.jsx(YW,{...e}),q.jsx(e6,{...n}),q.jsx(r6,{...r})]}),!1]})}),q.jsx("main",{className:"input-panel-container",children:q.jsx("div",{className:"input-panel-inner",children:q.jsx(i6,{onSubmit:c,isProcessing:a,placeholder:"What trend would you like to research?"})})})]})]})}const a6=[{id:"sf-tech",lat:37.7749,lng:-122.4194,intensity:.9,category:"tech"},{id:"nyc-finance",lat:40.7128,lng:-74.006,intensity:.75,category:"finance"},{id:"london-news",lat:51.5074,lng:-.1278,intensity:.85,category:"news"},{id:"berlin-health",lat:52.52,lng:13.405,intensity:.6,category:"health"},{id:"tokyo-entertainment",lat:35.6762,lng:139.6503,intensity:.8,category:"entertainment"},{id:"singapore-tech",lat:1.3521,lng:103.8198,intensity:.7,category:"tech"},{id:"mumbai-entertainment",lat:19.076,lng:72.8777,intensity:.65,category:"entertainment"},{id:"sao-paulo-news",lat:-23.5505,lng:-46.6333,intensity:.55,category:"news"},{id:"lagos-tech",lat:6.5244,lng:3.3792,intensity:.5,category:"tech"},{id:"sydney-health",lat:-33.8688,lng:151.2093,intensity:.7,category:"health"}];function o6(t,e=.2){const n=(Math.random()-.5)*2*e,r=t+n;return Math.max(.3,Math.min(1,r))}function l6(t){return t.map(e=>({...e,intensity:o6(e.intensity,.15)}))}const c6=[{id:"topic-1",name:"AI Regulation Framework",category:"tech",score:95,velocity:"rising"},{id:"topic-2",name:"Global Climate Summit",category:"news",score:87,velocity:"rising"},{id:"topic-3",name:"Mental Health Awareness",category:"health",score:76,velocity:"stable"},{id:"topic-4",name:"Cryptocurrency Market Shift",category:"finance",score:68,velocity:"falling"},{id:"topic-5",name:"Streaming Platform Wars",category:"entertainment",score:54,velocity:"stable"}];function u6(t){return t.map(e=>{const n=(Math.random()-.5)*20,r=Math.max(10,Math.min(100,e.score+n));let i="stable";return n>5?i="rising":n<-5&&(i="falling"),{...e,score:Math.round(r),velocity:i}})}const d6={platforms:[{platform:"youtube",percentage:35,count:45200},{platform:"x",percentage:28,count:36100},{platform:"reddit",percentage:22,count:28400},{platform:"news",percentage:15,count:19300}],totalVolume:129e3,updatedAt:new Date().toISOString()};function f6(t){const e=t.platforms.map(()=>Math.random()),n=e.reduce((c,u)=>c+u,0),r=e.map(c=>c/n),i=t.platforms.map((c,u)=>{const f=(Math.random()-.5)*10,h=Math.max(5,Math.min(50,r[u]*100+f));return{...c,percentage:Math.round(h),count:Math.round(h/100*t.totalVolume)}}),l=100-i.reduce((c,u)=>c+u.percentage,0);return l!==0&&(i[0].percentage+=l,i[0].count=Math.round(i[0].percentage/100*t.totalVolume)),{...t,platforms:i,updatedAt:new Date().toISOString()}}function h6(){const t=[],e=Date.now();for(let n=9;n>=0;n--){const r=new Date(e-n*6e4),i=Math.sin(n/3)*30+(Math.random()-.5)*10;t.push({timestamp:r.toISOString(),value:Math.round(i)})}return t}const p6={current:35,direction:"rising",history:h6(),changePercent:12.5};function m6(t){const e=t.history[t.history.length-1]?.value||0,n=(Math.random()-.5)*20,r=Math.max(-100,Math.min(100,e+n));let i="stable";r>20?i="rising":r<-20&&(i="falling");const a=e!==0?(r-e)/Math.abs(e)*100:0,l=[...t.history.slice(1),{timestamp:new Date().toISOString(),value:Math.round(r)}];return{current:Math.round(r),direction:i,history:l,changePercent:Math.round(a*10)/10}}function g6(t){return{topics:u6(t.topics),distribution:f6(t.distribution),velocity:m6(t.velocity)}}function _6(){return{topics:c6,distribution:d6,velocity:p6}}const v6=Pt({text:it().describe("Keyword text"),relevance:fn().min(0).max(100).describe("Relevance score 0-100")}),y6=Pt({title:it().describe("Suggested video title"),angle:it().describe("Content angle or hook"),estimatedViews:it().nullable().describe('Estimated view potential (e.g. "10K-50K")'),difficulty:rs(["easy","medium","hard"]).describe("Production difficulty")}),S6=rs(["idle","analyzing","complete","error"]);Pt({researchStatus:S6.describe("Current research phase"),statusMessage:it().describe("Human-readable status message"),query:it().nullable().describe("User research query"),topicName:it().nullable().describe("Extracted topic name"),summaryText:it().nullable().describe("AI-generated topic summary"),keywords:ji(v6).describe("Extracted keywords"),videoIdeas:ji(y6).describe("Video content suggestions"),confidenceScore:fn().min(0).max(100).nullable().describe("Research confidence 0-100"),dataPoints:fn().nullable().describe("Number of data points analyzed"),lastUpdated:it().nullable().describe("ISO timestamp of last update")});const w6={researchStatus:"idle",statusMessage:"Ready to research",query:null,topicName:null,summaryText:null,keywords:[],videoIdeas:[],confidenceScore:null,dataPoints:null,lastUpdated:null},DT={ai:"Artificial intelligence continues to dominate tech discussions, with particular focus on large language models, AI safety regulations, and the democratization of AI tools. Recent developments in open-source AI and concerns about job displacement are driving significant conversation volume.",climate:"Climate change remains a critical global topic with increasing urgency. Discussions center on renewable energy adoption, carbon capture technology, and international climate agreements. Youth activism and corporate sustainability commitments are emerging as key subtopics.",crypto:"Cryptocurrency markets show renewed interest following regulatory clarity in major economies. Bitcoin and Ethereum continue to lead discussions, while decentralized finance (DeFi) and NFT utility cases are evolving beyond initial hype cycles.",health:"Healthcare innovation is accelerating with focus on personalized medicine, mental health awareness, and preventive care technologies. Telehealth adoption remains strong post-pandemic, and wearable health devices are becoming mainstream.",default:"This topic is gaining traction across multiple platforms with diverse perspectives. Key themes include innovation, community engagement, and practical applications. Discussion volume indicates growing mainstream interest and potential for viral growth."},UT={ai:[{text:"ChatGPT",relevance:95},{text:"Machine Learning",relevance:88},{text:"AI Ethics",relevance:82},{text:"Automation",relevance:76},{text:"Neural Networks",relevance:71},{text:"GPT-4",relevance:68},{text:"AI Safety",relevance:65},{text:"Deep Learning",relevance:62}],climate:[{text:"Renewable Energy",relevance:92},{text:"Carbon Emissions",relevance:89},{text:"Climate Action",relevance:85},{text:"Sustainability",relevance:78},{text:"Green Technology",relevance:73},{text:"Climate Crisis",relevance:70},{text:"Solar Power",relevance:66},{text:"Climate Policy",relevance:63}],crypto:[{text:"Bitcoin",relevance:94},{text:"Ethereum",relevance:87},{text:"Blockchain",relevance:83},{text:"DeFi",relevance:79},{text:"Web3",relevance:74},{text:"Crypto Regulation",relevance:71},{text:"NFT",relevance:67},{text:"Smart Contracts",relevance:64}],health:[{text:"Mental Health",relevance:91},{text:"Wellness",relevance:86},{text:"Telemedicine",relevance:81},{text:"Health Tech",relevance:77},{text:"Fitness",relevance:72},{text:"Nutrition",relevance:69},{text:"Preventive Care",relevance:65},{text:"Wearables",relevance:61}],default:[{text:"Innovation",relevance:85},{text:"Community",relevance:78},{text:"Growth",relevance:72},{text:"Engagement",relevance:68},{text:"Technology",relevance:64},{text:"Future",relevance:60}]},FT={ai:[{title:"I Tested ChatGPT Against My Job for 24 Hours",angle:"Personal experiment comparing AI vs human performance in real tasks",difficulty:"medium",estimatedViews:"50K-150K"},{title:"The AI Tools That Actually Changed My Life",angle:"Practical guide to productivity-boosting AI tools with honest reviews",difficulty:"easy",estimatedViews:"30K-80K"},{title:"Why AI Will NOT Replace Humans (But This Will)",angle:"Contrarian take on AI job displacement with nuanced analysis",difficulty:"hard",estimatedViews:"100K-300K"},{title:"Building a Business Using Only AI in 2024",angle:"Case study documenting AI-powered business creation journey",difficulty:"medium",estimatedViews:"60K-120K"}],climate:[{title:"I Went Zero Waste for 30 Days  Here's What Happened",angle:"Personal challenge documenting lifestyle changes and impact",difficulty:"easy",estimatedViews:"40K-100K"},{title:"The Climate Solutions Nobody Talks About",angle:"Investigating underreported innovations in climate technology",difficulty:"hard",estimatedViews:"80K-200K"},{title:"How to Actually Reduce Your Carbon Footprint",angle:"Data-driven guide to effective personal climate action",difficulty:"medium",estimatedViews:"50K-120K"}],crypto:[{title:"I Invested $1000 in Crypto  1 Year Update",angle:"Honest portfolio review with lessons learned",difficulty:"easy",estimatedViews:"60K-150K"},{title:"Crypto vs Traditional Finance: The Real Comparison",angle:"Educational breakdown of advantages and disadvantages",difficulty:"medium",estimatedViews:"70K-180K"},{title:"The Future of Money Nobody Sees Coming",angle:"Forward-looking analysis of blockchain adoption trends",difficulty:"hard",estimatedViews:"90K-250K"}],default:[{title:"What Everyone Gets Wrong About [Topic]",angle:"Myth-busting common misconceptions with expert insights",difficulty:"medium",estimatedViews:"40K-100K"},{title:"I Tried [Topic] for 30 Days  Honest Review",angle:"Personal experiment with daily documentation",difficulty:"easy",estimatedViews:"30K-80K"},{title:"The Hidden Truth About [Topic]",angle:"Investigative deep-dive into lesser-known aspects",difficulty:"hard",estimatedViews:"60K-150K"}]};function Up(t){const e=t.toLowerCase();return e.includes("ai")||e.includes("artificial intelligence")||e.includes("chatgpt")||e.includes("machine learning")?"ai":e.includes("climate")||e.includes("environment")||e.includes("sustainability")||e.includes("green")?"climate":e.includes("crypto")||e.includes("bitcoin")||e.includes("blockchain")||e.includes("web3")?"crypto":e.includes("health")||e.includes("wellness")||e.includes("fitness")||e.includes("medical")?"health":"default"}function x6(t){const e=Up(t);return{ai:"Artificial Intelligence",climate:"Climate Change",crypto:"Cryptocurrency",health:"Health & Wellness",default:t.split(" ").slice(0,3).join(" ").replace(/[?!.]/g,"")}[e]||"Trending Topic"}function E6(t){const e=Up(t);return DT[e]||DT.default}function b6(t){const e=Up(t);return UT[e]||UT.default}function T6(t){const e=Up(t);return(FT[e]||FT.default).map(r=>({...r,estimatedViews:r.estimatedViews||null}))}function M6(){return Math.floor(Math.random()*30)+65}function R6(){return Math.floor(Math.random()*4e3)+1e3}async function C6(t,e){const n=x6(t);e({researchStatus:"analyzing",statusMessage:"Analyzing topic...",query:t,topicName:n,summaryText:null,keywords:[],videoIdeas:[],confidenceScore:null,dataPoints:null,lastUpdated:new Date().toISOString()}),await new Promise(r=>setTimeout(r,800)),e({statusMessage:"Generating summary...",summaryText:E6(t),lastUpdated:new Date().toISOString()}),await new Promise(r=>setTimeout(r,600)),e({statusMessage:"Extracting keywords...",keywords:b6(t),lastUpdated:new Date().toISOString()}),await new Promise(r=>setTimeout(r,700)),e({statusMessage:"Generating video ideas...",videoIdeas:T6(t),lastUpdated:new Date().toISOString()}),await new Promise(r=>setTimeout(r,500)),e({researchStatus:"complete",statusMessage:"Research complete",confidenceScore:M6(),dataPoints:R6(),lastUpdated:new Date().toISOString()})}async function A6(t,e){if(!t||t.type!=="research_request"||!t.query){e({researchStatus:"error",statusMessage:"Invalid research request",lastUpdated:new Date().toISOString()});return}e({researchStatus:"analyzing",statusMessage:"Interpreting request...",query:t.query,topicName:null,summaryText:null,keywords:[],videoIdeas:[],confidenceScore:null,dataPoints:null,lastUpdated:new Date().toISOString()});try{await C6(t.query,e)}catch(n){console.error("[Orchestrator] Error:",n),e({researchStatus:"error",statusMessage:"Research failed - please try again",lastUpdated:new Date().toISOString()})}}function P6(){const t=Wv(),e="tambo_mPXXBlHaO1/Ul9DhLWNSl9c1Mb1Sftu9Blpkah47PzD3NZ+vXkoMTa61+PgXj90nXVhdU31nk47AHxX4XR4u9WdHB+G6XeI3JWV23JT5Uf4=",[n,r]=V.useState(a6),[i,a]=V.useState(_6()),[l,c]=V.useState(w6),[u,f]=V.useState(!1);V.useEffect(()=>{const y=setInterval(()=>{r(S=>l6(S)),a(S=>g6(S))},8e3);return()=>clearInterval(y)},[]);const h=async y=>{console.log(" Research intent sent to Tambo conductor:",y),f(!0);try{await A6({type:"research_request",query:y},S=>{console.log(" TAMBO UPDATE:",S),c(E=>({...E,...S}))}),console.log(" Research orchestration complete")}catch(S){console.error("Research orchestration error",S),c(E=>({...E,researchStatus:"error",statusMessage:"Research failed - try again",lastUpdated:new Date().toISOString()}))}finally{f(!1)}},p={intro:{title:"See what the world is talking about",description:"Track emerging conversations before they become headlines. Understand what matters to people across the globe, spot patterns early, and stay ahead of the curve.",subtleHint:"Scroll to explore",introState:"ready"},features:[{icon:"",title:"Global Conversations",description:"Monitor real-time discussions happening across continents and cultures."},{icon:"",title:"Trend Analysis",description:"Identify patterns and emerging topics before they hit mainstream."},{icon:"",title:"Smart Insights",description:"Get actionable intelligence on what matters most to your audience."},{icon:"",title:"Real-Time Updates",description:"Stay current with live data streaming from around the world."}],globe:{radius:250,color:"#4adfff",opacity:.9,wireframe:!0,autoRotationSpeed:.002,enableInteraction:!0,resumeDelayMs:1500,hotspots:n},trendPanels:{topics:i.topics,distribution:i.distribution,velocity:i.velocity},researchCTA:{headline:"Ready to explore?",buttonText:"Research Now",onNavigate:()=>t("/research")},pageStatus:"ready"},m={topicSummary:{summaryText:l.summaryText,topicName:l.topicName,lastUpdated:l.lastUpdated},keywords:{keywords:l.keywords,maxKeywords:8},videoAngles:{angles:l.videoIdeas,maxAngles:5},status:{status:l.researchStatus,statusMessage:l.statusMessage,confidenceScore:l.confidenceScore,dataPoints:l.dataPoints}};return q.jsx(pV,{apiKey:e,components:WW,children:q.jsxs(gN,{children:[q.jsx(A_,{path:"/",element:q.jsx(P1,{...p})}),q.jsx(A_,{path:"/research",element:q.jsx(s6,{...m,onResearchSubmit:h,isProcessing:u})})]})})}function I6(){return q.jsx($N,{children:q.jsx(P6,{})})}yI.createRoot(document.getElementById("root")).render(q.jsx(qt.StrictMode,{children:q.jsx(I6,{})}));export{sq as $,HL as A,dR as B,WL as C,VL as D,zL as E,JL as F,jL as G,$L as H,DL as I,UL as J,QL as K,YL as L,h8 as M,GL as N,BL as O,XL as P,hp as Q,qL as R,qO as S,Q6 as T,iq as U,VO as V,OO as W,bO as X,iO as Y,aO as Z,Ho as _,M2 as a,d2 as a$,FO as a0,MM as a1,lq as a2,nO as a3,_O as a4,vO as a5,pO as a6,hO as a7,gO as a8,mO as a9,cq as aA,tq as aB,dq as aC,_R as aD,Mt as aE,uO as aF,sO as aG,rO as aH,nq as aI,gR as aJ,rq as aK,dO as aL,W6 as aM,_e as aN,mq as aO,pq as aP,eO as aQ,tx as aR,lL as aS,_q as aT,T2 as aU,f2 as aV,h2 as aW,Eq as aX,E2 as aY,s8 as aZ,u2 as a_,DO as aa,MO as ab,fO as ac,hq as ad,zO as ae,aq as af,uq as ag,oO as ah,NO as ai,HO as aj,AO as ak,BO as al,pR as am,RO as an,LO as ao,$O as ap,vR as aq,jO as ar,fq as as,WO as at,fp as au,UO as av,yR as aw,oq as ax,pp as ay,gn as az,IO as b,CM as b$,bq as b0,xq as b1,Iq as b2,w2 as b3,gq as b4,r2 as b5,i2 as b6,z2 as b7,Pq as b8,n8 as b9,xR as bA,Yq as bB,A2 as bC,q_ as bD,ph as bE,qq as bF,wR as bG,Uq as bH,Bq as bI,Oh as bJ,Fq as bK,ex as bL,Nq as bM,n2 as bN,Kq as bO,Lq as bP,R2 as bQ,Dq as bR,r8 as bS,Oq as bT,L2 as bU,b2 as bV,t8 as bW,S2 as bX,e8 as bY,bu as bZ,RM as b_,jq as ba,p2 as bb,KO as bc,t2 as bd,k2 as be,Xq as bf,Jq as bg,vq as bh,yq as bi,Z_ as bj,mh as bk,Qw as bl,I2 as bm,x2 as bn,Sq as bo,Tq as bp,Hq as bq,l2 as br,c2 as bs,_2 as bt,g2 as bu,y2 as bv,v2 as bw,m2 as bx,o2 as by,c8 as bz,Gq as c,Hr as c$,a8 as c0,kq as c1,u8 as c2,$q as c3,o8 as c4,Wq as c5,$2 as c6,C2 as c7,AM as c8,IM as c9,Ea as cA,ns as cB,EL as cC,bL as cD,G_ as cE,jc as cF,hR as cG,xO as cH,TO as cI,X6 as cJ,J6 as cK,ZO as cL,PM as cM,ML as cN,TL as cO,B2 as cP,Z6 as cQ,q6 as cR,tO as cS,VU as cT,VR as cU,ox as cV,aU as cW,oU as cX,jR as cY,sU as cZ,p8 as c_,Zq as ca,zq as cb,N2 as cc,XO as cd,f8 as ce,d8 as cf,i8 as cg,Rq as ch,l8 as ci,D2 as cj,U2 as ck,Qq as cl,O2 as cm,wq as cn,Mq as co,s2 as cp,Cq as cq,Vq as cr,P2 as cs,SR as ct,YO as cu,JO as cv,QO as cw,e2 as cx,Aq as cy,a2 as cz,F2 as d,lU as d0,cU as d1,uU as d2,HR as d3,dU as d4,GR as d5,Xt as d6,hU as d7,pU as d8,mU as d9,_U as da,vU as db,wU as dc,xU as dd,EU as de,bU as df,MU as dg,RU as dh,CU as di,IU as dj,NU as dk,kU as dl,FU as dm,qR as dn,LU as dp,WR as dq,OU as dr,DU as ds,TU as dt,UU as du,Uh as dv,zU as dw,tn as dx,Pi as dy,kO as e,Y6 as f,PO as g,fu as h,wO as i,pL as j,EO as k,CO as l,eq as m,mR as n,yO as o,K6 as p,SO as q,lO as r,mM as s,cO as t,GO as u,Dn as v,FL as w,KL as x,fR as y,ZL as z};
